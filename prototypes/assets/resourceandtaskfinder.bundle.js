"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
var ReactComponents_resourceandtaskfinder;
(self["webpackChunkReactComponents_"] = self["webpackChunkReactComponents_"] || []).push([["resourceandtaskfinder"],{

/***/ "./CommonScripts/sharedscripts/sharedscripts-npcommon.js":
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"handleAjaxError\": function() { return /* binding */ handleAjaxError; },\n/* harmony export */   \"hasAltKey\": function() { return /* binding */ hasAltKey; },\n/* harmony export */   \"hasMetaKey\": function() { return /* binding */ hasMetaKey; },\n/* harmony export */   \"insertCover\": function() { return /* binding */ insertCover; },\n/* harmony export */   \"removeCover\": function() { return /* binding */ removeCover; }\n/* harmony export */ });\n/* harmony import */ var _sentry_browser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./node_modules/@sentry/hub/esm/exports.js\");\n/* harmony import */ var _sharedscripts_sentry__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./CommonScripts/sharedscripts/sharedscripts-sentry.js\");\n/* eslint-disable no-unused-vars, func-names */\n/* global ajax request handling */\n\n\n$.ajaxSetup({\n  timeout: 60000\n});\n\n// the 'busy' spinner shows in the right-hand corner when an ajax request is running or a page navigation link was clicked\n$(document).ajaxStart(function () {\n  $('#status').addClass('busy').children('.message').html('BUSY');\n});\n$(window).on('beforeunload', function () {\n  $('#status').addClass('busy').children('.message').html('BUSY');\n});\n$(document).ajaxStop(function () {\n  $('#status').removeClass('busy').not('.lost').children('.message').html('');\n});\nfunction alertInternalServerError(errorDialogHTML) {\n  if (errorDialogHTML) $('body').append(errorDialogHTML);\n}\nfunction alertConnectionLost(message) {\n  alert(message);\n  window.location = '/';\n}\nfunction alertUnreportableError(message) {\n  alert(message);\n}\nfunction setOffline() {\n  $('#status').removeClass('busy').addClass('lost').children('.message').html('OFFLINE');\n}\n\n// tempo var to suppress multiple warning (should replace with nice encapsulated var)\nvar warningGiven;\nfunction handleAjaxError(e, jqXHR, ajaxSettings, thrownError) {\n  function logToSentry() {\n    if ((0,_sharedscripts_sentry__WEBPACK_IMPORTED_MODULE_0__.isSentryInitialized)()) {\n      _sentry_browser__WEBPACK_IMPORTED_MODULE_1__.withScope(function (scope) {\n        var extraData = {\n          type: ajaxSettings.type,\n          url: ajaxSettings.url,\n          data: ajaxSettings.data,\n          status: jqXHR.status,\n          error: thrownError || jqXHR.statusText,\n          response: jqXHR.responseText ? jqXHR.responseText.substring(0, 100) : undefined\n        };\n        scope.setExtras(extraData);\n        _sentry_browser__WEBPACK_IMPORTED_MODULE_1__.captureMessage(thrownError || jqXHR.statusText);\n      });\n    }\n  }\n  switch (jqXHR.status) {\n    case 500:\n      // Server-side error, use the communicated error message\n      setOffline();\n      // If an error happens however in a block with as response type Javascript, we need to manually evaluate the response text\n      if (jqXHR.getResponseHeader('content-type') === 'text/javascript') eval(jqXHR.responseText);\n      alertInternalServerError(jqXHR.getResponseHeader('content-type') === 'text/html' ? jqXHR.responseText : null);\n      logToSentry();\n      break;\n    case 403:\n      setOffline();\n      if ($('.panel--error').length === 0 && warningGiven === undefined) {\n        warningGiven = true;\n        alertConnectionLost('Connection with server has been lost. You need to login again. (error 403)');\n      }\n      break;\n    case 0:\n      if (jqXHR.statusText !== 'timeout') break;\n    // client-cancelled request: skip this one\n    // eslint-disable-next-line no-fallthrough\n    default:\n      if ($('.panel--error').length === 0 && warningGiven === undefined) {\n        warningGiven = true;\n        if (thrownError !== '' && thrownError !== 'timeout') {\n          logToSentry();\n          alertUnreportableError(\"Yesplan encountered an unreportable error: \".concat(thrownError));\n        } else {\n          setOffline();\n          alertConnectionLost(\"Connection with server has been lost. You need to login again. (error \".concat(jqXHR.status, \") - \").concat(thrownError, \" - \").concat(jqXHR.statusText, \" - \").concat(jqXHR.responseText, \" - \").concat(ajaxSettings.url));\n        }\n      }\n  }\n}\n$(document).ajaxError(handleAjaxError);\n\n/* cover insertion */\nfunction insertCover() {\n  if ($('.cover').length === 0) {\n    var bodyEl = $('body');\n    bodyEl.append('<div class=\"cover\"> </div>');\n    bodyEl.css({\n      'overflow': 'hidden'\n    });\n  }\n}\nfunction removeCover() {\n  var coverEl = $('.cover');\n  if (coverEl.length !== 0 && $('[data-needscover]').length === 0) coverEl.remove();\n  $('body').css({\n    'overflow': ''\n  });\n}\nfunction hasMetaKey(event) {\n  // Detect the metaKey (ctrl on windows/linux or cmd on mac)\n  var isMac = navigator.platform.match(/mac/i) !== null && navigator.platform.match(/mac/i).length > 0;\n  return isMac && event.metaKey || !isMac && event.ctrlKey;\n}\n\n// Detect the alt key\nfunction hasAltKey(event) {\n  return event.altKey;\n}\n\n// Extend the String class with a format function similar to the one in Smalltalk\nif (!String.prototype.format) {\n  String.prototype.format = function () {\n    var args = arguments;\n    return this.replace(/{(\\d+)}/g, function (match, number) {\n      return typeof args[number] !== 'undefined' ? args[number] : match;\n    });\n  };\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9Db21tb25TY3JpcHRzL3NoYXJlZHNjcmlwdHMvc2hhcmVkc2NyaXB0cy1ucGNvbW1vbi5qcy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL1JlYWN0Q29tcG9uZW50c18vLi9Db21tb25TY3JpcHRzL3NoYXJlZHNjcmlwdHMvc2hhcmVkc2NyaXB0cy1ucGNvbW1vbi5qcz9hNWNjIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIGVzbGludC1kaXNhYmxlIG5vLXVudXNlZC12YXJzLCBmdW5jLW5hbWVzICovXG4vKiBnbG9iYWwgYWpheCByZXF1ZXN0IGhhbmRsaW5nICovXG5pbXBvcnQgKiBhcyBTZW50cnkgZnJvbSBcIkBzZW50cnkvYnJvd3NlclwiO1xuaW1wb3J0IHtpc1NlbnRyeUluaXRpYWxpemVkfSBmcm9tIFwiLi9zaGFyZWRzY3JpcHRzLXNlbnRyeVwiO1xuXG4kLmFqYXhTZXR1cCh7IHRpbWVvdXQ6IDYwMDAwIH0pO1xuXG5cbi8vIHRoZSAnYnVzeScgc3Bpbm5lciBzaG93cyBpbiB0aGUgcmlnaHQtaGFuZCBjb3JuZXIgd2hlbiBhbiBhamF4IHJlcXVlc3QgaXMgcnVubmluZyBvciBhIHBhZ2UgbmF2aWdhdGlvbiBsaW5rIHdhcyBjbGlja2VkXG4kKGRvY3VtZW50KS5hamF4U3RhcnQoZnVuY3Rpb24oKSB7XG4gICQoJyNzdGF0dXMnKS5hZGRDbGFzcygnYnVzeScpLmNoaWxkcmVuKCcubWVzc2FnZScpLmh0bWwoJ0JVU1knKTtcbn0pO1xuJCh3aW5kb3cpLm9uKCdiZWZvcmV1bmxvYWQnLCBmdW5jdGlvbigpIHtcbiAgJCgnI3N0YXR1cycpLmFkZENsYXNzKCdidXN5JykuY2hpbGRyZW4oJy5tZXNzYWdlJykuaHRtbCgnQlVTWScpO1xufSk7XG5cbiQoZG9jdW1lbnQpLmFqYXhTdG9wKGZ1bmN0aW9uKCkge1xuICAkKCcjc3RhdHVzJykucmVtb3ZlQ2xhc3MoJ2J1c3knKS5ub3QoJy5sb3N0JykuY2hpbGRyZW4oJy5tZXNzYWdlJykuaHRtbCgnJyk7XG59KTtcblxuZnVuY3Rpb24gYWxlcnRJbnRlcm5hbFNlcnZlckVycm9yKGVycm9yRGlhbG9nSFRNTCkge1xuICBpZiAoZXJyb3JEaWFsb2dIVE1MKVxuICAgICQoJ2JvZHknKS5hcHBlbmQoZXJyb3JEaWFsb2dIVE1MKTtcbn1cblxuZnVuY3Rpb24gYWxlcnRDb25uZWN0aW9uTG9zdChtZXNzYWdlKSB7XG4gIGFsZXJ0KG1lc3NhZ2UpO1xuICB3aW5kb3cubG9jYXRpb24gPSAnLyc7XG59XG5cbmZ1bmN0aW9uIGFsZXJ0VW5yZXBvcnRhYmxlRXJyb3IobWVzc2FnZSkge1xuICBhbGVydChtZXNzYWdlKTtcbn1cblxuZnVuY3Rpb24gc2V0T2ZmbGluZSgpIHtcbiAgJCgnI3N0YXR1cycpLnJlbW92ZUNsYXNzKCdidXN5JykuYWRkQ2xhc3MoJ2xvc3QnKS5jaGlsZHJlbignLm1lc3NhZ2UnKS5odG1sKCdPRkZMSU5FJyk7XG59XG5cbi8vIHRlbXBvIHZhciB0byBzdXBwcmVzcyBtdWx0aXBsZSB3YXJuaW5nIChzaG91bGQgcmVwbGFjZSB3aXRoIG5pY2UgZW5jYXBzdWxhdGVkIHZhcilcbmxldCB3YXJuaW5nR2l2ZW47XG5leHBvcnQgZnVuY3Rpb24gaGFuZGxlQWpheEVycm9yKGUsIGpxWEhSLCBhamF4U2V0dGluZ3MsIHRocm93bkVycm9yKSB7XG4gIGZ1bmN0aW9uIGxvZ1RvU2VudHJ5KCkge1xuICAgIGlmIChpc1NlbnRyeUluaXRpYWxpemVkKCkpIHtcbiAgICAgIFNlbnRyeS53aXRoU2NvcGUoZnVuY3Rpb24oc2NvcGUpIHtcbiAgICAgICAgY29uc3QgZXh0cmFEYXRhID0ge1xuICAgICAgICAgIHR5cGU6IGFqYXhTZXR0aW5ncy50eXBlLFxuICAgICAgICAgIHVybDogYWpheFNldHRpbmdzLnVybCxcbiAgICAgICAgICBkYXRhOiBhamF4U2V0dGluZ3MuZGF0YSxcbiAgICAgICAgICBzdGF0dXM6IGpxWEhSLnN0YXR1cyxcbiAgICAgICAgICBlcnJvcjogdGhyb3duRXJyb3IgfHwganFYSFIuc3RhdHVzVGV4dCxcbiAgICAgICAgICByZXNwb25zZTogKGpxWEhSLnJlc3BvbnNlVGV4dCkgPyBqcVhIUi5yZXNwb25zZVRleHQuc3Vic3RyaW5nKDAsIDEwMCkgOiB1bmRlZmluZWRcbiAgICAgICAgfTtcbiAgICAgICAgc2NvcGUuc2V0RXh0cmFzKGV4dHJhRGF0YSk7XG4gICAgICAgIFNlbnRyeS5jYXB0dXJlTWVzc2FnZSh0aHJvd25FcnJvciB8fCBqcVhIUi5zdGF0dXNUZXh0KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuICBzd2l0Y2ggKGpxWEhSLnN0YXR1cykge1xuICAgIGNhc2UgNTAwOiAvLyBTZXJ2ZXItc2lkZSBlcnJvciwgdXNlIHRoZSBjb21tdW5pY2F0ZWQgZXJyb3IgbWVzc2FnZVxuICAgICAgc2V0T2ZmbGluZSgpO1xuICAgICAgLy8gSWYgYW4gZXJyb3IgaGFwcGVucyBob3dldmVyIGluIGEgYmxvY2sgd2l0aCBhcyByZXNwb25zZSB0eXBlIEphdmFzY3JpcHQsIHdlIG5lZWQgdG8gbWFudWFsbHkgZXZhbHVhdGUgdGhlIHJlc3BvbnNlIHRleHRcbiAgICAgIGlmIChqcVhIUi5nZXRSZXNwb25zZUhlYWRlcignY29udGVudC10eXBlJykgPT09ICd0ZXh0L2phdmFzY3JpcHQnKVxuICAgICAgICBldmFsKGpxWEhSLnJlc3BvbnNlVGV4dCk7XG4gICAgICBhbGVydEludGVybmFsU2VydmVyRXJyb3IoKGpxWEhSLmdldFJlc3BvbnNlSGVhZGVyKCdjb250ZW50LXR5cGUnKSA9PT0gJ3RleHQvaHRtbCcpID8ganFYSFIucmVzcG9uc2VUZXh0IDogbnVsbCk7XG4gICAgICBsb2dUb1NlbnRyeSgpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSA0MDM6XG4gICAgICBzZXRPZmZsaW5lKCk7XG4gICAgICBpZiAoJCgnLnBhbmVsLS1lcnJvcicpLmxlbmd0aCA9PT0gMCAmJiAod2FybmluZ0dpdmVuID09PSB1bmRlZmluZWQpKSB7XG4gICAgICAgIHdhcm5pbmdHaXZlbiA9IHRydWU7XG4gICAgICAgIGFsZXJ0Q29ubmVjdGlvbkxvc3QoJ0Nvbm5lY3Rpb24gd2l0aCBzZXJ2ZXIgaGFzIGJlZW4gbG9zdC4gWW91IG5lZWQgdG8gbG9naW4gYWdhaW4uIChlcnJvciA0MDMpJyk7XG4gICAgICB9XG4gICAgICBicmVhaztcbiAgICBjYXNlIDA6XG4gICAgICBpZiAoanFYSFIuc3RhdHVzVGV4dCAhPT0gJ3RpbWVvdXQnKVxuICAgICAgICBicmVhazsgLy8gY2xpZW50LWNhbmNlbGxlZCByZXF1ZXN0OiBza2lwIHRoaXMgb25lXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWZhbGx0aHJvdWdoXG4gICAgZGVmYXVsdDpcbiAgICAgIGlmICgkKCcucGFuZWwtLWVycm9yJykubGVuZ3RoID09PSAwICYmIHdhcm5pbmdHaXZlbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHdhcm5pbmdHaXZlbiA9IHRydWU7XG4gICAgICAgIGlmICh0aHJvd25FcnJvciAhPT0gJycgJiYgdGhyb3duRXJyb3IgIT09ICd0aW1lb3V0Jykge1xuICAgICAgICAgIGxvZ1RvU2VudHJ5KCk7XG4gICAgICAgICAgYWxlcnRVbnJlcG9ydGFibGVFcnJvcihgWWVzcGxhbiBlbmNvdW50ZXJlZCBhbiB1bnJlcG9ydGFibGUgZXJyb3I6ICR7dGhyb3duRXJyb3J9YCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2V0T2ZmbGluZSgpO1xuICAgICAgICAgIGFsZXJ0Q29ubmVjdGlvbkxvc3QoYENvbm5lY3Rpb24gd2l0aCBzZXJ2ZXIgaGFzIGJlZW4gbG9zdC4gWW91IG5lZWQgdG8gbG9naW4gYWdhaW4uIChlcnJvciAke2pxWEhSLnN0YXR1c30pIC0gJHt0aHJvd25FcnJvcn0gLSAke2pxWEhSLnN0YXR1c1RleHR9IC0gJHtqcVhIUi5yZXNwb25zZVRleHR9IC0gJHthamF4U2V0dGluZ3MudXJsfWApO1xuICAgICAgICB9XG4gICAgICB9XG4gIH1cbn1cblxuJChkb2N1bWVudCkuYWpheEVycm9yKGhhbmRsZUFqYXhFcnJvcik7XG5cbi8qIGNvdmVyIGluc2VydGlvbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluc2VydENvdmVyKCkge1xuICBpZiAoJCgnLmNvdmVyJykubGVuZ3RoID09PSAwKSB7XG4gICAgY29uc3QgYm9keUVsID0gJCgnYm9keScpO1xuICAgIGJvZHlFbC5hcHBlbmQoJzxkaXYgY2xhc3M9XCJjb3ZlclwiPiA8L2Rpdj4nKTtcbiAgICBib2R5RWwuY3NzKHsnb3ZlcmZsb3cnOiAnaGlkZGVuJ30pO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVDb3ZlcigpIHtcbiAgY29uc3QgY292ZXJFbCA9ICQoJy5jb3ZlcicpO1xuICBpZiAoKGNvdmVyRWwubGVuZ3RoICE9PSAwKSAmJiAoJCgnW2RhdGEtbmVlZHNjb3Zlcl0nKS5sZW5ndGggPT09IDApKVxuICAgIGNvdmVyRWwucmVtb3ZlKCk7XG4gICQoJ2JvZHknKS5jc3MoeydvdmVyZmxvdyc6ICcnfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBoYXNNZXRhS2V5KGV2ZW50KSB7XG4gIC8vIERldGVjdCB0aGUgbWV0YUtleSAoY3RybCBvbiB3aW5kb3dzL2xpbnV4IG9yIGNtZCBvbiBtYWMpXG4gIGNvbnN0IGlzTWFjID0gKG5hdmlnYXRvci5wbGF0Zm9ybS5tYXRjaCgvbWFjL2kpICE9PSBudWxsKSAmJiAobmF2aWdhdG9yLnBsYXRmb3JtLm1hdGNoKC9tYWMvaSkpLmxlbmd0aCA+IDA7XG4gIHJldHVybiAoaXNNYWMgJiYgZXZlbnQubWV0YUtleSkgfHwgKCFpc01hYyAmJiBldmVudC5jdHJsS2V5KTtcbn1cblxuLy8gRGV0ZWN0IHRoZSBhbHQga2V5XG5leHBvcnQgZnVuY3Rpb24gaGFzQWx0S2V5KGV2ZW50KSB7XG4gIHJldHVybiBldmVudC5hbHRLZXk7XG59XG5cbi8vIEV4dGVuZCB0aGUgU3RyaW5nIGNsYXNzIHdpdGggYSBmb3JtYXQgZnVuY3Rpb24gc2ltaWxhciB0byB0aGUgb25lIGluIFNtYWxsdGFsa1xuaWYgKCFTdHJpbmcucHJvdG90eXBlLmZvcm1hdCkge1xuICBTdHJpbmcucHJvdG90eXBlLmZvcm1hdCA9IGZ1bmN0aW9uKCkge1xuICAgIGNvbnN0IGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgcmV0dXJuIHRoaXMucmVwbGFjZSgveyhcXGQrKX0vZywgZnVuY3Rpb24obWF0Y2gsIG51bWJlcikge1xuICAgICAgcmV0dXJuIHR5cGVvZiBhcmdzW251bWJlcl0gIT09ICd1bmRlZmluZWQnID8gYXJnc1tudW1iZXJdIDogbWF0Y2g7XG4gICAgfSk7XG4gIH07XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./CommonScripts/sharedscripts/sharedscripts-npcommon.js\n");

/***/ }),

/***/ "./CommonScripts/sharedscripts/sharedscripts-sentry.js":
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"isSentryInitialized\": function() { return /* binding */ isSentryInitialized; }\n/* harmony export */ });\n/* harmony import */ var _sentry_browser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./node_modules/@sentry/hub/esm/hub.js\");\n/* harmony import */ var _sentry_browser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./node_modules/@sentry/browser/esm/index.js\");\n\nfunction isSentryInitialized() {\n  return _sentry_browser__WEBPACK_IMPORTED_MODULE_0__.getCurrentHub().getClient() !== undefined;\n}\n__webpack_require__.g.Sentry = _sentry_browser__WEBPACK_IMPORTED_MODULE_1__;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9Db21tb25TY3JpcHRzL3NoYXJlZHNjcmlwdHMvc2hhcmVkc2NyaXB0cy1zZW50cnkuanMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFFQSIsInNvdXJjZXMiOlsid2VicGFjazovL1JlYWN0Q29tcG9uZW50c18vLi9Db21tb25TY3JpcHRzL3NoYXJlZHNjcmlwdHMvc2hhcmVkc2NyaXB0cy1zZW50cnkuanM/ZTk3NSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBTZW50cnkgZnJvbSBcIkBzZW50cnkvYnJvd3NlclwiO1xuXG5leHBvcnQgZnVuY3Rpb24gaXNTZW50cnlJbml0aWFsaXplZCgpIHtcbiAgcmV0dXJuIFNlbnRyeS5nZXRDdXJyZW50SHViKCkuZ2V0Q2xpZW50KCkgIT09IHVuZGVmaW5lZFxufVxuXG5nbG9iYWwuU2VudHJ5ID0gU2VudHJ5O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./CommonScripts/sharedscripts/sharedscripts-sentry.js\n");

/***/ }),

/***/ "./finders/resourcefinder.js":
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"AbstractResource\": function() { return /* binding */ AbstractResource; },\n/* harmony export */   \"AdHoc\": function() { return /* binding */ AdHoc; },\n/* harmony export */   \"ExternalResource\": function() { return /* binding */ ExternalResource; },\n/* harmony export */   \"FinancialAdHoc\": function() { return /* binding */ FinancialAdHoc; },\n/* harmony export */   \"PlaceHolder\": function() { return /* binding */ PlaceHolder; },\n/* harmony export */   \"PlaceHolderInSet\": function() { return /* binding */ PlaceHolderInSet; },\n/* harmony export */   \"ResourceInSet\": function() { return /* binding */ ResourceInSet; },\n/* harmony export */   \"ResourceInstance\": function() { return /* binding */ ResourceInstance; },\n/* harmony export */   \"ResourceSet\": function() { return /* binding */ ResourceSet; },\n/* harmony export */   \"addEntities\": function() { return /* binding */ addEntities; },\n/* harmony export */   \"addOpenSets\": function() { return /* binding */ addOpenSets; },\n/* harmony export */   \"archiveOpenSets\": function() { return /* binding */ archiveOpenSets; },\n/* harmony export */   \"clearEntities\": function() { return /* binding */ clearEntities; },\n/* harmony export */   \"clickRow\": function() { return /* binding */ clickRow; },\n/* harmony export */   \"displayQueryResultIn\": function() { return /* binding */ displayQueryResultIn; },\n/* harmony export */   \"expandOpenSets\": function() { return /* binding */ expandOpenSets; },\n/* harmony export */   \"finderQueryChanged\": function() { return /* binding */ finderQueryChanged; },\n/* harmony export */   \"finderQueryChangedInteractive\": function() { return /* binding */ finderQueryChangedInteractive; },\n/* harmony export */   \"finders\": function() { return /* binding */ finders; },\n/* harmony export */   \"getCurrentRole\": function() { return /* binding */ getCurrentRole; },\n/* harmony export */   \"getCurrentRoleInSE\": function() { return /* binding */ getCurrentRoleInSE; },\n/* harmony export */   \"lockTable\": function() { return /* binding */ lockTable; },\n/* harmony export */   \"openRoleSelector\": function() { return /* binding */ openRoleSelector; },\n/* harmony export */   \"refreshOpenTimelines\": function() { return /* binding */ refreshOpenTimelines; },\n/* harmony export */   \"removeEntities\": function() { return /* binding */ removeEntities; },\n/* harmony export */   \"selectRow\": function() { return /* binding */ selectRow; },\n/* harmony export */   \"setContextMenuPermissionInFinder\": function() { return /* binding */ setContextMenuPermissionInFinder; },\n/* harmony export */   \"sortInstanceDown\": function() { return /* binding */ sortInstanceDown; },\n/* harmony export */   \"sortInstanceUp\": function() { return /* binding */ sortInstanceUp; },\n/* harmony export */   \"tickResourcesInBasket\": function() { return /* binding */ tickResourcesInBasket; },\n/* harmony export */   \"toggleBasket\": function() { return /* binding */ toggleBasket; },\n/* harmony export */   \"toggleMultiple\": function() { return /* binding */ toggleMultiple; },\n/* harmony export */   \"toggleSet\": function() { return /* binding */ toggleSet; },\n/* harmony export */   \"triggerFinderUpdates\": function() { return /* binding */ triggerFinderUpdates; },\n/* harmony export */   \"unlockTable\": function() { return /* binding */ unlockTable; },\n/* harmony export */   \"unselectRow\": function() { return /* binding */ unselectRow; }\n/* harmony export */ });\n/* harmony import */ var _CommonScripts_sharedscripts_sharedscripts_npcommon__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./CommonScripts/sharedscripts/sharedscripts-npcommon.js\");\nfunction _get(target, property, receiver) { if (typeof Reflect !== \"undefined\" && Reflect.get) { _get = Reflect.get; } else { _get = function _get(target, property, receiver) { var base = _superPropBase(target, property); if (!base) return; var desc = Object.getOwnPropertyDescriptor(base, property); if (desc.get) { return desc.get.call(receiver); } return desc.value; }; } return _get(target, property, receiver || target); }\nfunction _superPropBase(object, property) { while (!Object.prototype.hasOwnProperty.call(object, property)) { object = _getPrototypeOf(object); if (object === null) break; } return object; }\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n/* eslint-disable no-unused-vars, func-names */\n/* global permissions */\n/* NextPlan - Floating finders\n *\n * Copyright (c) 2011\t2Rivers NV\n * All rights reserved\n */\n\n\n/* maxMatches is the maximum number of resources to start showing interactively */\nvar maxInteractiveMatches = 50;\nvar maxMatches = 500;\nvar resourcePath = '/resources';\n\n// holds data and callbacks for the different floating finders\nvar finders = [];\nvar currentRegExps = [];\nfinders.tasksFinder = {};\nfinders.resourceFinder = {};\n/* labels in these arrays: */\n// queryCallback - callback function for complex queries\n// buildFinderContextMenu - function to activate the context menu\n// inplaceeditcallbacks - in-place edit callbacks per column\n// inplaceeditconfigs - in-place edit configs per column\n// entities - is an array of objects. Each object is an entity to display in the table */\n// matches - matches are kept in a var so we can redisplay the table when needed\n// setsToOpenAfterSearch - keep ids of sets to re-open after redisplay of the table\n// sortInstanceUpCallback -  function to sort an instance upward (resource finder specific)\n// sortInstanceDownCallback - function to sort an instance downward (resource finder specific)\n// addToBasket - function to add an item to the basket (resource finder specific)\n// idsWithConflicts - ids for which a conflict must be displayed (resource finder specific - in manager mode only)\n// finderMode - keeps the mode the finder is in (resource finder specific)\n// searchKeys - keys to search on\n// svgResourceUrl - the url needed for fetching svg icons\n\n// Triggered when a new query is entered\nvar complexQueryRegExp = /[\\\"\\+\\-\\(\\)\\:]/;\nvar currentProcess;\nfunction finderQueryChanged(searchId, data, closeOpenSets, interactive) {\n  $(searchId).parent().find('.loading').show();\n  var query = $(searchId).val();\n  clearTimeout(currentProcess);\n  var setsToOpen = [];\n  // if we should close the open sets after the search, start with a new array of ids of sets to open when displaying the table\n  if (closeOpenSets) {\n    data.setsToOpenAfterSearch = setsToOpen;\n  }\n  if (requiresQueryOnServer(data, query)) {\n    if (query === '') {\n      data.displayMessage('Too many matches... please refine query');\n      $(searchId).parent().find('.loading').hide();\n    } else {\n      data.queryCallback(query);\n    }\n  } else {\n    if ($('#status').hasClass('busy') && _.keys(data.entities).length === 0) {\n      setTimeout(function () {\n        finderQueryChanged(searchId, data, closeOpenSets, interactive);\n      }, 1000);\n      return;\n    }\n    var searchstrings = query.toLowerCase().split(' ');\n    currentRegExps = [];\n\n    // Create regexps for each search string\n    for (var i = 0; i < searchstrings.length; i++) {\n      if (searchstrings[i] !== '') {\n        try {\n          currentRegExps[i] = new RegExp(searchstrings[i], 'i');\n        } catch (err) {\n          data.displayMessage('Syntax error. ', err.message);\n          $(searchId).parent().find('.loading').hide();\n          return;\n        }\n      }\n    }\n    ;\n\n    // Search them!\n    data.matches = getEntitiesMatchingIn(currentRegExps, data.entities, data.searchKeys, setsToOpen);\n    if (interactive && data.matches.length > maxInteractiveMatches) {\n      return;\n    }\n    if (data.matches.length > maxMatches) {\n      data.displayMessage('Too many matches... please refine query');\n      $(searchId).parent().find('.loading').hide();\n      return;\n    }\n    // Special case: a search with an empty query should never open sets... (also only do this when required to close open sets...)\n    if (closeOpenSets && searchstrings.length === 1 && searchstrings[0] === '') {\n      data.setsToOpenAfterSearch = [];\n    }\n\n    // display results\n    if (data.matches.length === 0) {\n      data.displayMessage('No matches found');\n    } else {\n      var html = '';\n      var entities = [];\n      for (var _i = 0; _i < data.matches.length; _i++) {\n        entities[_i] = buildFromJSON(data.matches[_i], currentRegExps);\n        html += entities[_i].tableRow(0, '', true);\n      }\n      data.displayTable(data.matches, html);\n    }\n    $(searchId).parent().find('.loading').hide();\n  }\n}\n\n// Should the query happen server side?\nfunction requiresQueryOnServer(data, query) {\n  return data.queryOnServer || _.any(query, function (e) {\n    return complexQueryRegExp.test(e);\n  });\n}\n\n// Triggered for interactive refinement\nfunction finderQueryChangedInteractive(ev, searchId, data, closeOpenSets) {\n  clearTimeout(currentProcess);\n  var value = $(searchId).val();\n\n  // start updating interactively after more than 2 chars\n  if (value.length > 3 && !requiresQueryOnServer(data, value)) {\n    currentProcess = setTimeout(finderQueryChanged, 300, searchId, data, closeOpenSets, true);\n  }\n}\n\n// Retrieves the matching resources\nfunction getEntitiesMatchingIn(regexps, dict, searchKeys, setsToOpenAfterSearch) {\n  var filtered = [];\n  var amount = regexps.length;\n\n  // For each entity, see if it matches the query\n  _.each(dict, function (object, key) {\n    var matchesAll = true;\n\n    // Matching the query means matching all words in the query\n    for (var k = 0; k < amount; k++) {\n      var found = false;\n      // Matching a word means having a field that matches the word\n      for (var s = 0; s < searchKeys.length; s++) {\n        if (searchKeys[s] in object && object[searchKeys[s]].search(regexps[k]) != -1) {\n          found = true;\n          break;\n        }\n      }\n      if (!found && isSet(object)) {\n        if (getEntitiesMatchingIn([regexps[k]], object.children, searchKeys, setsToOpenAfterSearch).length != 0) {\n          found = true;\n          setsToOpenAfterSearch.push(object.id);\n        }\n      }\n      matchesAll = matchesAll && found;\n    }\n    if (matchesAll) {\n      filtered.push(object);\n    }\n  });\n  return filtered;\n}\nfunction displayQueryResultIn(message, ids, data) {\n  data.matches = [];\n  data.setsToOpenAfterSearch = [];\n  if (message !== '') {\n    data.displayMessage(message);\n  } else {\n    for (var i in ids) {\n      data.matches.push(data.entities[ids[i]]);\n    }\n\n    // display results\n    var html = '';\n    var entities = [];\n    for (var _i2 = 0; _i2 < data.matches.length; _i2++) {\n      entities[_i2] = buildFromJSON(data.matches[_i2], currentRegExps);\n      if (isSet(entities[_i2])) {\n        data.setsToOpenAfterSearch.push(entities[_i2].id);\n      }\n      html += entities[_i2].tableRow(0, '', true);\n    }\n    data.displayTable(data.matches, html);\n  }\n  $('.loading').hide();\n}\n\n// Function to render an SVG icon\nfunction svgIcon(iconClassName, resourceUrl) {\n  return \"<span title=\\\"\\\" class=\\\"svg-icon svg-icon--16 u-vertical-align-text-bottom svg-icon--black\\\">\\t\\t<svg class=\\\"svg-icon-\".concat(iconClassName, \"\\\">\\t\\t<use xmlns:xlink=\\\"http://www.w3.org/1999/xlink\\\" xlink:href=\\\"\").concat(resourceUrl, \"#\").concat(iconClassName, \"\\\"></use>\\t\\t</svg></span>\");\n}\n\n// Function to add entities incrementally to the entities for a finder\nfunction addEntities(finder, bodyId, entities, silent) {\n  var dict = finder.entities;\n  var table = $(\"#\".concat(bodyId)).parent();\n  for (var key in entities) {\n    dict[key] = entities[key]; // replace the entity in our local db\n    if (!silent) {\n      var renderObject = buildFromJSON(dict[key], currentRegExps); // create the object to render it\n      if (renderObject.myScope != undefined) {\n        $(\".\".concat(renderObject.myScope())).remove();\n      } // remove all containing items (when applicable)\n      var toplevelexisting = $(\"[objectid=\".concat(key, \"]\")).not('.setitem'); // replace only toplevel items\n      if (toplevelexisting.length == 0) {\n        $(\"#\".concat(bodyId)).append(renderObject.tableRow(0, '', true));\n      } else {\n        toplevelexisting.not('.singleton,.setitem').replaceWith(renderObject.tableRow(0, '', true));\n      }\n    }\n  }\n}\n\n// Function to remove entities incrementally from a finder\nfunction removeEntities(finder, ids, silent) {\n  for (var i in ids) {\n    delete finder.entities[ids[i]];\n    if (!silent) {\n      $(\"[objectid=\".concat(ids[i], \"]\")).remove();\n      $(\"[insetid=\".concat(ids[i], \"]\")).remove();\n    }\n  }\n}\n\n// Function to delete all entities from the finder\nfunction clearEntities(finder) {\n  finder.entities = {};\n}\n\n// Function that triggers the necessary updates on the table for context menu and sorter\nfunction triggerFinderUpdates(finder, bodyId) {\n  if (finder.buildFinderContextMenu !== undefined) {\n    finder.buildFinderContextMenu($(\"#\".concat(bodyId, \" tr\")));\n  }\n  $(\"#\".concat(bodyId)).on('click', clickRow);\n  var table = $(\"#\".concat(bodyId)).parent();\n  table.trigger('update');\n}\n\n/** **********\n FinderEntity\n *********** */\n\n// Object creation\nfunction buildFromJSON(object, myregexps) {\n  if (myregexps.length === 0) {\n    myregexps = [];\n    myregexps.push(new RegExp('', 'i'));\n  }\n  var clazz = eval(object._classname);\n  var obj = new clazz(object, myregexps);\n  if (obj.children !== undefined) {\n    obj.children = _.map(obj.children, function (child, key) {\n      return buildFromJSON(child, myregexps);\n    });\n  }\n  return obj;\n}\nvar FinderEntity = /*#__PURE__*/function () {\n  function FinderEntity(obj, myregexps) {\n    _classCallCheck(this, FinderEntity);\n    // copy the entity\n    for (var key in obj) {\n      var el = obj[key];\n      if (key !== 'id' && typeof obj[key] === 'string') {\n        el = encodeString(el);\n      }\n      for (var i = 0; i < myregexps.length; i++) {\n        if (key[0] !== '_' && key !== 'id' && key !== 'email' && typeof obj[key] === 'string' && myregexps[i].source !== '(?:)' && myregexps[i].source !== '') {\n          this[key] = el.replace(myregexps[i], '<em>$&</em>');\n        } else if (obj[key] != null && _typeof(obj[key]) === 'object')\n          // shallow copy arrays!\n          {\n            this[key] = _.clone(el);\n          } // still needed?\n        else {\n          this[key] = el;\n        }\n      }\n    }\n  }\n  _createClass(FinderEntity, [{\n    key: \"visibilityMarkup\",\n    value: function visibilityMarkup(token) {\n      var display;\n      if (this.visibleTableColumns().indexOf(token) === -1) {\n        display = 'none';\n      } else {\n        display = 'default';\n      }\n      return \"class=\\\"column-\".concat(token, \"\\\" style=\\\"display:\").concat(display, \"\\\"\");\n    }\n\n    // Display the property in a td with markup for visibility added\n  }, {\n    key: \"simpleTableDataFor\",\n    value: function simpleTableDataFor(property) {\n      if (this[property] === undefined) {\n        return \"<td \".concat(this.visibilityMarkup(property), \" columnKey=\\\"\").concat(property, \"\\\"></td>\");\n      } else {\n        var propertyValue = this[property];\n        switch (property) {\n          case 'email':\n            propertyValue = propertyValue.link(\"mailto:\".concat(propertyValue));\n            break;\n          case 'website':\n            propertyValue = \"<a target=\\\"_blank\\\" href=\\\"\".concat(propertyValue.addhttp(), \"\\\">\").concat(propertyValue, \"</a>\");\n            break;\n        }\n        return \"<td \".concat(this.visibilityMarkup(property), \" columnKey=\\\"\").concat(property, \"\\\">\").concat(propertyValue, \"</td>\");\n      }\n    }\n  }, {\n    key: \"checkboxTableData\",\n    value: function checkboxTableData() {\n      return '<td class=\"select-col\"><input type=\"checkbox\"></td>';\n    }\n  }]);\n  return FinderEntity;\n}();\nvar AbstractResource = /*#__PURE__*/function (_FinderEntity) {\n  _inherits(AbstractResource, _FinderEntity);\n  var _super = _createSuper(AbstractResource);\n  function AbstractResource() {\n    _classCallCheck(this, AbstractResource);\n    return _super.apply(this, arguments);\n  }\n  _createClass(AbstractResource, [{\n    key: \"visibleTableColumns\",\n    value: function visibleTableColumns() {\n      return AbstractResource.visibleTableColumns;\n    }\n  }, {\n    key: \"getPermissions\",\n    value: function getPermissions() {\n      // Returns the permissions for an entity\n      var perms = this.permissions;\n      if (isFinderUnlocked()) {\n        perms.push('unlocked');\n      }\n      return perms;\n    }\n  }, {\n    key: \"abstractCssClasses\",\n    value: function abstractCssClasses(level) {\n      var result = '';\n      if (this.amount > 1) {\n        result += 'multiple';\n      }\n      if (level > 0) {\n        result += \" expand-child setitem sub\".concat(level);\n      }\n      return result;\n    }\n  }, {\n    key: \"cssClasses\",\n    value: function cssClasses(level) {\n      return this.abstractCssClasses(level);\n    }\n  }, {\n    key: \"hasPlaceholders\",\n    value: function hasPlaceholders() {\n      return false;\n    }\n  }, {\n    key: \"timelineClasses\",\n    value: function timelineClasses() {\n      var result = '';\n      if (finders.resourceFinder.finderMode === 'listing') {\n        result += ' planned';\n        if (isConflictId(this.id)) {\n          result += ' conflict';\n        }\n      }\n      return result;\n    }\n  }, {\n    key: \"serializedId\",\n    value: function serializedId(sep) {\n      return serializedIdOf(this, sep);\n    }\n  }, {\n    key: \"tableRow\",\n    value: function tableRow(level, setscope, visible) {\n      // setting the right css classes for the row\n      // The setscope is a set of classes that depends on the sets we are (visually) located in. It allows us to remove this row if the set is closed!\n      var classes = \"\".concat(setscope, \" \").concat(this.cssClasses(level));\n      var style = '';\n      if (!visible) {\n        style = 'style=\"display:none\"';\n      }\n\n      // Generate the table row\n      var html = \"<tr \".concat(style, \" cMenu=\\\"finderMenu\\\" class=\\\"\").concat(classes, \"\\\" permissions=\\\"\").concat(toSource(this.getPermissions()), \"\\\" objectid=\\\"\").concat(this.serializedId(','), \"\\\" insetid=\\\"\").concat(this.setid, \"\\\">\");\n      // html += this.checkboxTableData();\n      html += this.nameTableData(level, setscope);\n      html += this.amountTableData(level);\n      for (var i = 0; i < AbstractResource.switchableTableColumns.length; i++) {\n        html += this.simpleTableDataFor(AbstractResource.switchableTableColumns[i]);\n      }\n      html += this.timelineTableData();\n      return \"\".concat(html, \"</tr>\");\n    }\n  }, {\n    key: \"nameTableData\",\n    value: function nameTableData(level, setscope) {\n      var html = '';\n\n      // If we are in finder mode, we can add things to the basket using this link\n      if (finders.resourceFinder.finderMode === 'finder' && this.permissions.indexOf('use') !== -1) {\n        html += \"<a href=\\\"javascript:{}\\\" onclick=\\\"ReactComponents_resourceandtaskfinder.finders.resourceFinder.addToBasket('\".concat(this.id, \"',ReactComponents_resourceandtaskfinder.getCurrentRole('\").concat(this.id, \"'))\\\" class=\\\"add\\\"><span id=\\\"R\").concat(this.id, \"\\\">\").concat(this.name, \"</span></a>\");\n        // If we have roles to show, show them.\n        if (this.type === 'Human' && this.defaultrole !== undefined && this.roles.length > 0 && !this.hasPlaceholders()) {\n          html += \" <span class=\\\"role\\\">(<span href=\\\"javascript:{}\\\" onclick=\\\"openRoleSelector('\".concat(this.id, \"')\\\" title=\\\"change role\\\">\").concat(this.defaultrole, \"</span>)</span>\");\n        }\n      } else {\n        html += \"<span id=\\\"R\".concat(this.id, \"\\\">\").concat(this.name, \"</span>\");\n      }\n      html += '</td>';\n      return html;\n    }\n  }, {\n    key: \"amountTableData\",\n    value: function amountTableData(level) {\n      return \"<td id=\\\"\".concat(this.myScope(), \"\\\" class=\\\"amount\\\" columnKey=\\\"amount\\\"><span>\").concat(this.amount, \"</span></td>\");\n    }\n  }, {\n    key: \"timelineTableData\",\n    value: function timelineTableData() {\n      var inset = '';\n      if (this.setid !== undefined) {\n        inset = \"inset=\\\"\".concat(this.setid, \"\\\"\");\n      }\n      return \"<td timeline=\\\"\".concat(this.serializedId('_'), \"\\\" \").concat(inset, \" class=\\\"availability \").concat(this.timelineClasses(), \"\\\"></td>\");\n    }\n  }], [{\n    key: \"displayTable\",\n    value:\n    // Display a table with resulting entities and the words matching the regexps highlighted\n    function displayTable(entities, html) {\n      $('#finderTableBody').html(html).on('click', clickRow);\n\n      // Sets context menu\n      finders.resourceFinder.buildFinderContextMenu($('#finderTableBody'));\n\n      // In listing mode, we show the timelines again after a search\n      if (finders.resourceFinder.finderMode === 'listing') {\n        refreshOpenTimelines();\n      }\n      if (finders.resourceFinder.finderMode === 'finder' || finders.resourceFinder.finderMode === 'external') {\n        hideTimelines();\n        // Tick resources that are in the basket\n        tickResourcesInBasket();\n      }\n\n      // Create draggables\n      if (finders.resourceFinder.allowDragging) {\n        for (var i = 0; i < entities.length; i++) {\n          if (entities[i].permissions.indexOf('use') !== -1) {\n            createDraggable(entities[i]);\n          }\n        }\n      }\n\n      // trigger the update of the sorter cache (required!)\n      $('#finderTable').trigger('update');\n    }\n  }, {\n    key: \"displayMessage\",\n    value: function displayMessage(aString) {\n      $('#finderTableBody').html(\"<tr><td colspan=\\\"\".concat(AbstractResource.visibleTableColumns.length + 3, \"\\\">\").concat(aString, \"</td></tr>\"));\n    }\n  }, {\n    key: \"displayInitialTable\",\n    value: function displayInitialTable() {\n      $('#finderTableBody').html('');\n    }\n  }]);\n  return AbstractResource;\n}(FinderEntity);\n_defineProperty(AbstractResource, \"switchableTableColumns\", ['type', 'group', 'roles', 'serial', 'productcode', 'date', 'cost', 'price', 'rosterpublisheduntil']);\n_defineProperty(AbstractResource, \"visibleTableColumns\", null);\nfunction openRoleSelector(id) {\n  $(\"[objectid=\".concat(id, \"] .role span\")).editable(finders.resourceFinder.inplaceeditcallbacks.role, finders.resourceFinder.inplaceeditconfigs.role).editable('enable');\n}\nfunction getCurrentRole(id) {\n  return $(\"[objectid=\".concat(id, \"] .role span\")).html();\n}\nfunction getCurrentRoleInSE(id) {\n  // in SE, we use an id that starts with R...\n  return $(\"[objectid=\".concat(id.substring(1, id.size), \"] .role span\")).html();\n}\nvar Resource = /*#__PURE__*/function (_AbstractResource) {\n  _inherits(Resource, _AbstractResource);\n  var _super2 = _createSuper(Resource);\n  function Resource() {\n    _classCallCheck(this, Resource);\n    return _super2.apply(this, arguments);\n  }\n  _createClass(Resource, [{\n    key: \"tableRow\",\n    value: function tableRow(level, setscope, visible) {\n      var html = _get(_getPrototypeOf(Resource.prototype), \"tableRow\", this).call(this, level, setscope, visible);\n      if (this.amount > 1) {\n        for (var i = 0; i < this.children.length; i++) {\n          html += this.children[i].tableRow(level, \"\".concat(setscope, \" \").concat(this.myScope()), false);\n        }\n      }\n      return html;\n    }\n  }, {\n    key: \"cssClasses\",\n    value: function cssClasses(level) {\n      var cssClasses = _get(_getPrototypeOf(Resource.prototype), \"abstractCssClasses\", this).call(this, level);\n      if (this.children.length === 1 && this.children[0].isInSet) {\n        cssClasses += ' fixed';\n      }\n      return cssClasses;\n    }\n  }, {\n    key: \"nameTableData\",\n    value: function nameTableData(level, setscope) {\n      return \"<td class=\\\"name\\\" columnKey=\\\"name\\\">\".concat(this.user ? svgIcon('icon-user', finders.resourceFinder.svgResourceUrl) : '').concat(this.suspendeduser ? svgIcon('icon-suspended-user', finders.resourceFinder.svgResourceUrl) : '').concat(AbstractResource.prototype.nameTableData.call(this, level, setscope));\n    }\n  }, {\n    key: \"amountTableData\",\n    value: function amountTableData(level) {\n      if (this.children.length === 1 && this.children[0].isInSet) {\n        return \"<td class=\\\"amount\\\" title=\\\"Fixed in set \".concat(this.children[0].isInSet.replace('<em>', '').replace('</em>', ''), \"\\\">  Fixed \");\n      } // need to remove the <em> because that crashes xml page\n      else {\n        var resourceId = this.myScope();\n        var html = \"<td id=\\\"\".concat(resourceId, \"\\\" class=\\\"amount\\\" columnKey=\\\"amount\\\">\");\n\n        // A bulk resource with an unspecified amount or a human resource is not editable in-place\n        if (this.amount === '-' || this.type === 'Human') {\n          html += this.amount;\n        } else {\n          html += \"<span>\".concat(this.amount, \"</span>\");\n        }\n        if (this.hasOwnProperty('actualamount')) {\n          html += \" <span class=\\\"actual\\\">(\".concat(this.actualamount, \")</span>\");\n        }\n        if (this.children.length > 1) {\n          html += \"<a class=\\\"openme\\\" href=\\\"javascript:{}\\\" onclick=\\\"ReactComponents_resourceandtaskfinder.toggleMultiple(this,'\".concat(resourceId, \"');event.stopPropagation()\\\" > </a></td>\");\n        } else {\n          html += '</td>';\n        }\n        return html;\n      }\n    }\n  }, {\n    key: \"myScope\",\n    value: function myScope() {\n      return \"resource\".concat(this.serializedId(''));\n    }\n  }]);\n  return Resource;\n}(AbstractResource);\nfunction toggleMultiple(el, resourceId) {\n  if ($(el).parent().parent().hasClass('open')) {\n    $(\".\".concat(resourceId)).hide();\n    $(el).parent().parent().removeClass('open');\n  } else {\n    refreshTimelineOfRows($(\".\".concat(resourceId)).show());\n    finders.resourceFinder.buildFinderContextMenu($(\".\".concat(resourceId)));\n    $(el).parent().parent().addClass('open');\n  }\n}\nvar ResourceInSet = /*#__PURE__*/function (_Resource) {\n  _inherits(ResourceInSet, _Resource);\n  var _super3 = _createSuper(ResourceInSet);\n  function ResourceInSet() {\n    _classCallCheck(this, ResourceInSet);\n    return _super3.apply(this, arguments);\n  }\n  _createClass(ResourceInSet, [{\n    key: \"nameTableData\",\n    value: function nameTableData(level, setscope) {\n      return \"<td class=\\\"name\\\" columnKey=\\\"name\\\">\".concat(AbstractResource.prototype.nameTableData.call(this, level, setscope));\n    }\n  }, {\n    key: \"amountTableData\",\n    value: function amountTableData(level) {\n      return \"<td class=\\\"amount\\\" columnKey=\\\"amount\\\"><span>\".concat(this.amount, \"</span></td>\");\n    }\n  }]);\n  return ResourceInSet;\n}(Resource);\nvar ExternalResource = /*#__PURE__*/function (_Resource2) {\n  _inherits(ExternalResource, _Resource2);\n  var _super4 = _createSuper(ExternalResource);\n  function ExternalResource() {\n    _classCallCheck(this, ExternalResource);\n    return _super4.apply(this, arguments);\n  }\n  _createClass(ExternalResource, [{\n    key: \"cssClasses\",\n    value: function cssClasses(level) {\n      return \"external \".concat(_get(_getPrototypeOf(ExternalResource.prototype), \"abstractCssClasses\", this).call(this, level));\n    }\n  }]);\n  return ExternalResource;\n}(Resource);\nvar AdHoc = /*#__PURE__*/function (_Resource3) {\n  _inherits(AdHoc, _Resource3);\n  var _super5 = _createSuper(AdHoc);\n  function AdHoc() {\n    _classCallCheck(this, AdHoc);\n    return _super5.apply(this, arguments);\n  }\n  _createClass(AdHoc, [{\n    key: \"cssClasses\",\n    value: function cssClasses(level) {\n      return \"adhoc \".concat(_get(_getPrototypeOf(AdHoc.prototype), \"abstractCssClasses\", this).call(this, level));\n    }\n  }]);\n  return AdHoc;\n}(Resource);\nvar FinancialAdHoc = /*#__PURE__*/function (_Resource4) {\n  _inherits(FinancialAdHoc, _Resource4);\n  var _super6 = _createSuper(FinancialAdHoc);\n  function FinancialAdHoc() {\n    _classCallCheck(this, FinancialAdHoc);\n    return _super6.apply(this, arguments);\n  }\n  _createClass(FinancialAdHoc, [{\n    key: \"cssClasses\",\n    value: function cssClasses(level) {\n      return \"adhoc-financial \".concat(_get(_getPrototypeOf(FinancialAdHoc.prototype), \"abstractCssClasses\", this).call(this, level));\n    }\n  }]);\n  return FinancialAdHoc;\n}(Resource);\nvar PlaceHolder = /*#__PURE__*/function (_Resource5) {\n  _inherits(PlaceHolder, _Resource5);\n  var _super7 = _createSuper(PlaceHolder);\n  function PlaceHolder() {\n    _classCallCheck(this, PlaceHolder);\n    return _super7.apply(this, arguments);\n  }\n  _createClass(PlaceHolder, [{\n    key: \"hasPlaceholders\",\n    value: function hasPlaceholders() {\n      return true;\n    }\n  }, {\n    key: \"cssClasses\",\n    value: function cssClasses(level) {\n      return \"placeholder \".concat(_get(_getPrototypeOf(PlaceHolder.prototype), \"abstractCssClasses\", this).call(this, level));\n    }\n  }, {\n    key: \"nameTableData\",\n    value: function nameTableData(level, setscope) {\n      return \"<td class=\\\"name\\\">\".concat(AbstractResource.prototype.nameTableData.call(this, level, setscope));\n    }\n  }, {\n    key: \"amountTableData\",\n    value: function amountTableData(level) {\n      return \"<td class=\\\"amount\\\">\".concat(this.amount, \"</td>\");\n    }\n  }, {\n    key: \"timelineClasses\",\n    value: function timelineClasses() {\n      if (AbstractResource.finderMode === 'listing') {\n        return \"\".concat(Resource.prototype.timelineClasses.call(this), \" empty-box-conflict\");\n      } else {\n        return '';\n      }\n    }\n  }]);\n  return PlaceHolder;\n}(Resource);\nvar PlaceHolderInSet = /*#__PURE__*/function (_PlaceHolder) {\n  _inherits(PlaceHolderInSet, _PlaceHolder);\n  var _super8 = _createSuper(PlaceHolderInSet);\n  function PlaceHolderInSet() {\n    _classCallCheck(this, PlaceHolderInSet);\n    return _super8.apply(this, arguments);\n  }\n  _createClass(PlaceHolderInSet, [{\n    key: \"getPermissions\",\n    value: function getPermissions() {\n      var perms = AbstractResource.prototype.getPermissions.call(this);\n      return perms.concat(['writeResource']);\n    }\n  }, {\n    key: \"amountTableData\",\n    value: function amountTableData(level) {\n      return \"<td class=\\\"amount\\\" columnKey=\\\"amount\\\"><span>\".concat(this.amount, \"</span></td>\");\n    }\n  }, {\n    key: \"timelineTableData\",\n    value: function timelineTableData() {\n      return \"<td timeline=\\\"\".concat(this.id, \"\\\" inset=\\\"\").concat(this.setid, \"\\\" class=\\\"availability \").concat(this.timelineClasses(), \"\\\"></td>\");\n    }\n  }]);\n  return PlaceHolderInSet;\n}(PlaceHolder);\nvar ResourceInstance = /*#__PURE__*/function (_AbstractResource2) {\n  _inherits(ResourceInstance, _AbstractResource2);\n  var _super9 = _createSuper(ResourceInstance);\n  function ResourceInstance() {\n    _classCallCheck(this, ResourceInstance);\n    return _super9.apply(this, arguments);\n  }\n  _createClass(ResourceInstance, [{\n    key: \"cssClasses\",\n    value: function cssClasses(level) {\n      if (this.isInSet) {\n        if (this.setid === undefined)\n          // in singleton list\n          {\n            return ' expand-child fixed';\n          } else {\n          return \"\".concat(_get(_getPrototypeOf(ResourceInstance.prototype), \"abstractCssClasses\", this).call(this, level), \" fixed\");\n        }\n      } else {\n        return 'expand-child singleton ';\n      }\n    }\n  }, {\n    key: \"nameTableData\",\n    value: function nameTableData(level, setscope) {\n      // only display the name in a set (otherwise we are in the instances listing)\n      if (level > 0) {\n        return \"<td class=\\\"name\\\">\".concat(this.name, \"</td>\");\n      } else {\n        return '<td class=\"name\"></td>';\n      }\n    }\n  }, {\n    key: \"amountTableData\",\n    value: function amountTableData() {\n      var html;\n      if (this.isInSet) {\n        html = \"<td class=\\\"amount\\\" title=\\\"Fixed in set \".concat(this.isInSet.replace('<em>', '').replace('</em>', ''), \"\\\">  Fixed \");\n      } // need to remove the <em> because that crashes xml page\n      else {\n        html = \"<td class=\\\"amount\\\"> <span>#\".concat(this.preference, \"</span>\");\n        if (isFinderUnlocked() && _.indexOf(this.getPermissions(), 'write') !== -1) {\n          html += sortingActionsForId(this.id);\n        }\n      }\n      return \"\".concat(html, \"</td>\");\n    }\n  }, {\n    key: \"timelineTableData\",\n    value: function timelineTableData() {\n      var insetattr = '';\n      if (this.setid !== undefined)\n        // if the inset attribute is set (ie. I am located inside the set here - not just displayed in the instances list)\n        {\n          insetattr = \"inset=\\\"\".concat(this.setid, \"\\\"\");\n        }\n      return \"<td timeline=\\\"\".concat(this.id, \"\\\" \").concat(insetattr, \" class=\\\"availability \").concat(this.timelineClasses(), \"\\\"></td>\");\n    }\n  }]);\n  return ResourceInstance;\n}(AbstractResource);\nvar ResourceSet = /*#__PURE__*/function (_AbstractResource3) {\n  _inherits(ResourceSet, _AbstractResource3);\n  var _super10 = _createSuper(ResourceSet);\n  function ResourceSet() {\n    _classCallCheck(this, ResourceSet);\n    return _super10.apply(this, arguments);\n  }\n  _createClass(ResourceSet, [{\n    key: \"cssClasses\",\n    value: function cssClasses(level) {\n      var open = '';\n      if (this.contentsVisible()) {\n        open = 'open ';\n      }\n      return \"set \".concat(open).concat(_get(_getPrototypeOf(ResourceSet.prototype), \"abstractCssClasses\", this).call(this, level));\n    }\n  }, {\n    key: \"hasPlaceholders\",\n    value: function hasPlaceholders() {\n      var has = false;\n      for (var i = 0; i < this.children.length; i++)\n      // have to make the objects here (did not work in constructor(yet))\n      {\n        has = has || this.children[i].hasPlaceholders();\n      }\n      return has;\n    }\n  }, {\n    key: \"contentsVisible\",\n    value: function contentsVisible() {\n      return finders.resourceFinder.setsToOpenAfterSearch.indexOf(this.serializedId('')) !== -1;\n    }\n  }, {\n    key: \"tableRow\",\n    value: function tableRow(level, setscope, visible) {\n      var html = AbstractResource.prototype.tableRow.call(this, level, setscope, visible);\n      var contentsVisible = this.contentsVisible();\n      for (var i = 0; i < this.children.length; i++) {\n        html += this.children[i].tableRow(level + 1, \"\".concat(setscope, \" \").concat(this.myScope()), contentsVisible);\n      }\n      return html;\n    }\n  }, {\n    key: \"nameTableData\",\n    value: function nameTableData(level, setscope) {\n      // If the row represents a set, add the click link and register a function that will register the click when the row is generated\n      var myScope = this.myScope();\n      var html = \"<td id=\\\"\".concat(myScope, \"\\\" class=\\\"name\\\" columnkey=\\\"name\\\"><a class=\\\"openme show-set\\\" onclick=\\\"ReactComponents_resourceandtaskfinder.toggleSet($(this),'\").concat(myScope, \"',\").concat(level, \");event.stopPropagation();\\\"> </a>\");\n      return html + AbstractResource.prototype.nameTableData.call(this, level, setscope);\n    }\n  }, {\n    key: \"amountTableData\",\n    value: function amountTableData(level) {\n      if (finders.resourceFinder.finderMode === 'listing') {\n        return \"<td class=\\\"amount\\\" columnKey=\\\"amount\\\"><span>\".concat(this.amount, \"</span></td>\");\n      } else if (this.setid == undefined) {\n        return '<td> - </td>';\n      } else {\n        return \"<td class=\\\"amount\\\" columnKey=\\\"amount\\\"><span>\".concat(this.amount, \"</span></td>\");\n      }\n    }\n  }, {\n    key: \"timelineClasses\",\n    value: function timelineClasses() {\n      if (finders.resourceFinder.finderMode === 'listing' && this.hasPlaceholders()) {\n        return \"\".concat(AbstractResource.prototype.timelineClasses.call(this), \" empty-box-conflict\");\n      } else {\n        return AbstractResource.prototype.timelineClasses.call(this);\n      }\n    }\n  }, {\n    key: \"myScope\",\n    value: function myScope() {\n      return \"set\".concat(this.id);\n    }\n  }]);\n  return ResourceSet;\n}(AbstractResource);\nfunction toggleSet(el, setId, level) {\n  if (el.parent().parent().hasClass('open')) {\n    // clicked on an open set or multiple\n    $(\".\".concat(setId)).hide().removeClass('open');\n    el.parent().parent().removeClass('open');\n  } else {\n    // clicked on a closed set or multiple\n    refreshTimelineOfRows($(\".\".concat(setId, \".sub\").concat(level + 1)).show());\n    finders.resourceFinder.buildFinderContextMenu($(\".\".concat(setId, \".sub\").concat(level + 1)));\n    el.parent().parent().addClass('open');\n  }\n}\n\n/** **********************\n Helper functions\n *********************** */\nvar htmlId = 0;\nfunction nextId() {\n  htmlId += 1;\n  return htmlId;\n}\nfunction sortingActionsForId(id) {\n  return \"<div><a href=\\\"javascript:{}\\\" class=\\\"sort-up\\\" onclick=\\\"sortInstanceUp('\".concat(id, \"',this);return false\\\">up</a> <a href=\\\"javascript:{}\\\" class=\\\"sort-down\\\" onclick=\\\"sortInstanceDown('\").concat(id, \"',this);return false\\\">down</a></div>\");\n}\nfunction isSet(anArray) {\n  return 'children' in anArray;\n}\nfunction isFinderUnlocked() {\n  return $('#finderlock').hasClass('unlocked');\n}\n\n// Function called by server-side when it refreshes the table after an operation\nfunction archiveOpenSets(data) {\n  data.setsToOpenAfterSearch = new Array();\n  $('.set.open,.multiple.open').each(function () {\n    data.setsToOpenAfterSearch.unshift($(this).attr('objectid'));\n  });\n}\n\n// Function to be used to open sets when rendering happens server-side\nfunction expandOpenSets(data) {\n  $(data.setsToOpenAfterSearch).each(function () {\n    $(\"[objectid=\".concat(this, \"]\")).not('.open').find('.show-set').trigger('click');\n  });\n}\n\n// Function to be used to open sets when rendering happens server-side\nfunction addOpenSets(data, newSets) {\n  data.setsToOpenAfterSearch = _.uniq(data.setsToOpenAfterSearch.concat(newSets));\n}\n\n// the following function implements the Mozilla-like toSource() method only for arrays with strings\n// because toSource() does not exist outside firefox\nfunction toSource(anArray) {\n  // replace with anArray.toSource() if everyone decides to implement this mozilla-specific method\n  return \"['\".concat($.map(anArray, function (each) {\n    return each.toString();\n  }).join('\\',\\''), \"']\");\n}\nfunction serializedIdOf(anObject, sep) {\n  if (_typeof(anObject.id) === 'object') {\n    return anObject.id.join(sep);\n  } else {\n    return \"\".concat(anObject.id);\n  } // make sure it's a string!;\n}\n\n/** **********************\n Context menu\n *********************** */\n\n// Permissions of the menu\nfunction setContextMenuPermissionInFinder(focusElement) {\n  var allPermissions = $(focusElement).map(function (i, el) {\n    return eval($(el).attr('permissions'));\n  });\n  var currentmenuClass = $(focusElement).attr('cmenu');\n\n  // disable all menu items that have a permission entry\n  $(\"#\".concat(currentmenuClass, \" li [permissions]\")).attr('isdisable', 'true');\n  // for each such menu item, check if all its required permissions are in our currently given permissions\n  $(\"#\".concat(currentmenuClass, \" li a[permissions]\")).not('.disabled').each(function () {\n    var myPerms = eval($(this).attr('permissions'));\n    // make the intersection of the required and given permissions to see if all required permissions are given\n    if (_.intersection(myPerms, allPermissions).length === myPerms.length) {\n      $(this).removeAttr('isdisable');\n    }\n  });\n}\n\n/** **********************\n Sort operations for resource instances\n *********************** */\n\nfunction sortInstanceUp(id, aEl) {\n  var rowEl = $(aEl).closest('tr');\n  // If we can move up...\n  if (rowEl.prev().hasClass('singleton')) {\n    // First swap the numbers\n    var temp = $(aEl).parent().parent().children('span').clone(true);\n    $(aEl).parent().parent().children('span').replaceWith(rowEl.prev().find('.amount span').clone(true));\n    rowEl.prev().find('.amount span').replaceWith(temp);\n\n    // Swap the rows and make the callback to server\n    rowEl.clone(true).insertBefore(rowEl.prev());\n    rowEl.remove();\n    finders.resourceFinder.sortInstanceUpCallback(id);\n  }\n}\nfunction sortInstanceDown(id, aEl) {\n  var rowEl = $(aEl).closest('tr');\n  if (rowEl.next().hasClass('singleton')) {\n    // First swap the numbers\n    var temp = $(aEl).parent().parent().children('span').clone(true);\n    $(aEl).parent().parent().children('span').replaceWith(rowEl.next().find('.amount span').clone(true));\n    rowEl.next().find('.amount span').replaceWith(temp);\n\n    // Swap the rows and make the callback to server\n    rowEl.clone(true).insertAfter(rowEl.next());\n    rowEl.remove();\n    finders.resourceFinder.sortInstanceDownCallback(id);\n  }\n}\n\n// variable that will contain a function to callback to the server (set by an onload script)\n__webpack_require__.g.getAvailabilityTimelinesFor = null;\n\n// trigger the update of the availability timelines\nfunction refreshTimelineOfRows(rows) {\n  if ($('#availabilityButton:visible').length === 0) {\n    rows.children('td[timeline]').html(\"<img src=\\\"\".concat(resourcePath, \"/images/ajax-loader.gif\\\"/>\"));\n    __webpack_require__.g.getAvailabilityTimelinesFor(rows.map(function () {\n      return this.getAttribute('objectid');\n    }).toArray().join(';'), rows.map(function () {\n      return this.getAttribute('insetid');\n    }).toArray().join(','));\n  }\n}\nfunction refreshOpenTimelines() {\n  if ($('#availabilityButton:visible').length === 0) {\n    $('.resolving').parent().remove();\n    var all = $('td[timeline]:visible');\n    if (all.length < 100) {\n      all.html(\"<img src=\\\"\".concat(resourcePath, \"/images/ajax-loader.gif\\\"/>\"));\n      __webpack_require__.g.getAvailabilityTimelinesFor($.map(all, function (each) {\n        return $(each).attr('timeline');\n      }).join(';'), $.map(all, function (each) {\n        if ($(each).attr('inset') != undefined) return $(each).attr('inset');else return 'null';\n      }).join(','));\n    } else {\n      hideTimelines();\n    }\n  }\n}\n\n// Hides the timelines\nfunction hideTimelines() {\n  $('#availabilityButton').show();\n  $('#timelineHeaderInFinder').hide();\n}\nfunction isConflictId(id) {\n  return finders.resourceFinder.idsWithConflicts.indexOf(id) !== -1;\n}\n\n// Locking and unlocking the table\nfunction unlockTable(id) {\n  // unlocking\n  $(\"#\".concat(id, \" tr[permissions]\")).each(function () {\n    var perms = eval($(this).attr('permissions'));\n    perms.push('unlocked');\n    $(this).attr('permissions', toSource(perms));\n  });\n  // adding the singleton in-place movement -- should only happen in resource finder!\n  $('.singleton[permissions*=write]').not('.contact-singleton').each(function () {\n    $(this).children('.amount').append(sortingActionsForId($(this).attr('objectid')));\n  });\n  // adding the in-place edits\n  // addInPlaceEdits();\n}\n\nfunction lockTable(id) {\n  // locking\n  $(\"#\".concat(id, \" tr[permissions]\")).each(function () {\n    $(this).attr('permissions', toSource(_.without(eval($(this).attr('permissions')), 'unlocked')));\n  });\n  // removing the singleton in-place movement\n  $('.singleton .amount a').remove();\n  // removing the inplace edits\n  $(\"#\".concat(id, \" .name span\")).off('click');\n}\n\n/** ****************************\n Generic row selection functions\n ****************************** */\nfunction clickRow(event) {\n  if (event.originalEvent == null) return; // jQuery-generated events in Chrome that are triggered on the set-open anchor still propagate to this handler, which is wrong wrong wrong...\n  var theRow = $(event.originalEvent.target).closest('tr');\n  var multiSelect = theRow.hasClass('ui-selected') || (0,_CommonScripts_sharedscripts_sharedscripts_npcommon__WEBPACK_IMPORTED_MODULE_0__.hasMetaKey)(event);\n  if (!multiSelect) {\n    $('.ui-selected').each(function () {\n      unselectRow(event, theRow);\n    }).removeClass('ui-selected').find('.select-col [type=checkbox]').attr('checked', false);\n  }\n  theRow.addClass('ui-selected').find('.select-col [type=checkbox]').attr('checked', true);\n  selectRow(event, theRow);\n}\nfunction selectRow(event, row) {\n  // The target of the click event (and the edit) must be a span\n  var theTarget = $(event.originalEvent.target).closest('span');\n  var theColumnKey = $(theTarget).closest('[columnKey]').attr('columnKey'); // need to start from span to allow multi-value columns\n  var theTd = theTarget.closest('td');\n  var finderId = theTd.closest('div').parent().attr('id');\n  // We can write if the column does not have a 'noedit' class and if the row is writable and ready for edit\n  var canWrite = !theTd.hasClass('noedit') && theTd.closest('tr').filter('.editready').filter('[permissions*=write]').length === 1 && finders[finderId].inplaceeditcallbacks[theColumnKey] !== undefined;\n  // Also verify the writer lock\n  var finderLock = theTd.closest('div').parent().find('.lock.dev-finderlock');\n  var finderHasLock = finderLock.length === 1;\n  var finderIsLocked = !finderLock.hasClass('unlocked');\n\n  // If the finder has a lock that is locked, we do nothing\n  if (finderHasLock && finderIsLocked) {\n    return;\n  }\n\n  // If we can write, set the editable. If not, we prepare the row for editing (this ensures a double click is needed).\n  if (canWrite) {\n    theTarget.editable(finders[finderId].inplaceeditcallbacks[theColumnKey], finders[finderId].inplaceeditconfigs[theColumnKey]).editable('enable');\n  } else {\n    theTd.closest('tr').addClass('editready');\n  }\n}\nfunction unselectRow(event, row) {\n  row.removeClass('editready').editable('disable');\n}\n\n// Function to toggle the basket\nfunction toggleBasket() {\n  $('#finderbasket').slideToggle(50).removeClass('automaticOpen');\n}\n\n// Adds a tick image to the resources in the table which are already in the basket\nfunction tickResourcesInBasket() {\n  var resourceIdsInBasket = $('#finderbasket li').map(function (i, el) {\n    return $(el).attr('inBasket');\n  });\n  var tickedResourceIds = $('#finderTable .name.added').map(function (i, el) {\n    return $(el).parent().attr('objectid');\n  });\n\n  // Remove the ticks for resources that are not in the basket\n  for (var i = 0; i < tickedResourceIds.length; i++) {\n    if (jQuery.inArray(tickedResourceIds[i], resourceIdsInBasket) === -1) {\n      $('#finderTable tr').filter(\"[objectid=\".concat(tickedResourceIds[i], \"]\")).children('.name').removeClass('added');\n    }\n  }\n\n  // Add a tick for all resources in the basket\n  for (var _i3 = 0; _i3 < resourceIdsInBasket.length; _i3++) {\n    $('#finderTable tr').filter(\"[objectid=\".concat(resourceIdsInBasket[_i3], \"]\")).children('.name').addClass('added');\n  }\n}\n\n// function to ensure that special chars are correctly encoded (on xml page)\nfunction encodeString(aString) {\n  return $('<span/>').text(aString).html();\n}\n\n// some fixed items for the finders data\nfinders.resourceFinder.displayTable = AbstractResource.displayTable;\nfinders.resourceFinder.displayMessage = AbstractResource.displayMessage;\nfinders.resourceFinder.displayInitialTable = AbstractResource.displayInitialTable;\nfinders.resourceFinder.entities = {};\nfinders.resourceFinder.queryOnServer = false;\nfinders.resourceFinder.setsToOpenAfterSearch = [];\nfinders.resourceFinder.searchKeys = ['name', 'type', 'roles', 'group', 'serial', 'productcode', 'date'];//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9maW5kZXJzL3Jlc291cmNlZmluZGVyLmpzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBSUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBSUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBOztBQUVBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUlBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBMkNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUE1SUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUEwR0E7QUFqSkE7QUFtSkE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUlBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9SZWFjdENvbXBvbmVudHNfLy4vZmluZGVycy9yZXNvdXJjZWZpbmRlci5qcz8yZGE1Il0sInNvdXJjZXNDb250ZW50IjpbIi8qIGVzbGludC1kaXNhYmxlIG5vLXVudXNlZC12YXJzLCBmdW5jLW5hbWVzICovXG4vKiBnbG9iYWwgcGVybWlzc2lvbnMgKi9cbi8qIE5leHRQbGFuIC0gRmxvYXRpbmcgZmluZGVyc1xuICpcbiAqIENvcHlyaWdodCAoYykgMjAxMVx0MlJpdmVycyBOVlxuICogQWxsIHJpZ2h0cyByZXNlcnZlZFxuICovXG5pbXBvcnQge2hhc01ldGFLZXl9IGZyb20gJy4uL0NvbW1vblNjcmlwdHMvc2hhcmVkc2NyaXB0cy9zaGFyZWRzY3JpcHRzLW5wY29tbW9uJztcblxuLyogbWF4TWF0Y2hlcyBpcyB0aGUgbWF4aW11bSBudW1iZXIgb2YgcmVzb3VyY2VzIHRvIHN0YXJ0IHNob3dpbmcgaW50ZXJhY3RpdmVseSAqL1xuY29uc3QgbWF4SW50ZXJhY3RpdmVNYXRjaGVzID0gNTA7XG5jb25zdCBtYXhNYXRjaGVzID0gNTAwO1xuY29uc3QgcmVzb3VyY2VQYXRoID0gJy9yZXNvdXJjZXMnO1xuXG4vLyBob2xkcyBkYXRhIGFuZCBjYWxsYmFja3MgZm9yIHRoZSBkaWZmZXJlbnQgZmxvYXRpbmcgZmluZGVyc1xuZXhwb3J0IGNvbnN0IGZpbmRlcnMgPSBbXTtcbmxldCBjdXJyZW50UmVnRXhwcyA9IFtdO1xuZmluZGVycy50YXNrc0ZpbmRlciA9IHt9O1xuZmluZGVycy5yZXNvdXJjZUZpbmRlciA9IHt9O1xuLyogbGFiZWxzIGluIHRoZXNlIGFycmF5czogKi9cbi8vIHF1ZXJ5Q2FsbGJhY2sgLSBjYWxsYmFjayBmdW5jdGlvbiBmb3IgY29tcGxleCBxdWVyaWVzXG4vLyBidWlsZEZpbmRlckNvbnRleHRNZW51IC0gZnVuY3Rpb24gdG8gYWN0aXZhdGUgdGhlIGNvbnRleHQgbWVudVxuLy8gaW5wbGFjZWVkaXRjYWxsYmFja3MgLSBpbi1wbGFjZSBlZGl0IGNhbGxiYWNrcyBwZXIgY29sdW1uXG4vLyBpbnBsYWNlZWRpdGNvbmZpZ3MgLSBpbi1wbGFjZSBlZGl0IGNvbmZpZ3MgcGVyIGNvbHVtblxuLy8gZW50aXRpZXMgLSBpcyBhbiBhcnJheSBvZiBvYmplY3RzLiBFYWNoIG9iamVjdCBpcyBhbiBlbnRpdHkgdG8gZGlzcGxheSBpbiB0aGUgdGFibGUgKi9cbi8vIG1hdGNoZXMgLSBtYXRjaGVzIGFyZSBrZXB0IGluIGEgdmFyIHNvIHdlIGNhbiByZWRpc3BsYXkgdGhlIHRhYmxlIHdoZW4gbmVlZGVkXG4vLyBzZXRzVG9PcGVuQWZ0ZXJTZWFyY2ggLSBrZWVwIGlkcyBvZiBzZXRzIHRvIHJlLW9wZW4gYWZ0ZXIgcmVkaXNwbGF5IG9mIHRoZSB0YWJsZVxuLy8gc29ydEluc3RhbmNlVXBDYWxsYmFjayAtICBmdW5jdGlvbiB0byBzb3J0IGFuIGluc3RhbmNlIHVwd2FyZCAocmVzb3VyY2UgZmluZGVyIHNwZWNpZmljKVxuLy8gc29ydEluc3RhbmNlRG93bkNhbGxiYWNrIC0gZnVuY3Rpb24gdG8gc29ydCBhbiBpbnN0YW5jZSBkb3dud2FyZCAocmVzb3VyY2UgZmluZGVyIHNwZWNpZmljKVxuLy8gYWRkVG9CYXNrZXQgLSBmdW5jdGlvbiB0byBhZGQgYW4gaXRlbSB0byB0aGUgYmFza2V0IChyZXNvdXJjZSBmaW5kZXIgc3BlY2lmaWMpXG4vLyBpZHNXaXRoQ29uZmxpY3RzIC0gaWRzIGZvciB3aGljaCBhIGNvbmZsaWN0IG11c3QgYmUgZGlzcGxheWVkIChyZXNvdXJjZSBmaW5kZXIgc3BlY2lmaWMgLSBpbiBtYW5hZ2VyIG1vZGUgb25seSlcbi8vIGZpbmRlck1vZGUgLSBrZWVwcyB0aGUgbW9kZSB0aGUgZmluZGVyIGlzIGluIChyZXNvdXJjZSBmaW5kZXIgc3BlY2lmaWMpXG4vLyBzZWFyY2hLZXlzIC0ga2V5cyB0byBzZWFyY2ggb25cbi8vIHN2Z1Jlc291cmNlVXJsIC0gdGhlIHVybCBuZWVkZWQgZm9yIGZldGNoaW5nIHN2ZyBpY29uc1xuXG4vLyBUcmlnZ2VyZWQgd2hlbiBhIG5ldyBxdWVyeSBpcyBlbnRlcmVkXG5jb25zdCBjb21wbGV4UXVlcnlSZWdFeHAgPSAvW1xcXCJcXCtcXC1cXChcXClcXDpdLztcbmxldCBjdXJyZW50UHJvY2VzcztcblxuZXhwb3J0IGZ1bmN0aW9uIGZpbmRlclF1ZXJ5Q2hhbmdlZChzZWFyY2hJZCwgZGF0YSwgY2xvc2VPcGVuU2V0cywgaW50ZXJhY3RpdmUpIHtcbiAgJChzZWFyY2hJZCkucGFyZW50KCkuZmluZCgnLmxvYWRpbmcnKS5zaG93KCk7XG4gIGNvbnN0IHF1ZXJ5ID0gJChzZWFyY2hJZCkudmFsKCk7XG5cbiAgY2xlYXJUaW1lb3V0KGN1cnJlbnRQcm9jZXNzKTtcbiAgY29uc3Qgc2V0c1RvT3BlbiA9IFtdO1xuICAvLyBpZiB3ZSBzaG91bGQgY2xvc2UgdGhlIG9wZW4gc2V0cyBhZnRlciB0aGUgc2VhcmNoLCBzdGFydCB3aXRoIGEgbmV3IGFycmF5IG9mIGlkcyBvZiBzZXRzIHRvIG9wZW4gd2hlbiBkaXNwbGF5aW5nIHRoZSB0YWJsZVxuICBpZiAoY2xvc2VPcGVuU2V0cykge1xuICAgIGRhdGEuc2V0c1RvT3BlbkFmdGVyU2VhcmNoID0gc2V0c1RvT3BlbjtcbiAgfVxuXG4gIGlmIChyZXF1aXJlc1F1ZXJ5T25TZXJ2ZXIoZGF0YSwgcXVlcnkpKSB7XG4gICAgaWYgKHF1ZXJ5ID09PSAnJykge1xuICAgICAgZGF0YS5kaXNwbGF5TWVzc2FnZSgnVG9vIG1hbnkgbWF0Y2hlcy4uLiBwbGVhc2UgcmVmaW5lIHF1ZXJ5Jyk7XG4gICAgICAkKHNlYXJjaElkKS5wYXJlbnQoKS5maW5kKCcubG9hZGluZycpLmhpZGUoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZGF0YS5xdWVyeUNhbGxiYWNrKHF1ZXJ5KTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgaWYgKCQoJyNzdGF0dXMnKS5oYXNDbGFzcygnYnVzeScpICYmIChfLmtleXMoZGF0YS5lbnRpdGllcykubGVuZ3RoID09PSAwKSkge1xuICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgZmluZGVyUXVlcnlDaGFuZ2VkKHNlYXJjaElkLCBkYXRhLCBjbG9zZU9wZW5TZXRzLCBpbnRlcmFjdGl2ZSk7XG4gICAgICB9LCAxMDAwKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3Qgc2VhcmNoc3RyaW5ncyA9IHF1ZXJ5LnRvTG93ZXJDYXNlKCkuc3BsaXQoJyAnKTtcbiAgICBjdXJyZW50UmVnRXhwcyA9IFtdO1xuXG4gICAgLy8gQ3JlYXRlIHJlZ2V4cHMgZm9yIGVhY2ggc2VhcmNoIHN0cmluZ1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2VhcmNoc3RyaW5ncy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHNlYXJjaHN0cmluZ3NbaV0gIT09ICcnKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY3VycmVudFJlZ0V4cHNbaV0gPSBuZXcgUmVnRXhwKHNlYXJjaHN0cmluZ3NbaV0sICdpJyk7XG4gICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgIGRhdGEuZGlzcGxheU1lc3NhZ2UoJ1N5bnRheCBlcnJvci4gJywgZXJyLm1lc3NhZ2UpO1xuICAgICAgICAgICQoc2VhcmNoSWQpLnBhcmVudCgpLmZpbmQoJy5sb2FkaW5nJykuaGlkZSgpO1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICA7XG5cbiAgICAvLyBTZWFyY2ggdGhlbSFcbiAgICBkYXRhLm1hdGNoZXMgPSBnZXRFbnRpdGllc01hdGNoaW5nSW4oY3VycmVudFJlZ0V4cHMsIGRhdGEuZW50aXRpZXMsIGRhdGEuc2VhcmNoS2V5cywgc2V0c1RvT3Blbik7XG5cbiAgICBpZiAoaW50ZXJhY3RpdmUgJiYgZGF0YS5tYXRjaGVzLmxlbmd0aCA+IG1heEludGVyYWN0aXZlTWF0Y2hlcykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoZGF0YS5tYXRjaGVzLmxlbmd0aCA+IG1heE1hdGNoZXMpIHtcbiAgICAgIGRhdGEuZGlzcGxheU1lc3NhZ2UoJ1RvbyBtYW55IG1hdGNoZXMuLi4gcGxlYXNlIHJlZmluZSBxdWVyeScpO1xuICAgICAgJChzZWFyY2hJZCkucGFyZW50KCkuZmluZCgnLmxvYWRpbmcnKS5oaWRlKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIC8vIFNwZWNpYWwgY2FzZTogYSBzZWFyY2ggd2l0aCBhbiBlbXB0eSBxdWVyeSBzaG91bGQgbmV2ZXIgb3BlbiBzZXRzLi4uIChhbHNvIG9ubHkgZG8gdGhpcyB3aGVuIHJlcXVpcmVkIHRvIGNsb3NlIG9wZW4gc2V0cy4uLilcbiAgICBpZiAoY2xvc2VPcGVuU2V0cyAmJiBzZWFyY2hzdHJpbmdzLmxlbmd0aCA9PT0gMSAmJiBzZWFyY2hzdHJpbmdzWzBdID09PSAnJykge1xuICAgICAgZGF0YS5zZXRzVG9PcGVuQWZ0ZXJTZWFyY2ggPSBbXTtcbiAgICB9XG5cbiAgICAvLyBkaXNwbGF5IHJlc3VsdHNcbiAgICBpZiAoZGF0YS5tYXRjaGVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgZGF0YS5kaXNwbGF5TWVzc2FnZSgnTm8gbWF0Y2hlcyBmb3VuZCcpO1xuICAgIH0gZWxzZSB7XG4gICAgICBsZXQgaHRtbCA9ICcnO1xuICAgICAgY29uc3QgZW50aXRpZXMgPSBbXTtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5tYXRjaGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGVudGl0aWVzW2ldID0gYnVpbGRGcm9tSlNPTihkYXRhLm1hdGNoZXNbaV0sIGN1cnJlbnRSZWdFeHBzKTtcbiAgICAgICAgaHRtbCArPSBlbnRpdGllc1tpXS50YWJsZVJvdygwLCAnJywgdHJ1ZSk7XG4gICAgICB9XG4gICAgICBkYXRhLmRpc3BsYXlUYWJsZShkYXRhLm1hdGNoZXMsIGh0bWwpO1xuICAgIH1cbiAgICAkKHNlYXJjaElkKS5wYXJlbnQoKS5maW5kKCcubG9hZGluZycpLmhpZGUoKTtcbiAgfVxufVxuXG4vLyBTaG91bGQgdGhlIHF1ZXJ5IGhhcHBlbiBzZXJ2ZXIgc2lkZT9cbmZ1bmN0aW9uIHJlcXVpcmVzUXVlcnlPblNlcnZlcihkYXRhLCBxdWVyeSkge1xuICByZXR1cm4gZGF0YS5xdWVyeU9uU2VydmVyIHx8IF8uYW55KHF1ZXJ5LCBmdW5jdGlvbihlKSB7XG4gICAgcmV0dXJuIGNvbXBsZXhRdWVyeVJlZ0V4cC50ZXN0KGUpO1xuICB9KTtcbn1cblxuLy8gVHJpZ2dlcmVkIGZvciBpbnRlcmFjdGl2ZSByZWZpbmVtZW50XG5leHBvcnQgZnVuY3Rpb24gZmluZGVyUXVlcnlDaGFuZ2VkSW50ZXJhY3RpdmUoZXYsIHNlYXJjaElkLCBkYXRhLCBjbG9zZU9wZW5TZXRzKSB7XG4gIGNsZWFyVGltZW91dChjdXJyZW50UHJvY2Vzcyk7XG5cbiAgY29uc3QgdmFsdWUgPSAkKHNlYXJjaElkKS52YWwoKTtcblxuICAvLyBzdGFydCB1cGRhdGluZyBpbnRlcmFjdGl2ZWx5IGFmdGVyIG1vcmUgdGhhbiAyIGNoYXJzXG4gIGlmICh2YWx1ZS5sZW5ndGggPiAzICYmICEocmVxdWlyZXNRdWVyeU9uU2VydmVyKGRhdGEsIHZhbHVlKSkpIHtcbiAgICBjdXJyZW50UHJvY2VzcyA9IHNldFRpbWVvdXQoZmluZGVyUXVlcnlDaGFuZ2VkLCAzMDAsIHNlYXJjaElkLCBkYXRhLCBjbG9zZU9wZW5TZXRzLCB0cnVlKTtcbiAgfVxufVxuXG4vLyBSZXRyaWV2ZXMgdGhlIG1hdGNoaW5nIHJlc291cmNlc1xuZnVuY3Rpb24gZ2V0RW50aXRpZXNNYXRjaGluZ0luKHJlZ2V4cHMsIGRpY3QsIHNlYXJjaEtleXMsIHNldHNUb09wZW5BZnRlclNlYXJjaCkge1xuICBjb25zdCBmaWx0ZXJlZCA9IFtdO1xuICBjb25zdCBhbW91bnQgPSByZWdleHBzLmxlbmd0aDtcblxuICAvLyBGb3IgZWFjaCBlbnRpdHksIHNlZSBpZiBpdCBtYXRjaGVzIHRoZSBxdWVyeVxuICBfLmVhY2goZGljdCwgZnVuY3Rpb24ob2JqZWN0LCBrZXkpIHtcbiAgICBsZXQgbWF0Y2hlc0FsbCA9IHRydWU7XG5cbiAgICAvLyBNYXRjaGluZyB0aGUgcXVlcnkgbWVhbnMgbWF0Y2hpbmcgYWxsIHdvcmRzIGluIHRoZSBxdWVyeVxuICAgIGZvciAobGV0IGsgPSAwOyBrIDwgYW1vdW50OyBrKyspIHtcbiAgICAgIGxldCBmb3VuZCA9IGZhbHNlO1xuICAgICAgLy8gTWF0Y2hpbmcgYSB3b3JkIG1lYW5zIGhhdmluZyBhIGZpZWxkIHRoYXQgbWF0Y2hlcyB0aGUgd29yZFxuICAgICAgZm9yIChsZXQgcyA9IDA7IHMgPCBzZWFyY2hLZXlzLmxlbmd0aDsgcysrKSB7XG4gICAgICAgIGlmICgoc2VhcmNoS2V5c1tzXSBpbiBvYmplY3QpICYmIChvYmplY3Rbc2VhcmNoS2V5c1tzXV0uc2VhcmNoKHJlZ2V4cHNba10pICE9IC0xKSkge1xuICAgICAgICAgIGZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKCFmb3VuZCAmJiBpc1NldChvYmplY3QpKSB7XG4gICAgICAgIGlmIChnZXRFbnRpdGllc01hdGNoaW5nSW4oW3JlZ2V4cHNba11dLCBvYmplY3QuY2hpbGRyZW4sIHNlYXJjaEtleXMsIHNldHNUb09wZW5BZnRlclNlYXJjaCkubGVuZ3RoICE9IDApIHtcbiAgICAgICAgICBmb3VuZCA9IHRydWU7XG4gICAgICAgICAgc2V0c1RvT3BlbkFmdGVyU2VhcmNoLnB1c2gob2JqZWN0LmlkKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgbWF0Y2hlc0FsbCA9IG1hdGNoZXNBbGwgJiYgZm91bmQ7XG4gICAgfVxuICAgIGlmIChtYXRjaGVzQWxsKSB7XG4gICAgICBmaWx0ZXJlZC5wdXNoKG9iamVjdCk7XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIGZpbHRlcmVkO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZGlzcGxheVF1ZXJ5UmVzdWx0SW4obWVzc2FnZSwgaWRzLCBkYXRhKSB7XG4gIGRhdGEubWF0Y2hlcyA9IFtdO1xuICBkYXRhLnNldHNUb09wZW5BZnRlclNlYXJjaCA9IFtdO1xuXG4gIGlmIChtZXNzYWdlICE9PSAnJykge1xuICAgIGRhdGEuZGlzcGxheU1lc3NhZ2UobWVzc2FnZSk7XG4gIH0gZWxzZSB7XG4gICAgZm9yIChsZXQgaSBpbiBpZHMpIHtcbiAgICAgIGRhdGEubWF0Y2hlcy5wdXNoKGRhdGEuZW50aXRpZXNbaWRzW2ldXSk7XG4gICAgfVxuXG4gICAgLy8gZGlzcGxheSByZXN1bHRzXG4gICAgbGV0IGh0bWwgPSAnJztcbiAgICBjb25zdCBlbnRpdGllcyA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5tYXRjaGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBlbnRpdGllc1tpXSA9IGJ1aWxkRnJvbUpTT04oZGF0YS5tYXRjaGVzW2ldLCBjdXJyZW50UmVnRXhwcyk7XG4gICAgICBpZiAoaXNTZXQoZW50aXRpZXNbaV0pKSB7XG4gICAgICAgIGRhdGEuc2V0c1RvT3BlbkFmdGVyU2VhcmNoLnB1c2goZW50aXRpZXNbaV0uaWQpO1xuICAgICAgfVxuICAgICAgaHRtbCArPSBlbnRpdGllc1tpXS50YWJsZVJvdygwLCAnJywgdHJ1ZSk7XG4gICAgfVxuICAgIGRhdGEuZGlzcGxheVRhYmxlKGRhdGEubWF0Y2hlcywgaHRtbCk7XG4gIH1cbiAgJCgnLmxvYWRpbmcnKS5oaWRlKCk7XG59XG5cbi8vIEZ1bmN0aW9uIHRvIHJlbmRlciBhbiBTVkcgaWNvblxuZnVuY3Rpb24gc3ZnSWNvbihpY29uQ2xhc3NOYW1lLCByZXNvdXJjZVVybCkge1xuICByZXR1cm4gYDxzcGFuIHRpdGxlPVwiXCIgY2xhc3M9XCJzdmctaWNvbiBzdmctaWNvbi0tMTYgdS12ZXJ0aWNhbC1hbGlnbi10ZXh0LWJvdHRvbSBzdmctaWNvbi0tYmxhY2tcIj5cXFxuXHRcdDxzdmcgY2xhc3M9XCJzdmctaWNvbi0ke2ljb25DbGFzc05hbWV9XCI+XFxcblx0XHQ8dXNlIHhtbG5zOnhsaW5rPVwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGlua1wiIHhsaW5rOmhyZWY9XCIke3Jlc291cmNlVXJsfSMke2ljb25DbGFzc05hbWV9XCI+PC91c2U+XFxcblx0XHQ8L3N2Zz48L3NwYW4+YDtcbn1cblxuLy8gRnVuY3Rpb24gdG8gYWRkIGVudGl0aWVzIGluY3JlbWVudGFsbHkgdG8gdGhlIGVudGl0aWVzIGZvciBhIGZpbmRlclxuZXhwb3J0IGZ1bmN0aW9uIGFkZEVudGl0aWVzKGZpbmRlciwgYm9keUlkLCBlbnRpdGllcywgc2lsZW50KSB7XG4gIGNvbnN0IGRpY3QgPSBmaW5kZXIuZW50aXRpZXM7XG4gIGNvbnN0IHRhYmxlID0gJChgIyR7Ym9keUlkfWApLnBhcmVudCgpO1xuICBmb3IgKGNvbnN0IGtleSBpbiBlbnRpdGllcykge1xuICAgIGRpY3Rba2V5XSA9IGVudGl0aWVzW2tleV07IC8vIHJlcGxhY2UgdGhlIGVudGl0eSBpbiBvdXIgbG9jYWwgZGJcbiAgICBpZiAoIXNpbGVudCkge1xuICAgICAgY29uc3QgcmVuZGVyT2JqZWN0ID0gYnVpbGRGcm9tSlNPTihkaWN0W2tleV0sIGN1cnJlbnRSZWdFeHBzKTsgLy8gY3JlYXRlIHRoZSBvYmplY3QgdG8gcmVuZGVyIGl0XG4gICAgICBpZiAocmVuZGVyT2JqZWN0Lm15U2NvcGUgIT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICQoYC4ke3JlbmRlck9iamVjdC5teVNjb3BlKCl9YCkucmVtb3ZlKCk7XG4gICAgICB9IC8vIHJlbW92ZSBhbGwgY29udGFpbmluZyBpdGVtcyAod2hlbiBhcHBsaWNhYmxlKVxuICAgICAgY29uc3QgdG9wbGV2ZWxleGlzdGluZyA9ICQoYFtvYmplY3RpZD0ke2tleX1dYCkubm90KCcuc2V0aXRlbScpOyAvLyByZXBsYWNlIG9ubHkgdG9wbGV2ZWwgaXRlbXNcbiAgICAgIGlmICh0b3BsZXZlbGV4aXN0aW5nLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICQoYCMke2JvZHlJZH1gKS5hcHBlbmQocmVuZGVyT2JqZWN0LnRhYmxlUm93KDAsICcnLCB0cnVlKSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0b3BsZXZlbGV4aXN0aW5nLm5vdCgnLnNpbmdsZXRvbiwuc2V0aXRlbScpLnJlcGxhY2VXaXRoKHJlbmRlck9iamVjdC50YWJsZVJvdygwLCAnJywgdHJ1ZSkpO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG4vLyBGdW5jdGlvbiB0byByZW1vdmUgZW50aXRpZXMgaW5jcmVtZW50YWxseSBmcm9tIGEgZmluZGVyXG5leHBvcnQgZnVuY3Rpb24gcmVtb3ZlRW50aXRpZXMoZmluZGVyLCBpZHMsIHNpbGVudCkge1xuICBmb3IgKGNvbnN0IGkgaW4gaWRzKSB7XG4gICAgZGVsZXRlIGZpbmRlci5lbnRpdGllc1tpZHNbaV1dO1xuICAgIGlmICghc2lsZW50KSB7XG4gICAgICAkKGBbb2JqZWN0aWQ9JHtpZHNbaV19XWApLnJlbW92ZSgpO1xuICAgICAgJChgW2luc2V0aWQ9JHtpZHNbaV19XWApLnJlbW92ZSgpO1xuICAgIH1cbiAgfVxufVxuXG4vLyBGdW5jdGlvbiB0byBkZWxldGUgYWxsIGVudGl0aWVzIGZyb20gdGhlIGZpbmRlclxuZXhwb3J0IGZ1bmN0aW9uIGNsZWFyRW50aXRpZXMoZmluZGVyKSB7XG4gIGZpbmRlci5lbnRpdGllcyA9IHt9O1xufVxuXG4vLyBGdW5jdGlvbiB0aGF0IHRyaWdnZXJzIHRoZSBuZWNlc3NhcnkgdXBkYXRlcyBvbiB0aGUgdGFibGUgZm9yIGNvbnRleHQgbWVudSBhbmQgc29ydGVyXG5leHBvcnQgZnVuY3Rpb24gdHJpZ2dlckZpbmRlclVwZGF0ZXMoZmluZGVyLCBib2R5SWQpIHtcbiAgaWYgKGZpbmRlci5idWlsZEZpbmRlckNvbnRleHRNZW51ICE9PSB1bmRlZmluZWQpIHtcbiAgICBmaW5kZXIuYnVpbGRGaW5kZXJDb250ZXh0TWVudSgkKGAjJHtib2R5SWR9IHRyYCkpO1xuICB9XG4gICQoYCMke2JvZHlJZH1gKS5vbignY2xpY2snLCBjbGlja1Jvdyk7XG4gIGNvbnN0IHRhYmxlID0gJChgIyR7Ym9keUlkfWApLnBhcmVudCgpO1xuICB0YWJsZS50cmlnZ2VyKCd1cGRhdGUnKTtcbn1cblxuLyoqICoqKioqKioqKipcbiBGaW5kZXJFbnRpdHlcbiAqKioqKioqKioqKiAqL1xuXG4vLyBPYmplY3QgY3JlYXRpb25cbmZ1bmN0aW9uIGJ1aWxkRnJvbUpTT04ob2JqZWN0LCBteXJlZ2V4cHMpIHtcbiAgaWYgKG15cmVnZXhwcy5sZW5ndGggPT09IDApIHtcbiAgICBteXJlZ2V4cHMgPSBbXTtcbiAgICBteXJlZ2V4cHMucHVzaChuZXcgUmVnRXhwKCcnLCAnaScpKTtcbiAgfVxuICBjb25zdCBjbGF6eiA9IGV2YWwob2JqZWN0Ll9jbGFzc25hbWUpO1xuICBjb25zdCBvYmogPSBuZXcgY2xhenoob2JqZWN0LCBteXJlZ2V4cHMpO1xuICBpZiAob2JqLmNoaWxkcmVuICE9PSB1bmRlZmluZWQpIHtcbiAgICBvYmouY2hpbGRyZW4gPSBfLm1hcChvYmouY2hpbGRyZW4sIGZ1bmN0aW9uKGNoaWxkLCBrZXkpIHtcbiAgICAgIHJldHVybiBidWlsZEZyb21KU09OKGNoaWxkLCBteXJlZ2V4cHMpO1xuICAgIH0pO1xuICB9XG4gIHJldHVybiBvYmo7XG59XG5cbmNsYXNzIEZpbmRlckVudGl0eSB7XG5cbiAgY29uc3RydWN0b3Iob2JqLCBteXJlZ2V4cHMpIHtcbiAgICAvLyBjb3B5IHRoZSBlbnRpdHlcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBvYmopIHtcbiAgICAgIGxldCBlbCA9IG9ialtrZXldO1xuICAgICAgaWYgKGtleSAhPT0gJ2lkJyAmJiAodHlwZW9mIG9ialtrZXldID09PSAnc3RyaW5nJykpIHtcbiAgICAgICAgZWwgPSBlbmNvZGVTdHJpbmcoZWwpO1xuICAgICAgfVxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBteXJlZ2V4cHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKChrZXlbMF0gIT09ICdfJykgJiYgKGtleSAhPT0gJ2lkJykgJiYgKGtleSAhPT0gJ2VtYWlsJykgJiYgKHR5cGVvZiBvYmpba2V5XSA9PT0gJ3N0cmluZycpICYmIChteXJlZ2V4cHNbaV0uc291cmNlICE9PSAnKD86KScgJiYgbXlyZWdleHBzW2ldLnNvdXJjZSAhPT0gJycpKSB7XG4gICAgICAgICAgdGhpc1trZXldID0gZWwucmVwbGFjZShteXJlZ2V4cHNbaV0sICc8ZW0+JCY8L2VtPicpO1xuICAgICAgICB9IGVsc2UgaWYgKChvYmpba2V5XSAhPSBudWxsKSAmJiAodHlwZW9mIG9ialtrZXldID09PSAnb2JqZWN0JykpIC8vIHNoYWxsb3cgY29weSBhcnJheXMhXG4gICAgICAgIHtcbiAgICAgICAgICB0aGlzW2tleV0gPSBfLmNsb25lKGVsKTtcbiAgICAgICAgfS8vIHN0aWxsIG5lZWRlZD9cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgdGhpc1trZXldID0gZWw7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB2aXNpYmlsaXR5TWFya3VwKHRva2VuKSB7XG4gICAgbGV0IGRpc3BsYXk7XG4gICAgaWYgKHRoaXMudmlzaWJsZVRhYmxlQ29sdW1ucygpLmluZGV4T2YodG9rZW4pID09PSAtMSkge1xuICAgICAgZGlzcGxheSA9ICdub25lJztcbiAgICB9IGVsc2Uge1xuICAgICAgZGlzcGxheSA9ICdkZWZhdWx0JztcbiAgICB9XG5cbiAgICByZXR1cm4gYGNsYXNzPVwiY29sdW1uLSR7dG9rZW59XCIgc3R5bGU9XCJkaXNwbGF5OiR7ZGlzcGxheX1cImA7XG4gIH1cblxuICAvLyBEaXNwbGF5IHRoZSBwcm9wZXJ0eSBpbiBhIHRkIHdpdGggbWFya3VwIGZvciB2aXNpYmlsaXR5IGFkZGVkXG4gIHNpbXBsZVRhYmxlRGF0YUZvcihwcm9wZXJ0eSkge1xuICAgIGlmICh0aGlzW3Byb3BlcnR5XSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gYDx0ZCAke3RoaXMudmlzaWJpbGl0eU1hcmt1cChwcm9wZXJ0eSl9IGNvbHVtbktleT1cIiR7cHJvcGVydHl9XCI+PC90ZD5gO1xuICAgIH0gZWxzZSB7XG4gICAgICBsZXQgcHJvcGVydHlWYWx1ZSA9IHRoaXNbcHJvcGVydHldO1xuXG4gICAgICBzd2l0Y2ggKHByb3BlcnR5KSB7XG4gICAgICAgIGNhc2UgJ2VtYWlsJzpcbiAgICAgICAgICBwcm9wZXJ0eVZhbHVlID0gcHJvcGVydHlWYWx1ZS5saW5rKGBtYWlsdG86JHtwcm9wZXJ0eVZhbHVlfWApO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICd3ZWJzaXRlJzpcbiAgICAgICAgICBwcm9wZXJ0eVZhbHVlID0gYDxhIHRhcmdldD1cIl9ibGFua1wiIGhyZWY9XCIke3Byb3BlcnR5VmFsdWUuYWRkaHR0cCgpfVwiPiR7cHJvcGVydHlWYWx1ZX08L2E+YDtcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICAgIHJldHVybiBgPHRkICR7dGhpcy52aXNpYmlsaXR5TWFya3VwKHByb3BlcnR5KX0gY29sdW1uS2V5PVwiJHtwcm9wZXJ0eX1cIj4ke3Byb3BlcnR5VmFsdWV9PC90ZD5gO1xuICAgIH1cbiAgfVxuXG4gIGNoZWNrYm94VGFibGVEYXRhKCkge1xuICAgIHJldHVybiAnPHRkIGNsYXNzPVwic2VsZWN0LWNvbFwiPjxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIj48L3RkPic7XG4gIH1cblxufVxuXG5leHBvcnQgY2xhc3MgQWJzdHJhY3RSZXNvdXJjZSBleHRlbmRzIEZpbmRlckVudGl0eSB7XG4gIHN0YXRpYyBzd2l0Y2hhYmxlVGFibGVDb2x1bW5zID0gWyd0eXBlJywgJ2dyb3VwJywgJ3JvbGVzJywgJ3NlcmlhbCcsICdwcm9kdWN0Y29kZScsICdkYXRlJywgJ2Nvc3QnLCAncHJpY2UnLCAncm9zdGVycHVibGlzaGVkdW50aWwnXTtcbiAgc3RhdGljIHZpc2libGVUYWJsZUNvbHVtbnMgPSBudWxsO1xuXG4gIC8vIERpc3BsYXkgYSB0YWJsZSB3aXRoIHJlc3VsdGluZyBlbnRpdGllcyBhbmQgdGhlIHdvcmRzIG1hdGNoaW5nIHRoZSByZWdleHBzIGhpZ2hsaWdodGVkXG4gIHN0YXRpYyBkaXNwbGF5VGFibGUoZW50aXRpZXMsIGh0bWwpIHtcbiAgICAkKCcjZmluZGVyVGFibGVCb2R5JykuaHRtbChodG1sKS5vbignY2xpY2snLCBjbGlja1Jvdyk7XG5cbiAgICAvLyBTZXRzIGNvbnRleHQgbWVudVxuICAgIGZpbmRlcnMucmVzb3VyY2VGaW5kZXIuYnVpbGRGaW5kZXJDb250ZXh0TWVudSgkKCcjZmluZGVyVGFibGVCb2R5JykpO1xuXG4gICAgLy8gSW4gbGlzdGluZyBtb2RlLCB3ZSBzaG93IHRoZSB0aW1lbGluZXMgYWdhaW4gYWZ0ZXIgYSBzZWFyY2hcbiAgICBpZiAoZmluZGVycy5yZXNvdXJjZUZpbmRlci5maW5kZXJNb2RlID09PSAnbGlzdGluZycpIHtcbiAgICAgIHJlZnJlc2hPcGVuVGltZWxpbmVzKCk7XG4gICAgfVxuICAgIGlmIChmaW5kZXJzLnJlc291cmNlRmluZGVyLmZpbmRlck1vZGUgPT09ICdmaW5kZXInIHx8IGZpbmRlcnMucmVzb3VyY2VGaW5kZXIuZmluZGVyTW9kZSA9PT0gJ2V4dGVybmFsJykge1xuICAgICAgaGlkZVRpbWVsaW5lcygpO1xuICAgICAgLy8gVGljayByZXNvdXJjZXMgdGhhdCBhcmUgaW4gdGhlIGJhc2tldFxuICAgICAgdGlja1Jlc291cmNlc0luQmFza2V0KCk7XG4gICAgfVxuXG4gICAgLy8gQ3JlYXRlIGRyYWdnYWJsZXNcbiAgICBpZiAoZmluZGVycy5yZXNvdXJjZUZpbmRlci5hbGxvd0RyYWdnaW5nKSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGVudGl0aWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChlbnRpdGllc1tpXS5wZXJtaXNzaW9ucy5pbmRleE9mKCd1c2UnKSAhPT0gLTEpIHtcbiAgICAgICAgICBjcmVhdGVEcmFnZ2FibGUoZW50aXRpZXNbaV0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gdHJpZ2dlciB0aGUgdXBkYXRlIG9mIHRoZSBzb3J0ZXIgY2FjaGUgKHJlcXVpcmVkISlcbiAgICAkKCcjZmluZGVyVGFibGUnKS50cmlnZ2VyKCd1cGRhdGUnKTtcbiAgfVxuXG4gIHN0YXRpYyBkaXNwbGF5TWVzc2FnZShhU3RyaW5nKSB7XG4gICAgJCgnI2ZpbmRlclRhYmxlQm9keScpLmh0bWwoYDx0cj48dGQgY29sc3Bhbj1cIiR7QWJzdHJhY3RSZXNvdXJjZS52aXNpYmxlVGFibGVDb2x1bW5zLmxlbmd0aCArIDN9XCI+JHthU3RyaW5nfTwvdGQ+PC90cj5gKTtcbiAgfVxuXG4gIHN0YXRpYyBkaXNwbGF5SW5pdGlhbFRhYmxlKCkge1xuICAgICQoJyNmaW5kZXJUYWJsZUJvZHknKS5odG1sKCcnKTtcbiAgfVxuXG4gIHZpc2libGVUYWJsZUNvbHVtbnMoKSB7XG4gICAgcmV0dXJuIEFic3RyYWN0UmVzb3VyY2UudmlzaWJsZVRhYmxlQ29sdW1ucztcbiAgfVxuXG4gIGdldFBlcm1pc3Npb25zKCkge1xuICAgIC8vIFJldHVybnMgdGhlIHBlcm1pc3Npb25zIGZvciBhbiBlbnRpdHlcbiAgICBjb25zdCBwZXJtcyA9IHRoaXMucGVybWlzc2lvbnM7XG4gICAgaWYgKGlzRmluZGVyVW5sb2NrZWQoKSkge1xuICAgICAgcGVybXMucHVzaCgndW5sb2NrZWQnKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcGVybXM7XG4gIH1cblxuICBhYnN0cmFjdENzc0NsYXNzZXMobGV2ZWwpIHtcbiAgICBsZXQgcmVzdWx0ID0gJyc7XG4gICAgaWYgKHRoaXMuYW1vdW50ID4gMSkge1xuICAgICAgcmVzdWx0ICs9ICdtdWx0aXBsZSc7XG4gICAgfVxuICAgIGlmIChsZXZlbCA+IDApIHtcbiAgICAgIHJlc3VsdCArPSBgIGV4cGFuZC1jaGlsZCBzZXRpdGVtIHN1YiR7bGV2ZWx9YDtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIGNzc0NsYXNzZXMobGV2ZWwpIHtcbiAgICByZXR1cm4gdGhpcy5hYnN0cmFjdENzc0NsYXNzZXMobGV2ZWwpO1xuICB9XG5cbiAgaGFzUGxhY2Vob2xkZXJzKCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIHRpbWVsaW5lQ2xhc3NlcygpIHtcbiAgICBsZXQgcmVzdWx0ID0gJyc7XG5cbiAgICBpZiAoZmluZGVycy5yZXNvdXJjZUZpbmRlci5maW5kZXJNb2RlID09PSAnbGlzdGluZycpIHtcbiAgICAgIHJlc3VsdCArPSAnIHBsYW5uZWQnO1xuICAgICAgaWYgKGlzQ29uZmxpY3RJZCh0aGlzLmlkKSkge1xuICAgICAgICByZXN1bHQgKz0gJyBjb25mbGljdCc7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cblxuICBzZXJpYWxpemVkSWQoc2VwKSB7XG4gICAgcmV0dXJuIHNlcmlhbGl6ZWRJZE9mKHRoaXMsIHNlcCk7XG4gIH1cblxuICB0YWJsZVJvdyhsZXZlbCwgc2V0c2NvcGUsIHZpc2libGUpIHtcbiAgICAvLyBzZXR0aW5nIHRoZSByaWdodCBjc3MgY2xhc3NlcyBmb3IgdGhlIHJvd1xuICAgIC8vIFRoZSBzZXRzY29wZSBpcyBhIHNldCBvZiBjbGFzc2VzIHRoYXQgZGVwZW5kcyBvbiB0aGUgc2V0cyB3ZSBhcmUgKHZpc3VhbGx5KSBsb2NhdGVkIGluLiBJdCBhbGxvd3MgdXMgdG8gcmVtb3ZlIHRoaXMgcm93IGlmIHRoZSBzZXQgaXMgY2xvc2VkIVxuICAgIGNvbnN0IGNsYXNzZXMgPSBgJHtzZXRzY29wZX0gJHt0aGlzLmNzc0NsYXNzZXMobGV2ZWwpfWA7XG4gICAgbGV0IHN0eWxlID0gJyc7XG5cbiAgICBpZiAoIXZpc2libGUpIHtcbiAgICAgIHN0eWxlID0gJ3N0eWxlPVwiZGlzcGxheTpub25lXCInO1xuICAgIH1cblxuICAgIC8vIEdlbmVyYXRlIHRoZSB0YWJsZSByb3dcbiAgICBsZXQgaHRtbCA9IGA8dHIgJHtzdHlsZX0gY01lbnU9XCJmaW5kZXJNZW51XCIgY2xhc3M9XCIke2NsYXNzZXN9XCIgcGVybWlzc2lvbnM9XCIke3RvU291cmNlKHRoaXMuZ2V0UGVybWlzc2lvbnMoKSl9XCIgb2JqZWN0aWQ9XCIke3RoaXMuc2VyaWFsaXplZElkKCcsJyl9XCIgaW5zZXRpZD1cIiR7dGhpcy5zZXRpZH1cIj5gO1xuICAgIC8vIGh0bWwgKz0gdGhpcy5jaGVja2JveFRhYmxlRGF0YSgpO1xuICAgIGh0bWwgKz0gdGhpcy5uYW1lVGFibGVEYXRhKGxldmVsLCBzZXRzY29wZSk7XG4gICAgaHRtbCArPSB0aGlzLmFtb3VudFRhYmxlRGF0YShsZXZlbCk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBBYnN0cmFjdFJlc291cmNlLnN3aXRjaGFibGVUYWJsZUNvbHVtbnMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGh0bWwgKz0gdGhpcy5zaW1wbGVUYWJsZURhdGFGb3IoQWJzdHJhY3RSZXNvdXJjZS5zd2l0Y2hhYmxlVGFibGVDb2x1bW5zW2ldKTtcbiAgICB9XG4gICAgaHRtbCArPSB0aGlzLnRpbWVsaW5lVGFibGVEYXRhKCk7XG5cbiAgICByZXR1cm4gYCR7aHRtbH08L3RyPmA7XG4gIH1cblxuICBuYW1lVGFibGVEYXRhKGxldmVsLCBzZXRzY29wZSkge1xuICAgIGxldCBodG1sID0gJyc7XG5cbiAgICAvLyBJZiB3ZSBhcmUgaW4gZmluZGVyIG1vZGUsIHdlIGNhbiBhZGQgdGhpbmdzIHRvIHRoZSBiYXNrZXQgdXNpbmcgdGhpcyBsaW5rXG4gICAgaWYgKChmaW5kZXJzLnJlc291cmNlRmluZGVyLmZpbmRlck1vZGUgPT09ICdmaW5kZXInKSAmJiAodGhpcy5wZXJtaXNzaW9ucy5pbmRleE9mKCd1c2UnKSAhPT0gLTEpKSB7XG4gICAgICBodG1sICs9IGA8YSBocmVmPVwiamF2YXNjcmlwdDp7fVwiIG9uY2xpY2s9XCJSZWFjdENvbXBvbmVudHNfcmVzb3VyY2VhbmR0YXNrZmluZGVyLmZpbmRlcnMucmVzb3VyY2VGaW5kZXIuYWRkVG9CYXNrZXQoJyR7dGhpcy5pZH0nLFJlYWN0Q29tcG9uZW50c19yZXNvdXJjZWFuZHRhc2tmaW5kZXIuZ2V0Q3VycmVudFJvbGUoJyR7dGhpcy5pZH0nKSlcIiBjbGFzcz1cImFkZFwiPjxzcGFuIGlkPVwiUiR7dGhpcy5pZH1cIj4ke3RoaXMubmFtZX08L3NwYW4+PC9hPmA7XG4gICAgICAvLyBJZiB3ZSBoYXZlIHJvbGVzIHRvIHNob3csIHNob3cgdGhlbS5cbiAgICAgIGlmICh0aGlzLnR5cGUgPT09ICdIdW1hbicgJiYgdGhpcy5kZWZhdWx0cm9sZSAhPT0gdW5kZWZpbmVkICYmIHRoaXMucm9sZXMubGVuZ3RoID4gMCAmJiAhdGhpcy5oYXNQbGFjZWhvbGRlcnMoKSkge1xuICAgICAgICBodG1sICs9IGAgPHNwYW4gY2xhc3M9XCJyb2xlXCI+KDxzcGFuIGhyZWY9XCJqYXZhc2NyaXB0Ont9XCIgb25jbGljaz1cIm9wZW5Sb2xlU2VsZWN0b3IoJyR7dGhpcy5pZH0nKVwiIHRpdGxlPVwiY2hhbmdlIHJvbGVcIj4ke3RoaXMuZGVmYXVsdHJvbGV9PC9zcGFuPik8L3NwYW4+YDtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgaHRtbCArPSBgPHNwYW4gaWQ9XCJSJHt0aGlzLmlkfVwiPiR7dGhpcy5uYW1lfTwvc3Bhbj5gO1xuICAgIH1cblxuICAgIGh0bWwgKz0gJzwvdGQ+JztcblxuICAgIHJldHVybiBodG1sO1xuICB9XG5cbiAgYW1vdW50VGFibGVEYXRhKGxldmVsKSB7XG4gICAgcmV0dXJuIGA8dGQgaWQ9XCIke3RoaXMubXlTY29wZSgpfVwiIGNsYXNzPVwiYW1vdW50XCIgY29sdW1uS2V5PVwiYW1vdW50XCI+PHNwYW4+JHt0aGlzLmFtb3VudH08L3NwYW4+PC90ZD5gO1xuICB9XG5cbiAgdGltZWxpbmVUYWJsZURhdGEoKSB7XG4gICAgbGV0IGluc2V0ID0gJyc7XG4gICAgaWYgKHRoaXMuc2V0aWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgaW5zZXQgPSBgaW5zZXQ9XCIke3RoaXMuc2V0aWR9XCJgO1xuICAgIH1cblxuICAgIHJldHVybiBgPHRkIHRpbWVsaW5lPVwiJHt0aGlzLnNlcmlhbGl6ZWRJZCgnXycpfVwiICR7aW5zZXR9IGNsYXNzPVwiYXZhaWxhYmlsaXR5ICR7dGhpcy50aW1lbGluZUNsYXNzZXMoKX1cIj48L3RkPmA7XG4gIH1cblxufVxuXG5leHBvcnQgZnVuY3Rpb24gb3BlblJvbGVTZWxlY3RvcihpZCkge1xuICAkKGBbb2JqZWN0aWQ9JHtpZH1dIC5yb2xlIHNwYW5gKS5lZGl0YWJsZShmaW5kZXJzLnJlc291cmNlRmluZGVyLmlucGxhY2VlZGl0Y2FsbGJhY2tzLnJvbGUsIGZpbmRlcnMucmVzb3VyY2VGaW5kZXIuaW5wbGFjZWVkaXRjb25maWdzLnJvbGUpLmVkaXRhYmxlKCdlbmFibGUnKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEN1cnJlbnRSb2xlKGlkKSB7XG4gIHJldHVybiAkKGBbb2JqZWN0aWQ9JHtpZH1dIC5yb2xlIHNwYW5gKS5odG1sKCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRDdXJyZW50Um9sZUluU0UoaWQpIHtcbiAgLy8gaW4gU0UsIHdlIHVzZSBhbiBpZCB0aGF0IHN0YXJ0cyB3aXRoIFIuLi5cbiAgcmV0dXJuICQoYFtvYmplY3RpZD0ke2lkLnN1YnN0cmluZygxLCBpZC5zaXplKX1dIC5yb2xlIHNwYW5gKS5odG1sKCk7XG59XG5cbmNsYXNzIFJlc291cmNlIGV4dGVuZHMgQWJzdHJhY3RSZXNvdXJjZSB7XG5cbiAgdGFibGVSb3cobGV2ZWwsIHNldHNjb3BlLCB2aXNpYmxlKSB7XG4gICAgbGV0IGh0bWwgPSBzdXBlci50YWJsZVJvdyhsZXZlbCwgc2V0c2NvcGUsIHZpc2libGUpO1xuXG4gICAgaWYgKHRoaXMuYW1vdW50ID4gMSkge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGh0bWwgKz0gKHRoaXMuY2hpbGRyZW5baV0pLnRhYmxlUm93KGxldmVsLCBgJHtzZXRzY29wZX0gJHt0aGlzLm15U2NvcGUoKX1gLCBmYWxzZSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGh0bWw7XG4gIH1cblxuICBjc3NDbGFzc2VzKGxldmVsKSB7XG4gICAgbGV0IGNzc0NsYXNzZXMgPSBzdXBlci5hYnN0cmFjdENzc0NsYXNzZXMobGV2ZWwpO1xuICAgIGlmICh0aGlzLmNoaWxkcmVuLmxlbmd0aCA9PT0gMSAmJiB0aGlzLmNoaWxkcmVuWzBdLmlzSW5TZXQpIHtcbiAgICAgIGNzc0NsYXNzZXMgKz0gJyBmaXhlZCc7XG4gICAgfVxuICAgIHJldHVybiBjc3NDbGFzc2VzO1xuICB9XG5cbiAgbmFtZVRhYmxlRGF0YShsZXZlbCwgc2V0c2NvcGUpIHtcbiAgICByZXR1cm4gYDx0ZCBjbGFzcz1cIm5hbWVcIiBjb2x1bW5LZXk9XCJuYW1lXCI+JHtcbiAgICAgIHRoaXMudXNlciA/IHN2Z0ljb24oJ2ljb24tdXNlcicsIGZpbmRlcnMucmVzb3VyY2VGaW5kZXIuc3ZnUmVzb3VyY2VVcmwpIDogJydcbiAgICB9JHt0aGlzLnN1c3BlbmRlZHVzZXIgPyBzdmdJY29uKCdpY29uLXN1c3BlbmRlZC11c2VyJywgZmluZGVycy5yZXNvdXJjZUZpbmRlci5zdmdSZXNvdXJjZVVybCkgOiAnJ1xuICAgIH0ke0Fic3RyYWN0UmVzb3VyY2UucHJvdG90eXBlLm5hbWVUYWJsZURhdGEuY2FsbCh0aGlzLCBsZXZlbCwgc2V0c2NvcGUpfWA7XG4gIH1cblxuICBhbW91bnRUYWJsZURhdGEobGV2ZWwpIHtcbiAgICBpZiAodGhpcy5jaGlsZHJlbi5sZW5ndGggPT09IDEgJiYgdGhpcy5jaGlsZHJlblswXS5pc0luU2V0KSB7XG4gICAgICByZXR1cm4gYDx0ZCBjbGFzcz1cImFtb3VudFwiIHRpdGxlPVwiRml4ZWQgaW4gc2V0ICR7dGhpcy5jaGlsZHJlblswXS5pc0luU2V0LnJlcGxhY2UoJzxlbT4nLCAnJykucmVwbGFjZSgnPC9lbT4nLCAnJyl9XCI+ICBGaXhlZCBgO1xuICAgIH0vLyBuZWVkIHRvIHJlbW92ZSB0aGUgPGVtPiBiZWNhdXNlIHRoYXQgY3Jhc2hlcyB4bWwgcGFnZVxuICAgIGVsc2Uge1xuICAgICAgY29uc3QgcmVzb3VyY2VJZCA9IHRoaXMubXlTY29wZSgpO1xuICAgICAgbGV0IGh0bWwgPSBgPHRkIGlkPVwiJHtyZXNvdXJjZUlkfVwiIGNsYXNzPVwiYW1vdW50XCIgY29sdW1uS2V5PVwiYW1vdW50XCI+YDtcblxuICAgICAgLy8gQSBidWxrIHJlc291cmNlIHdpdGggYW4gdW5zcGVjaWZpZWQgYW1vdW50IG9yIGEgaHVtYW4gcmVzb3VyY2UgaXMgbm90IGVkaXRhYmxlIGluLXBsYWNlXG4gICAgICBpZiAodGhpcy5hbW91bnQgPT09ICctJyB8fCB0aGlzLnR5cGUgPT09ICdIdW1hbicpIHtcbiAgICAgICAgaHRtbCArPSB0aGlzLmFtb3VudDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGh0bWwgKz0gYDxzcGFuPiR7dGhpcy5hbW91bnR9PC9zcGFuPmA7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLmhhc093blByb3BlcnR5KCdhY3R1YWxhbW91bnQnKSkge1xuICAgICAgICBodG1sICs9IGAgPHNwYW4gY2xhc3M9XCJhY3R1YWxcIj4oJHt0aGlzLmFjdHVhbGFtb3VudH0pPC9zcGFuPmA7XG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLmNoaWxkcmVuLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgaHRtbCArPSBgPGEgY2xhc3M9XCJvcGVubWVcIiBocmVmPVwiamF2YXNjcmlwdDp7fVwiIG9uY2xpY2s9XCJSZWFjdENvbXBvbmVudHNfcmVzb3VyY2VhbmR0YXNrZmluZGVyLnRvZ2dsZU11bHRpcGxlKHRoaXMsJyR7cmVzb3VyY2VJZH0nKTtldmVudC5zdG9wUHJvcGFnYXRpb24oKVwiID4gPC9hPjwvdGQ+YDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGh0bWwgKz0gJzwvdGQ+JztcbiAgICAgIH1cbiAgICAgIHJldHVybiBodG1sO1xuICAgIH1cbiAgfVxuXG4gIG15U2NvcGUoKSB7XG4gICAgcmV0dXJuIGByZXNvdXJjZSR7dGhpcy5zZXJpYWxpemVkSWQoJycpfWA7XG4gIH1cblxufVxuXG5leHBvcnQgZnVuY3Rpb24gdG9nZ2xlTXVsdGlwbGUoZWwsIHJlc291cmNlSWQpIHtcbiAgaWYgKCQoZWwpLnBhcmVudCgpLnBhcmVudCgpLmhhc0NsYXNzKCdvcGVuJykpIHtcbiAgICAkKGAuJHtyZXNvdXJjZUlkfWApLmhpZGUoKTtcbiAgICAkKGVsKS5wYXJlbnQoKS5wYXJlbnQoKS5yZW1vdmVDbGFzcygnb3BlbicpO1xuICB9IGVsc2Uge1xuICAgIHJlZnJlc2hUaW1lbGluZU9mUm93cygkKGAuJHtyZXNvdXJjZUlkfWApLnNob3coKSk7XG4gICAgZmluZGVycy5yZXNvdXJjZUZpbmRlci5idWlsZEZpbmRlckNvbnRleHRNZW51KCQoYC4ke3Jlc291cmNlSWR9YCkpO1xuICAgICQoZWwpLnBhcmVudCgpLnBhcmVudCgpLmFkZENsYXNzKCdvcGVuJyk7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFJlc291cmNlSW5TZXQgZXh0ZW5kcyBSZXNvdXJjZSB7XG4gIG5hbWVUYWJsZURhdGEobGV2ZWwsIHNldHNjb3BlKSB7XG4gICAgcmV0dXJuIGA8dGQgY2xhc3M9XCJuYW1lXCIgY29sdW1uS2V5PVwibmFtZVwiPiR7QWJzdHJhY3RSZXNvdXJjZS5wcm90b3R5cGUubmFtZVRhYmxlRGF0YS5jYWxsKHRoaXMsIGxldmVsLCBzZXRzY29wZSl9YDtcbiAgfVxuXG4gIGFtb3VudFRhYmxlRGF0YShsZXZlbCkge1xuICAgIHJldHVybiBgPHRkIGNsYXNzPVwiYW1vdW50XCIgY29sdW1uS2V5PVwiYW1vdW50XCI+PHNwYW4+JHt0aGlzLmFtb3VudH08L3NwYW4+PC90ZD5gO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBFeHRlcm5hbFJlc291cmNlIGV4dGVuZHMgUmVzb3VyY2Uge1xuICBjc3NDbGFzc2VzKGxldmVsKSB7XG4gICAgcmV0dXJuIGBleHRlcm5hbCAke3N1cGVyLmFic3RyYWN0Q3NzQ2xhc3NlcyhsZXZlbCl9YDtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgQWRIb2MgZXh0ZW5kcyBSZXNvdXJjZSB7XG5cbiAgY3NzQ2xhc3NlcyhsZXZlbCkge1xuICAgIHJldHVybiBgYWRob2MgJHtzdXBlci5hYnN0cmFjdENzc0NsYXNzZXMobGV2ZWwpfWA7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIEZpbmFuY2lhbEFkSG9jIGV4dGVuZHMgUmVzb3VyY2Uge1xuICBjc3NDbGFzc2VzKGxldmVsKSB7XG4gICAgcmV0dXJuIGBhZGhvYy1maW5hbmNpYWwgJHtzdXBlci5hYnN0cmFjdENzc0NsYXNzZXMobGV2ZWwpfWA7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFBsYWNlSG9sZGVyIGV4dGVuZHMgUmVzb3VyY2Uge1xuXG4gIGhhc1BsYWNlaG9sZGVycygpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIGNzc0NsYXNzZXMobGV2ZWwpIHtcbiAgICByZXR1cm4gYHBsYWNlaG9sZGVyICR7c3VwZXIuYWJzdHJhY3RDc3NDbGFzc2VzKGxldmVsKX1gO1xuICB9XG5cbiAgbmFtZVRhYmxlRGF0YShsZXZlbCwgc2V0c2NvcGUpIHtcbiAgICByZXR1cm4gYDx0ZCBjbGFzcz1cIm5hbWVcIj4ke0Fic3RyYWN0UmVzb3VyY2UucHJvdG90eXBlLm5hbWVUYWJsZURhdGEuY2FsbCh0aGlzLCBsZXZlbCwgc2V0c2NvcGUpfWA7XG4gIH1cblxuICBhbW91bnRUYWJsZURhdGEobGV2ZWwpIHtcbiAgICByZXR1cm4gYDx0ZCBjbGFzcz1cImFtb3VudFwiPiR7dGhpcy5hbW91bnR9PC90ZD5gO1xuICB9XG5cbiAgdGltZWxpbmVDbGFzc2VzKCkge1xuICAgIGlmIChBYnN0cmFjdFJlc291cmNlLmZpbmRlck1vZGUgPT09ICdsaXN0aW5nJykge1xuICAgICAgcmV0dXJuIGAke1Jlc291cmNlLnByb3RvdHlwZS50aW1lbGluZUNsYXNzZXMuY2FsbCh0aGlzKX0gZW1wdHktYm94LWNvbmZsaWN0YDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuICcnO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgUGxhY2VIb2xkZXJJblNldCBleHRlbmRzIFBsYWNlSG9sZGVyIHtcblxuICBnZXRQZXJtaXNzaW9ucygpIHtcbiAgICBjb25zdCBwZXJtcyA9IEFic3RyYWN0UmVzb3VyY2UucHJvdG90eXBlLmdldFBlcm1pc3Npb25zLmNhbGwodGhpcyk7XG4gICAgcmV0dXJuIHBlcm1zLmNvbmNhdChbJ3dyaXRlUmVzb3VyY2UnXSk7XG4gIH1cblxuICBhbW91bnRUYWJsZURhdGEobGV2ZWwpIHtcbiAgICByZXR1cm4gYDx0ZCBjbGFzcz1cImFtb3VudFwiIGNvbHVtbktleT1cImFtb3VudFwiPjxzcGFuPiR7dGhpcy5hbW91bnR9PC9zcGFuPjwvdGQ+YDtcbiAgfVxuXG4gIHRpbWVsaW5lVGFibGVEYXRhKCkge1xuICAgIHJldHVybiBgPHRkIHRpbWVsaW5lPVwiJHt0aGlzLmlkfVwiIGluc2V0PVwiJHt0aGlzLnNldGlkfVwiIGNsYXNzPVwiYXZhaWxhYmlsaXR5ICR7dGhpcy50aW1lbGluZUNsYXNzZXMoKX1cIj48L3RkPmA7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFJlc291cmNlSW5zdGFuY2UgZXh0ZW5kcyBBYnN0cmFjdFJlc291cmNlIHtcblxuICBjc3NDbGFzc2VzKGxldmVsKSB7XG4gICAgaWYgKHRoaXMuaXNJblNldCkge1xuICAgICAgaWYgKHRoaXMuc2V0aWQgPT09IHVuZGVmaW5lZCkgLy8gaW4gc2luZ2xldG9uIGxpc3RcbiAgICAgIHtcbiAgICAgICAgcmV0dXJuICcgZXhwYW5kLWNoaWxkIGZpeGVkJztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBgJHtzdXBlci5hYnN0cmFjdENzc0NsYXNzZXMobGV2ZWwpfSBmaXhlZGA7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiAnZXhwYW5kLWNoaWxkIHNpbmdsZXRvbiAnO1xuICAgIH1cbiAgfVxuXG4gIG5hbWVUYWJsZURhdGEobGV2ZWwsIHNldHNjb3BlKSB7XG4gICAgLy8gb25seSBkaXNwbGF5IHRoZSBuYW1lIGluIGEgc2V0IChvdGhlcndpc2Ugd2UgYXJlIGluIHRoZSBpbnN0YW5jZXMgbGlzdGluZylcbiAgICBpZiAobGV2ZWwgPiAwKSB7XG4gICAgICByZXR1cm4gYDx0ZCBjbGFzcz1cIm5hbWVcIj4ke3RoaXMubmFtZX08L3RkPmA7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiAnPHRkIGNsYXNzPVwibmFtZVwiPjwvdGQ+JztcbiAgICB9XG4gIH1cblxuICBhbW91bnRUYWJsZURhdGEoKSB7XG4gICAgbGV0IGh0bWw7XG5cbiAgICBpZiAodGhpcy5pc0luU2V0KSB7XG4gICAgICBodG1sID0gYDx0ZCBjbGFzcz1cImFtb3VudFwiIHRpdGxlPVwiRml4ZWQgaW4gc2V0ICR7dGhpcy5pc0luU2V0LnJlcGxhY2UoJzxlbT4nLCAnJykucmVwbGFjZSgnPC9lbT4nLCAnJyl9XCI+ICBGaXhlZCBgO1xuICAgIH0vLyBuZWVkIHRvIHJlbW92ZSB0aGUgPGVtPiBiZWNhdXNlIHRoYXQgY3Jhc2hlcyB4bWwgcGFnZVxuICAgIGVsc2Uge1xuICAgICAgaHRtbCA9IGA8dGQgY2xhc3M9XCJhbW91bnRcIj4gPHNwYW4+IyR7dGhpcy5wcmVmZXJlbmNlfTwvc3Bhbj5gO1xuXG4gICAgICBpZiAoaXNGaW5kZXJVbmxvY2tlZCgpICYmIChfLmluZGV4T2YodGhpcy5nZXRQZXJtaXNzaW9ucygpLCAnd3JpdGUnKSAhPT0gLTEpKSB7XG4gICAgICAgIGh0bWwgKz0gc29ydGluZ0FjdGlvbnNGb3JJZCh0aGlzLmlkKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGAke2h0bWx9PC90ZD5gO1xuICB9XG5cbiAgdGltZWxpbmVUYWJsZURhdGEoKSB7XG4gICAgbGV0IGluc2V0YXR0ciA9ICcnO1xuXG4gICAgaWYgKHRoaXMuc2V0aWQgIT09IHVuZGVmaW5lZCkgLy8gaWYgdGhlIGluc2V0IGF0dHJpYnV0ZSBpcyBzZXQgKGllLiBJIGFtIGxvY2F0ZWQgaW5zaWRlIHRoZSBzZXQgaGVyZSAtIG5vdCBqdXN0IGRpc3BsYXllZCBpbiB0aGUgaW5zdGFuY2VzIGxpc3QpXG4gICAge1xuICAgICAgaW5zZXRhdHRyID0gYGluc2V0PVwiJHt0aGlzLnNldGlkfVwiYDtcbiAgICB9XG4gICAgcmV0dXJuIGA8dGQgdGltZWxpbmU9XCIke3RoaXMuaWR9XCIgJHtpbnNldGF0dHJ9IGNsYXNzPVwiYXZhaWxhYmlsaXR5ICR7dGhpcy50aW1lbGluZUNsYXNzZXMoKX1cIj48L3RkPmA7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFJlc291cmNlU2V0IGV4dGVuZHMgQWJzdHJhY3RSZXNvdXJjZSB7XG5cbiAgY3NzQ2xhc3NlcyhsZXZlbCkge1xuICAgIGxldCBvcGVuID0gJyc7XG4gICAgaWYgKHRoaXMuY29udGVudHNWaXNpYmxlKCkpIHtcbiAgICAgIG9wZW4gPSAnb3BlbiAnO1xuICAgIH1cbiAgICByZXR1cm4gYHNldCAke29wZW59JHtzdXBlci5hYnN0cmFjdENzc0NsYXNzZXMobGV2ZWwpfWA7XG4gIH1cblxuICBoYXNQbGFjZWhvbGRlcnMoKSB7XG4gICAgbGV0IGhhcyA9IGZhbHNlO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmNoaWxkcmVuLmxlbmd0aDsgaSsrKVxuICAgICAgLy8gaGF2ZSB0byBtYWtlIHRoZSBvYmplY3RzIGhlcmUgKGRpZCBub3Qgd29yayBpbiBjb25zdHJ1Y3Rvcih5ZXQpKVxuICAgIHtcbiAgICAgIGhhcyA9IGhhcyB8fCB0aGlzLmNoaWxkcmVuW2ldLmhhc1BsYWNlaG9sZGVycygpO1xuICAgIH1cblxuICAgIHJldHVybiBoYXM7XG4gIH1cblxuICBjb250ZW50c1Zpc2libGUoKSB7XG4gICAgcmV0dXJuIGZpbmRlcnMucmVzb3VyY2VGaW5kZXIuc2V0c1RvT3BlbkFmdGVyU2VhcmNoLmluZGV4T2YodGhpcy5zZXJpYWxpemVkSWQoJycpKSAhPT0gLTE7XG4gIH1cblxuICB0YWJsZVJvdyhsZXZlbCwgc2V0c2NvcGUsIHZpc2libGUpIHtcbiAgICBsZXQgaHRtbCA9IEFic3RyYWN0UmVzb3VyY2UucHJvdG90eXBlLnRhYmxlUm93LmNhbGwodGhpcywgbGV2ZWwsIHNldHNjb3BlLCB2aXNpYmxlKTtcbiAgICBjb25zdCBjb250ZW50c1Zpc2libGUgPSB0aGlzLmNvbnRlbnRzVmlzaWJsZSgpO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG4gICAgICBodG1sICs9ICh0aGlzLmNoaWxkcmVuW2ldKS50YWJsZVJvdyhsZXZlbCArIDEsIGAke3NldHNjb3BlfSAke3RoaXMubXlTY29wZSgpfWAsIGNvbnRlbnRzVmlzaWJsZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGh0bWw7XG4gIH1cblxuICBuYW1lVGFibGVEYXRhKGxldmVsLCBzZXRzY29wZSkge1xuICAgIC8vIElmIHRoZSByb3cgcmVwcmVzZW50cyBhIHNldCwgYWRkIHRoZSBjbGljayBsaW5rIGFuZCByZWdpc3RlciBhIGZ1bmN0aW9uIHRoYXQgd2lsbCByZWdpc3RlciB0aGUgY2xpY2sgd2hlbiB0aGUgcm93IGlzIGdlbmVyYXRlZFxuICAgIGNvbnN0IG15U2NvcGUgPSB0aGlzLm15U2NvcGUoKTtcbiAgICBjb25zdCBodG1sID0gYDx0ZCBpZD1cIiR7bXlTY29wZX1cIiBjbGFzcz1cIm5hbWVcIiBjb2x1bW5rZXk9XCJuYW1lXCI+PGEgY2xhc3M9XCJvcGVubWUgc2hvdy1zZXRcIiBvbmNsaWNrPVwiUmVhY3RDb21wb25lbnRzX3Jlc291cmNlYW5kdGFza2ZpbmRlci50b2dnbGVTZXQoJCh0aGlzKSwnJHtteVNjb3BlfScsJHtsZXZlbH0pO2V2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1wiPiA8L2E+YDtcblxuICAgIHJldHVybiBodG1sICsgQWJzdHJhY3RSZXNvdXJjZS5wcm90b3R5cGUubmFtZVRhYmxlRGF0YS5jYWxsKHRoaXMsIGxldmVsLCBzZXRzY29wZSk7XG4gIH1cblxuICBhbW91bnRUYWJsZURhdGEobGV2ZWwpIHtcbiAgICBpZiAoZmluZGVycy5yZXNvdXJjZUZpbmRlci5maW5kZXJNb2RlID09PSAnbGlzdGluZycpIHtcbiAgICAgIHJldHVybiBgPHRkIGNsYXNzPVwiYW1vdW50XCIgY29sdW1uS2V5PVwiYW1vdW50XCI+PHNwYW4+JHt0aGlzLmFtb3VudH08L3NwYW4+PC90ZD5gO1xuICAgIH0gZWxzZSBpZiAodGhpcy5zZXRpZCA9PSB1bmRlZmluZWQpIHtcbiAgICAgIHJldHVybiAnPHRkPiAtIDwvdGQ+JztcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGA8dGQgY2xhc3M9XCJhbW91bnRcIiBjb2x1bW5LZXk9XCJhbW91bnRcIj48c3Bhbj4ke3RoaXMuYW1vdW50fTwvc3Bhbj48L3RkPmA7XG4gICAgfVxuICB9XG5cbiAgdGltZWxpbmVDbGFzc2VzKCkge1xuICAgIGlmIChmaW5kZXJzLnJlc291cmNlRmluZGVyLmZpbmRlck1vZGUgPT09ICdsaXN0aW5nJyAmJiB0aGlzLmhhc1BsYWNlaG9sZGVycygpKSB7XG4gICAgICByZXR1cm4gYCR7QWJzdHJhY3RSZXNvdXJjZS5wcm90b3R5cGUudGltZWxpbmVDbGFzc2VzLmNhbGwodGhpcyl9IGVtcHR5LWJveC1jb25mbGljdGA7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBBYnN0cmFjdFJlc291cmNlLnByb3RvdHlwZS50aW1lbGluZUNsYXNzZXMuY2FsbCh0aGlzKTtcbiAgICB9XG4gIH1cblxuICBteVNjb3BlKCkge1xuICAgIHJldHVybiBgc2V0JHt0aGlzLmlkfWA7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRvZ2dsZVNldChlbCwgc2V0SWQsIGxldmVsKSB7XG4gIGlmIChlbC5wYXJlbnQoKS5wYXJlbnQoKS5oYXNDbGFzcygnb3BlbicpKSB7XG4gICAgLy8gY2xpY2tlZCBvbiBhbiBvcGVuIHNldCBvciBtdWx0aXBsZVxuICAgICQoYC4ke3NldElkfWApLmhpZGUoKS5yZW1vdmVDbGFzcygnb3BlbicpO1xuICAgIGVsLnBhcmVudCgpLnBhcmVudCgpLnJlbW92ZUNsYXNzKCdvcGVuJyk7XG4gIH0gZWxzZSB7XG4gICAgLy8gY2xpY2tlZCBvbiBhIGNsb3NlZCBzZXQgb3IgbXVsdGlwbGVcbiAgICByZWZyZXNoVGltZWxpbmVPZlJvd3MoJChgLiR7c2V0SWR9LnN1YiR7bGV2ZWwgKyAxfWApLnNob3coKSk7XG4gICAgZmluZGVycy5yZXNvdXJjZUZpbmRlci5idWlsZEZpbmRlckNvbnRleHRNZW51KCQoYC4ke3NldElkfS5zdWIke2xldmVsICsgMX1gKSk7XG4gICAgZWwucGFyZW50KCkucGFyZW50KCkuYWRkQ2xhc3MoJ29wZW4nKTtcbiAgfVxufVxuXG4vKiogKioqKioqKioqKioqKioqKioqKioqKlxuIEhlbHBlciBmdW5jdGlvbnNcbiAqKioqKioqKioqKioqKioqKioqKioqKiAqL1xubGV0IGh0bWxJZCA9IDA7XG5cbmZ1bmN0aW9uIG5leHRJZCgpIHtcbiAgaHRtbElkICs9IDE7XG4gIHJldHVybiBodG1sSWQ7XG59XG5cbmZ1bmN0aW9uIHNvcnRpbmdBY3Rpb25zRm9ySWQoaWQpIHtcbiAgcmV0dXJuIGA8ZGl2PjxhIGhyZWY9XCJqYXZhc2NyaXB0Ont9XCIgY2xhc3M9XCJzb3J0LXVwXCIgb25jbGljaz1cInNvcnRJbnN0YW5jZVVwKCcke2lkfScsdGhpcyk7cmV0dXJuIGZhbHNlXCI+dXA8L2E+IDxhIGhyZWY9XCJqYXZhc2NyaXB0Ont9XCIgY2xhc3M9XCJzb3J0LWRvd25cIiBvbmNsaWNrPVwic29ydEluc3RhbmNlRG93bignJHtpZH0nLHRoaXMpO3JldHVybiBmYWxzZVwiPmRvd248L2E+PC9kaXY+YDtcbn1cblxuZnVuY3Rpb24gaXNTZXQoYW5BcnJheSkge1xuICByZXR1cm4gJ2NoaWxkcmVuJyBpbiBhbkFycmF5O1xufVxuXG5mdW5jdGlvbiBpc0ZpbmRlclVubG9ja2VkKCkge1xuICByZXR1cm4gJCgnI2ZpbmRlcmxvY2snKS5oYXNDbGFzcygndW5sb2NrZWQnKTtcbn1cblxuLy8gRnVuY3Rpb24gY2FsbGVkIGJ5IHNlcnZlci1zaWRlIHdoZW4gaXQgcmVmcmVzaGVzIHRoZSB0YWJsZSBhZnRlciBhbiBvcGVyYXRpb25cbmV4cG9ydCBmdW5jdGlvbiBhcmNoaXZlT3BlblNldHMoZGF0YSkge1xuICBkYXRhLnNldHNUb09wZW5BZnRlclNlYXJjaCA9IG5ldyBBcnJheTtcbiAgJCgnLnNldC5vcGVuLC5tdWx0aXBsZS5vcGVuJykuZWFjaChmdW5jdGlvbigpIHtcbiAgICBkYXRhLnNldHNUb09wZW5BZnRlclNlYXJjaC51bnNoaWZ0KCQodGhpcykuYXR0cignb2JqZWN0aWQnKSk7XG4gIH0pO1xufVxuXG4vLyBGdW5jdGlvbiB0byBiZSB1c2VkIHRvIG9wZW4gc2V0cyB3aGVuIHJlbmRlcmluZyBoYXBwZW5zIHNlcnZlci1zaWRlXG5leHBvcnQgZnVuY3Rpb24gZXhwYW5kT3BlblNldHMoZGF0YSkge1xuICAkKGRhdGEuc2V0c1RvT3BlbkFmdGVyU2VhcmNoKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICQoYFtvYmplY3RpZD0ke3RoaXN9XWApLm5vdCgnLm9wZW4nKS5maW5kKCcuc2hvdy1zZXQnKS50cmlnZ2VyKCdjbGljaycpO1xuICB9KTtcbn1cblxuLy8gRnVuY3Rpb24gdG8gYmUgdXNlZCB0byBvcGVuIHNldHMgd2hlbiByZW5kZXJpbmcgaGFwcGVucyBzZXJ2ZXItc2lkZVxuZXhwb3J0IGZ1bmN0aW9uIGFkZE9wZW5TZXRzKGRhdGEsIG5ld1NldHMpIHtcbiAgZGF0YS5zZXRzVG9PcGVuQWZ0ZXJTZWFyY2ggPSBfLnVuaXEoZGF0YS5zZXRzVG9PcGVuQWZ0ZXJTZWFyY2guY29uY2F0KG5ld1NldHMpKTtcbn1cblxuLy8gdGhlIGZvbGxvd2luZyBmdW5jdGlvbiBpbXBsZW1lbnRzIHRoZSBNb3ppbGxhLWxpa2UgdG9Tb3VyY2UoKSBtZXRob2Qgb25seSBmb3IgYXJyYXlzIHdpdGggc3RyaW5nc1xuLy8gYmVjYXVzZSB0b1NvdXJjZSgpIGRvZXMgbm90IGV4aXN0IG91dHNpZGUgZmlyZWZveFxuZnVuY3Rpb24gdG9Tb3VyY2UoYW5BcnJheSkge1xuICAvLyByZXBsYWNlIHdpdGggYW5BcnJheS50b1NvdXJjZSgpIGlmIGV2ZXJ5b25lIGRlY2lkZXMgdG8gaW1wbGVtZW50IHRoaXMgbW96aWxsYS1zcGVjaWZpYyBtZXRob2RcbiAgcmV0dXJuIGBbJyR7JC5tYXAoYW5BcnJheSwgZnVuY3Rpb24oZWFjaCkge1xuICAgIHJldHVybiBlYWNoLnRvU3RyaW5nKCk7XG4gIH0pLmpvaW4oJ1xcJyxcXCcnKX0nXWA7XG59XG5cbmZ1bmN0aW9uIHNlcmlhbGl6ZWRJZE9mKGFuT2JqZWN0LCBzZXApIHtcbiAgaWYgKHR5cGVvZiAoYW5PYmplY3QuaWQpID09PSAnb2JqZWN0Jykge1xuICAgIHJldHVybiBhbk9iamVjdC5pZC5qb2luKHNlcCk7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGAke2FuT2JqZWN0LmlkfWA7XG4gIH0gLy8gbWFrZSBzdXJlIGl0J3MgYSBzdHJpbmchO1xufVxuXG4vKiogKioqKioqKioqKioqKioqKioqKioqKlxuIENvbnRleHQgbWVudVxuICoqKioqKioqKioqKioqKioqKioqKioqICovXG5cbi8vIFBlcm1pc3Npb25zIG9mIHRoZSBtZW51XG5leHBvcnQgZnVuY3Rpb24gc2V0Q29udGV4dE1lbnVQZXJtaXNzaW9uSW5GaW5kZXIoZm9jdXNFbGVtZW50KSB7XG4gIGNvbnN0IGFsbFBlcm1pc3Npb25zID0gJChmb2N1c0VsZW1lbnQpLm1hcChmdW5jdGlvbihpLCBlbCkge1xuICAgIHJldHVybiBldmFsKCQoZWwpLmF0dHIoJ3Blcm1pc3Npb25zJykpO1xuICB9KTtcbiAgY29uc3QgY3VycmVudG1lbnVDbGFzcyA9ICQoZm9jdXNFbGVtZW50KS5hdHRyKCdjbWVudScpO1xuXG4gIC8vIGRpc2FibGUgYWxsIG1lbnUgaXRlbXMgdGhhdCBoYXZlIGEgcGVybWlzc2lvbiBlbnRyeVxuICAkKGAjJHtjdXJyZW50bWVudUNsYXNzfSBsaSBbcGVybWlzc2lvbnNdYCkuYXR0cignaXNkaXNhYmxlJywgJ3RydWUnKTtcbiAgLy8gZm9yIGVhY2ggc3VjaCBtZW51IGl0ZW0sIGNoZWNrIGlmIGFsbCBpdHMgcmVxdWlyZWQgcGVybWlzc2lvbnMgYXJlIGluIG91ciBjdXJyZW50bHkgZ2l2ZW4gcGVybWlzc2lvbnNcbiAgJChgIyR7Y3VycmVudG1lbnVDbGFzc30gbGkgYVtwZXJtaXNzaW9uc11gKS5ub3QoJy5kaXNhYmxlZCcpLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgY29uc3QgbXlQZXJtcyA9IGV2YWwoJCh0aGlzKS5hdHRyKCdwZXJtaXNzaW9ucycpKTtcbiAgICAvLyBtYWtlIHRoZSBpbnRlcnNlY3Rpb24gb2YgdGhlIHJlcXVpcmVkIGFuZCBnaXZlbiBwZXJtaXNzaW9ucyB0byBzZWUgaWYgYWxsIHJlcXVpcmVkIHBlcm1pc3Npb25zIGFyZSBnaXZlblxuICAgIGlmIChfLmludGVyc2VjdGlvbihteVBlcm1zLCBhbGxQZXJtaXNzaW9ucykubGVuZ3RoID09PSBteVBlcm1zLmxlbmd0aCkge1xuICAgICAgJCh0aGlzKS5yZW1vdmVBdHRyKCdpc2Rpc2FibGUnKTtcbiAgICB9XG4gIH0pO1xufVxuXG4vKiogKioqKioqKioqKioqKioqKioqKioqKlxuIFNvcnQgb3BlcmF0aW9ucyBmb3IgcmVzb3VyY2UgaW5zdGFuY2VzXG4gKioqKioqKioqKioqKioqKioqKioqKiogKi9cblxuZXhwb3J0IGZ1bmN0aW9uIHNvcnRJbnN0YW5jZVVwKGlkLCBhRWwpIHtcbiAgY29uc3Qgcm93RWwgPSAkKGFFbCkuY2xvc2VzdCgndHInKTtcbiAgLy8gSWYgd2UgY2FuIG1vdmUgdXAuLi5cbiAgaWYgKHJvd0VsLnByZXYoKS5oYXNDbGFzcygnc2luZ2xldG9uJykpIHtcbiAgICAvLyBGaXJzdCBzd2FwIHRoZSBudW1iZXJzXG4gICAgY29uc3QgdGVtcCA9ICQoYUVsKS5wYXJlbnQoKS5wYXJlbnQoKS5jaGlsZHJlbignc3BhbicpLmNsb25lKHRydWUpO1xuICAgICQoYUVsKS5wYXJlbnQoKS5wYXJlbnQoKS5jaGlsZHJlbignc3BhbicpLnJlcGxhY2VXaXRoKHJvd0VsLnByZXYoKS5maW5kKCcuYW1vdW50IHNwYW4nKS5jbG9uZSh0cnVlKSk7XG4gICAgcm93RWwucHJldigpLmZpbmQoJy5hbW91bnQgc3BhbicpLnJlcGxhY2VXaXRoKHRlbXApO1xuXG4gICAgLy8gU3dhcCB0aGUgcm93cyBhbmQgbWFrZSB0aGUgY2FsbGJhY2sgdG8gc2VydmVyXG4gICAgcm93RWwuY2xvbmUodHJ1ZSkuaW5zZXJ0QmVmb3JlKHJvd0VsLnByZXYoKSk7XG4gICAgcm93RWwucmVtb3ZlKCk7XG4gICAgZmluZGVycy5yZXNvdXJjZUZpbmRlci5zb3J0SW5zdGFuY2VVcENhbGxiYWNrKGlkKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gc29ydEluc3RhbmNlRG93bihpZCwgYUVsKSB7XG4gIGNvbnN0IHJvd0VsID0gJChhRWwpLmNsb3Nlc3QoJ3RyJyk7XG4gIGlmIChyb3dFbC5uZXh0KCkuaGFzQ2xhc3MoJ3NpbmdsZXRvbicpKSB7XG4gICAgLy8gRmlyc3Qgc3dhcCB0aGUgbnVtYmVyc1xuICAgIGNvbnN0IHRlbXAgPSAkKGFFbCkucGFyZW50KCkucGFyZW50KCkuY2hpbGRyZW4oJ3NwYW4nKS5jbG9uZSh0cnVlKTtcbiAgICAkKGFFbCkucGFyZW50KCkucGFyZW50KCkuY2hpbGRyZW4oJ3NwYW4nKS5yZXBsYWNlV2l0aChyb3dFbC5uZXh0KCkuZmluZCgnLmFtb3VudCBzcGFuJykuY2xvbmUodHJ1ZSkpO1xuICAgIHJvd0VsLm5leHQoKS5maW5kKCcuYW1vdW50IHNwYW4nKS5yZXBsYWNlV2l0aCh0ZW1wKTtcblxuICAgIC8vIFN3YXAgdGhlIHJvd3MgYW5kIG1ha2UgdGhlIGNhbGxiYWNrIHRvIHNlcnZlclxuICAgIHJvd0VsLmNsb25lKHRydWUpLmluc2VydEFmdGVyKHJvd0VsLm5leHQoKSk7XG4gICAgcm93RWwucmVtb3ZlKCk7XG4gICAgZmluZGVycy5yZXNvdXJjZUZpbmRlci5zb3J0SW5zdGFuY2VEb3duQ2FsbGJhY2soaWQpO1xuICB9XG59XG5cbi8vIHZhcmlhYmxlIHRoYXQgd2lsbCBjb250YWluIGEgZnVuY3Rpb24gdG8gY2FsbGJhY2sgdG8gdGhlIHNlcnZlciAoc2V0IGJ5IGFuIG9ubG9hZCBzY3JpcHQpXG5nbG9iYWwuZ2V0QXZhaWxhYmlsaXR5VGltZWxpbmVzRm9yID0gbnVsbDtcblxuLy8gdHJpZ2dlciB0aGUgdXBkYXRlIG9mIHRoZSBhdmFpbGFiaWxpdHkgdGltZWxpbmVzXG5mdW5jdGlvbiByZWZyZXNoVGltZWxpbmVPZlJvd3Mocm93cykge1xuICBpZiAoJCgnI2F2YWlsYWJpbGl0eUJ1dHRvbjp2aXNpYmxlJykubGVuZ3RoID09PSAwKSB7XG4gICAgcm93cy5jaGlsZHJlbigndGRbdGltZWxpbmVdJykuaHRtbChgPGltZyBzcmM9XCIke3Jlc291cmNlUGF0aH0vaW1hZ2VzL2FqYXgtbG9hZGVyLmdpZlwiLz5gKTtcbiAgICBnbG9iYWwuZ2V0QXZhaWxhYmlsaXR5VGltZWxpbmVzRm9yKHJvd3MubWFwKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0QXR0cmlidXRlKCdvYmplY3RpZCcpO1xuICAgIH0pLnRvQXJyYXkoKS5qb2luKCc7JyksIHJvd3MubWFwKGZ1bmN0aW9uKCkge1xuICAgICAgcmV0dXJuIHRoaXMuZ2V0QXR0cmlidXRlKCdpbnNldGlkJyk7XG4gICAgfSkudG9BcnJheSgpLmpvaW4oJywnKSk7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlZnJlc2hPcGVuVGltZWxpbmVzKCkge1xuICBpZiAoJCgnI2F2YWlsYWJpbGl0eUJ1dHRvbjp2aXNpYmxlJykubGVuZ3RoID09PSAwKSB7XG4gICAgJCgnLnJlc29sdmluZycpLnBhcmVudCgpLnJlbW92ZSgpO1xuICAgIGNvbnN0IGFsbCA9ICQoJ3RkW3RpbWVsaW5lXTp2aXNpYmxlJyk7XG4gICAgaWYgKGFsbC5sZW5ndGggPCAxMDApIHtcbiAgICAgIGFsbC5odG1sKGA8aW1nIHNyYz1cIiR7cmVzb3VyY2VQYXRofS9pbWFnZXMvYWpheC1sb2FkZXIuZ2lmXCIvPmApO1xuICAgICAgZ2xvYmFsLmdldEF2YWlsYWJpbGl0eVRpbWVsaW5lc0ZvcigkLm1hcChhbGwsIGZ1bmN0aW9uKGVhY2gpIHtcbiAgICAgICAgcmV0dXJuICQoZWFjaCkuYXR0cigndGltZWxpbmUnKTtcbiAgICAgIH0pLmpvaW4oJzsnKSwgJC5tYXAoYWxsLCBmdW5jdGlvbihlYWNoKSB7XG4gICAgICAgIGlmICgkKGVhY2gpLmF0dHIoJ2luc2V0JykgIT0gdW5kZWZpbmVkKSByZXR1cm4gJChlYWNoKS5hdHRyKCdpbnNldCcpOyBlbHNlIHJldHVybiAnbnVsbCc7XG4gICAgICB9KS5qb2luKCcsJykpO1xuICAgIH0gZWxzZSB7XG4gICAgICBoaWRlVGltZWxpbmVzKCk7XG4gICAgfVxuICB9XG59XG5cbi8vIEhpZGVzIHRoZSB0aW1lbGluZXNcbmZ1bmN0aW9uIGhpZGVUaW1lbGluZXMoKSB7XG4gICQoJyNhdmFpbGFiaWxpdHlCdXR0b24nKS5zaG93KCk7XG4gICQoJyN0aW1lbGluZUhlYWRlckluRmluZGVyJykuaGlkZSgpO1xufVxuXG5mdW5jdGlvbiBpc0NvbmZsaWN0SWQoaWQpIHtcbiAgcmV0dXJuIGZpbmRlcnMucmVzb3VyY2VGaW5kZXIuaWRzV2l0aENvbmZsaWN0cy5pbmRleE9mKGlkKSAhPT0gLTE7XG59XG5cbi8vIExvY2tpbmcgYW5kIHVubG9ja2luZyB0aGUgdGFibGVcbmV4cG9ydCBmdW5jdGlvbiB1bmxvY2tUYWJsZShpZCkge1xuICAvLyB1bmxvY2tpbmdcbiAgJChgIyR7aWR9IHRyW3Blcm1pc3Npb25zXWApLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgY29uc3QgcGVybXMgPSBldmFsKCQodGhpcykuYXR0cigncGVybWlzc2lvbnMnKSk7XG4gICAgcGVybXMucHVzaCgndW5sb2NrZWQnKTtcbiAgICAkKHRoaXMpLmF0dHIoJ3Blcm1pc3Npb25zJywgdG9Tb3VyY2UocGVybXMpKTtcbiAgfSk7XG4gIC8vIGFkZGluZyB0aGUgc2luZ2xldG9uIGluLXBsYWNlIG1vdmVtZW50IC0tIHNob3VsZCBvbmx5IGhhcHBlbiBpbiByZXNvdXJjZSBmaW5kZXIhXG4gICQoJy5zaW5nbGV0b25bcGVybWlzc2lvbnMqPXdyaXRlXScpLm5vdCgnLmNvbnRhY3Qtc2luZ2xldG9uJykuZWFjaChmdW5jdGlvbigpIHtcbiAgICAkKHRoaXMpLmNoaWxkcmVuKCcuYW1vdW50JykuYXBwZW5kKHNvcnRpbmdBY3Rpb25zRm9ySWQoJCh0aGlzKS5hdHRyKCdvYmplY3RpZCcpKSk7XG4gIH0pO1xuICAvLyBhZGRpbmcgdGhlIGluLXBsYWNlIGVkaXRzXG4gIC8vIGFkZEluUGxhY2VFZGl0cygpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbG9ja1RhYmxlKGlkKSB7XG4gIC8vIGxvY2tpbmdcbiAgJChgIyR7aWR9IHRyW3Blcm1pc3Npb25zXWApLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgJCh0aGlzKS5hdHRyKCdwZXJtaXNzaW9ucycsIHRvU291cmNlKF8ud2l0aG91dChldmFsKCQodGhpcykuYXR0cigncGVybWlzc2lvbnMnKSksICd1bmxvY2tlZCcpKSk7XG4gIH0pO1xuICAvLyByZW1vdmluZyB0aGUgc2luZ2xldG9uIGluLXBsYWNlIG1vdmVtZW50XG4gICQoJy5zaW5nbGV0b24gLmFtb3VudCBhJykucmVtb3ZlKCk7XG4gIC8vIHJlbW92aW5nIHRoZSBpbnBsYWNlIGVkaXRzXG4gICQoYCMke2lkfSAubmFtZSBzcGFuYCkub2ZmKCdjbGljaycpO1xufVxuXG4vKiogKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuIEdlbmVyaWMgcm93IHNlbGVjdGlvbiBmdW5jdGlvbnNcbiAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiogKi9cbmV4cG9ydCBmdW5jdGlvbiBjbGlja1JvdyhldmVudCkge1xuICBpZiAoZXZlbnQub3JpZ2luYWxFdmVudCA9PSBudWxsKSByZXR1cm47IC8vIGpRdWVyeS1nZW5lcmF0ZWQgZXZlbnRzIGluIENocm9tZSB0aGF0IGFyZSB0cmlnZ2VyZWQgb24gdGhlIHNldC1vcGVuIGFuY2hvciBzdGlsbCBwcm9wYWdhdGUgdG8gdGhpcyBoYW5kbGVyLCB3aGljaCBpcyB3cm9uZyB3cm9uZyB3cm9uZy4uLlxuICBjb25zdCB0aGVSb3cgPSAkKGV2ZW50Lm9yaWdpbmFsRXZlbnQudGFyZ2V0KS5jbG9zZXN0KCd0cicpO1xuICBjb25zdCBtdWx0aVNlbGVjdCA9IHRoZVJvdy5oYXNDbGFzcygndWktc2VsZWN0ZWQnKSB8fCBoYXNNZXRhS2V5KGV2ZW50KTtcbiAgaWYgKCFtdWx0aVNlbGVjdCkge1xuICAgICQoJy51aS1zZWxlY3RlZCcpLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICB1bnNlbGVjdFJvdyhldmVudCwgdGhlUm93KTtcbiAgICB9KS5yZW1vdmVDbGFzcygndWktc2VsZWN0ZWQnKS5maW5kKCcuc2VsZWN0LWNvbCBbdHlwZT1jaGVja2JveF0nKS5hdHRyKCdjaGVja2VkJywgZmFsc2UpO1xuICB9XG4gIHRoZVJvdy5hZGRDbGFzcygndWktc2VsZWN0ZWQnKS5maW5kKCcuc2VsZWN0LWNvbCBbdHlwZT1jaGVja2JveF0nKS5hdHRyKCdjaGVja2VkJywgdHJ1ZSk7XG4gIHNlbGVjdFJvdyhldmVudCwgdGhlUm93KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNlbGVjdFJvdyhldmVudCwgcm93KSB7XG4gIC8vIFRoZSB0YXJnZXQgb2YgdGhlIGNsaWNrIGV2ZW50IChhbmQgdGhlIGVkaXQpIG11c3QgYmUgYSBzcGFuXG4gIGNvbnN0IHRoZVRhcmdldCA9ICQoZXZlbnQub3JpZ2luYWxFdmVudC50YXJnZXQpLmNsb3Nlc3QoJ3NwYW4nKTtcbiAgY29uc3QgdGhlQ29sdW1uS2V5ID0gJCh0aGVUYXJnZXQpLmNsb3Nlc3QoJ1tjb2x1bW5LZXldJykuYXR0cignY29sdW1uS2V5Jyk7IC8vIG5lZWQgdG8gc3RhcnQgZnJvbSBzcGFuIHRvIGFsbG93IG11bHRpLXZhbHVlIGNvbHVtbnNcbiAgY29uc3QgdGhlVGQgPSB0aGVUYXJnZXQuY2xvc2VzdCgndGQnKTtcbiAgY29uc3QgZmluZGVySWQgPSB0aGVUZC5jbG9zZXN0KCdkaXYnKS5wYXJlbnQoKS5hdHRyKCdpZCcpO1xuICAvLyBXZSBjYW4gd3JpdGUgaWYgdGhlIGNvbHVtbiBkb2VzIG5vdCBoYXZlIGEgJ25vZWRpdCcgY2xhc3MgYW5kIGlmIHRoZSByb3cgaXMgd3JpdGFibGUgYW5kIHJlYWR5IGZvciBlZGl0XG4gIGNvbnN0IGNhbldyaXRlID0gISh0aGVUZC5oYXNDbGFzcygnbm9lZGl0JykpICYmICh0aGVUZC5jbG9zZXN0KCd0cicpLmZpbHRlcignLmVkaXRyZWFkeScpLmZpbHRlcignW3Blcm1pc3Npb25zKj13cml0ZV0nKS5sZW5ndGggPT09IDEpICYmIChmaW5kZXJzW2ZpbmRlcklkXS5pbnBsYWNlZWRpdGNhbGxiYWNrc1t0aGVDb2x1bW5LZXldICE9PSB1bmRlZmluZWQpO1xuICAvLyBBbHNvIHZlcmlmeSB0aGUgd3JpdGVyIGxvY2tcbiAgY29uc3QgZmluZGVyTG9jayA9IHRoZVRkLmNsb3Nlc3QoJ2RpdicpLnBhcmVudCgpLmZpbmQoJy5sb2NrLmRldi1maW5kZXJsb2NrJyk7XG4gIGNvbnN0IGZpbmRlckhhc0xvY2sgPSBmaW5kZXJMb2NrLmxlbmd0aCA9PT0gMTtcbiAgY29uc3QgZmluZGVySXNMb2NrZWQgPSAhKGZpbmRlckxvY2suaGFzQ2xhc3MoJ3VubG9ja2VkJykpO1xuXG4gIC8vIElmIHRoZSBmaW5kZXIgaGFzIGEgbG9jayB0aGF0IGlzIGxvY2tlZCwgd2UgZG8gbm90aGluZ1xuICBpZiAoZmluZGVySGFzTG9jayAmJiBmaW5kZXJJc0xvY2tlZCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vIElmIHdlIGNhbiB3cml0ZSwgc2V0IHRoZSBlZGl0YWJsZS4gSWYgbm90LCB3ZSBwcmVwYXJlIHRoZSByb3cgZm9yIGVkaXRpbmcgKHRoaXMgZW5zdXJlcyBhIGRvdWJsZSBjbGljayBpcyBuZWVkZWQpLlxuICBpZiAoY2FuV3JpdGUpIHtcbiAgICB0aGVUYXJnZXQuZWRpdGFibGUoZmluZGVyc1tmaW5kZXJJZF0uaW5wbGFjZWVkaXRjYWxsYmFja3NbdGhlQ29sdW1uS2V5XSwgZmluZGVyc1tmaW5kZXJJZF0uaW5wbGFjZWVkaXRjb25maWdzW3RoZUNvbHVtbktleV0pLmVkaXRhYmxlKCdlbmFibGUnKTtcbiAgfSBlbHNlIHtcbiAgICB0aGVUZC5jbG9zZXN0KCd0cicpLmFkZENsYXNzKCdlZGl0cmVhZHknKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gdW5zZWxlY3RSb3coZXZlbnQsIHJvdykge1xuICByb3cucmVtb3ZlQ2xhc3MoJ2VkaXRyZWFkeScpLmVkaXRhYmxlKCdkaXNhYmxlJyk7XG59XG5cbi8vIEZ1bmN0aW9uIHRvIHRvZ2dsZSB0aGUgYmFza2V0XG5leHBvcnQgZnVuY3Rpb24gdG9nZ2xlQmFza2V0KCkge1xuICAkKCcjZmluZGVyYmFza2V0Jykuc2xpZGVUb2dnbGUoNTApLnJlbW92ZUNsYXNzKCdhdXRvbWF0aWNPcGVuJyk7XG59XG5cbi8vIEFkZHMgYSB0aWNrIGltYWdlIHRvIHRoZSByZXNvdXJjZXMgaW4gdGhlIHRhYmxlIHdoaWNoIGFyZSBhbHJlYWR5IGluIHRoZSBiYXNrZXRcbmV4cG9ydCBmdW5jdGlvbiB0aWNrUmVzb3VyY2VzSW5CYXNrZXQoKSB7XG4gIGNvbnN0IHJlc291cmNlSWRzSW5CYXNrZXQgPSAkKCcjZmluZGVyYmFza2V0IGxpJykubWFwKGZ1bmN0aW9uKGksIGVsKSB7XG4gICAgcmV0dXJuICQoZWwpLmF0dHIoJ2luQmFza2V0Jyk7XG4gIH0pO1xuICBjb25zdCB0aWNrZWRSZXNvdXJjZUlkcyA9ICQoJyNmaW5kZXJUYWJsZSAubmFtZS5hZGRlZCcpLm1hcChmdW5jdGlvbihpLCBlbCkge1xuICAgIHJldHVybiAkKGVsKS5wYXJlbnQoKS5hdHRyKCdvYmplY3RpZCcpO1xuICB9KTtcblxuICAvLyBSZW1vdmUgdGhlIHRpY2tzIGZvciByZXNvdXJjZXMgdGhhdCBhcmUgbm90IGluIHRoZSBiYXNrZXRcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aWNrZWRSZXNvdXJjZUlkcy5sZW5ndGg7IGkrKykge1xuICAgIGlmIChqUXVlcnkuaW5BcnJheSh0aWNrZWRSZXNvdXJjZUlkc1tpXSwgcmVzb3VyY2VJZHNJbkJhc2tldCkgPT09IC0xKSB7XG4gICAgICAkKCcjZmluZGVyVGFibGUgdHInKS5maWx0ZXIoYFtvYmplY3RpZD0ke3RpY2tlZFJlc291cmNlSWRzW2ldfV1gKS5jaGlsZHJlbignLm5hbWUnKS5yZW1vdmVDbGFzcygnYWRkZWQnKTtcbiAgICB9XG4gIH1cblxuICAvLyBBZGQgYSB0aWNrIGZvciBhbGwgcmVzb3VyY2VzIGluIHRoZSBiYXNrZXRcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCByZXNvdXJjZUlkc0luQmFza2V0Lmxlbmd0aDsgaSsrKSB7XG4gICAgJCgnI2ZpbmRlclRhYmxlIHRyJykuZmlsdGVyKGBbb2JqZWN0aWQ9JHtyZXNvdXJjZUlkc0luQmFza2V0W2ldfV1gKS5jaGlsZHJlbignLm5hbWUnKS5hZGRDbGFzcygnYWRkZWQnKTtcbiAgfVxufVxuXG4vLyBmdW5jdGlvbiB0byBlbnN1cmUgdGhhdCBzcGVjaWFsIGNoYXJzIGFyZSBjb3JyZWN0bHkgZW5jb2RlZCAob24geG1sIHBhZ2UpXG5mdW5jdGlvbiBlbmNvZGVTdHJpbmcoYVN0cmluZykge1xuICByZXR1cm4gJCgnPHNwYW4vPicpLnRleHQoYVN0cmluZykuaHRtbCgpO1xufVxuXG4vLyBzb21lIGZpeGVkIGl0ZW1zIGZvciB0aGUgZmluZGVycyBkYXRhXG5maW5kZXJzLnJlc291cmNlRmluZGVyLmRpc3BsYXlUYWJsZSA9IEFic3RyYWN0UmVzb3VyY2UuZGlzcGxheVRhYmxlO1xuZmluZGVycy5yZXNvdXJjZUZpbmRlci5kaXNwbGF5TWVzc2FnZSA9IEFic3RyYWN0UmVzb3VyY2UuZGlzcGxheU1lc3NhZ2U7XG5maW5kZXJzLnJlc291cmNlRmluZGVyLmRpc3BsYXlJbml0aWFsVGFibGUgPSBBYnN0cmFjdFJlc291cmNlLmRpc3BsYXlJbml0aWFsVGFibGU7XG5maW5kZXJzLnJlc291cmNlRmluZGVyLmVudGl0aWVzID0ge307XG5maW5kZXJzLnJlc291cmNlRmluZGVyLnF1ZXJ5T25TZXJ2ZXIgPSBmYWxzZTtcbmZpbmRlcnMucmVzb3VyY2VGaW5kZXIuc2V0c1RvT3BlbkFmdGVyU2VhcmNoID0gW107XG5maW5kZXJzLnJlc291cmNlRmluZGVyLnNlYXJjaEtleXMgPSBbJ25hbWUnLCAndHlwZScsICdyb2xlcycsICdncm91cCcsICdzZXJpYWwnLCAncHJvZHVjdGNvZGUnLCAnZGF0ZSddO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./finders/resourcefinder.js\n");

/***/ })

},
/******/ function(__webpack_require__) { // webpackRuntimeModules
/******/ var __webpack_exec__ = function(moduleId) { return __webpack_require__(__webpack_require__.s = moduleId); }
/******/ __webpack_require__.O(0, ["vendor"], function() { return __webpack_exec__("./finders/resourcefinder.js"); });
/******/ var __webpack_exports__ = __webpack_require__.O();
/******/ ReactComponents_resourceandtaskfinder = __webpack_exports__;
/******/ }
]);