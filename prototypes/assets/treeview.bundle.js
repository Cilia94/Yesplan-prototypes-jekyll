/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
var ReactComponents_treeview;
(self["webpackChunkReactComponents_"] = self["webpackChunkReactComponents_"] || []).push([["treeview"],{

/***/ "./CommonScripts/sharedscripts/sharedscripts-contextmenu.js":
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"SharedscriptsContextmenu\": function() { return /* binding */ SharedscriptsContextmenu; }\n/* harmony export */ });\n/* harmony import */ var _sentry_browser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./node_modules/@sentry/hub/esm/exports.js\");\n/* harmony import */ var _sharedscripts_sentry__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./CommonScripts/sharedscripts/sharedscripts-sentry.js\");\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n/* eslint-disable camelcase, func-names */\n// Client-side support for dynamic context menus.\n//\n// The trigger to open them is something which is left to the client to set up.\n// All the client needs to do is tell this module the page coordinates of where\n// the menu should appear. E.g.:\n//\n//   $('#maintable').on('contextmenu', 'td', function(e) {\n//       menu.show(e.pageX, e.pageY)\n//   })\n//\n// The menu will be created with its top-left corner at exactly that position,\n// unless it would not fit within the bounds of the viewport. If that is the\n// case it will get shifted left and up as much as is needed to make it fit.\n//\n//\n// Creating the menu is done by calling $context.create(...) and passing it a\n// javascript array which defines the menu structure. E.g.:\n//\n//   menu = $context.create([\n//     item_1,\n//     item_2,\n//     ...\n//     item_n,\n//   ])\n//\n// The menus get attached to the DOM, so it is best to only create them once.\n// When a menu closes they do not get cleaned up. Cleanup should be done\n// explicitly, but there is no supporting function yet to do so. (TODO!)\n//\n//\n// Each menu item is a javascript object which defines some basic data. At the\n// heart of everything is its type, which can be anything supported by the\n// 'formatters' list you'll find further down in the code. At the time of\n// writing these are: item, separator, submenu, input and checkbox. The type gets\n// specified via a 'a' or 'an' field. E.g.:\n//\n//   item_1 = { an: 'item', ... }\n//   item_2 = { a: 'separator', ... }\n//   item_3 = { a: 'submenu', ... }\n//\n// If no type is specified then it is assumed to be 'item'. This should be the\n// common case. So 'item_1' could have been reduced to:\n//\n//   item_1 = { ... }\n//\n// All menu items can have an optional 'id' field. This allows referring to,\n// and manipulating, a specific menu item after the menu has been built. The\n// added effect is that a data attribute 'data-menu-id' is added to the DOM\n// element, which helps grabbing specific menu items in automated tests.\n//\n// All other fields which are required depend on the type of the menu item. For\n// the default type 'item' these are:\n//   - text: which sets the menu item's label.\n//   - fn: which defines a callback function to be triggered when the menu item\n//     gets activated. If you don't specify a callback and a menu item gets\n//     activated this library will fire a 'click-menu-item' event, which can be\n//     handled by JQuery event handlers. E.g.:\n//\n//     $('body').on('click-menu-item', function(e, menu_item_definition) {\n//       ...\n//     })\n//\n// Item visibility and enablement:\n// All menu items have an optional 'disableif' and 'hideif' field. They accept\n// a function parameter and can be used to respectively disable or hide the menu item.\n//\n// Submenus also have a label which you can define via the 'text' field. In\n// addition it accepts a 'with' field which holds the definition for the\n// submenu. This again conforms to the definition of any menu (i.e. a list of\n// menu items). E.g.:\n//\n//   submenu = { a: 'submenu', text: 'Submenu', with: [\n//     item_1,\n//     item_2,\n//     ...\n//     item_n\n//   ]}\n//\n// Aside from that submenus can also be created dynamically. To do that you\n// should not pass an array as the value of the 'with' field but pass a\n// function instead. This function will get triggered when the submenu should\n// become visible, and it should return the definition of the submenu as usual.\n// So the above example could also have been written as:\n//\n//   submenu = { a: 'submenu', text: 'Submenu', with: function() {\n//     return [\n//       item_1,\n//       item_2,\n//       ...\n//       item_n\n//     ]\n//   }}\n//\n// Here is a more complete example of a menu definition, which also shows\n// fields for other menu item types:\n//\n//   menu = $context.create([\n//     { text: 'New Event', fn: function() { console.log('NEW EVENT')} },\n//     { text: 'Set as Unavailable', fn: logit },\n//\n//     { a: 'separator' },\n//\n//     { a: 'submenu', text: 'Assign Status', with: [\n//       { text: 'No Status' },\n//           { text: 'Option Request' },\n//           { text: 'Option' },\n//           { text: 'Confirmed Option' },\n//           { text: 'Planned' },\n//           { text: 'Locked' },\n//           { text: 'Cancelled' }\n//      ]},\n//      { a: 'submenu', text: 'Assign Role', with: dynamic_items_fn },\n//\n//      { a: 'separator' },\n//\n//      { text: 'Cut', disableif=function(){ return user can_delete }},\n//      { text: 'Copy' },\n//      { text: 'Paste' },\n//\n//      { a: 'separator' },\n//\n//      { a: 'submenu', text: 'Add to Group', with: [ { an: 'search', text: 'Search contact...', source: source_fn, select: select_fn } ],\n//\n//      { an: 'input' },\n//      { a: 'checkbox', text: 'Check ?' },\n//   ])\n//\n//\n// In addition, the opening and closing of menus and submenus fires events\n// which can be handles by JQuery event handlers. E.g.:\n//\n//   $('body').on('closed-menu', function(e) {\n//      ...\n//   })\n//\n// The events which can be watched for are:\n//   - opening-menu\n//   - closed-menu\n//   - opening-sub-menu\n//   - closed-sub-menu\n\n\n\nvar SharedscriptsContextmenu = /*#__PURE__*/function () {\n  function SharedscriptsContextmenu(items, options, root_menu) {\n    _classCallCheck(this, SharedscriptsContextmenu);\n    this.menu = null;\n    this.root_menu = root_menu || this;\n    this.options = options || {};\n    this.identified = {};\n    this.active_submenu_item = null;\n    this.active_submenu = null;\n    this.is_shown = false;\n    this.x = null;\n    this.y = null;\n    this.isMac = navigator.platform.match(/mac/i) !== null && navigator.platform.match(/mac/i).length > 0;\n    this.clones = [];\n    this.cached_submenu_items = {};\n    this.timer = null;\n    this.setup_container();\n    this.setup_items(items);\n    this.setup_interactions();\n  }\n  _createClass(SharedscriptsContextmenu, [{\n    key: \"setup_container\",\n    value: function setup_container() {\n      this.menu = $('<ul>');\n      if (this.root_menu === this) {\n        this.menu.addClass('menu');\n      } else {\n        this.menu.addClass('submenu');\n        if (this.options.subMenuCssClasses) {\n          this.options.subMenuCssClasses.forEach(function (cssClass) {\n            this.menu.addClass(cssClass);\n          }.bind(this));\n        }\n      }\n      if (this.options.containerCssClasses) {\n        this.menu.removeClass('menu');\n        this.options.containerCssClasses.forEach(function (cssClass) {\n          this.menu.addClass(cssClass);\n        }.bind(this));\n      }\n      if (this.options.id) this.menu.attr('id', this.options.id);\n      if (this.options.closeOnMouseOut) {\n        var self = this;\n        this.menu.on('mouseleave', function () {\n          this.timer = setTimeout(function () {\n            self.close();\n            if (self.root_menu === self) {\n              self.options.onCloseMouseOut && self.options.onCloseMouseOut();\n            }\n          }, self.options.closeAfter || 500);\n        });\n        /* If a mouseover happens while the timer on mouseleave is still counting,\n           cancel the close action.  */\n        this.menu.on('mouseover', function () {\n          if (this.timer) {\n            clearTimeout(this.timer);\n            this.timer = null;\n          }\n        });\n      }\n    }\n  }, {\n    key: \"setup_items\",\n    value: function setup_items(items) {\n      for (var i = 0; i < items.length; i++) {\n        var item = items[i];\n        var element = $('<li>').addClass('dev-menu-item');\n        if (item.class) element.addClass(item.class);\n        element.data('dev-menu-item', item);\n        format(item, element, this);\n        if (item.hideif !== undefined) element.data('hideif', item.hideif);\n        if (item.disableif !== undefined) {\n          element.data('disableif', item.disableif);\n        }\n        if (item.showif !== undefined) {\n          element.data('showif', item.showif);\n        }\n        if (typeof item.text === 'function') element.data('text_fn', item.text);\n        if (item.htmlAttributes) {\n          element.data('htmlAttributes', item.htmlAttributes);\n        }\n        if (item.id) {\n          element.attr('data-menu-id', item.id);\n          this.identified[item.id] = {\n            item: item,\n            element: element\n          };\n        }\n        if (item.focus) element.attr('data-focus', true);\n        this.menu.append(element);\n      }\n    }\n  }, {\n    key: \"setup_interactions\",\n    value: function setup_interactions() {\n      var context = this;\n\n      // Prevent clicks from seeping through the context menu, which might\n      // otherwise close the menu prematurely.\n      // eslint-disable-next-line func-names\n      this.menu.on('click', function (e) {\n        e.stopPropagation();\n      });\n\n      // Same for input fields shown in the menu. Interacting with them should\n      // not close the menu.\n      // eslint-disable-next-line func-names\n      this.menu.on('click', 'input', function (e) {\n        e.stopPropagation();\n      });\n\n      // Clicking on a menu item triggers an action event.\n      this.menu.on('click', '.dev-menu-item:not(.separator):not(.disabled)',\n      // eslint-disable-next-line func-names\n      function (e) {\n        e.stopPropagation();\n        var definition = $(this).data('dev-menu-item');\n        logAction(\"Clicked on \".concat(definition.text));\n        if (definition.fn) {\n          definition.fn(e);\n          if ((definition.a || definition.an) !== 'submenu') {\n            context.root_menu.close();\n          }\n        } else {\n          context.menu.trigger('click-menu-item', definition);\n        }\n      });\n\n      // Submenu interaction.\n      // eslint-disable-next-line func-names\n      this.menu.on('mouseover', '.dev-menu-item', function (e) {\n        if ($(this).hasClass('disabled')) return;\n        if (context.active_submenu_item) context.active_submenu_item.removeClass('active');\n        if ($(this).data('dev-menu-item').a !== 'submenu' && $(this).data('dev-menu-item').an !== 'submenu') {\n          context.active_submenu_item = null;\n        } else {\n          context.active_submenu_item = $(this);\n          context.active_submenu_item.addClass('active');\n        }\n        toggle_submenu_as_needed();\n      });\n\n      // Show/Hide submenus as needed.\n      // This gets debounced to prevent visual artefacts.\n      var toggle_submenu_as_needed = debounce(function () {\n        if (context.active_submenu && context.active_submenu.is_shown && context.active_submenu_item && context.active_submenu === context.active_submenu_item.data('submenu')) {\n          return;\n        }\n        if (context.active_submenu) context.active_submenu.close();\n        if (context.active_submenu_item) {\n          context.active_submenu = context.active_submenu_item.data('submenu');\n          var definition = context.active_submenu_item.data('dev-menu-item');\n          var items = definition.with;\n          var createSubMenu = function createSubMenu(items, options, context) {\n            options.id = 'submenu';\n            options.for = definition.text;\n            context.active_submenu = new SharedscriptsContextmenu(items, options, context);\n            context.active_submenu_item.data('submenu', context.active_submenu);\n          };\n          var contextHasSubmenuForDefinition = function contextHasSubmenuForDefinition(definition) {\n            return context.active_submenu && context.active_submenu.options.for === definition.text;\n          };\n          logAction(\"Opening submenu for \".concat(definition.text));\n\n          // Async function\n          if (typeof items === 'function') {\n            var cached_items = context.root_menu.cached_submenu_items[definition.text];\n            if (definition.rebuildSubmenu || !cached_items) {\n              items(true, function (res) {\n                /* If the active_submenu_item is no longer set, the user has selected another menu item.\n                   Discard the results of the async call and do not show the submenu */\n                if (context.active_submenu_item) {\n                  createSubMenu(res, context.options, context);\n                  context.active_submenu.show_for(context.active_submenu_item);\n                }\n                context.root_menu.cached_submenu_items[definition.text] = res;\n              });\n            } else {\n              createSubMenu(cached_items, context.options, context);\n              context.active_submenu.show_for(context.active_submenu_item);\n            }\n          } else {\n            /* Recreate the menu if explicitly configured or if the current submenu is not set or for another definition */\n            if (!contextHasSubmenuForDefinition(definition) || definition.rebuildSubmenu) {\n              createSubMenu(items, context.options, context);\n            }\n            context.active_submenu.show_for(context.active_submenu_item);\n          }\n        }\n      }, 250);\n\n      // Clicking outside the context menu must hide it.\n      $('body').on('click', function (e) {\n        if (e.ctrlKey && context.isMac) return;\n        context.close();\n      });\n    }\n  }, {\n    key: \"show\",\n    value:\n    // Show the menu as near as possible to the requested coordinates, but\n    // making sure that the entire menu stays visible...\n    function show(x, y) {\n      var max_x = $(document).width();\n      var max_y = $(document).height();\n      var width = this.menu.width();\n      var height = this.menu.height();\n      x = Math.max(0, Math.min(x, max_x - width));\n      y = Math.max(0, Math.min(y, max_y - height));\n      this.show_at(x, y);\n    }\n  }, {\n    key: \"show_for\",\n    value: function show_for(menu_item) {\n      if (this.is_shown) return;\n      this.prepare_show();\n      this.menu.hide();\n      $(menu_item).append(this.menu);\n      this.menu.css('visibility', 'visible').hide().fadeIn(100);\n      if (this.menu.width() + menu_item.offset().left + menu_item.width() > document.documentElement.clientWidth + $(window).scrollLeft()) {\n        var left = this.menu.width() > menu_item.width() ? menu_item.width() - this.menu.width() : 5;\n        this.menu.css('left', \"\".concat(left, \"px\")).css('position', 'absolute');\n      }\n      this.is_shown = true;\n      this.after_show();\n    }\n  }, {\n    key: \"show_at\",\n    value: function show_at(x, y) {\n      if (this.is_shown && this.x === x && this.y === y) return;\n\n      // Only append the root menu to the body, submenus are appended to their menu-item element\n      if (this.root_menu === this) $('body').append(this.menu);\n      this.prepare_show();\n      var top = y;\n      if ($('body').height() + $(document).scrollTop() - y < this.menu.height()) {\n        top -= this.menu.height() - ($('body').height() + $(document).scrollTop() - y) + 5;\n      }\n      this.menu.css('top', \"\".concat(top, \"px\")).css('left', \"\".concat(x, \"px\")).css('visibility', 'visible').css('z-index', 999999).hide().fadeIn(100);\n      this.is_shown = true;\n      this.after_show();\n    }\n  }, {\n    key: \"prepare_show\",\n    value: function prepare_show() {\n      if (this.active_submenu_item) {\n        this.active_submenu_item.removeClass('active');\n        this.active_submenu_item = null;\n      }\n      if (this.active_submenu) {\n        this.active_submenu.close();\n        this.active_submenu = null;\n      }\n      this.menu.find('li').each(function () {\n        if ($(this).data('hideif') && $(this).data('hideif')()) {\n          $(this).hide();\n        } else {\n          $(this).show();\n        }\n      }).each(function () {\n        if ($(this).data('disableif')) {\n          var disableif = $(this).data('disableif');\n          if (typeof disableif === 'boolean' && disableif || $(this).data('disableif')()) {\n            $(this).addClass('disabled');\n            $(this).find('> a').addClass('disabled');\n          } else {\n            $(this).removeClass('disabled');\n            $(this).find('> a').removeClass('disabled');\n          }\n        }\n      }).each(function () {\n        if ($(this).data('showif')) {\n          if (!$(this).data('showif')()) {\n            $(this).css('display', 'none');\n          } else {\n            $(this).css('display', 'block');\n          }\n        }\n      }).each(function () {\n        if ($(this).data('htmlAttributes')) {\n          var attributes = $(this).data('htmlAttributes');\n          var element = $(this);\n          Object.keys(attributes).forEach(function (key) {\n            $(element).data(key, attributes[key]);\n          });\n        }\n      }).each(function () {\n        if ($(this).data('text_fn')) {\n          $(this).find('a').html($(this).data('text_fn')());\n        }\n      });\n      if (this.root_menu === this) {\n        this.menu.trigger('opening-menu');\n      } else {\n        $(this.menu).trigger('opening-sub-menu');\n      }\n    }\n  }, {\n    key: \"after_show\",\n    value: function after_show() {\n      this.menu.find('li').each(function () {\n        if ($(this).data('focus')) {\n          $(this).find('input').focus();\n        }\n      });\n    }\n  }, {\n    key: \"close\",\n    value: function close() {\n      if (!this.is_shown) return;\n      if (this.active_submenu_item) {\n        this.active_submenu_item.removeClass('active');\n        if (this.active_submenu_item.data('submenu') !== undefined) {\n          this.active_submenu_item.data('submenu').close();\n        }\n      }\n\n      /* Add the clone element back on the page */\n      this.clones.forEach(function (cloneElement) {\n        cloneElement.appendTo(cloneElement.data('parent'));\n      });\n      /* Reset cached submenu items */\n      this.cached_submenu_items = {};\n      this.is_shown = false;\n      this.menu.css('visibility', 'hidden').fadeOut(100);\n      if (this.root_menu === this) {\n        this.menu.trigger('closed-menu');\n      } else {\n        this.menu.trigger('closed-sub-menu');\n      }\n      this.menu.detach();\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      this.menu.remove();\n    }\n  }, {\n    key: \"enable\",\n    value: function enable(id) {\n      if (this.identified[id]) {\n        this.identified[id].element.removeClass('disabled');\n        this.identified[id].element.find('> a').removeClass('disabled');\n        if (typeof this.identified[id].element.data('disableif') === 'boolean') {\n          this.identified[id].element.data('disableif', false);\n        }\n      }\n    }\n  }, {\n    key: \"enable_all\",\n    value: function enable_all() {\n      var ids = Object.keys(this.identified);\n      for (var i = 0; i < ids.length; i++) {\n        this.enable(ids[i]);\n      }\n    }\n  }, {\n    key: \"disable\",\n    value: function disable(id) {\n      if (this.identified[id]) {\n        this.identified[id].element.addClass('disabled');\n        if (typeof this.identified[id].element.data('disableif') === 'boolean') {\n          this.identified[id].element.data('disableif', true);\n        }\n      }\n    }\n  }, {\n    key: \"disable_all\",\n    value: function disable_all() {\n      var ids = Object.keys(this.identified);\n      for (var i = 0; i < ids.length; i++) {\n        this.disable(ids[i]);\n      }\n    }\n  }, {\n    key: \"set_text\",\n    value: function set_text(id, text) {\n      var idd = this.identified[id];\n      if (idd.item.text) {\n        idd.item.text = text;\n        idd.element.find('a.menu-action').text(text);\n      }\n    }\n  }, {\n    key: \"get_htmlattribute\",\n    value: function get_htmlattribute(id, key) {\n      if (this.identified[id]) {\n        if (this.identified[id].item.htmlAttributes) {\n          return this.identified[id].item.htmlAttributes[key];\n        }\n      }\n      return null;\n    }\n  }, {\n    key: \"set_htmlattribute\",\n    value: function set_htmlattribute(id, key, value) {\n      var idd = this.identified[id];\n      if (idd) {\n        var htmlAttributes = idd.item.htmlAttributes || {};\n        htmlAttributes[key] = value;\n        idd.item.htmlAttributes = htmlAttributes;\n        idd.element.data(key, value);\n      }\n    }\n  }]);\n  return SharedscriptsContextmenu;\n}();\n\n// --------------------------------------------------------------------------\n\nvar formatters = {\n  separator: function separator(definition, element, menucontext) {\n    element.addClass('separator');\n  },\n  item: function item(definition, element, menucontext) {\n    var text = typeof definition.text === 'function' ? definition.text : definition.text.replace(/\\s/g, '&nbsp;'); // Preserve whitespaces in the text\n    if (definition.cssClass) {\n      element.addClass(definition.cssClass);\n    }\n    $('<a class=\"menu-action\" href=\"javascript:{}\">').appendTo(element).html(text);\n    if (definition.deleteAction) {\n      $('<a class=\"destroyer\" href=\"javascript:{}\">').on('click', function (e) {\n        e.stopPropagation();\n        definition.deleteAction(e);\n        return false;\n      }).appendTo(element).html('delete');\n    }\n  },\n  submenu: function submenu(definition, element, menucontext) {\n    $('<a href=\"javascript:{}\">').html(definition.text).appendTo(element.addClass('branch'));\n  },\n  input: function input(definition, element, menucontext) {\n    var input = $('<input>').attr('type', 'text').attr('placeholder', definition.text);\n    if (definition.focusOnOpen) {\n      menucontext.menu.on('opening-sub-menu', function () {\n        setTimeout(function () {\n          input.focus();\n        }, 150);\n      });\n    }\n    if (definition.onEnter) {\n      input.on('keypress', function (e) {\n        if (e.key === 'Enter') {\n          var inputValue = input.val();\n          definition.onEnter(inputValue);\n          input.val('');\n        }\n      });\n    }\n    element.append(input);\n  },\n  search: function search(definition, element, menucontext) {\n    var updateInputMarginFunction = function updateInputMarginFunction() {\n      setTimeout(function () {\n        var width = $('.input-filter', element).outerWidth() + 10;\n        $(searchfield).css('padding-right', \"\".concat(width.toString(), \"px\"));\n      }, 0);\n    };\n\n    // JQ-UI Autocomplete automatically appends the suggestion menu to a parent marked with .ui-front\n    var container = $('<div>').addClass('ui-front menu__autocomplete-result');\n    var searchfield = $('<input>').attr('type', 'text').attr('placeholder', definition.text);\n    if (definition.onNew) {\n      searchfield.on('keyup', function (event) {\n        if (event.key === 'Enter') {\n          event.preventDefault();\n          definition.onNew(searchfield.val());\n        }\n      });\n    }\n    container.append(searchfield);\n    if (definition.withFilter) {\n      var filter = $('<span>').addClass('submenu-filter input-filter');\n      filter.attr('title', definition.filterTooltipFunction());\n      filter.html(definition.filterLabelFunction());\n      filter.on('click', function (clickEvent) {\n        clickEvent.preventDefault();\n        definition.filterToggle(function () {\n          filter.attr('title', definition.filterTooltipFunction());\n          filter.html(definition.filterLabelFunction());\n          updateInputMarginFunction();\n        });\n      });\n      container.append(filter);\n    }\n    menucontext.menu.on('opening-sub-menu', function () {\n      searchfield.get(0).value = '';\n      updateInputMarginFunction();\n      setTimeout(function () {\n        searchfield.focus();\n      }, 150);\n    });\n    element.append(container);\n\n    // TODO: move autocomplete implementation to separate module for sharing\n    searchfield.npPresetAutocomplete({\n      autoFocus: true,\n      minLength: definition.minLength,\n      messages: {\n        noResults: function noResults() {},\n        results: function results() {}\n      },\n      source: definition.source,\n      create: function create() {\n        if (definition.withPresets) {\n          searchfield.on('focus', function () {\n            searchfield.npPresetAutocomplete('search', '');\n          });\n        }\n      },\n      select: function select(event, ui) {\n        event.stopPropagation();\n        event.preventDefault();\n        definition.select(event, ui);\n        menucontext.root_menu.close();\n      },\n      open: function open(event, ui) {\n        $('.ui-autocomplete.ui-menu').css('left', 0).css('top', 0).css('width', 'auto');\n      }\n    });\n  },\n  searchresults: function searchresults(definition, element, menucontext) {\n    element.append($('<div>').attr('id', definition.id));\n  },\n  checkbox: function checkbox(definition, element, menucontext) {\n    var checkbox = $('<input>').attr('type', 'checkbox');\n    element.append(checkbox).append(definition.text);\n  },\n  hoverable: function hoverable(definition, element, menucontext) {\n    var text = typeof definition.text === 'function' ? definition.text : definition.text.replace(/\\s/g, '&nbsp;'); // Preserve whitespaces in the text\n    $('<a class=\"menu-action\" href=\"javascript:{}\">').appendTo(element).on('mouseover', definition.mouseover || function (e) {}).on('mouseout', definition.mouseout || function (e) {}).html(text);\n  },\n  clone: function clone(definition, element, menucontext) {\n    var original = $(\"#\".concat(definition.cloneId));\n    var clone = original.clone(true);\n    /* Remove the original element, keeping it in the clones array.\n       Necessary such that no two elements with the same id are on the page\n       and callback functions operate on the correct element */\n    menucontext.clones.push(original);\n    original.data('parent', original.parent());\n    original.detach();\n    clone.show();\n    clone.appendTo(element);\n  }\n};\nfunction format(definition, element, menucontext) {\n  var type = definition.a || definition.an || 'item';\n  formatters[type](definition, element, menucontext);\n}\n\n// --------------------------------------------------------------------------\n\n// http://davidwalsh.name/javascript-debounce-function\n// Returns a function, that, as long as it continues to be invoked, will not\n// be triggered. The function will be called after it stops being called for\n// N milliseconds. If `immediate` is passed, trigger the function on the\n// leading edge, instead of the trailing.\nfunction debounce(func, wait, immediate) {\n  var timeout;\n  return function () {\n    var context = this,\n      args = arguments;\n    var later = function later() {\n      timeout = null;\n      if (!immediate) func.apply(context, args);\n    };\n    var callNow = immediate && !timeout;\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n    if (callNow) func.apply(context, args);\n  };\n}\n\n// Error logging\nfunction logAction(message) {\n  if ((0,_sharedscripts_sentry__WEBPACK_IMPORTED_MODULE_0__.isSentryInitialized)()) {\n    _sentry_browser__WEBPACK_IMPORTED_MODULE_1__.addBreadcrumb({\n      category: 'contextmenu',\n      message: message,\n      level: 'info'\n    });\n  }\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9Db21tb25TY3JpcHRzL3NoYXJlZHNjcmlwdHMvc2hhcmVkc2NyaXB0cy1jb250ZXh0bWVudS5qcy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBTUE7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBUUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7O0FBR0E7O0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBRUE7QUFDQTtBQUdBO0FBRUE7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBT0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9SZWFjdENvbXBvbmVudHNfLy4vQ29tbW9uU2NyaXB0cy9zaGFyZWRzY3JpcHRzL3NoYXJlZHNjcmlwdHMtY29udGV4dG1lbnUuanM/MWM1NCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiBlc2xpbnQtZGlzYWJsZSBjYW1lbGNhc2UsIGZ1bmMtbmFtZXMgKi9cbi8vIENsaWVudC1zaWRlIHN1cHBvcnQgZm9yIGR5bmFtaWMgY29udGV4dCBtZW51cy5cbi8vXG4vLyBUaGUgdHJpZ2dlciB0byBvcGVuIHRoZW0gaXMgc29tZXRoaW5nIHdoaWNoIGlzIGxlZnQgdG8gdGhlIGNsaWVudCB0byBzZXQgdXAuXG4vLyBBbGwgdGhlIGNsaWVudCBuZWVkcyB0byBkbyBpcyB0ZWxsIHRoaXMgbW9kdWxlIHRoZSBwYWdlIGNvb3JkaW5hdGVzIG9mIHdoZXJlXG4vLyB0aGUgbWVudSBzaG91bGQgYXBwZWFyLiBFLmcuOlxuLy9cbi8vICAgJCgnI21haW50YWJsZScpLm9uKCdjb250ZXh0bWVudScsICd0ZCcsIGZ1bmN0aW9uKGUpIHtcbi8vICAgICAgIG1lbnUuc2hvdyhlLnBhZ2VYLCBlLnBhZ2VZKVxuLy8gICB9KVxuLy9cbi8vIFRoZSBtZW51IHdpbGwgYmUgY3JlYXRlZCB3aXRoIGl0cyB0b3AtbGVmdCBjb3JuZXIgYXQgZXhhY3RseSB0aGF0IHBvc2l0aW9uLFxuLy8gdW5sZXNzIGl0IHdvdWxkIG5vdCBmaXQgd2l0aGluIHRoZSBib3VuZHMgb2YgdGhlIHZpZXdwb3J0LiBJZiB0aGF0IGlzIHRoZVxuLy8gY2FzZSBpdCB3aWxsIGdldCBzaGlmdGVkIGxlZnQgYW5kIHVwIGFzIG11Y2ggYXMgaXMgbmVlZGVkIHRvIG1ha2UgaXQgZml0LlxuLy9cbi8vXG4vLyBDcmVhdGluZyB0aGUgbWVudSBpcyBkb25lIGJ5IGNhbGxpbmcgJGNvbnRleHQuY3JlYXRlKC4uLikgYW5kIHBhc3NpbmcgaXQgYVxuLy8gamF2YXNjcmlwdCBhcnJheSB3aGljaCBkZWZpbmVzIHRoZSBtZW51IHN0cnVjdHVyZS4gRS5nLjpcbi8vXG4vLyAgIG1lbnUgPSAkY29udGV4dC5jcmVhdGUoW1xuLy8gICAgIGl0ZW1fMSxcbi8vICAgICBpdGVtXzIsXG4vLyAgICAgLi4uXG4vLyAgICAgaXRlbV9uLFxuLy8gICBdKVxuLy9cbi8vIFRoZSBtZW51cyBnZXQgYXR0YWNoZWQgdG8gdGhlIERPTSwgc28gaXQgaXMgYmVzdCB0byBvbmx5IGNyZWF0ZSB0aGVtIG9uY2UuXG4vLyBXaGVuIGEgbWVudSBjbG9zZXMgdGhleSBkbyBub3QgZ2V0IGNsZWFuZWQgdXAuIENsZWFudXAgc2hvdWxkIGJlIGRvbmVcbi8vIGV4cGxpY2l0bHksIGJ1dCB0aGVyZSBpcyBubyBzdXBwb3J0aW5nIGZ1bmN0aW9uIHlldCB0byBkbyBzby4gKFRPRE8hKVxuLy9cbi8vXG4vLyBFYWNoIG1lbnUgaXRlbSBpcyBhIGphdmFzY3JpcHQgb2JqZWN0IHdoaWNoIGRlZmluZXMgc29tZSBiYXNpYyBkYXRhLiBBdCB0aGVcbi8vIGhlYXJ0IG9mIGV2ZXJ5dGhpbmcgaXMgaXRzIHR5cGUsIHdoaWNoIGNhbiBiZSBhbnl0aGluZyBzdXBwb3J0ZWQgYnkgdGhlXG4vLyAnZm9ybWF0dGVycycgbGlzdCB5b3UnbGwgZmluZCBmdXJ0aGVyIGRvd24gaW4gdGhlIGNvZGUuIEF0IHRoZSB0aW1lIG9mXG4vLyB3cml0aW5nIHRoZXNlIGFyZTogaXRlbSwgc2VwYXJhdG9yLCBzdWJtZW51LCBpbnB1dCBhbmQgY2hlY2tib3guIFRoZSB0eXBlIGdldHNcbi8vIHNwZWNpZmllZCB2aWEgYSAnYScgb3IgJ2FuJyBmaWVsZC4gRS5nLjpcbi8vXG4vLyAgIGl0ZW1fMSA9IHsgYW46ICdpdGVtJywgLi4uIH1cbi8vICAgaXRlbV8yID0geyBhOiAnc2VwYXJhdG9yJywgLi4uIH1cbi8vICAgaXRlbV8zID0geyBhOiAnc3VibWVudScsIC4uLiB9XG4vL1xuLy8gSWYgbm8gdHlwZSBpcyBzcGVjaWZpZWQgdGhlbiBpdCBpcyBhc3N1bWVkIHRvIGJlICdpdGVtJy4gVGhpcyBzaG91bGQgYmUgdGhlXG4vLyBjb21tb24gY2FzZS4gU28gJ2l0ZW1fMScgY291bGQgaGF2ZSBiZWVuIHJlZHVjZWQgdG86XG4vL1xuLy8gICBpdGVtXzEgPSB7IC4uLiB9XG4vL1xuLy8gQWxsIG1lbnUgaXRlbXMgY2FuIGhhdmUgYW4gb3B0aW9uYWwgJ2lkJyBmaWVsZC4gVGhpcyBhbGxvd3MgcmVmZXJyaW5nIHRvLFxuLy8gYW5kIG1hbmlwdWxhdGluZywgYSBzcGVjaWZpYyBtZW51IGl0ZW0gYWZ0ZXIgdGhlIG1lbnUgaGFzIGJlZW4gYnVpbHQuIFRoZVxuLy8gYWRkZWQgZWZmZWN0IGlzIHRoYXQgYSBkYXRhIGF0dHJpYnV0ZSAnZGF0YS1tZW51LWlkJyBpcyBhZGRlZCB0byB0aGUgRE9NXG4vLyBlbGVtZW50LCB3aGljaCBoZWxwcyBncmFiYmluZyBzcGVjaWZpYyBtZW51IGl0ZW1zIGluIGF1dG9tYXRlZCB0ZXN0cy5cbi8vXG4vLyBBbGwgb3RoZXIgZmllbGRzIHdoaWNoIGFyZSByZXF1aXJlZCBkZXBlbmQgb24gdGhlIHR5cGUgb2YgdGhlIG1lbnUgaXRlbS4gRm9yXG4vLyB0aGUgZGVmYXVsdCB0eXBlICdpdGVtJyB0aGVzZSBhcmU6XG4vLyAgIC0gdGV4dDogd2hpY2ggc2V0cyB0aGUgbWVudSBpdGVtJ3MgbGFiZWwuXG4vLyAgIC0gZm46IHdoaWNoIGRlZmluZXMgYSBjYWxsYmFjayBmdW5jdGlvbiB0byBiZSB0cmlnZ2VyZWQgd2hlbiB0aGUgbWVudSBpdGVtXG4vLyAgICAgZ2V0cyBhY3RpdmF0ZWQuIElmIHlvdSBkb24ndCBzcGVjaWZ5IGEgY2FsbGJhY2sgYW5kIGEgbWVudSBpdGVtIGdldHNcbi8vICAgICBhY3RpdmF0ZWQgdGhpcyBsaWJyYXJ5IHdpbGwgZmlyZSBhICdjbGljay1tZW51LWl0ZW0nIGV2ZW50LCB3aGljaCBjYW4gYmVcbi8vICAgICBoYW5kbGVkIGJ5IEpRdWVyeSBldmVudCBoYW5kbGVycy4gRS5nLjpcbi8vXG4vLyAgICAgJCgnYm9keScpLm9uKCdjbGljay1tZW51LWl0ZW0nLCBmdW5jdGlvbihlLCBtZW51X2l0ZW1fZGVmaW5pdGlvbikge1xuLy8gICAgICAgLi4uXG4vLyAgICAgfSlcbi8vXG4vLyBJdGVtIHZpc2liaWxpdHkgYW5kIGVuYWJsZW1lbnQ6XG4vLyBBbGwgbWVudSBpdGVtcyBoYXZlIGFuIG9wdGlvbmFsICdkaXNhYmxlaWYnIGFuZCAnaGlkZWlmJyBmaWVsZC4gVGhleSBhY2NlcHRcbi8vIGEgZnVuY3Rpb24gcGFyYW1ldGVyIGFuZCBjYW4gYmUgdXNlZCB0byByZXNwZWN0aXZlbHkgZGlzYWJsZSBvciBoaWRlIHRoZSBtZW51IGl0ZW0uXG4vL1xuLy8gU3VibWVudXMgYWxzbyBoYXZlIGEgbGFiZWwgd2hpY2ggeW91IGNhbiBkZWZpbmUgdmlhIHRoZSAndGV4dCcgZmllbGQuIEluXG4vLyBhZGRpdGlvbiBpdCBhY2NlcHRzIGEgJ3dpdGgnIGZpZWxkIHdoaWNoIGhvbGRzIHRoZSBkZWZpbml0aW9uIGZvciB0aGVcbi8vIHN1Ym1lbnUuIFRoaXMgYWdhaW4gY29uZm9ybXMgdG8gdGhlIGRlZmluaXRpb24gb2YgYW55IG1lbnUgKGkuZS4gYSBsaXN0IG9mXG4vLyBtZW51IGl0ZW1zKS4gRS5nLjpcbi8vXG4vLyAgIHN1Ym1lbnUgPSB7IGE6ICdzdWJtZW51JywgdGV4dDogJ1N1Ym1lbnUnLCB3aXRoOiBbXG4vLyAgICAgaXRlbV8xLFxuLy8gICAgIGl0ZW1fMixcbi8vICAgICAuLi5cbi8vICAgICBpdGVtX25cbi8vICAgXX1cbi8vXG4vLyBBc2lkZSBmcm9tIHRoYXQgc3VibWVudXMgY2FuIGFsc28gYmUgY3JlYXRlZCBkeW5hbWljYWxseS4gVG8gZG8gdGhhdCB5b3Vcbi8vIHNob3VsZCBub3QgcGFzcyBhbiBhcnJheSBhcyB0aGUgdmFsdWUgb2YgdGhlICd3aXRoJyBmaWVsZCBidXQgcGFzcyBhXG4vLyBmdW5jdGlvbiBpbnN0ZWFkLiBUaGlzIGZ1bmN0aW9uIHdpbGwgZ2V0IHRyaWdnZXJlZCB3aGVuIHRoZSBzdWJtZW51IHNob3VsZFxuLy8gYmVjb21lIHZpc2libGUsIGFuZCBpdCBzaG91bGQgcmV0dXJuIHRoZSBkZWZpbml0aW9uIG9mIHRoZSBzdWJtZW51IGFzIHVzdWFsLlxuLy8gU28gdGhlIGFib3ZlIGV4YW1wbGUgY291bGQgYWxzbyBoYXZlIGJlZW4gd3JpdHRlbiBhczpcbi8vXG4vLyAgIHN1Ym1lbnUgPSB7IGE6ICdzdWJtZW51JywgdGV4dDogJ1N1Ym1lbnUnLCB3aXRoOiBmdW5jdGlvbigpIHtcbi8vICAgICByZXR1cm4gW1xuLy8gICAgICAgaXRlbV8xLFxuLy8gICAgICAgaXRlbV8yLFxuLy8gICAgICAgLi4uXG4vLyAgICAgICBpdGVtX25cbi8vICAgICBdXG4vLyAgIH19XG4vL1xuLy8gSGVyZSBpcyBhIG1vcmUgY29tcGxldGUgZXhhbXBsZSBvZiBhIG1lbnUgZGVmaW5pdGlvbiwgd2hpY2ggYWxzbyBzaG93c1xuLy8gZmllbGRzIGZvciBvdGhlciBtZW51IGl0ZW0gdHlwZXM6XG4vL1xuLy8gICBtZW51ID0gJGNvbnRleHQuY3JlYXRlKFtcbi8vICAgICB7IHRleHQ6ICdOZXcgRXZlbnQnLCBmbjogZnVuY3Rpb24oKSB7IGNvbnNvbGUubG9nKCdORVcgRVZFTlQnKX0gfSxcbi8vICAgICB7IHRleHQ6ICdTZXQgYXMgVW5hdmFpbGFibGUnLCBmbjogbG9naXQgfSxcbi8vXG4vLyAgICAgeyBhOiAnc2VwYXJhdG9yJyB9LFxuLy9cbi8vICAgICB7IGE6ICdzdWJtZW51JywgdGV4dDogJ0Fzc2lnbiBTdGF0dXMnLCB3aXRoOiBbXG4vLyAgICAgICB7IHRleHQ6ICdObyBTdGF0dXMnIH0sXG4vLyAgICAgICAgICAgeyB0ZXh0OiAnT3B0aW9uIFJlcXVlc3QnIH0sXG4vLyAgICAgICAgICAgeyB0ZXh0OiAnT3B0aW9uJyB9LFxuLy8gICAgICAgICAgIHsgdGV4dDogJ0NvbmZpcm1lZCBPcHRpb24nIH0sXG4vLyAgICAgICAgICAgeyB0ZXh0OiAnUGxhbm5lZCcgfSxcbi8vICAgICAgICAgICB7IHRleHQ6ICdMb2NrZWQnIH0sXG4vLyAgICAgICAgICAgeyB0ZXh0OiAnQ2FuY2VsbGVkJyB9XG4vLyAgICAgIF19LFxuLy8gICAgICB7IGE6ICdzdWJtZW51JywgdGV4dDogJ0Fzc2lnbiBSb2xlJywgd2l0aDogZHluYW1pY19pdGVtc19mbiB9LFxuLy9cbi8vICAgICAgeyBhOiAnc2VwYXJhdG9yJyB9LFxuLy9cbi8vICAgICAgeyB0ZXh0OiAnQ3V0JywgZGlzYWJsZWlmPWZ1bmN0aW9uKCl7IHJldHVybiB1c2VyIGNhbl9kZWxldGUgfX0sXG4vLyAgICAgIHsgdGV4dDogJ0NvcHknIH0sXG4vLyAgICAgIHsgdGV4dDogJ1Bhc3RlJyB9LFxuLy9cbi8vICAgICAgeyBhOiAnc2VwYXJhdG9yJyB9LFxuLy9cbi8vICAgICAgeyBhOiAnc3VibWVudScsIHRleHQ6ICdBZGQgdG8gR3JvdXAnLCB3aXRoOiBbIHsgYW46ICdzZWFyY2gnLCB0ZXh0OiAnU2VhcmNoIGNvbnRhY3QuLi4nLCBzb3VyY2U6IHNvdXJjZV9mbiwgc2VsZWN0OiBzZWxlY3RfZm4gfSBdLFxuLy9cbi8vICAgICAgeyBhbjogJ2lucHV0JyB9LFxuLy8gICAgICB7IGE6ICdjaGVja2JveCcsIHRleHQ6ICdDaGVjayA/JyB9LFxuLy8gICBdKVxuLy9cbi8vXG4vLyBJbiBhZGRpdGlvbiwgdGhlIG9wZW5pbmcgYW5kIGNsb3Npbmcgb2YgbWVudXMgYW5kIHN1Ym1lbnVzIGZpcmVzIGV2ZW50c1xuLy8gd2hpY2ggY2FuIGJlIGhhbmRsZXMgYnkgSlF1ZXJ5IGV2ZW50IGhhbmRsZXJzLiBFLmcuOlxuLy9cbi8vICAgJCgnYm9keScpLm9uKCdjbG9zZWQtbWVudScsIGZ1bmN0aW9uKGUpIHtcbi8vICAgICAgLi4uXG4vLyAgIH0pXG4vL1xuLy8gVGhlIGV2ZW50cyB3aGljaCBjYW4gYmUgd2F0Y2hlZCBmb3IgYXJlOlxuLy8gICAtIG9wZW5pbmctbWVudVxuLy8gICAtIGNsb3NlZC1tZW51XG4vLyAgIC0gb3BlbmluZy1zdWItbWVudVxuLy8gICAtIGNsb3NlZC1zdWItbWVudVxuXG5pbXBvcnQgKiBhcyBTZW50cnkgZnJvbSBcIkBzZW50cnkvYnJvd3NlclwiO1xuaW1wb3J0IHtpc1NlbnRyeUluaXRpYWxpemVkfSBmcm9tIFwiLi9zaGFyZWRzY3JpcHRzLXNlbnRyeVwiO1xuXG5leHBvcnQgY2xhc3MgU2hhcmVkc2NyaXB0c0NvbnRleHRtZW51IHtcbiAgY29uc3RydWN0b3IoaXRlbXMsIG9wdGlvbnMsIHJvb3RfbWVudSkge1xuICAgIHRoaXMubWVudSA9IG51bGw7XG4gICAgdGhpcy5yb290X21lbnUgPSByb290X21lbnUgfHwgdGhpcztcbiAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuXG4gICAgdGhpcy5pZGVudGlmaWVkID0ge307XG5cbiAgICB0aGlzLmFjdGl2ZV9zdWJtZW51X2l0ZW0gPSBudWxsO1xuICAgIHRoaXMuYWN0aXZlX3N1Ym1lbnUgPSBudWxsO1xuXG4gICAgdGhpcy5pc19zaG93biA9IGZhbHNlO1xuICAgIHRoaXMueCA9IG51bGw7XG4gICAgdGhpcy55ID0gbnVsbDtcbiAgICB0aGlzLmlzTWFjID1cbiAgICAgIG5hdmlnYXRvci5wbGF0Zm9ybS5tYXRjaCgvbWFjL2kpICE9PSBudWxsICYmXG4gICAgICBuYXZpZ2F0b3IucGxhdGZvcm0ubWF0Y2goL21hYy9pKS5sZW5ndGggPiAwO1xuICAgIHRoaXMuY2xvbmVzID0gW107XG4gICAgdGhpcy5jYWNoZWRfc3VibWVudV9pdGVtcyA9IHt9O1xuICAgIHRoaXMudGltZXIgPSBudWxsO1xuXG4gICAgdGhpcy5zZXR1cF9jb250YWluZXIoKTtcbiAgICB0aGlzLnNldHVwX2l0ZW1zKGl0ZW1zKTtcbiAgICB0aGlzLnNldHVwX2ludGVyYWN0aW9ucygpO1xuICB9XG5cbiAgc2V0dXBfY29udGFpbmVyKCkge1xuICAgIHRoaXMubWVudSA9ICQoJzx1bD4nKTtcbiAgICBpZiAodGhpcy5yb290X21lbnUgPT09IHRoaXMpIHtcbiAgICAgIHRoaXMubWVudS5hZGRDbGFzcygnbWVudScpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLm1lbnUuYWRkQ2xhc3MoJ3N1Ym1lbnUnKTtcbiAgICAgIGlmICh0aGlzLm9wdGlvbnMuc3ViTWVudUNzc0NsYXNzZXMpIHtcbiAgICAgICAgdGhpcy5vcHRpb25zLnN1Yk1lbnVDc3NDbGFzc2VzLmZvckVhY2goXG4gICAgICAgICAgZnVuY3Rpb24oY3NzQ2xhc3MpIHtcbiAgICAgICAgICAgIHRoaXMubWVudS5hZGRDbGFzcyhjc3NDbGFzcyk7XG4gICAgICAgICAgfS5iaW5kKHRoaXMpXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmICh0aGlzLm9wdGlvbnMuY29udGFpbmVyQ3NzQ2xhc3Nlcykge1xuICAgICAgdGhpcy5tZW51LnJlbW92ZUNsYXNzKCdtZW51Jyk7XG4gICAgICB0aGlzLm9wdGlvbnMuY29udGFpbmVyQ3NzQ2xhc3Nlcy5mb3JFYWNoKFxuICAgICAgICBmdW5jdGlvbihjc3NDbGFzcykge1xuICAgICAgICAgIHRoaXMubWVudS5hZGRDbGFzcyhjc3NDbGFzcyk7XG4gICAgICAgIH0uYmluZCh0aGlzKVxuICAgICAgKTtcbiAgICB9XG4gICAgaWYgKHRoaXMub3B0aW9ucy5pZCkgdGhpcy5tZW51LmF0dHIoJ2lkJywgdGhpcy5vcHRpb25zLmlkKTtcblxuICAgIGlmICh0aGlzLm9wdGlvbnMuY2xvc2VPbk1vdXNlT3V0KSB7XG4gICAgICBjb25zdCBzZWxmID0gdGhpcztcbiAgICAgIHRoaXMubWVudS5vbignbW91c2VsZWF2ZScsIGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLnRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICBzZWxmLmNsb3NlKCk7XG4gICAgICAgICAgaWYgKHNlbGYucm9vdF9tZW51ID09PSBzZWxmKSB7XG4gICAgICAgICAgICBzZWxmLm9wdGlvbnMub25DbG9zZU1vdXNlT3V0ICYmIHNlbGYub3B0aW9ucy5vbkNsb3NlTW91c2VPdXQoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sIHNlbGYub3B0aW9ucy5jbG9zZUFmdGVyIHx8IDUwMCk7XG4gICAgICB9KTtcbiAgICAgIC8qIElmIGEgbW91c2VvdmVyIGhhcHBlbnMgd2hpbGUgdGhlIHRpbWVyIG9uIG1vdXNlbGVhdmUgaXMgc3RpbGwgY291bnRpbmcsXG4gICAgICAgICBjYW5jZWwgdGhlIGNsb3NlIGFjdGlvbi4gICovXG4gICAgICB0aGlzLm1lbnUub24oJ21vdXNlb3ZlcicsIGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAodGhpcy50aW1lcikge1xuICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVyKTtcbiAgICAgICAgICB0aGlzLnRpbWVyID0gbnVsbDtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG4gIHNldHVwX2l0ZW1zKGl0ZW1zKSB7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgaXRlbSA9IGl0ZW1zW2ldO1xuICAgICAgY29uc3QgZWxlbWVudCA9ICQoJzxsaT4nKS5hZGRDbGFzcygnZGV2LW1lbnUtaXRlbScpO1xuICAgICAgaWYgKGl0ZW0uY2xhc3MpIGVsZW1lbnQuYWRkQ2xhc3MoaXRlbS5jbGFzcyk7XG4gICAgICBlbGVtZW50LmRhdGEoJ2Rldi1tZW51LWl0ZW0nLCBpdGVtKTtcblxuICAgICAgZm9ybWF0KGl0ZW0sIGVsZW1lbnQsIHRoaXMpO1xuICAgICAgaWYgKGl0ZW0uaGlkZWlmICE9PSB1bmRlZmluZWQpIGVsZW1lbnQuZGF0YSgnaGlkZWlmJywgaXRlbS5oaWRlaWYpO1xuICAgICAgaWYgKGl0ZW0uZGlzYWJsZWlmICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgZWxlbWVudC5kYXRhKCdkaXNhYmxlaWYnLCBpdGVtLmRpc2FibGVpZik7XG4gICAgICB9XG4gICAgICBpZiAoaXRlbS5zaG93aWYgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBlbGVtZW50LmRhdGEoJ3Nob3dpZicsIGl0ZW0uc2hvd2lmKTtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgaXRlbS50ZXh0ID09PSAnZnVuY3Rpb24nKSBlbGVtZW50LmRhdGEoJ3RleHRfZm4nLCBpdGVtLnRleHQpO1xuICAgICAgaWYgKGl0ZW0uaHRtbEF0dHJpYnV0ZXMpIHtcbiAgICAgICAgZWxlbWVudC5kYXRhKCdodG1sQXR0cmlidXRlcycsIGl0ZW0uaHRtbEF0dHJpYnV0ZXMpO1xuICAgICAgfVxuXG4gICAgICBpZiAoaXRlbS5pZCkge1xuICAgICAgICBlbGVtZW50LmF0dHIoJ2RhdGEtbWVudS1pZCcsIGl0ZW0uaWQpO1xuICAgICAgICB0aGlzLmlkZW50aWZpZWRbaXRlbS5pZF0gPSB7XG4gICAgICAgICAgaXRlbSxcbiAgICAgICAgICBlbGVtZW50XG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIGlmIChpdGVtLmZvY3VzKSBlbGVtZW50LmF0dHIoJ2RhdGEtZm9jdXMnLCB0cnVlKTtcbiAgICAgIHRoaXMubWVudS5hcHBlbmQoZWxlbWVudCk7XG4gICAgfVxuICB9O1xuXG4gIHNldHVwX2ludGVyYWN0aW9ucygpIHtcbiAgICBjb25zdCBjb250ZXh0ID0gdGhpcztcblxuICAgIC8vIFByZXZlbnQgY2xpY2tzIGZyb20gc2VlcGluZyB0aHJvdWdoIHRoZSBjb250ZXh0IG1lbnUsIHdoaWNoIG1pZ2h0XG4gICAgLy8gb3RoZXJ3aXNlIGNsb3NlIHRoZSBtZW51IHByZW1hdHVyZWx5LlxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBmdW5jLW5hbWVzXG4gICAgdGhpcy5tZW51Lm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcbiAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgfSk7XG5cbiAgICAvLyBTYW1lIGZvciBpbnB1dCBmaWVsZHMgc2hvd24gaW4gdGhlIG1lbnUuIEludGVyYWN0aW5nIHdpdGggdGhlbSBzaG91bGRcbiAgICAvLyBub3QgY2xvc2UgdGhlIG1lbnUuXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGZ1bmMtbmFtZXNcbiAgICB0aGlzLm1lbnUub24oJ2NsaWNrJywgJ2lucHV0JywgZnVuY3Rpb24oZSkge1xuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICB9KTtcblxuICAgIC8vIENsaWNraW5nIG9uIGEgbWVudSBpdGVtIHRyaWdnZXJzIGFuIGFjdGlvbiBldmVudC5cbiAgICB0aGlzLm1lbnUub24oXG4gICAgICAnY2xpY2snLFxuICAgICAgJy5kZXYtbWVudS1pdGVtOm5vdCguc2VwYXJhdG9yKTpub3QoLmRpc2FibGVkKScsXG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZnVuYy1uYW1lc1xuICAgICAgZnVuY3Rpb24oZSkge1xuICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICBjb25zdCBkZWZpbml0aW9uID0gJCh0aGlzKS5kYXRhKCdkZXYtbWVudS1pdGVtJyk7XG4gICAgICAgIGxvZ0FjdGlvbihgQ2xpY2tlZCBvbiAke2RlZmluaXRpb24udGV4dH1gKTtcblxuICAgICAgICBpZiAoZGVmaW5pdGlvbi5mbikge1xuICAgICAgICAgIGRlZmluaXRpb24uZm4oZSk7XG4gICAgICAgICAgaWYgKChkZWZpbml0aW9uLmEgfHwgZGVmaW5pdGlvbi5hbikgIT09ICdzdWJtZW51Jykge1xuICAgICAgICAgICAgY29udGV4dC5yb290X21lbnUuY2xvc2UoKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29udGV4dC5tZW51LnRyaWdnZXIoJ2NsaWNrLW1lbnUtaXRlbScsIGRlZmluaXRpb24pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgKTtcblxuICAgIC8vIFN1Ym1lbnUgaW50ZXJhY3Rpb24uXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGZ1bmMtbmFtZXNcbiAgICB0aGlzLm1lbnUub24oJ21vdXNlb3ZlcicsICcuZGV2LW1lbnUtaXRlbScsIGZ1bmN0aW9uKGUpIHtcbiAgICAgIGlmICgkKHRoaXMpLmhhc0NsYXNzKCdkaXNhYmxlZCcpKSByZXR1cm47XG5cbiAgICAgIGlmIChjb250ZXh0LmFjdGl2ZV9zdWJtZW51X2l0ZW0pIGNvbnRleHQuYWN0aXZlX3N1Ym1lbnVfaXRlbS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG5cbiAgICAgIGlmIChcbiAgICAgICAgJCh0aGlzKS5kYXRhKCdkZXYtbWVudS1pdGVtJykuYSAhPT0gJ3N1Ym1lbnUnICYmXG4gICAgICAgICQodGhpcykuZGF0YSgnZGV2LW1lbnUtaXRlbScpLmFuICE9PSAnc3VibWVudSdcbiAgICAgICkge1xuICAgICAgICBjb250ZXh0LmFjdGl2ZV9zdWJtZW51X2l0ZW0gPSBudWxsO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29udGV4dC5hY3RpdmVfc3VibWVudV9pdGVtID0gJCh0aGlzKTtcbiAgICAgICAgY29udGV4dC5hY3RpdmVfc3VibWVudV9pdGVtLmFkZENsYXNzKCdhY3RpdmUnKTtcbiAgICAgIH1cblxuICAgICAgdG9nZ2xlX3N1Ym1lbnVfYXNfbmVlZGVkKCk7XG4gICAgfSk7XG5cbiAgICAvLyBTaG93L0hpZGUgc3VibWVudXMgYXMgbmVlZGVkLlxuICAgIC8vIFRoaXMgZ2V0cyBkZWJvdW5jZWQgdG8gcHJldmVudCB2aXN1YWwgYXJ0ZWZhY3RzLlxuICAgIGNvbnN0IHRvZ2dsZV9zdWJtZW51X2FzX25lZWRlZCA9IGRlYm91bmNlKGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKFxuICAgICAgICBjb250ZXh0LmFjdGl2ZV9zdWJtZW51ICYmXG4gICAgICAgIGNvbnRleHQuYWN0aXZlX3N1Ym1lbnUuaXNfc2hvd24gJiZcbiAgICAgICAgY29udGV4dC5hY3RpdmVfc3VibWVudV9pdGVtICYmXG4gICAgICAgIGNvbnRleHQuYWN0aXZlX3N1Ym1lbnUgPT09IGNvbnRleHQuYWN0aXZlX3N1Ym1lbnVfaXRlbS5kYXRhKCdzdWJtZW51JylcbiAgICAgICkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmIChjb250ZXh0LmFjdGl2ZV9zdWJtZW51KSBjb250ZXh0LmFjdGl2ZV9zdWJtZW51LmNsb3NlKCk7XG5cbiAgICAgIGlmIChjb250ZXh0LmFjdGl2ZV9zdWJtZW51X2l0ZW0pIHtcbiAgICAgICAgY29udGV4dC5hY3RpdmVfc3VibWVudSA9IGNvbnRleHQuYWN0aXZlX3N1Ym1lbnVfaXRlbS5kYXRhKCdzdWJtZW51Jyk7XG5cbiAgICAgICAgY29uc3QgZGVmaW5pdGlvbiA9IGNvbnRleHQuYWN0aXZlX3N1Ym1lbnVfaXRlbS5kYXRhKCdkZXYtbWVudS1pdGVtJyk7XG4gICAgICAgIGNvbnN0IGl0ZW1zID0gZGVmaW5pdGlvbi53aXRoO1xuICAgICAgICBjb25zdCBjcmVhdGVTdWJNZW51ID0gZnVuY3Rpb24oaXRlbXMsIG9wdGlvbnMsIGNvbnRleHQpIHtcbiAgICAgICAgICBvcHRpb25zLmlkID0gJ3N1Ym1lbnUnO1xuICAgICAgICAgIG9wdGlvbnMuZm9yID0gZGVmaW5pdGlvbi50ZXh0O1xuICAgICAgICAgIGNvbnRleHQuYWN0aXZlX3N1Ym1lbnUgPSBuZXcgU2hhcmVkc2NyaXB0c0NvbnRleHRtZW51KGl0ZW1zLCBvcHRpb25zLCBjb250ZXh0KTtcbiAgICAgICAgICBjb250ZXh0LmFjdGl2ZV9zdWJtZW51X2l0ZW0uZGF0YSgnc3VibWVudScsIGNvbnRleHQuYWN0aXZlX3N1Ym1lbnUpO1xuICAgICAgICB9O1xuICAgICAgICBjb25zdCBjb250ZXh0SGFzU3VibWVudUZvckRlZmluaXRpb24gPSBmdW5jdGlvbihkZWZpbml0aW9uKSB7XG4gICAgICAgICAgcmV0dXJuIGNvbnRleHQuYWN0aXZlX3N1Ym1lbnUgJiYgY29udGV4dC5hY3RpdmVfc3VibWVudS5vcHRpb25zLmZvciA9PT0gZGVmaW5pdGlvbi50ZXh0O1xuICAgICAgICB9O1xuXG4gICAgICAgIGxvZ0FjdGlvbihgT3BlbmluZyBzdWJtZW51IGZvciAke2RlZmluaXRpb24udGV4dH1gKTtcblxuICAgICAgICAvLyBBc3luYyBmdW5jdGlvblxuICAgICAgICBpZiAodHlwZW9mIGl0ZW1zID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgY29uc3QgY2FjaGVkX2l0ZW1zID0gY29udGV4dC5yb290X21lbnUuY2FjaGVkX3N1Ym1lbnVfaXRlbXNbZGVmaW5pdGlvbi50ZXh0XTtcbiAgICAgICAgICBpZiAoZGVmaW5pdGlvbi5yZWJ1aWxkU3VibWVudSB8fCAhY2FjaGVkX2l0ZW1zKSB7XG4gICAgICAgICAgICBpdGVtcyh0cnVlLCBmdW5jdGlvbihyZXMpIHtcbiAgICAgICAgICAgICAgLyogSWYgdGhlIGFjdGl2ZV9zdWJtZW51X2l0ZW0gaXMgbm8gbG9uZ2VyIHNldCwgdGhlIHVzZXIgaGFzIHNlbGVjdGVkIGFub3RoZXIgbWVudSBpdGVtLlxuICAgICAgICAgICAgICAgICBEaXNjYXJkIHRoZSByZXN1bHRzIG9mIHRoZSBhc3luYyBjYWxsIGFuZCBkbyBub3Qgc2hvdyB0aGUgc3VibWVudSAqL1xuICAgICAgICAgICAgICBpZiAoY29udGV4dC5hY3RpdmVfc3VibWVudV9pdGVtKSB7XG4gICAgICAgICAgICAgICAgY3JlYXRlU3ViTWVudShyZXMsIGNvbnRleHQub3B0aW9ucywgY29udGV4dCk7XG4gICAgICAgICAgICAgICAgY29udGV4dC5hY3RpdmVfc3VibWVudS5zaG93X2Zvcihjb250ZXh0LmFjdGl2ZV9zdWJtZW51X2l0ZW0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIGNvbnRleHQucm9vdF9tZW51LmNhY2hlZF9zdWJtZW51X2l0ZW1zW2RlZmluaXRpb24udGV4dF0gPSByZXM7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY3JlYXRlU3ViTWVudShjYWNoZWRfaXRlbXMsIGNvbnRleHQub3B0aW9ucywgY29udGV4dCk7XG4gICAgICAgICAgICBjb250ZXh0LmFjdGl2ZV9zdWJtZW51LnNob3dfZm9yKGNvbnRleHQuYWN0aXZlX3N1Ym1lbnVfaXRlbSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIC8qIFJlY3JlYXRlIHRoZSBtZW51IGlmIGV4cGxpY2l0bHkgY29uZmlndXJlZCBvciBpZiB0aGUgY3VycmVudCBzdWJtZW51IGlzIG5vdCBzZXQgb3IgZm9yIGFub3RoZXIgZGVmaW5pdGlvbiAqL1xuICAgICAgICAgIGlmICghY29udGV4dEhhc1N1Ym1lbnVGb3JEZWZpbml0aW9uKGRlZmluaXRpb24pIHx8IGRlZmluaXRpb24ucmVidWlsZFN1Ym1lbnUpIHtcbiAgICAgICAgICAgIGNyZWF0ZVN1Yk1lbnUoaXRlbXMsIGNvbnRleHQub3B0aW9ucywgY29udGV4dCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnRleHQuYWN0aXZlX3N1Ym1lbnUuc2hvd19mb3IoY29udGV4dC5hY3RpdmVfc3VibWVudV9pdGVtKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sIDI1MCk7XG5cbiAgICAvLyBDbGlja2luZyBvdXRzaWRlIHRoZSBjb250ZXh0IG1lbnUgbXVzdCBoaWRlIGl0LlxuICAgICQoJ2JvZHknKS5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7XG4gICAgICBpZiAoZS5jdHJsS2V5ICYmIGNvbnRleHQuaXNNYWMpIHJldHVybjtcbiAgICAgIGNvbnRleHQuY2xvc2UoKTtcbiAgICB9KTtcbiAgfTtcblxuICAvLyBTaG93IHRoZSBtZW51IGFzIG5lYXIgYXMgcG9zc2libGUgdG8gdGhlIHJlcXVlc3RlZCBjb29yZGluYXRlcywgYnV0XG4gIC8vIG1ha2luZyBzdXJlIHRoYXQgdGhlIGVudGlyZSBtZW51IHN0YXlzIHZpc2libGUuLi5cbiAgc2hvdyh4LCB5KSB7XG4gICAgY29uc3QgbWF4X3ggPSAkKGRvY3VtZW50KS53aWR0aCgpO1xuICAgIGNvbnN0IG1heF95ID0gJChkb2N1bWVudCkuaGVpZ2h0KCk7XG5cbiAgICBjb25zdCB3aWR0aCA9IHRoaXMubWVudS53aWR0aCgpO1xuICAgIGNvbnN0IGhlaWdodCA9IHRoaXMubWVudS5oZWlnaHQoKTtcblxuICAgIHggPSBNYXRoLm1heCgwLCBNYXRoLm1pbih4LCBtYXhfeCAtIHdpZHRoKSk7XG4gICAgeSA9IE1hdGgubWF4KDAsIE1hdGgubWluKHksIG1heF95IC0gaGVpZ2h0KSk7XG5cbiAgICB0aGlzLnNob3dfYXQoeCwgeSk7XG4gIH07XG5cbiAgc2hvd19mb3IobWVudV9pdGVtKSB7XG4gICAgaWYgKHRoaXMuaXNfc2hvd24pIHJldHVybjtcblxuICAgIHRoaXMucHJlcGFyZV9zaG93KCk7XG5cbiAgICB0aGlzLm1lbnUuaGlkZSgpO1xuICAgICQobWVudV9pdGVtKS5hcHBlbmQodGhpcy5tZW51KTtcbiAgICB0aGlzLm1lbnVcbiAgICAgIC5jc3MoJ3Zpc2liaWxpdHknLCAndmlzaWJsZScpXG4gICAgICAuaGlkZSgpXG4gICAgICAuZmFkZUluKDEwMCk7XG5cbiAgICBpZiAodGhpcy5tZW51LndpZHRoKCkgKyBtZW51X2l0ZW0ub2Zmc2V0KCkubGVmdCArIG1lbnVfaXRlbS53aWR0aCgpID4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudFdpZHRoICsgJCh3aW5kb3cpLnNjcm9sbExlZnQoKSkge1xuICAgICAgY29uc3QgbGVmdCA9IHRoaXMubWVudS53aWR0aCgpID4gbWVudV9pdGVtLndpZHRoKCkgPyBtZW51X2l0ZW0ud2lkdGgoKSAtIHRoaXMubWVudS53aWR0aCgpIDogNTtcbiAgICAgIHRoaXMubWVudS5jc3MoJ2xlZnQnLCBgJHtsZWZ0fXB4YCkuY3NzKCdwb3NpdGlvbicsICdhYnNvbHV0ZScpO1xuICAgIH1cblxuICAgIHRoaXMuaXNfc2hvd24gPSB0cnVlO1xuICAgIHRoaXMuYWZ0ZXJfc2hvdygpO1xuICB9O1xuXG4gIHNob3dfYXQoeCwgeSkge1xuICAgIGlmICh0aGlzLmlzX3Nob3duICYmIHRoaXMueCA9PT0geCAmJiB0aGlzLnkgPT09IHkpIHJldHVybjtcblxuICAgIC8vIE9ubHkgYXBwZW5kIHRoZSByb290IG1lbnUgdG8gdGhlIGJvZHksIHN1Ym1lbnVzIGFyZSBhcHBlbmRlZCB0byB0aGVpciBtZW51LWl0ZW0gZWxlbWVudFxuICAgIGlmICh0aGlzLnJvb3RfbWVudSA9PT0gdGhpcykgJCgnYm9keScpLmFwcGVuZCh0aGlzLm1lbnUpO1xuICAgIHRoaXMucHJlcGFyZV9zaG93KCk7XG5cbiAgICBsZXQgdG9wID0geTtcblxuICAgIGlmICgkKCdib2R5JykuaGVpZ2h0KCkgKyAkKGRvY3VtZW50KS5zY3JvbGxUb3AoKSAtIHkgPCB0aGlzLm1lbnUuaGVpZ2h0KCkpIHtcbiAgICAgIHRvcCAtPSAodGhpcy5tZW51LmhlaWdodCgpIC0gKCQoJ2JvZHknKS5oZWlnaHQoKSArICQoZG9jdW1lbnQpLnNjcm9sbFRvcCgpIC0geSkgKyA1KTtcbiAgICB9XG5cbiAgICB0aGlzLm1lbnVcbiAgICAgIC5jc3MoJ3RvcCcsIGAke3RvcH1weGApXG4gICAgICAuY3NzKCdsZWZ0JywgYCR7eH1weGApXG4gICAgICAuY3NzKCd2aXNpYmlsaXR5JywgJ3Zpc2libGUnKVxuICAgICAgLmNzcygnei1pbmRleCcsIDk5OTk5OSlcbiAgICAgIC5oaWRlKClcbiAgICAgIC5mYWRlSW4oMTAwKTtcblxuICAgIHRoaXMuaXNfc2hvd24gPSB0cnVlO1xuICAgIHRoaXMuYWZ0ZXJfc2hvdygpO1xuICB9O1xuXG4gIHByZXBhcmVfc2hvdygpIHtcbiAgICBpZiAodGhpcy5hY3RpdmVfc3VibWVudV9pdGVtKSB7XG4gICAgICB0aGlzLmFjdGl2ZV9zdWJtZW51X2l0ZW0ucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgdGhpcy5hY3RpdmVfc3VibWVudV9pdGVtID0gbnVsbDtcbiAgICB9XG5cbiAgICBpZiAodGhpcy5hY3RpdmVfc3VibWVudSkge1xuICAgICAgdGhpcy5hY3RpdmVfc3VibWVudS5jbG9zZSgpO1xuICAgICAgdGhpcy5hY3RpdmVfc3VibWVudSA9IG51bGw7XG4gICAgfVxuXG4gICAgdGhpcy5tZW51XG4gICAgICAuZmluZCgnbGknKVxuICAgICAgLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICgkKHRoaXMpLmRhdGEoJ2hpZGVpZicpICYmICQodGhpcykuZGF0YSgnaGlkZWlmJykoKSkge1xuICAgICAgICAgICQodGhpcykuaGlkZSgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICQodGhpcykuc2hvdygpO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmICgkKHRoaXMpLmRhdGEoJ2Rpc2FibGVpZicpKSB7XG4gICAgICAgICAgY29uc3QgZGlzYWJsZWlmID0gJCh0aGlzKS5kYXRhKCdkaXNhYmxlaWYnKTtcbiAgICAgICAgICBpZiAoKHR5cGVvZiBkaXNhYmxlaWYgPT09ICdib29sZWFuJyAmJiBkaXNhYmxlaWYpIHx8ICQodGhpcykuZGF0YSgnZGlzYWJsZWlmJykoKSkge1xuICAgICAgICAgICAgJCh0aGlzKS5hZGRDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgICAgICQodGhpcylcbiAgICAgICAgICAgICAgLmZpbmQoJz4gYScpXG4gICAgICAgICAgICAgIC5hZGRDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJCh0aGlzKS5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgICAgICQodGhpcylcbiAgICAgICAgICAgICAgLmZpbmQoJz4gYScpXG4gICAgICAgICAgICAgIC5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICAuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgICAgaWYgKCQodGhpcykuZGF0YSgnc2hvd2lmJykpIHtcbiAgICAgICAgICBpZiAoISQodGhpcykuZGF0YSgnc2hvd2lmJykoKSkge1xuICAgICAgICAgICAgJCh0aGlzKS5jc3MoJ2Rpc3BsYXknLCAnbm9uZScpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAkKHRoaXMpLmNzcygnZGlzcGxheScsICdibG9jaycpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIC5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoJCh0aGlzKS5kYXRhKCdodG1sQXR0cmlidXRlcycpKSB7XG4gICAgICAgICAgY29uc3QgYXR0cmlidXRlcyA9ICQodGhpcykuZGF0YSgnaHRtbEF0dHJpYnV0ZXMnKTtcbiAgICAgICAgICBjb25zdCBlbGVtZW50ID0gJCh0aGlzKTtcbiAgICAgICAgICBPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKS5mb3JFYWNoKGZ1bmN0aW9uKGtleSkge1xuICAgICAgICAgICAgJChlbGVtZW50KS5kYXRhKGtleSwgYXR0cmlidXRlc1trZXldKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICAgIC5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAoJCh0aGlzKS5kYXRhKCd0ZXh0X2ZuJykpIHtcbiAgICAgICAgICAkKHRoaXMpXG4gICAgICAgICAgICAuZmluZCgnYScpXG4gICAgICAgICAgICAuaHRtbCgkKHRoaXMpLmRhdGEoJ3RleHRfZm4nKSgpKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgaWYgKHRoaXMucm9vdF9tZW51ID09PSB0aGlzKSB7XG4gICAgICB0aGlzLm1lbnUudHJpZ2dlcignb3BlbmluZy1tZW51Jyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICQodGhpcy5tZW51KS50cmlnZ2VyKCdvcGVuaW5nLXN1Yi1tZW51Jyk7XG4gICAgfVxuICB9O1xuXG4gIGFmdGVyX3Nob3coKSB7XG4gICAgdGhpcy5tZW51LmZpbmQoJ2xpJykuZWFjaChmdW5jdGlvbigpIHtcbiAgICAgIGlmICgkKHRoaXMpLmRhdGEoJ2ZvY3VzJykpIHtcbiAgICAgICAgJCh0aGlzKVxuICAgICAgICAgIC5maW5kKCdpbnB1dCcpXG4gICAgICAgICAgLmZvY3VzKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG5cbiAgY2xvc2UoKSB7XG4gICAgaWYgKCF0aGlzLmlzX3Nob3duKSByZXR1cm47XG5cbiAgICBpZiAodGhpcy5hY3RpdmVfc3VibWVudV9pdGVtKSB7XG4gICAgICB0aGlzLmFjdGl2ZV9zdWJtZW51X2l0ZW0ucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgICAgaWYgKHRoaXMuYWN0aXZlX3N1Ym1lbnVfaXRlbS5kYXRhKCdzdWJtZW51JykgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aGlzLmFjdGl2ZV9zdWJtZW51X2l0ZW0uZGF0YSgnc3VibWVudScpLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLyogQWRkIHRoZSBjbG9uZSBlbGVtZW50IGJhY2sgb24gdGhlIHBhZ2UgKi9cbiAgICB0aGlzLmNsb25lcy5mb3JFYWNoKGZ1bmN0aW9uKGNsb25lRWxlbWVudCkge1xuICAgICAgY2xvbmVFbGVtZW50LmFwcGVuZFRvKGNsb25lRWxlbWVudC5kYXRhKCdwYXJlbnQnKSk7XG4gICAgfSk7XG4gICAgLyogUmVzZXQgY2FjaGVkIHN1Ym1lbnUgaXRlbXMgKi9cbiAgICB0aGlzLmNhY2hlZF9zdWJtZW51X2l0ZW1zID0ge307XG5cbiAgICB0aGlzLmlzX3Nob3duID0gZmFsc2U7XG4gICAgdGhpcy5tZW51LmNzcygndmlzaWJpbGl0eScsICdoaWRkZW4nKS5mYWRlT3V0KDEwMCk7XG4gICAgaWYgKHRoaXMucm9vdF9tZW51ID09PSB0aGlzKSB7XG4gICAgICB0aGlzLm1lbnUudHJpZ2dlcignY2xvc2VkLW1lbnUnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5tZW51LnRyaWdnZXIoJ2Nsb3NlZC1zdWItbWVudScpO1xuICAgIH1cbiAgICB0aGlzLm1lbnUuZGV0YWNoKCk7XG4gIH07XG5cbiAgZGVzdHJveSgpIHtcbiAgICB0aGlzLm1lbnUucmVtb3ZlKCk7XG4gIH07XG5cbiAgZW5hYmxlKGlkKSB7XG4gICAgaWYgKHRoaXMuaWRlbnRpZmllZFtpZF0pIHtcbiAgICAgIHRoaXMuaWRlbnRpZmllZFtpZF0uZWxlbWVudC5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgIHRoaXMuaWRlbnRpZmllZFtpZF0uZWxlbWVudC5maW5kKCc+IGEnKS5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgIGlmICh0eXBlb2YgdGhpcy5pZGVudGlmaWVkW2lkXS5lbGVtZW50LmRhdGEoJ2Rpc2FibGVpZicpID09PSAnYm9vbGVhbicpIHtcbiAgICAgICAgdGhpcy5pZGVudGlmaWVkW2lkXS5lbGVtZW50LmRhdGEoJ2Rpc2FibGVpZicsIGZhbHNlKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgZW5hYmxlX2FsbCgpIHtcbiAgICBjb25zdCBpZHMgPSBPYmplY3Qua2V5cyh0aGlzLmlkZW50aWZpZWQpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaWRzLmxlbmd0aDsgaSsrKSB0aGlzLmVuYWJsZShpZHNbaV0pO1xuICB9O1xuXG4gIGRpc2FibGUoaWQpIHtcbiAgICBpZiAodGhpcy5pZGVudGlmaWVkW2lkXSkge1xuICAgICAgdGhpcy5pZGVudGlmaWVkW2lkXS5lbGVtZW50LmFkZENsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgaWYgKHR5cGVvZiB0aGlzLmlkZW50aWZpZWRbaWRdLmVsZW1lbnQuZGF0YSgnZGlzYWJsZWlmJykgPT09ICdib29sZWFuJykge1xuICAgICAgICB0aGlzLmlkZW50aWZpZWRbaWRdLmVsZW1lbnQuZGF0YSgnZGlzYWJsZWlmJywgdHJ1ZSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIGRpc2FibGVfYWxsKCkge1xuICAgIGNvbnN0IGlkcyA9IE9iamVjdC5rZXlzKHRoaXMuaWRlbnRpZmllZCk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpZHMubGVuZ3RoOyBpKyspIHRoaXMuZGlzYWJsZShpZHNbaV0pO1xuICB9O1xuXG4gIHNldF90ZXh0KGlkLCB0ZXh0KSB7XG4gICAgY29uc3QgaWRkID0gdGhpcy5pZGVudGlmaWVkW2lkXTtcbiAgICBpZiAoaWRkLml0ZW0udGV4dCkge1xuICAgICAgaWRkLml0ZW0udGV4dCA9IHRleHQ7XG4gICAgICBpZGQuZWxlbWVudC5maW5kKCdhLm1lbnUtYWN0aW9uJykudGV4dCh0ZXh0KTtcbiAgICB9XG4gIH07XG5cbiAgZ2V0X2h0bWxhdHRyaWJ1dGUoaWQsIGtleSkge1xuICAgIGlmICh0aGlzLmlkZW50aWZpZWRbaWRdKSB7XG4gICAgICBpZiAodGhpcy5pZGVudGlmaWVkW2lkXS5pdGVtLmh0bWxBdHRyaWJ1dGVzKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmlkZW50aWZpZWRbaWRdLml0ZW0uaHRtbEF0dHJpYnV0ZXNba2V5XTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG4gIH07XG5cbiAgc2V0X2h0bWxhdHRyaWJ1dGUoaWQsIGtleSwgdmFsdWUpIHtcbiAgICBjb25zdCBpZGQgPSB0aGlzLmlkZW50aWZpZWRbaWRdO1xuICAgIGlmIChpZGQpIHtcbiAgICAgIGNvbnN0IGh0bWxBdHRyaWJ1dGVzID0gaWRkLml0ZW0uaHRtbEF0dHJpYnV0ZXMgfHwge307XG4gICAgICBodG1sQXR0cmlidXRlc1trZXldID0gdmFsdWU7XG4gICAgICBpZGQuaXRlbS5odG1sQXR0cmlidXRlcyA9IGh0bWxBdHRyaWJ1dGVzO1xuICAgICAgaWRkLmVsZW1lbnQuZGF0YShrZXksIHZhbHVlKTtcbiAgICB9XG4gIH07XG59XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbmNvbnN0IGZvcm1hdHRlcnMgPSB7XG5cbiAgc2VwYXJhdG9yKGRlZmluaXRpb24sIGVsZW1lbnQsIG1lbnVjb250ZXh0KSB7XG4gICAgZWxlbWVudC5hZGRDbGFzcygnc2VwYXJhdG9yJyk7XG4gIH0sXG5cbiAgaXRlbShkZWZpbml0aW9uLCBlbGVtZW50LCBtZW51Y29udGV4dCkge1xuICAgIGNvbnN0IHRleHQgPSB0eXBlb2YgZGVmaW5pdGlvbi50ZXh0ID09PSAnZnVuY3Rpb24nID8gZGVmaW5pdGlvbi50ZXh0IDogZGVmaW5pdGlvbi50ZXh0LnJlcGxhY2UoL1xccy9nLCAnJm5ic3A7Jyk7IC8vIFByZXNlcnZlIHdoaXRlc3BhY2VzIGluIHRoZSB0ZXh0XG4gICAgaWYgKGRlZmluaXRpb24uY3NzQ2xhc3MpIHtcbiAgICAgIGVsZW1lbnQuYWRkQ2xhc3MoZGVmaW5pdGlvbi5jc3NDbGFzcyk7XG4gICAgfVxuICAgICQoJzxhIGNsYXNzPVwibWVudS1hY3Rpb25cIiBocmVmPVwiamF2YXNjcmlwdDp7fVwiPicpXG4gICAgICAuYXBwZW5kVG8oZWxlbWVudClcbiAgICAgIC5odG1sKHRleHQpO1xuXG4gICAgaWYgKGRlZmluaXRpb24uZGVsZXRlQWN0aW9uKSB7XG4gICAgICAkKCc8YSBjbGFzcz1cImRlc3Ryb3llclwiIGhyZWY9XCJqYXZhc2NyaXB0Ont9XCI+JylcbiAgICAgICAgLm9uKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgIGRlZmluaXRpb24uZGVsZXRlQWN0aW9uKGUpO1xuICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSlcbiAgICAgICAgLmFwcGVuZFRvKGVsZW1lbnQpXG4gICAgICAgIC5odG1sKCdkZWxldGUnKTtcbiAgICB9XG4gIH0sXG5cbiAgc3VibWVudShkZWZpbml0aW9uLCBlbGVtZW50LCBtZW51Y29udGV4dCkge1xuICAgICQoJzxhIGhyZWY9XCJqYXZhc2NyaXB0Ont9XCI+JylcbiAgICAgIC5odG1sKGRlZmluaXRpb24udGV4dClcbiAgICAgIC5hcHBlbmRUbyhlbGVtZW50LmFkZENsYXNzKCdicmFuY2gnKSk7XG4gIH0sXG5cbiAgaW5wdXQoZGVmaW5pdGlvbiwgZWxlbWVudCwgbWVudWNvbnRleHQpIHtcbiAgICBjb25zdCBpbnB1dCA9ICQoJzxpbnB1dD4nKVxuICAgICAgLmF0dHIoJ3R5cGUnLCAndGV4dCcpXG4gICAgICAuYXR0cigncGxhY2Vob2xkZXInLCBkZWZpbml0aW9uLnRleHQpO1xuICAgIGlmIChkZWZpbml0aW9uLmZvY3VzT25PcGVuKSB7XG4gICAgICBtZW51Y29udGV4dC5tZW51Lm9uKCdvcGVuaW5nLXN1Yi1tZW51JywgZnVuY3Rpb24oKSB7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgaW5wdXQuZm9jdXMoKTtcbiAgICAgICAgfSwgMTUwKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoZGVmaW5pdGlvbi5vbkVudGVyKSB7XG4gICAgICBpbnB1dC5vbigna2V5cHJlc3MnLCBmdW5jdGlvbihlKSB7XG4gICAgICAgIGlmIChlLmtleSA9PT0gJ0VudGVyJykge1xuICAgICAgICAgIGNvbnN0IGlucHV0VmFsdWUgPSBpbnB1dC52YWwoKTtcbiAgICAgICAgICBkZWZpbml0aW9uLm9uRW50ZXIoaW5wdXRWYWx1ZSk7XG4gICAgICAgICAgaW5wdXQudmFsKCcnKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIGVsZW1lbnQuYXBwZW5kKGlucHV0KTtcbiAgfSxcblxuICBzZWFyY2goZGVmaW5pdGlvbiwgZWxlbWVudCwgbWVudWNvbnRleHQpIHtcblxuICAgIGNvbnN0IHVwZGF0ZUlucHV0TWFyZ2luRnVuY3Rpb24gPSBmdW5jdGlvbigpIHtcbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgIGNvbnN0IHdpZHRoID0gJCgnLmlucHV0LWZpbHRlcicsIGVsZW1lbnQpLm91dGVyV2lkdGgoKSArIDEwO1xuICAgICAgICAkKHNlYXJjaGZpZWxkKS5jc3MoJ3BhZGRpbmctcmlnaHQnLCBgJHt3aWR0aC50b1N0cmluZygpfXB4YCk7XG4gICAgICB9LCAwKTtcbiAgICB9O1xuXG4gICAgLy8gSlEtVUkgQXV0b2NvbXBsZXRlIGF1dG9tYXRpY2FsbHkgYXBwZW5kcyB0aGUgc3VnZ2VzdGlvbiBtZW51IHRvIGEgcGFyZW50IG1hcmtlZCB3aXRoIC51aS1mcm9udFxuICAgIGNvbnN0IGNvbnRhaW5lciA9ICQoJzxkaXY+JykuYWRkQ2xhc3MoJ3VpLWZyb250IG1lbnVfX2F1dG9jb21wbGV0ZS1yZXN1bHQnKTtcbiAgICBjb25zdCBzZWFyY2hmaWVsZCA9ICQoJzxpbnB1dD4nKVxuICAgICAgLmF0dHIoJ3R5cGUnLCAndGV4dCcpXG4gICAgICAuYXR0cigncGxhY2Vob2xkZXInLCBkZWZpbml0aW9uLnRleHQpO1xuICAgIGlmIChkZWZpbml0aW9uLm9uTmV3KSB7XG4gICAgICBzZWFyY2hmaWVsZC5vbigna2V5dXAnLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICBpZiAoZXZlbnQua2V5ID09PSAnRW50ZXInKSB7XG4gICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICBkZWZpbml0aW9uLm9uTmV3KHNlYXJjaGZpZWxkLnZhbCgpKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnRhaW5lci5hcHBlbmQoc2VhcmNoZmllbGQpO1xuICAgIGlmIChkZWZpbml0aW9uLndpdGhGaWx0ZXIpIHtcbiAgICAgIGNvbnN0IGZpbHRlciA9ICQoJzxzcGFuPicpLmFkZENsYXNzKCdzdWJtZW51LWZpbHRlciBpbnB1dC1maWx0ZXInKTtcbiAgICAgIGZpbHRlci5hdHRyKCd0aXRsZScsIGRlZmluaXRpb24uZmlsdGVyVG9vbHRpcEZ1bmN0aW9uKCkpO1xuICAgICAgZmlsdGVyLmh0bWwoZGVmaW5pdGlvbi5maWx0ZXJMYWJlbEZ1bmN0aW9uKCkpO1xuICAgICAgZmlsdGVyLm9uKCdjbGljaycsIGZ1bmN0aW9uKGNsaWNrRXZlbnQpIHtcbiAgICAgICAgY2xpY2tFdmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBkZWZpbml0aW9uLmZpbHRlclRvZ2dsZShmdW5jdGlvbigpIHtcbiAgICAgICAgICBmaWx0ZXIuYXR0cigndGl0bGUnLCBkZWZpbml0aW9uLmZpbHRlclRvb2x0aXBGdW5jdGlvbigpKTtcbiAgICAgICAgICBmaWx0ZXIuaHRtbChkZWZpbml0aW9uLmZpbHRlckxhYmVsRnVuY3Rpb24oKSk7XG4gICAgICAgICAgdXBkYXRlSW5wdXRNYXJnaW5GdW5jdGlvbigpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgICAgY29udGFpbmVyLmFwcGVuZChmaWx0ZXIpO1xuICAgIH1cbiAgICBtZW51Y29udGV4dC5tZW51Lm9uKCdvcGVuaW5nLXN1Yi1tZW51JywgZnVuY3Rpb24oKSB7XG4gICAgICBzZWFyY2hmaWVsZC5nZXQoMCkudmFsdWUgPSAnJztcbiAgICAgIHVwZGF0ZUlucHV0TWFyZ2luRnVuY3Rpb24oKTtcbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgIHNlYXJjaGZpZWxkLmZvY3VzKCk7XG4gICAgICB9LCAxNTApO1xuICAgIH0pO1xuXG4gICAgZWxlbWVudC5hcHBlbmQoY29udGFpbmVyKTtcblxuICAgIC8vIFRPRE86IG1vdmUgYXV0b2NvbXBsZXRlIGltcGxlbWVudGF0aW9uIHRvIHNlcGFyYXRlIG1vZHVsZSBmb3Igc2hhcmluZ1xuICAgIHNlYXJjaGZpZWxkLm5wUHJlc2V0QXV0b2NvbXBsZXRlKHtcbiAgICAgIGF1dG9Gb2N1czogdHJ1ZSxcbiAgICAgIG1pbkxlbmd0aDogZGVmaW5pdGlvbi5taW5MZW5ndGgsXG4gICAgICBtZXNzYWdlczoge1xuICAgICAgICBub1Jlc3VsdHMoKSB7XG4gICAgICAgIH0sXG4gICAgICAgIHJlc3VsdHMoKSB7XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBzb3VyY2U6IGRlZmluaXRpb24uc291cmNlLFxuICAgICAgY3JlYXRlKCkge1xuICAgICAgICBpZiAoZGVmaW5pdGlvbi53aXRoUHJlc2V0cykge1xuICAgICAgICAgIHNlYXJjaGZpZWxkLm9uKCdmb2N1cycsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgc2VhcmNoZmllbGQubnBQcmVzZXRBdXRvY29tcGxldGUoJ3NlYXJjaCcsICcnKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHNlbGVjdChldmVudCwgdWkpIHtcbiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGRlZmluaXRpb24uc2VsZWN0KGV2ZW50LCB1aSk7XG4gICAgICAgIG1lbnVjb250ZXh0LnJvb3RfbWVudS5jbG9zZSgpO1xuICAgICAgfSxcbiAgICAgIG9wZW4oZXZlbnQsIHVpKSB7XG4gICAgICAgICQoJy51aS1hdXRvY29tcGxldGUudWktbWVudScpXG4gICAgICAgICAgLmNzcygnbGVmdCcsIDApXG4gICAgICAgICAgLmNzcygndG9wJywgMClcbiAgICAgICAgICAuY3NzKCd3aWR0aCcsICdhdXRvJyk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0sXG5cbiAgc2VhcmNocmVzdWx0cyhkZWZpbml0aW9uLCBlbGVtZW50LCBtZW51Y29udGV4dCkge1xuICAgIGVsZW1lbnQuYXBwZW5kKCQoJzxkaXY+JykuYXR0cignaWQnLCBkZWZpbml0aW9uLmlkKSk7XG4gIH0sXG5cbiAgY2hlY2tib3goZGVmaW5pdGlvbiwgZWxlbWVudCwgbWVudWNvbnRleHQpIHtcbiAgICBjb25zdCBjaGVja2JveCA9ICQoJzxpbnB1dD4nKS5hdHRyKCd0eXBlJywgJ2NoZWNrYm94Jyk7XG5cbiAgICBlbGVtZW50LmFwcGVuZChjaGVja2JveCkuYXBwZW5kKGRlZmluaXRpb24udGV4dCk7XG4gIH0sXG5cbiAgaG92ZXJhYmxlKGRlZmluaXRpb24sIGVsZW1lbnQsIG1lbnVjb250ZXh0KSB7XG4gICAgY29uc3QgdGV4dCA9IHR5cGVvZiBkZWZpbml0aW9uLnRleHQgPT09ICdmdW5jdGlvbicgPyBkZWZpbml0aW9uLnRleHQgOiBkZWZpbml0aW9uLnRleHQucmVwbGFjZSgvXFxzL2csICcmbmJzcDsnKTsgLy8gUHJlc2VydmUgd2hpdGVzcGFjZXMgaW4gdGhlIHRleHRcbiAgICAkKCc8YSBjbGFzcz1cIm1lbnUtYWN0aW9uXCIgaHJlZj1cImphdmFzY3JpcHQ6e31cIj4nKVxuICAgICAgLmFwcGVuZFRvKGVsZW1lbnQpXG4gICAgICAub24oJ21vdXNlb3ZlcicsIGRlZmluaXRpb24ubW91c2VvdmVyIHx8IGZ1bmN0aW9uKGUpIHtcbiAgICAgIH0pXG4gICAgICAub24oJ21vdXNlb3V0JywgZGVmaW5pdGlvbi5tb3VzZW91dCB8fCBmdW5jdGlvbihlKSB7XG4gICAgICB9KVxuICAgICAgLmh0bWwodGV4dCk7XG4gIH0sXG5cbiAgY2xvbmUoZGVmaW5pdGlvbiwgZWxlbWVudCwgbWVudWNvbnRleHQpIHtcbiAgICBjb25zdCBvcmlnaW5hbCA9ICQoYCMke2RlZmluaXRpb24uY2xvbmVJZH1gKTtcbiAgICBjb25zdCBjbG9uZSA9IG9yaWdpbmFsLmNsb25lKHRydWUpO1xuICAgIC8qIFJlbW92ZSB0aGUgb3JpZ2luYWwgZWxlbWVudCwga2VlcGluZyBpdCBpbiB0aGUgY2xvbmVzIGFycmF5LlxuICAgICAgIE5lY2Vzc2FyeSBzdWNoIHRoYXQgbm8gdHdvIGVsZW1lbnRzIHdpdGggdGhlIHNhbWUgaWQgYXJlIG9uIHRoZSBwYWdlXG4gICAgICAgYW5kIGNhbGxiYWNrIGZ1bmN0aW9ucyBvcGVyYXRlIG9uIHRoZSBjb3JyZWN0IGVsZW1lbnQgKi9cbiAgICBtZW51Y29udGV4dC5jbG9uZXMucHVzaChvcmlnaW5hbCk7XG4gICAgb3JpZ2luYWwuZGF0YSgncGFyZW50Jywgb3JpZ2luYWwucGFyZW50KCkpO1xuICAgIG9yaWdpbmFsLmRldGFjaCgpO1xuICAgIGNsb25lLnNob3coKTtcbiAgICBjbG9uZS5hcHBlbmRUbyhlbGVtZW50KTtcbiAgfVxufTtcblxuZnVuY3Rpb24gZm9ybWF0KGRlZmluaXRpb24sIGVsZW1lbnQsIG1lbnVjb250ZXh0KSB7XG4gIGNvbnN0IHR5cGUgPSBkZWZpbml0aW9uLmEgfHwgZGVmaW5pdGlvbi5hbiB8fCAnaXRlbSc7XG4gIGZvcm1hdHRlcnNbdHlwZV0oZGVmaW5pdGlvbiwgZWxlbWVudCwgbWVudWNvbnRleHQpO1xufVxuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4vLyBodHRwOi8vZGF2aWR3YWxzaC5uYW1lL2phdmFzY3JpcHQtZGVib3VuY2UtZnVuY3Rpb25cbi8vIFJldHVybnMgYSBmdW5jdGlvbiwgdGhhdCwgYXMgbG9uZyBhcyBpdCBjb250aW51ZXMgdG8gYmUgaW52b2tlZCwgd2lsbCBub3Rcbi8vIGJlIHRyaWdnZXJlZC4gVGhlIGZ1bmN0aW9uIHdpbGwgYmUgY2FsbGVkIGFmdGVyIGl0IHN0b3BzIGJlaW5nIGNhbGxlZCBmb3Jcbi8vIE4gbWlsbGlzZWNvbmRzLiBJZiBgaW1tZWRpYXRlYCBpcyBwYXNzZWQsIHRyaWdnZXIgdGhlIGZ1bmN0aW9uIG9uIHRoZVxuLy8gbGVhZGluZyBlZGdlLCBpbnN0ZWFkIG9mIHRoZSB0cmFpbGluZy5cbmZ1bmN0aW9uIGRlYm91bmNlKGZ1bmMsIHdhaXQsIGltbWVkaWF0ZSkge1xuICBsZXQgdGltZW91dDtcbiAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgIGNvbnN0IGNvbnRleHQgPSB0aGlzLFxuICAgICAgYXJncyA9IGFyZ3VtZW50cztcbiAgICBjb25zdCBsYXRlciA9IGZ1bmN0aW9uKCkge1xuICAgICAgdGltZW91dCA9IG51bGw7XG4gICAgICBpZiAoIWltbWVkaWF0ZSkgZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcbiAgICB9O1xuICAgIGNvbnN0IGNhbGxOb3cgPSBpbW1lZGlhdGUgJiYgIXRpbWVvdXQ7XG4gICAgY2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xuICAgIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGxhdGVyLCB3YWl0KTtcbiAgICBpZiAoY2FsbE5vdykgZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcbiAgfTtcbn1cblxuLy8gRXJyb3IgbG9nZ2luZ1xuZnVuY3Rpb24gbG9nQWN0aW9uKG1lc3NhZ2UpIHtcbiAgaWYgKGlzU2VudHJ5SW5pdGlhbGl6ZWQoKSkge1xuICAgIFNlbnRyeS5hZGRCcmVhZGNydW1iKHtcbiAgICAgIGNhdGVnb3J5OiAnY29udGV4dG1lbnUnLFxuICAgICAgbWVzc2FnZSxcbiAgICAgIGxldmVsOiAnaW5mbydcbiAgICB9KVxuICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./CommonScripts/sharedscripts/sharedscripts-contextmenu.js\n");

/***/ }),

/***/ "./CommonScripts/sharedscripts/sharedscripts-datepicker.js":
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"closeDatepicker\": function() { return /* binding */ closeDatepicker; },\n/* harmony export */   \"formatDate\": function() { return /* binding */ formatDate; },\n/* harmony export */   \"isValidDate\": function() { return /* binding */ isValidDate; },\n/* harmony export */   \"renderInputDatepicker\": function() { return /* binding */ renderInputDatepicker; },\n/* harmony export */   \"renderInputDatepickerInElement\": function() { return /* binding */ renderInputDatepickerInElement; },\n/* harmony export */   \"setDateForInputWithDatepicker\": function() { return /* binding */ setDateForInputWithDatepicker; },\n/* harmony export */   \"toggleDatepicker\": function() { return /* binding */ toggleDatepicker; }\n/* harmony export */ });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./node_modules/react/index.js\");\n/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./node_modules/react-dom/index.js\");\n/* harmony import */ var react_dates_initialize__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"./node_modules/react-dates/initialize.js\");\n/* harmony import */ var react_dates_initialize__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(react_dates_initialize__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"./node_modules/moment/moment.js\");\n/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var _common_RawIntlProviderGlobalIntl__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(\"./common/RawIntlProviderGlobalIntl.js\");\n/* harmony import */ var _common_InputWithDatePicker__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(\"./common/InputWithDatePicker.js\");\n/* harmony import */ var _globalConfiguration__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(\"./globalConfiguration.ts\");\n\n\n\n\n\n\n\n__webpack_require__(\"./node_modules/moment/locale/nl.js\");\n__webpack_require__(\"./node_modules/moment/locale/fr.js\");\nfunction renderInputDatepickerInElement(htmlElement, configuration) {\n  moment__WEBPACK_IMPORTED_MODULE_3___default().locale(configuration.locale);\n  if (!htmlElement.length) {\n    window.requestAnimationFrame(function () {\n      return renderInputDatepickerInElement(htmlElement, configuration);\n    });\n  } else {\n    react_dom__WEBPACK_IMPORTED_MODULE_1__.render( /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_common_RawIntlProviderGlobalIntl__WEBPACK_IMPORTED_MODULE_4__[\"default\"], null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_common_InputWithDatePicker__WEBPACK_IMPORTED_MODULE_5__[\"default\"], {\n      configuration: configuration\n    })), $(htmlElement).get(0));\n  }\n}\nfunction renderInputDatepicker(htmlElementID, configuration, resourceUrl) {\n  var htmlAccessor = \"#\".concat(htmlElementID);\n  (0,_globalConfiguration__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(resourceUrl, configuration.dateFormat);\n  moment__WEBPACK_IMPORTED_MODULE_3___default().locale(configuration.locale);\n  if (!$(htmlAccessor).length) {\n    window.requestAnimationFrame(function () {\n      return renderInputDatepicker(htmlElementID, configuration, resourceUrl);\n    });\n  } else {\n    var htmlElement = $(htmlAccessor);\n    if (htmlElement.length) {\n      renderInputDatepickerInElement(htmlElement, configuration);\n    }\n  }\n}\nfunction toggleDatepicker(htmlElementID) {\n  var htmlAccessor = \"#\".concat(htmlElementID, \" .dev-attachdatepicker\");\n  var htmlElement = $(htmlAccessor);\n  if (htmlElement.length) {\n    htmlElement.trigger('toggleDatepicker');\n  }\n}\nfunction closeDatepicker(htmlElementID) {\n  var htmlAccessor = \"#\".concat(htmlElementID, \" .dev-attachdatepicker\");\n  var htmlElement = $(htmlAccessor);\n  if (htmlElement.length) {\n    htmlElement.trigger('closeDatepicker');\n  }\n}\nfunction setDateForInputWithDatepicker(htmlElementID, date, isDisabled) {\n  var htmlAccessor = \"#\".concat(htmlElementID, \" .dev-attachdatepicker\");\n  var htmlElement = $(htmlAccessor);\n  if (htmlElement.length) {\n    htmlElement.trigger('setDate', [date]);\n    htmlElement.trigger('setDisablement', [isDisabled]);\n  }\n}\nfunction formatDate(date, format) {\n  return moment__WEBPACK_IMPORTED_MODULE_3___default()(date, format);\n}\nfunction isValidDate(date, format) {\n  return moment__WEBPACK_IMPORTED_MODULE_3___default()(date, format).isValid();\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9Db21tb25TY3JpcHRzL3NoYXJlZHNjcmlwdHMvc2hhcmVkc2NyaXB0cy1kYXRlcGlja2VyLmpzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBR0E7QUFBQTtBQUtBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL1JlYWN0Q29tcG9uZW50c18vLi9Db21tb25TY3JpcHRzL3NoYXJlZHNjcmlwdHMvc2hhcmVkc2NyaXB0cy1kYXRlcGlja2VyLmpzP2QwYjkiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCBSZWFjdERPTSBmcm9tICdyZWFjdC1kb20nO1xuaW1wb3J0ICdyZWFjdC1kYXRlcy9pbml0aWFsaXplJztcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcbmltcG9ydCBSYXdJbnRsUHJvdmlkZXJHbG9iYWxJbnRsIGZyb20gJy4uLy4uL2NvbW1vbi9SYXdJbnRsUHJvdmlkZXJHbG9iYWxJbnRsJztcbmltcG9ydCBJbnB1dFdpdGhEYXRlUGlja2VyIGZyb20gJy4uLy4uL2NvbW1vbi9JbnB1dFdpdGhEYXRlUGlja2VyJztcbmltcG9ydCBlbnN1cmVSZXNvdXJjZVVybEFuZERhdGVGb3JtYXRDb25maWcgZnJvbSAnLi4vLi4vZ2xvYmFsQ29uZmlndXJhdGlvbic7XG5cbnJlcXVpcmUoJ21vbWVudC9sb2NhbGUvbmwnKTtcbnJlcXVpcmUoJ21vbWVudC9sb2NhbGUvZnInKTtcblxuZXhwb3J0IGZ1bmN0aW9uIHJlbmRlcklucHV0RGF0ZXBpY2tlckluRWxlbWVudChodG1sRWxlbWVudCwgY29uZmlndXJhdGlvbikge1xuICBtb21lbnQubG9jYWxlKGNvbmZpZ3VyYXRpb24ubG9jYWxlKTtcbiAgaWYgKCFodG1sRWxlbWVudC5sZW5ndGgpIHtcbiAgICB3aW5kb3cucmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHJlbmRlcklucHV0RGF0ZXBpY2tlckluRWxlbWVudChodG1sRWxlbWVudCwgY29uZmlndXJhdGlvbikpO1xuICB9IGVsc2Uge1xuICAgIFJlYWN0RE9NLnJlbmRlcihcbiAgICAgIDxSYXdJbnRsUHJvdmlkZXJHbG9iYWxJbnRsPlxuICAgICAgICA8SW5wdXRXaXRoRGF0ZVBpY2tlclxuICAgICAgICAgIGNvbmZpZ3VyYXRpb249e2NvbmZpZ3VyYXRpb259XG4gICAgICAgIC8+XG4gICAgICA8L1Jhd0ludGxQcm92aWRlckdsb2JhbEludGw+LFxuICAgICAgJChodG1sRWxlbWVudCkuZ2V0KDApXG4gICAgKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVuZGVySW5wdXREYXRlcGlja2VyKGh0bWxFbGVtZW50SUQsIGNvbmZpZ3VyYXRpb24sIHJlc291cmNlVXJsKSB7XG4gIGNvbnN0IGh0bWxBY2Nlc3NvciA9IGAjJHtodG1sRWxlbWVudElEfWA7XG4gIGVuc3VyZVJlc291cmNlVXJsQW5kRGF0ZUZvcm1hdENvbmZpZyhyZXNvdXJjZVVybCwgY29uZmlndXJhdGlvbi5kYXRlRm9ybWF0KTtcbiAgbW9tZW50LmxvY2FsZShjb25maWd1cmF0aW9uLmxvY2FsZSk7XG4gIGlmICghJChodG1sQWNjZXNzb3IpLmxlbmd0aCkge1xuICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gcmVuZGVySW5wdXREYXRlcGlja2VyKGh0bWxFbGVtZW50SUQsIGNvbmZpZ3VyYXRpb24sIHJlc291cmNlVXJsKSk7XG4gIH0gZWxzZSB7XG4gICAgY29uc3QgaHRtbEVsZW1lbnQgPSAkKGh0bWxBY2Nlc3Nvcik7XG4gICAgaWYgKGh0bWxFbGVtZW50Lmxlbmd0aCkge1xuICAgICAgcmVuZGVySW5wdXREYXRlcGlja2VySW5FbGVtZW50KGh0bWxFbGVtZW50LCBjb25maWd1cmF0aW9uKTtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHRvZ2dsZURhdGVwaWNrZXIoaHRtbEVsZW1lbnRJRCkge1xuICBjb25zdCBodG1sQWNjZXNzb3IgPSBgIyR7aHRtbEVsZW1lbnRJRH0gLmRldi1hdHRhY2hkYXRlcGlja2VyYDtcbiAgY29uc3QgaHRtbEVsZW1lbnQgPSAkKGh0bWxBY2Nlc3Nvcik7XG4gIGlmIChodG1sRWxlbWVudC5sZW5ndGgpIHtcbiAgICBodG1sRWxlbWVudC50cmlnZ2VyKCd0b2dnbGVEYXRlcGlja2VyJylcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY2xvc2VEYXRlcGlja2VyKGh0bWxFbGVtZW50SUQpIHtcbiAgY29uc3QgaHRtbEFjY2Vzc29yID0gYCMke2h0bWxFbGVtZW50SUR9IC5kZXYtYXR0YWNoZGF0ZXBpY2tlcmA7XG4gIGNvbnN0IGh0bWxFbGVtZW50ID0gJChodG1sQWNjZXNzb3IpO1xuICBpZiAoaHRtbEVsZW1lbnQubGVuZ3RoKSB7XG4gICAgaHRtbEVsZW1lbnQudHJpZ2dlcignY2xvc2VEYXRlcGlja2VyJylcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gc2V0RGF0ZUZvcklucHV0V2l0aERhdGVwaWNrZXIoaHRtbEVsZW1lbnRJRCwgZGF0ZSwgaXNEaXNhYmxlZCkge1xuICBjb25zdCBodG1sQWNjZXNzb3IgPSBgIyR7aHRtbEVsZW1lbnRJRH0gLmRldi1hdHRhY2hkYXRlcGlja2VyYDtcbiAgY29uc3QgaHRtbEVsZW1lbnQgPSAkKGh0bWxBY2Nlc3Nvcik7XG4gIGlmIChodG1sRWxlbWVudC5sZW5ndGgpIHtcbiAgICBodG1sRWxlbWVudC50cmlnZ2VyKCdzZXREYXRlJywgW2RhdGVdKTtcbiAgICBodG1sRWxlbWVudC50cmlnZ2VyKCdzZXREaXNhYmxlbWVudCcsIFtpc0Rpc2FibGVkXSk7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZvcm1hdERhdGUoZGF0ZSwgZm9ybWF0KSB7XG4gIHJldHVybiBtb21lbnQoZGF0ZSwgZm9ybWF0KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzVmFsaWREYXRlKGRhdGUsIGZvcm1hdCkge1xuICByZXR1cm4gbW9tZW50KGRhdGUsIGZvcm1hdCkuaXNWYWxpZCgpO1xufVxuXG5cblxuXG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./CommonScripts/sharedscripts/sharedscripts-datepicker.js\n");

/***/ }),

/***/ "./CommonScripts/sharedscripts/sharedscripts-globals.js":
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"internalJSDateFormat\": function() { return /* binding */ internalJSDateFormat; }\n/* harmony export */ });\nvar internalJSDateFormat = 'YYYY-MM-DD';//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9Db21tb25TY3JpcHRzL3NoYXJlZHNjcmlwdHMvc2hhcmVkc2NyaXB0cy1nbG9iYWxzLmpzLmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQSIsInNvdXJjZXMiOlsid2VicGFjazovL1JlYWN0Q29tcG9uZW50c18vLi9Db21tb25TY3JpcHRzL3NoYXJlZHNjcmlwdHMvc2hhcmVkc2NyaXB0cy1nbG9iYWxzLmpzPzA4MGEiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IGludGVybmFsSlNEYXRlRm9ybWF0ID0gJ1lZWVktTU0tREQnOyJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./CommonScripts/sharedscripts/sharedscripts-globals.js\n");

/***/ }),

/***/ "./CommonScripts/sharedscripts/sharedscripts-modalconfirmation.js":
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"confirmationModal\": function() { return /* binding */ confirmationModal; }\n/* harmony export */ });\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n/* eslint-disable no-unused-vars, func-names */\n/* MODAL CONFIRMATION DIALOG\nThis file provides an implementation of a modal dialog used to confirm the execution of an operation.\nThe modal is created by invoking the 'confirm' method.\nThis method takes a single argument, namely the configuration.\nThis configuration should be an object with the following fields:\n  - title: The title of the modal dialog\n  - message: The message that is shown\n  - confirmation_label: The label of the button that, when pressed executes the action that is being confirmed\n  - cancel_label: The label of the button that cancels the operation and closes the modal dialog\n  - callback: A Javascript function that doesn't take any arguments and that executes the operation\n*/\nvar ModalConfirmation = /*#__PURE__*/function () {\n  function ModalConfirmation(configuration) {\n    _classCallCheck(this, ModalConfirmation);\n    this.callback = configuration.callback;\n    this.message = configuration.message;\n    this.title = configuration.title;\n    this.confirmation_label = configuration.confirmation_label;\n    this.cancel_label = configuration.cancel_label;\n  }\n\n  /* Function to create the modal and add it to the page.\n  The modal has the following structure:\n  <div class=\"panel panel--modal panel--warning\">\n    <div class=\"panel-main\">\n      <h1 class=\"panel-title\">TITLE</h1>\n      <p>Message</p>\n    </div>\n    <div class=\"panel-footer text-right\">\n      <a class=\"cancel\">Cancel button</a>\n      <a class=\"btn btn-primary\">Confirmation button</a>\n    </div>\n  </div>\n  */\n  _createClass(ModalConfirmation, [{\n    key: \"createModal\",\n    value: function createModal() {\n      var self = this;\n      var modalPanel = $('<div>').addClass('panel panel--modal panel--warning');\n      // Install a click handler to prevent clicks in the body of the modal to trigger event handlers elsewhere on the page\n      $(modalPanel).on('click', function (event) {\n        event.stopPropagation();\n      });\n      var lightBox = $('<div class=\\'cover-lightbox\\'/>');\n      var panelMain = $('<div>').addClass('panel-main');\n      var panelTitle = $('<h1>').addClass('panel-title').html(this.title);\n\n      // Closing the modal means removing it and the lightbox\n      var closeModalFunction = function closeModalFunction(event) {\n        // Stop the event propagation in order to ensure that other event handlers are not triggered by clicking the button\n        event.stopPropagation();\n        $(modalPanel).remove();\n        $(lightBox).remove();\n      };\n      panelMain.append(panelTitle);\n      panelMain.append(this.message);\n      modalPanel.append(panelMain);\n      var panelFooter = $('<div>').addClass('panel-footer text-right');\n      var cancelButton = $('<a>').addClass('cancel').html(self.cancel_label);\n      $(cancelButton).on('click', closeModalFunction);\n      var confirmationButton = $('<a>').addClass('btn btn-primary').html(self.confirmation_label);\n      $(confirmationButton).on('click', function (event) {\n        closeModalFunction(event);\n        self.callback();\n      });\n      panelFooter.append(cancelButton);\n      panelFooter.append(confirmationButton);\n      modalPanel.append(panelFooter);\n\n      // Append both the modal and the lightbox to the body of the page\n      $('body').append(modalPanel).append(lightBox);\n    }\n  }]);\n  return ModalConfirmation;\n}(); // eslint-disable-next-line import/prefer-default-export\nvar confirmationModal = function confirmationModal(configuration) {\n  var modal = new ModalConfirmation(configuration);\n  modal.createModal();\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9Db21tb25TY3JpcHRzL3NoYXJlZHNjcmlwdHMvc2hhcmVkc2NyaXB0cy1tb2RhbGNvbmZpcm1hdGlvbi5qcy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBVkE7QUFjQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWkE7QUFBQTtBQUFBO0FBY0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFJQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL1JlYWN0Q29tcG9uZW50c18vLi9Db21tb25TY3JpcHRzL3NoYXJlZHNjcmlwdHMvc2hhcmVkc2NyaXB0cy1tb2RhbGNvbmZpcm1hdGlvbi5qcz8yNDM2Il0sInNvdXJjZXNDb250ZW50IjpbIi8qIGVzbGludC1kaXNhYmxlIG5vLXVudXNlZC12YXJzLCBmdW5jLW5hbWVzICovXG5cbi8qIE1PREFMIENPTkZJUk1BVElPTiBESUFMT0dcblRoaXMgZmlsZSBwcm92aWRlcyBhbiBpbXBsZW1lbnRhdGlvbiBvZiBhIG1vZGFsIGRpYWxvZyB1c2VkIHRvIGNvbmZpcm0gdGhlIGV4ZWN1dGlvbiBvZiBhbiBvcGVyYXRpb24uXG5UaGUgbW9kYWwgaXMgY3JlYXRlZCBieSBpbnZva2luZyB0aGUgJ2NvbmZpcm0nIG1ldGhvZC5cblRoaXMgbWV0aG9kIHRha2VzIGEgc2luZ2xlIGFyZ3VtZW50LCBuYW1lbHkgdGhlIGNvbmZpZ3VyYXRpb24uXG5UaGlzIGNvbmZpZ3VyYXRpb24gc2hvdWxkIGJlIGFuIG9iamVjdCB3aXRoIHRoZSBmb2xsb3dpbmcgZmllbGRzOlxuICAtIHRpdGxlOiBUaGUgdGl0bGUgb2YgdGhlIG1vZGFsIGRpYWxvZ1xuICAtIG1lc3NhZ2U6IFRoZSBtZXNzYWdlIHRoYXQgaXMgc2hvd25cbiAgLSBjb25maXJtYXRpb25fbGFiZWw6IFRoZSBsYWJlbCBvZiB0aGUgYnV0dG9uIHRoYXQsIHdoZW4gcHJlc3NlZCBleGVjdXRlcyB0aGUgYWN0aW9uIHRoYXQgaXMgYmVpbmcgY29uZmlybWVkXG4gIC0gY2FuY2VsX2xhYmVsOiBUaGUgbGFiZWwgb2YgdGhlIGJ1dHRvbiB0aGF0IGNhbmNlbHMgdGhlIG9wZXJhdGlvbiBhbmQgY2xvc2VzIHRoZSBtb2RhbCBkaWFsb2dcbiAgLSBjYWxsYmFjazogQSBKYXZhc2NyaXB0IGZ1bmN0aW9uIHRoYXQgZG9lc24ndCB0YWtlIGFueSBhcmd1bWVudHMgYW5kIHRoYXQgZXhlY3V0ZXMgdGhlIG9wZXJhdGlvblxuKi9cblxuY2xhc3MgTW9kYWxDb25maXJtYXRpb24ge1xuXG4gIGNvbnN0cnVjdG9yKGNvbmZpZ3VyYXRpb24pIHtcbiAgICB0aGlzLmNhbGxiYWNrID0gY29uZmlndXJhdGlvbi5jYWxsYmFjaztcbiAgICB0aGlzLm1lc3NhZ2UgPSBjb25maWd1cmF0aW9uLm1lc3NhZ2U7XG4gICAgdGhpcy50aXRsZSA9IGNvbmZpZ3VyYXRpb24udGl0bGU7XG4gICAgdGhpcy5jb25maXJtYXRpb25fbGFiZWwgPSBjb25maWd1cmF0aW9uLmNvbmZpcm1hdGlvbl9sYWJlbDtcbiAgICB0aGlzLmNhbmNlbF9sYWJlbCA9IGNvbmZpZ3VyYXRpb24uY2FuY2VsX2xhYmVsO1xuICB9XG5cbiAgLyogRnVuY3Rpb24gdG8gY3JlYXRlIHRoZSBtb2RhbCBhbmQgYWRkIGl0IHRvIHRoZSBwYWdlLlxuICBUaGUgbW9kYWwgaGFzIHRoZSBmb2xsb3dpbmcgc3RydWN0dXJlOlxuICA8ZGl2IGNsYXNzPVwicGFuZWwgcGFuZWwtLW1vZGFsIHBhbmVsLS13YXJuaW5nXCI+XG4gICAgPGRpdiBjbGFzcz1cInBhbmVsLW1haW5cIj5cbiAgICAgIDxoMSBjbGFzcz1cInBhbmVsLXRpdGxlXCI+VElUTEU8L2gxPlxuICAgICAgPHA+TWVzc2FnZTwvcD5cbiAgICA8L2Rpdj5cbiAgICA8ZGl2IGNsYXNzPVwicGFuZWwtZm9vdGVyIHRleHQtcmlnaHRcIj5cbiAgICAgIDxhIGNsYXNzPVwiY2FuY2VsXCI+Q2FuY2VsIGJ1dHRvbjwvYT5cbiAgICAgIDxhIGNsYXNzPVwiYnRuIGJ0bi1wcmltYXJ5XCI+Q29uZmlybWF0aW9uIGJ1dHRvbjwvYT5cbiAgICA8L2Rpdj5cbiAgPC9kaXY+XG4gICovXG4gIGNyZWF0ZU1vZGFsKCkge1xuICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgY29uc3QgbW9kYWxQYW5lbCA9ICQoJzxkaXY+JykuYWRkQ2xhc3MoJ3BhbmVsIHBhbmVsLS1tb2RhbCBwYW5lbC0td2FybmluZycpO1xuICAgIC8vIEluc3RhbGwgYSBjbGljayBoYW5kbGVyIHRvIHByZXZlbnQgY2xpY2tzIGluIHRoZSBib2R5IG9mIHRoZSBtb2RhbCB0byB0cmlnZ2VyIGV2ZW50IGhhbmRsZXJzIGVsc2V3aGVyZSBvbiB0aGUgcGFnZVxuICAgICQobW9kYWxQYW5lbCkub24oJ2NsaWNrJywgZnVuY3Rpb24oZXZlbnQpIHtcbiAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIH0pO1xuICAgIGNvbnN0IGxpZ2h0Qm94ID0gJCgnPGRpdiBjbGFzcz1cXCdjb3Zlci1saWdodGJveFxcJy8+Jyk7XG5cbiAgICBjb25zdCBwYW5lbE1haW4gPSAkKCc8ZGl2PicpLmFkZENsYXNzKCdwYW5lbC1tYWluJyk7XG4gICAgY29uc3QgcGFuZWxUaXRsZSA9ICQoJzxoMT4nKS5hZGRDbGFzcygncGFuZWwtdGl0bGUnKS5odG1sKHRoaXMudGl0bGUpO1xuXG4gICAgLy8gQ2xvc2luZyB0aGUgbW9kYWwgbWVhbnMgcmVtb3ZpbmcgaXQgYW5kIHRoZSBsaWdodGJveFxuICAgIGNvbnN0IGNsb3NlTW9kYWxGdW5jdGlvbiA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAvLyBTdG9wIHRoZSBldmVudCBwcm9wYWdhdGlvbiBpbiBvcmRlciB0byBlbnN1cmUgdGhhdCBvdGhlciBldmVudCBoYW5kbGVycyBhcmUgbm90IHRyaWdnZXJlZCBieSBjbGlja2luZyB0aGUgYnV0dG9uXG4gICAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICQobW9kYWxQYW5lbCkucmVtb3ZlKCk7XG4gICAgICAkKGxpZ2h0Qm94KS5yZW1vdmUoKTtcbiAgICB9O1xuXG4gICAgcGFuZWxNYWluLmFwcGVuZChwYW5lbFRpdGxlKTtcbiAgICBwYW5lbE1haW4uYXBwZW5kKHRoaXMubWVzc2FnZSk7XG5cbiAgICBtb2RhbFBhbmVsLmFwcGVuZChwYW5lbE1haW4pO1xuXG4gICAgY29uc3QgcGFuZWxGb290ZXIgPSAkKCc8ZGl2PicpLmFkZENsYXNzKCdwYW5lbC1mb290ZXIgdGV4dC1yaWdodCcpO1xuICAgIGNvbnN0IGNhbmNlbEJ1dHRvbiA9ICQoJzxhPicpLmFkZENsYXNzKCdjYW5jZWwnKS5odG1sKHNlbGYuY2FuY2VsX2xhYmVsKTtcblxuICAgICQoY2FuY2VsQnV0dG9uKS5vbignY2xpY2snLCBjbG9zZU1vZGFsRnVuY3Rpb24pO1xuXG4gICAgY29uc3QgY29uZmlybWF0aW9uQnV0dG9uID0gJCgnPGE+JykuYWRkQ2xhc3MoJ2J0biBidG4tcHJpbWFyeScpLmh0bWwoc2VsZi5jb25maXJtYXRpb25fbGFiZWwpO1xuICAgICQoY29uZmlybWF0aW9uQnV0dG9uKS5vbignY2xpY2snLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgY2xvc2VNb2RhbEZ1bmN0aW9uKGV2ZW50KTtcbiAgICAgIHNlbGYuY2FsbGJhY2soKTtcbiAgICB9KTtcblxuICAgIHBhbmVsRm9vdGVyLmFwcGVuZChjYW5jZWxCdXR0b24pO1xuICAgIHBhbmVsRm9vdGVyLmFwcGVuZChjb25maXJtYXRpb25CdXR0b24pO1xuICAgIG1vZGFsUGFuZWwuYXBwZW5kKHBhbmVsRm9vdGVyKTtcblxuICAgIC8vIEFwcGVuZCBib3RoIHRoZSBtb2RhbCBhbmQgdGhlIGxpZ2h0Ym94IHRvIHRoZSBib2R5IG9mIHRoZSBwYWdlXG4gICAgJCgnYm9keScpLmFwcGVuZChtb2RhbFBhbmVsKS5hcHBlbmQobGlnaHRCb3gpO1xuICB9O1xufVxuXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L3ByZWZlci1kZWZhdWx0LWV4cG9ydFxuZXhwb3J0IGNvbnN0IGNvbmZpcm1hdGlvbk1vZGFsID0gKGNvbmZpZ3VyYXRpb24pID0+IHtcbiAgY29uc3QgbW9kYWwgPSBuZXcgTW9kYWxDb25maXJtYXRpb24oY29uZmlndXJhdGlvbik7XG4gIG1vZGFsLmNyZWF0ZU1vZGFsKCk7XG59O1xuXG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./CommonScripts/sharedscripts/sharedscripts-modalconfirmation.js\n");

/***/ }),

/***/ "./CommonScripts/sharedscripts/sharedscripts-npcommon.js":
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"handleAjaxError\": function() { return /* binding */ handleAjaxError; },\n/* harmony export */   \"hasAltKey\": function() { return /* binding */ hasAltKey; },\n/* harmony export */   \"hasMetaKey\": function() { return /* binding */ hasMetaKey; },\n/* harmony export */   \"insertCover\": function() { return /* binding */ insertCover; },\n/* harmony export */   \"removeCover\": function() { return /* binding */ removeCover; }\n/* harmony export */ });\n/* harmony import */ var _sentry_browser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./node_modules/@sentry/hub/esm/exports.js\");\n/* harmony import */ var _sharedscripts_sentry__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./CommonScripts/sharedscripts/sharedscripts-sentry.js\");\n/* eslint-disable no-unused-vars, func-names */\n/* global ajax request handling */\n\n\n$.ajaxSetup({\n  timeout: 60000\n});\n\n// the 'busy' spinner shows in the right-hand corner when an ajax request is running or a page navigation link was clicked\n$(document).ajaxStart(function () {\n  $('#status').addClass('busy').children('.message').html('BUSY');\n});\n$(window).on('beforeunload', function () {\n  $('#status').addClass('busy').children('.message').html('BUSY');\n});\n$(document).ajaxStop(function () {\n  $('#status').removeClass('busy').not('.lost').children('.message').html('');\n});\nfunction alertInternalServerError(errorDialogHTML) {\n  if (errorDialogHTML) $('body').append(errorDialogHTML);\n}\nfunction alertConnectionLost(message) {\n  alert(message);\n  window.location = '/';\n}\nfunction alertUnreportableError(message) {\n  alert(message);\n}\nfunction setOffline() {\n  $('#status').removeClass('busy').addClass('lost').children('.message').html('OFFLINE');\n}\n\n// tempo var to suppress multiple warning (should replace with nice encapsulated var)\nvar warningGiven;\nfunction handleAjaxError(e, jqXHR, ajaxSettings, thrownError) {\n  function logToSentry() {\n    if ((0,_sharedscripts_sentry__WEBPACK_IMPORTED_MODULE_0__.isSentryInitialized)()) {\n      _sentry_browser__WEBPACK_IMPORTED_MODULE_1__.withScope(function (scope) {\n        var extraData = {\n          type: ajaxSettings.type,\n          url: ajaxSettings.url,\n          data: ajaxSettings.data,\n          status: jqXHR.status,\n          error: thrownError || jqXHR.statusText,\n          response: jqXHR.responseText ? jqXHR.responseText.substring(0, 100) : undefined\n        };\n        scope.setExtras(extraData);\n        _sentry_browser__WEBPACK_IMPORTED_MODULE_1__.captureMessage(thrownError || jqXHR.statusText);\n      });\n    }\n  }\n  switch (jqXHR.status) {\n    case 500:\n      // Server-side error, use the communicated error message\n      setOffline();\n      // If an error happens however in a block with as response type Javascript, we need to manually evaluate the response text\n      if (jqXHR.getResponseHeader('content-type') === 'text/javascript') eval(jqXHR.responseText);\n      alertInternalServerError(jqXHR.getResponseHeader('content-type') === 'text/html' ? jqXHR.responseText : null);\n      logToSentry();\n      break;\n    case 403:\n      setOffline();\n      if ($('.panel--error').length === 0 && warningGiven === undefined) {\n        warningGiven = true;\n        alertConnectionLost('Connection with server has been lost. You need to login again. (error 403)');\n      }\n      break;\n    case 0:\n      if (jqXHR.statusText !== 'timeout') break;\n    // client-cancelled request: skip this one\n    // eslint-disable-next-line no-fallthrough\n    default:\n      if ($('.panel--error').length === 0 && warningGiven === undefined) {\n        warningGiven = true;\n        if (thrownError !== '' && thrownError !== 'timeout') {\n          logToSentry();\n          alertUnreportableError(\"Yesplan encountered an unreportable error: \".concat(thrownError));\n        } else {\n          setOffline();\n          alertConnectionLost(\"Connection with server has been lost. You need to login again. (error \".concat(jqXHR.status, \") - \").concat(thrownError, \" - \").concat(jqXHR.statusText, \" - \").concat(jqXHR.responseText, \" - \").concat(ajaxSettings.url));\n        }\n      }\n  }\n}\n$(document).ajaxError(handleAjaxError);\n\n/* cover insertion */\nfunction insertCover() {\n  if ($('.cover').length === 0) {\n    var bodyEl = $('body');\n    bodyEl.append('<div class=\"cover\"> </div>');\n    bodyEl.css({\n      'overflow': 'hidden'\n    });\n  }\n}\nfunction removeCover() {\n  var coverEl = $('.cover');\n  if (coverEl.length !== 0 && $('[data-needscover]').length === 0) coverEl.remove();\n  $('body').css({\n    'overflow': ''\n  });\n}\nfunction hasMetaKey(event) {\n  // Detect the metaKey (ctrl on windows/linux or cmd on mac)\n  var isMac = navigator.platform.match(/mac/i) !== null && navigator.platform.match(/mac/i).length > 0;\n  return isMac && event.metaKey || !isMac && event.ctrlKey;\n}\n\n// Detect the alt key\nfunction hasAltKey(event) {\n  return event.altKey;\n}\n\n// Extend the String class with a format function similar to the one in Smalltalk\nif (!String.prototype.format) {\n  String.prototype.format = function () {\n    var args = arguments;\n    return this.replace(/{(\\d+)}/g, function (match, number) {\n      return typeof args[number] !== 'undefined' ? args[number] : match;\n    });\n  };\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9Db21tb25TY3JpcHRzL3NoYXJlZHNjcmlwdHMvc2hhcmVkc2NyaXB0cy1ucGNvbW1vbi5qcy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7O0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL1JlYWN0Q29tcG9uZW50c18vLi9Db21tb25TY3JpcHRzL3NoYXJlZHNjcmlwdHMvc2hhcmVkc2NyaXB0cy1ucGNvbW1vbi5qcz9hNWNjIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIGVzbGludC1kaXNhYmxlIG5vLXVudXNlZC12YXJzLCBmdW5jLW5hbWVzICovXG4vKiBnbG9iYWwgYWpheCByZXF1ZXN0IGhhbmRsaW5nICovXG5pbXBvcnQgKiBhcyBTZW50cnkgZnJvbSBcIkBzZW50cnkvYnJvd3NlclwiO1xuaW1wb3J0IHtpc1NlbnRyeUluaXRpYWxpemVkfSBmcm9tIFwiLi9zaGFyZWRzY3JpcHRzLXNlbnRyeVwiO1xuXG4kLmFqYXhTZXR1cCh7IHRpbWVvdXQ6IDYwMDAwIH0pO1xuXG5cbi8vIHRoZSAnYnVzeScgc3Bpbm5lciBzaG93cyBpbiB0aGUgcmlnaHQtaGFuZCBjb3JuZXIgd2hlbiBhbiBhamF4IHJlcXVlc3QgaXMgcnVubmluZyBvciBhIHBhZ2UgbmF2aWdhdGlvbiBsaW5rIHdhcyBjbGlja2VkXG4kKGRvY3VtZW50KS5hamF4U3RhcnQoZnVuY3Rpb24oKSB7XG4gICQoJyNzdGF0dXMnKS5hZGRDbGFzcygnYnVzeScpLmNoaWxkcmVuKCcubWVzc2FnZScpLmh0bWwoJ0JVU1knKTtcbn0pO1xuJCh3aW5kb3cpLm9uKCdiZWZvcmV1bmxvYWQnLCBmdW5jdGlvbigpIHtcbiAgJCgnI3N0YXR1cycpLmFkZENsYXNzKCdidXN5JykuY2hpbGRyZW4oJy5tZXNzYWdlJykuaHRtbCgnQlVTWScpO1xufSk7XG5cbiQoZG9jdW1lbnQpLmFqYXhTdG9wKGZ1bmN0aW9uKCkge1xuICAkKCcjc3RhdHVzJykucmVtb3ZlQ2xhc3MoJ2J1c3knKS5ub3QoJy5sb3N0JykuY2hpbGRyZW4oJy5tZXNzYWdlJykuaHRtbCgnJyk7XG59KTtcblxuZnVuY3Rpb24gYWxlcnRJbnRlcm5hbFNlcnZlckVycm9yKGVycm9yRGlhbG9nSFRNTCkge1xuICBpZiAoZXJyb3JEaWFsb2dIVE1MKVxuICAgICQoJ2JvZHknKS5hcHBlbmQoZXJyb3JEaWFsb2dIVE1MKTtcbn1cblxuZnVuY3Rpb24gYWxlcnRDb25uZWN0aW9uTG9zdChtZXNzYWdlKSB7XG4gIGFsZXJ0KG1lc3NhZ2UpO1xuICB3aW5kb3cubG9jYXRpb24gPSAnLyc7XG59XG5cbmZ1bmN0aW9uIGFsZXJ0VW5yZXBvcnRhYmxlRXJyb3IobWVzc2FnZSkge1xuICBhbGVydChtZXNzYWdlKTtcbn1cblxuZnVuY3Rpb24gc2V0T2ZmbGluZSgpIHtcbiAgJCgnI3N0YXR1cycpLnJlbW92ZUNsYXNzKCdidXN5JykuYWRkQ2xhc3MoJ2xvc3QnKS5jaGlsZHJlbignLm1lc3NhZ2UnKS5odG1sKCdPRkZMSU5FJyk7XG59XG5cbi8vIHRlbXBvIHZhciB0byBzdXBwcmVzcyBtdWx0aXBsZSB3YXJuaW5nIChzaG91bGQgcmVwbGFjZSB3aXRoIG5pY2UgZW5jYXBzdWxhdGVkIHZhcilcbmxldCB3YXJuaW5nR2l2ZW47XG5leHBvcnQgZnVuY3Rpb24gaGFuZGxlQWpheEVycm9yKGUsIGpxWEhSLCBhamF4U2V0dGluZ3MsIHRocm93bkVycm9yKSB7XG4gIGZ1bmN0aW9uIGxvZ1RvU2VudHJ5KCkge1xuICAgIGlmIChpc1NlbnRyeUluaXRpYWxpemVkKCkpIHtcbiAgICAgIFNlbnRyeS53aXRoU2NvcGUoZnVuY3Rpb24oc2NvcGUpIHtcbiAgICAgICAgY29uc3QgZXh0cmFEYXRhID0ge1xuICAgICAgICAgIHR5cGU6IGFqYXhTZXR0aW5ncy50eXBlLFxuICAgICAgICAgIHVybDogYWpheFNldHRpbmdzLnVybCxcbiAgICAgICAgICBkYXRhOiBhamF4U2V0dGluZ3MuZGF0YSxcbiAgICAgICAgICBzdGF0dXM6IGpxWEhSLnN0YXR1cyxcbiAgICAgICAgICBlcnJvcjogdGhyb3duRXJyb3IgfHwganFYSFIuc3RhdHVzVGV4dCxcbiAgICAgICAgICByZXNwb25zZTogKGpxWEhSLnJlc3BvbnNlVGV4dCkgPyBqcVhIUi5yZXNwb25zZVRleHQuc3Vic3RyaW5nKDAsIDEwMCkgOiB1bmRlZmluZWRcbiAgICAgICAgfTtcbiAgICAgICAgc2NvcGUuc2V0RXh0cmFzKGV4dHJhRGF0YSk7XG4gICAgICAgIFNlbnRyeS5jYXB0dXJlTWVzc2FnZSh0aHJvd25FcnJvciB8fCBqcVhIUi5zdGF0dXNUZXh0KTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuICBzd2l0Y2ggKGpxWEhSLnN0YXR1cykge1xuICAgIGNhc2UgNTAwOiAvLyBTZXJ2ZXItc2lkZSBlcnJvciwgdXNlIHRoZSBjb21tdW5pY2F0ZWQgZXJyb3IgbWVzc2FnZVxuICAgICAgc2V0T2ZmbGluZSgpO1xuICAgICAgLy8gSWYgYW4gZXJyb3IgaGFwcGVucyBob3dldmVyIGluIGEgYmxvY2sgd2l0aCBhcyByZXNwb25zZSB0eXBlIEphdmFzY3JpcHQsIHdlIG5lZWQgdG8gbWFudWFsbHkgZXZhbHVhdGUgdGhlIHJlc3BvbnNlIHRleHRcbiAgICAgIGlmIChqcVhIUi5nZXRSZXNwb25zZUhlYWRlcignY29udGVudC10eXBlJykgPT09ICd0ZXh0L2phdmFzY3JpcHQnKVxuICAgICAgICBldmFsKGpxWEhSLnJlc3BvbnNlVGV4dCk7XG4gICAgICBhbGVydEludGVybmFsU2VydmVyRXJyb3IoKGpxWEhSLmdldFJlc3BvbnNlSGVhZGVyKCdjb250ZW50LXR5cGUnKSA9PT0gJ3RleHQvaHRtbCcpID8ganFYSFIucmVzcG9uc2VUZXh0IDogbnVsbCk7XG4gICAgICBsb2dUb1NlbnRyeSgpO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSA0MDM6XG4gICAgICBzZXRPZmZsaW5lKCk7XG4gICAgICBpZiAoJCgnLnBhbmVsLS1lcnJvcicpLmxlbmd0aCA9PT0gMCAmJiAod2FybmluZ0dpdmVuID09PSB1bmRlZmluZWQpKSB7XG4gICAgICAgIHdhcm5pbmdHaXZlbiA9IHRydWU7XG4gICAgICAgIGFsZXJ0Q29ubmVjdGlvbkxvc3QoJ0Nvbm5lY3Rpb24gd2l0aCBzZXJ2ZXIgaGFzIGJlZW4gbG9zdC4gWW91IG5lZWQgdG8gbG9naW4gYWdhaW4uIChlcnJvciA0MDMpJyk7XG4gICAgICB9XG4gICAgICBicmVhaztcbiAgICBjYXNlIDA6XG4gICAgICBpZiAoanFYSFIuc3RhdHVzVGV4dCAhPT0gJ3RpbWVvdXQnKVxuICAgICAgICBicmVhazsgLy8gY2xpZW50LWNhbmNlbGxlZCByZXF1ZXN0OiBza2lwIHRoaXMgb25lXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWZhbGx0aHJvdWdoXG4gICAgZGVmYXVsdDpcbiAgICAgIGlmICgkKCcucGFuZWwtLWVycm9yJykubGVuZ3RoID09PSAwICYmIHdhcm5pbmdHaXZlbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHdhcm5pbmdHaXZlbiA9IHRydWU7XG4gICAgICAgIGlmICh0aHJvd25FcnJvciAhPT0gJycgJiYgdGhyb3duRXJyb3IgIT09ICd0aW1lb3V0Jykge1xuICAgICAgICAgIGxvZ1RvU2VudHJ5KCk7XG4gICAgICAgICAgYWxlcnRVbnJlcG9ydGFibGVFcnJvcihgWWVzcGxhbiBlbmNvdW50ZXJlZCBhbiB1bnJlcG9ydGFibGUgZXJyb3I6ICR7dGhyb3duRXJyb3J9YCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2V0T2ZmbGluZSgpO1xuICAgICAgICAgIGFsZXJ0Q29ubmVjdGlvbkxvc3QoYENvbm5lY3Rpb24gd2l0aCBzZXJ2ZXIgaGFzIGJlZW4gbG9zdC4gWW91IG5lZWQgdG8gbG9naW4gYWdhaW4uIChlcnJvciAke2pxWEhSLnN0YXR1c30pIC0gJHt0aHJvd25FcnJvcn0gLSAke2pxWEhSLnN0YXR1c1RleHR9IC0gJHtqcVhIUi5yZXNwb25zZVRleHR9IC0gJHthamF4U2V0dGluZ3MudXJsfWApO1xuICAgICAgICB9XG4gICAgICB9XG4gIH1cbn1cblxuJChkb2N1bWVudCkuYWpheEVycm9yKGhhbmRsZUFqYXhFcnJvcik7XG5cbi8qIGNvdmVyIGluc2VydGlvbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGluc2VydENvdmVyKCkge1xuICBpZiAoJCgnLmNvdmVyJykubGVuZ3RoID09PSAwKSB7XG4gICAgY29uc3QgYm9keUVsID0gJCgnYm9keScpO1xuICAgIGJvZHlFbC5hcHBlbmQoJzxkaXYgY2xhc3M9XCJjb3ZlclwiPiA8L2Rpdj4nKTtcbiAgICBib2R5RWwuY3NzKHsnb3ZlcmZsb3cnOiAnaGlkZGVuJ30pO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZW1vdmVDb3ZlcigpIHtcbiAgY29uc3QgY292ZXJFbCA9ICQoJy5jb3ZlcicpO1xuICBpZiAoKGNvdmVyRWwubGVuZ3RoICE9PSAwKSAmJiAoJCgnW2RhdGEtbmVlZHNjb3Zlcl0nKS5sZW5ndGggPT09IDApKVxuICAgIGNvdmVyRWwucmVtb3ZlKCk7XG4gICQoJ2JvZHknKS5jc3MoeydvdmVyZmxvdyc6ICcnfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBoYXNNZXRhS2V5KGV2ZW50KSB7XG4gIC8vIERldGVjdCB0aGUgbWV0YUtleSAoY3RybCBvbiB3aW5kb3dzL2xpbnV4IG9yIGNtZCBvbiBtYWMpXG4gIGNvbnN0IGlzTWFjID0gKG5hdmlnYXRvci5wbGF0Zm9ybS5tYXRjaCgvbWFjL2kpICE9PSBudWxsKSAmJiAobmF2aWdhdG9yLnBsYXRmb3JtLm1hdGNoKC9tYWMvaSkpLmxlbmd0aCA+IDA7XG4gIHJldHVybiAoaXNNYWMgJiYgZXZlbnQubWV0YUtleSkgfHwgKCFpc01hYyAmJiBldmVudC5jdHJsS2V5KTtcbn1cblxuLy8gRGV0ZWN0IHRoZSBhbHQga2V5XG5leHBvcnQgZnVuY3Rpb24gaGFzQWx0S2V5KGV2ZW50KSB7XG4gIHJldHVybiBldmVudC5hbHRLZXk7XG59XG5cbi8vIEV4dGVuZCB0aGUgU3RyaW5nIGNsYXNzIHdpdGggYSBmb3JtYXQgZnVuY3Rpb24gc2ltaWxhciB0byB0aGUgb25lIGluIFNtYWxsdGFsa1xuaWYgKCFTdHJpbmcucHJvdG90eXBlLmZvcm1hdCkge1xuICBTdHJpbmcucHJvdG90eXBlLmZvcm1hdCA9IGZ1bmN0aW9uKCkge1xuICAgIGNvbnN0IGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgcmV0dXJuIHRoaXMucmVwbGFjZSgveyhcXGQrKX0vZywgZnVuY3Rpb24obWF0Y2gsIG51bWJlcikge1xuICAgICAgcmV0dXJuIHR5cGVvZiBhcmdzW251bWJlcl0gIT09ICd1bmRlZmluZWQnID8gYXJnc1tudW1iZXJdIDogbWF0Y2g7XG4gICAgfSk7XG4gIH07XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./CommonScripts/sharedscripts/sharedscripts-npcommon.js\n");

/***/ }),

/***/ "./CommonScripts/sharedscripts/sharedscripts-sentry.js":
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"isSentryInitialized\": function() { return /* binding */ isSentryInitialized; }\n/* harmony export */ });\n/* harmony import */ var _sentry_browser__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./node_modules/@sentry/hub/esm/hub.js\");\n/* harmony import */ var _sentry_browser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./node_modules/@sentry/browser/esm/index.js\");\n\nfunction isSentryInitialized() {\n  return _sentry_browser__WEBPACK_IMPORTED_MODULE_0__.getCurrentHub().getClient() !== undefined;\n}\n__webpack_require__.g.Sentry = _sentry_browser__WEBPACK_IMPORTED_MODULE_1__;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9Db21tb25TY3JpcHRzL3NoYXJlZHNjcmlwdHMvc2hhcmVkc2NyaXB0cy1zZW50cnkuanMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFFQSIsInNvdXJjZXMiOlsid2VicGFjazovL1JlYWN0Q29tcG9uZW50c18vLi9Db21tb25TY3JpcHRzL3NoYXJlZHNjcmlwdHMvc2hhcmVkc2NyaXB0cy1zZW50cnkuanM/ZTk3NSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBTZW50cnkgZnJvbSBcIkBzZW50cnkvYnJvd3NlclwiO1xuXG5leHBvcnQgZnVuY3Rpb24gaXNTZW50cnlJbml0aWFsaXplZCgpIHtcbiAgcmV0dXJuIFNlbnRyeS5nZXRDdXJyZW50SHViKCkuZ2V0Q2xpZW50KCkgIT09IHVuZGVmaW5lZFxufVxuXG5nbG9iYWwuU2VudHJ5ID0gU2VudHJ5O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./CommonScripts/sharedscripts/sharedscripts-sentry.js\n");

/***/ }),

/***/ "./CommonScripts/sharedscripts/sharedscripts-yesplanapi.js":
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n// This module abstracts away some of the interaction with the server. The\n// server will dynamically create javascript functions for doing calls to\n// server side business logic. Those functions will get registered with this\n// module which then takes care of the basic handling of replies coming back\n// from the server (which includes updating the view model whenever needed).\n\n//  To ensure that there is only one instance of the exported Proxy,\n// webpack needs to be configured to have a \"commons\" runtime chunk, which\n// contains the code that is common to all webpack entry points. Because this\n// API is used in the sharedscripts (that exposes it to the Smalltalk code),\n// but it is also imported as ES6 module in the treeview and contactfinder modules,\n// the code should not be duplicated to all different bundles. So to ensure a true\n// Singleton instance of this yesplan client-side API, webpack needs to be configured\n// correctly.\n//\n// ___________________________________________________________________________\n// This turns a javascript function into a promise. It will pass the\n// arguments to the orginal function, but will return a promise rather than\n// the actual result. That will get returned through the usual promise\n// chaining instead.\n//\n// The promise will get set up in such a way that the model updates\n// will get run. After that it will take either the error value (if there\n// is one) and reject (fail) the promise, or take the return value and\n// resolve the promise instead.\n/* eslint-disable camelcase */\nfunction promised(fn) {\n  return function () {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    return new Promise(function (resolve, reject) {\n      var $model = args[0];\n\n      // Collect the arguments for the call:\n      var collected_args = new Array(args.length);\n      for (var i = 1; i < args.length; i++) {\n        collected_args[i - 1] = args[i];\n      }\n\n      // Add the handler for the result from the call. The original function\n      // should invoke this callback when done, passing an object with\n      // following structure:\n      //\n      // { added:   <array of new records>,\n      //   changed: <array of updated records>,\n      //   deleted: <array of deleted record ids>,\n      //   undostate: <string describing the currently available undo action on server>,\n      //   error:   <error value>,\n      //   value:   <actual return value of the function>\n      // }\n      //\n      // Every field here is optional. But we do recommend setting at least the\n      // error or value fields.\n      collected_args[args.length - 1] = function (reply) {\n        // console.log(reply)\n\n        // Whatever happened, we always process any updates we get back from\n        // the server.\n        if ($model) {\n          if (reply.added) $model.process_all_additions(reply.added);\n          if (reply.changed) $model.process_all_changes(reply.changed);\n          if (reply.deleted) $model.process_all_deletions(reply.deleted);\n        }\n\n        // TODO if (reply.script) eval it\n\n        // Only then do we handle the real reply.\n        if (reply.error) {\n          reject(reply.error);\n        } else {\n          undo_state[args[1].stack_symbol] = reply.undostate;\n          resolve(reply.value);\n        }\n      };\n\n      // Make the call:\n      fn.apply(null, collected_args);\n    });\n  };\n}\n\n// The default behaviour for all methods (before having been correctly\n// installed) is to return an error stating that the actual method\n// implementation is missing.\nfunction nop(name) {\n  return function () {\n    var _ref;\n    var reply = (_ref = arguments.length - 1, _ref < 0 || arguments.length <= _ref ? undefined : arguments[_ref]);\n    reply({\n      error: \"Missing API operation <\".concat(name, \">.\")\n    });\n  };\n}\nvar undo_state = {\n  treeview: null,\n  contacts: null\n};\nvar api = {\n  reset_undo: function reset_undo(stack_symbol) {\n    undo_state[stack_symbol] = null;\n  },\n  has_undo: function has_undo(stack_symbol) {\n    return undo_state[stack_symbol] !== null;\n  },\n  undo_name: function undo_name(stack_symbol) {\n    return undo_state[stack_symbol];\n  },\n  // Event-related functions\n  set_event_name: promised(nop('set_event_name')),\n  move_event: promised(nop('move_event')),\n  add_event: promised(nop('add_event')),\n  set_productionflag: promised(nop('set_productionflag')),\n  edit_event: promised(nop('edit_event')),\n  edit_group: promised(nop('edit_group')),\n  add_group: promised(nop('add_group')),\n  group_events: promised(nop('group_events')),\n  remove_events: promised(nop('remove_events')),\n  remove_groups_only: promised(nop('remove_groups_only')),\n  undo_events: promised(nop('undo_events')),\n  // Contacts-related functions\n  create_organization: promised(nop('create_organization')),\n  create_person: promised(nop('create_person')),\n  create_contactlinks: promised(nop('create_contactlinks')),\n  duplicate_contacts: promised(nop('duplicate_contacts')),\n  remove_contacts: promised(nop('remove_contacts')),\n  undo_contacts: promised(nop('undo_contacts')),\n  // Generic functions\n  update_model: promised(nop('update_model')),\n  remove_from_model: promised(nop('remove_from_model'))\n};\nvar yesplanapi = {\n  _install: function _install(name, fn) {\n    api[name] = promised(fn);\n  }\n};\n/* harmony default export */ __webpack_exports__[\"default\"] = (new Proxy(yesplanapi, {\n  get: function get(target, propertyKey) {\n    if (api[propertyKey] !== undefined) return function () {\n      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n      return api[propertyKey].apply(target, args);\n    };\n    return function () {\n      for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n        args[_key3] = arguments[_key3];\n      }\n      return target[propertyKey].apply(target, args);\n    };\n  }\n}));//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9Db21tb25TY3JpcHRzL3NoYXJlZHNjcmlwdHMvc2hhcmVkc2NyaXB0cy15ZXNwbGFuYXBpLmpzLmpzIiwibWFwcGluZ3MiOiI7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL1JlYWN0Q29tcG9uZW50c18vLi9Db21tb25TY3JpcHRzL3NoYXJlZHNjcmlwdHMvc2hhcmVkc2NyaXB0cy15ZXNwbGFuYXBpLmpzP2UxMzkiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhpcyBtb2R1bGUgYWJzdHJhY3RzIGF3YXkgc29tZSBvZiB0aGUgaW50ZXJhY3Rpb24gd2l0aCB0aGUgc2VydmVyLiBUaGVcbi8vIHNlcnZlciB3aWxsIGR5bmFtaWNhbGx5IGNyZWF0ZSBqYXZhc2NyaXB0IGZ1bmN0aW9ucyBmb3IgZG9pbmcgY2FsbHMgdG9cbi8vIHNlcnZlciBzaWRlIGJ1c2luZXNzIGxvZ2ljLiBUaG9zZSBmdW5jdGlvbnMgd2lsbCBnZXQgcmVnaXN0ZXJlZCB3aXRoIHRoaXNcbi8vIG1vZHVsZSB3aGljaCB0aGVuIHRha2VzIGNhcmUgb2YgdGhlIGJhc2ljIGhhbmRsaW5nIG9mIHJlcGxpZXMgY29taW5nIGJhY2tcbi8vIGZyb20gdGhlIHNlcnZlciAod2hpY2ggaW5jbHVkZXMgdXBkYXRpbmcgdGhlIHZpZXcgbW9kZWwgd2hlbmV2ZXIgbmVlZGVkKS5cblxuLy8g4pqg77iPIFRvIGVuc3VyZSB0aGF0IHRoZXJlIGlzIG9ubHkgb25lIGluc3RhbmNlIG9mIHRoZSBleHBvcnRlZCBQcm94eSxcbi8vIHdlYnBhY2sgbmVlZHMgdG8gYmUgY29uZmlndXJlZCB0byBoYXZlIGEgXCJjb21tb25zXCIgcnVudGltZSBjaHVuaywgd2hpY2hcbi8vIGNvbnRhaW5zIHRoZSBjb2RlIHRoYXQgaXMgY29tbW9uIHRvIGFsbCB3ZWJwYWNrIGVudHJ5IHBvaW50cy4gQmVjYXVzZSB0aGlzXG4vLyBBUEkgaXMgdXNlZCBpbiB0aGUgc2hhcmVkc2NyaXB0cyAodGhhdCBleHBvc2VzIGl0IHRvIHRoZSBTbWFsbHRhbGsgY29kZSksXG4vLyBidXQgaXQgaXMgYWxzbyBpbXBvcnRlZCBhcyBFUzYgbW9kdWxlIGluIHRoZSB0cmVldmlldyBhbmQgY29udGFjdGZpbmRlciBtb2R1bGVzLFxuLy8gdGhlIGNvZGUgc2hvdWxkIG5vdCBiZSBkdXBsaWNhdGVkIHRvIGFsbCBkaWZmZXJlbnQgYnVuZGxlcy4gU28gdG8gZW5zdXJlIGEgdHJ1ZVxuLy8gU2luZ2xldG9uIGluc3RhbmNlIG9mIHRoaXMgeWVzcGxhbiBjbGllbnQtc2lkZSBBUEksIHdlYnBhY2sgbmVlZHMgdG8gYmUgY29uZmlndXJlZFxuLy8gY29ycmVjdGx5LlxuLy9cbi8vIF9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX1xuLy8gVGhpcyB0dXJucyBhIGphdmFzY3JpcHQgZnVuY3Rpb24gaW50byBhIHByb21pc2UuIEl0IHdpbGwgcGFzcyB0aGVcbi8vIGFyZ3VtZW50cyB0byB0aGUgb3JnaW5hbCBmdW5jdGlvbiwgYnV0IHdpbGwgcmV0dXJuIGEgcHJvbWlzZSByYXRoZXIgdGhhblxuLy8gdGhlIGFjdHVhbCByZXN1bHQuIFRoYXQgd2lsbCBnZXQgcmV0dXJuZWQgdGhyb3VnaCB0aGUgdXN1YWwgcHJvbWlzZVxuLy8gY2hhaW5pbmcgaW5zdGVhZC5cbi8vXG4vLyBUaGUgcHJvbWlzZSB3aWxsIGdldCBzZXQgdXAgaW4gc3VjaCBhIHdheSB0aGF0IHRoZSBtb2RlbCB1cGRhdGVzXG4vLyB3aWxsIGdldCBydW4uIEFmdGVyIHRoYXQgaXQgd2lsbCB0YWtlIGVpdGhlciB0aGUgZXJyb3IgdmFsdWUgKGlmIHRoZXJlXG4vLyBpcyBvbmUpIGFuZCByZWplY3QgKGZhaWwpIHRoZSBwcm9taXNlLCBvciB0YWtlIHRoZSByZXR1cm4gdmFsdWUgYW5kXG4vLyByZXNvbHZlIHRoZSBwcm9taXNlIGluc3RlYWQuXG4vKiBlc2xpbnQtZGlzYWJsZSBjYW1lbGNhc2UgKi9cbmZ1bmN0aW9uIHByb21pc2VkKGZuKSB7XG4gIHJldHVybiAoLi4uYXJncykgPT4ge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBjb25zdCAkbW9kZWwgPSBhcmdzWzBdO1xuXG4gICAgICAvLyBDb2xsZWN0IHRoZSBhcmd1bWVudHMgZm9yIHRoZSBjYWxsOlxuICAgICAgY29uc3QgY29sbGVjdGVkX2FyZ3MgPSBuZXcgQXJyYXkoYXJncy5sZW5ndGgpO1xuICAgICAgZm9yIChsZXQgaSA9IDE7IGkgPCBhcmdzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbGxlY3RlZF9hcmdzW2kgLSAxXSA9IGFyZ3NbaV07XG4gICAgICB9XG5cbiAgICAgIC8vIEFkZCB0aGUgaGFuZGxlciBmb3IgdGhlIHJlc3VsdCBmcm9tIHRoZSBjYWxsLiBUaGUgb3JpZ2luYWwgZnVuY3Rpb25cbiAgICAgIC8vIHNob3VsZCBpbnZva2UgdGhpcyBjYWxsYmFjayB3aGVuIGRvbmUsIHBhc3NpbmcgYW4gb2JqZWN0IHdpdGhcbiAgICAgIC8vIGZvbGxvd2luZyBzdHJ1Y3R1cmU6XG4gICAgICAvL1xuICAgICAgLy8geyBhZGRlZDogICA8YXJyYXkgb2YgbmV3IHJlY29yZHM+LFxuICAgICAgLy8gICBjaGFuZ2VkOiA8YXJyYXkgb2YgdXBkYXRlZCByZWNvcmRzPixcbiAgICAgIC8vICAgZGVsZXRlZDogPGFycmF5IG9mIGRlbGV0ZWQgcmVjb3JkIGlkcz4sXG4gICAgICAvLyAgIHVuZG9zdGF0ZTogPHN0cmluZyBkZXNjcmliaW5nIHRoZSBjdXJyZW50bHkgYXZhaWxhYmxlIHVuZG8gYWN0aW9uIG9uIHNlcnZlcj4sXG4gICAgICAvLyAgIGVycm9yOiAgIDxlcnJvciB2YWx1ZT4sXG4gICAgICAvLyAgIHZhbHVlOiAgIDxhY3R1YWwgcmV0dXJuIHZhbHVlIG9mIHRoZSBmdW5jdGlvbj5cbiAgICAgIC8vIH1cbiAgICAgIC8vXG4gICAgICAvLyBFdmVyeSBmaWVsZCBoZXJlIGlzIG9wdGlvbmFsLiBCdXQgd2UgZG8gcmVjb21tZW5kIHNldHRpbmcgYXQgbGVhc3QgdGhlXG4gICAgICAvLyBlcnJvciBvciB2YWx1ZSBmaWVsZHMuXG4gICAgICBjb2xsZWN0ZWRfYXJnc1thcmdzLmxlbmd0aCAtIDFdID0gKHJlcGx5KSA9PiB7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHJlcGx5KVxuXG4gICAgICAgIC8vIFdoYXRldmVyIGhhcHBlbmVkLCB3ZSBhbHdheXMgcHJvY2VzcyBhbnkgdXBkYXRlcyB3ZSBnZXQgYmFjayBmcm9tXG4gICAgICAgIC8vIHRoZSBzZXJ2ZXIuXG4gICAgICAgIGlmKCRtb2RlbCkge1xuICAgICAgICAgIGlmIChyZXBseS5hZGRlZCkgJG1vZGVsLnByb2Nlc3NfYWxsX2FkZGl0aW9ucyhyZXBseS5hZGRlZCk7XG4gICAgICAgICAgaWYgKHJlcGx5LmNoYW5nZWQpICRtb2RlbC5wcm9jZXNzX2FsbF9jaGFuZ2VzKHJlcGx5LmNoYW5nZWQpO1xuICAgICAgICAgIGlmIChyZXBseS5kZWxldGVkKSAkbW9kZWwucHJvY2Vzc19hbGxfZGVsZXRpb25zKHJlcGx5LmRlbGV0ZWQpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVE9ETyBpZiAocmVwbHkuc2NyaXB0KSBldmFsIGl0XG5cbiAgICAgICAgLy8gT25seSB0aGVuIGRvIHdlIGhhbmRsZSB0aGUgcmVhbCByZXBseS5cbiAgICAgICAgaWYgKHJlcGx5LmVycm9yKSB7XG4gICAgICAgICAgcmVqZWN0KHJlcGx5LmVycm9yKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB1bmRvX3N0YXRlW2FyZ3NbMV0uc3RhY2tfc3ltYm9sXSA9IHJlcGx5LnVuZG9zdGF0ZTtcbiAgICAgICAgICByZXNvbHZlKHJlcGx5LnZhbHVlKTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgLy8gTWFrZSB0aGUgY2FsbDpcbiAgICAgIGZuLmFwcGx5KG51bGwsIGNvbGxlY3RlZF9hcmdzKTtcbiAgICB9KTtcbiAgfTtcbn1cblxuLy8gVGhlIGRlZmF1bHQgYmVoYXZpb3VyIGZvciBhbGwgbWV0aG9kcyAoYmVmb3JlIGhhdmluZyBiZWVuIGNvcnJlY3RseVxuLy8gaW5zdGFsbGVkKSBpcyB0byByZXR1cm4gYW4gZXJyb3Igc3RhdGluZyB0aGF0IHRoZSBhY3R1YWwgbWV0aG9kXG4vLyBpbXBsZW1lbnRhdGlvbiBpcyBtaXNzaW5nLlxuZnVuY3Rpb24gbm9wKG5hbWUpIHtcbiAgcmV0dXJuICguLi5hcmdzKSA9PiB7XG4gICAgY29uc3QgcmVwbHkgPSBhcmdzW2FyZ3MubGVuZ3RoIC0gMV07XG4gICAgcmVwbHkoe2Vycm9yOiBgTWlzc2luZyBBUEkgb3BlcmF0aW9uIDwke25hbWV9Pi5gfSk7XG4gIH07XG59XG5cbmNvbnN0IHVuZG9fc3RhdGUgPSB7XG4gIHRyZWV2aWV3OiBudWxsLFxuICBjb250YWN0czogbnVsbFxufTtcblxuY29uc3QgYXBpID0ge1xuICByZXNldF91bmRvKHN0YWNrX3N5bWJvbCkge1xuICAgIHVuZG9fc3RhdGVbc3RhY2tfc3ltYm9sXSA9IG51bGw7XG4gIH0sXG4gIGhhc191bmRvKHN0YWNrX3N5bWJvbCkge1xuICAgIHJldHVybiB1bmRvX3N0YXRlW3N0YWNrX3N5bWJvbF0gIT09IG51bGw7XG4gIH0sXG4gIHVuZG9fbmFtZShzdGFja19zeW1ib2wpIHtcbiAgICByZXR1cm4gdW5kb19zdGF0ZVtzdGFja19zeW1ib2xdO1xuICB9LFxuXG4gIC8vIEV2ZW50LXJlbGF0ZWQgZnVuY3Rpb25zXG4gIHNldF9ldmVudF9uYW1lOiBwcm9taXNlZChub3AoJ3NldF9ldmVudF9uYW1lJykpLFxuICBtb3ZlX2V2ZW50OiBwcm9taXNlZChub3AoJ21vdmVfZXZlbnQnKSksXG4gIGFkZF9ldmVudDogcHJvbWlzZWQobm9wKCdhZGRfZXZlbnQnKSksXG4gIHNldF9wcm9kdWN0aW9uZmxhZzogcHJvbWlzZWQobm9wKCdzZXRfcHJvZHVjdGlvbmZsYWcnKSksXG4gIGVkaXRfZXZlbnQ6IHByb21pc2VkKG5vcCgnZWRpdF9ldmVudCcpKSxcbiAgZWRpdF9ncm91cDogcHJvbWlzZWQobm9wKCdlZGl0X2dyb3VwJykpLFxuICBhZGRfZ3JvdXA6IHByb21pc2VkKG5vcCgnYWRkX2dyb3VwJykpLFxuICBncm91cF9ldmVudHM6IHByb21pc2VkKG5vcCgnZ3JvdXBfZXZlbnRzJykpLFxuICByZW1vdmVfZXZlbnRzOiBwcm9taXNlZChub3AoJ3JlbW92ZV9ldmVudHMnKSksXG4gIHJlbW92ZV9ncm91cHNfb25seTogcHJvbWlzZWQobm9wKCdyZW1vdmVfZ3JvdXBzX29ubHknKSksXG4gIHVuZG9fZXZlbnRzOiBwcm9taXNlZChub3AoJ3VuZG9fZXZlbnRzJykpLFxuXG4gIC8vIENvbnRhY3RzLXJlbGF0ZWQgZnVuY3Rpb25zXG4gIGNyZWF0ZV9vcmdhbml6YXRpb246IHByb21pc2VkKG5vcCgnY3JlYXRlX29yZ2FuaXphdGlvbicpKSxcbiAgY3JlYXRlX3BlcnNvbjogcHJvbWlzZWQobm9wKCdjcmVhdGVfcGVyc29uJykpLFxuICBjcmVhdGVfY29udGFjdGxpbmtzOiBwcm9taXNlZChub3AoJ2NyZWF0ZV9jb250YWN0bGlua3MnKSksXG4gIGR1cGxpY2F0ZV9jb250YWN0czogcHJvbWlzZWQobm9wKCdkdXBsaWNhdGVfY29udGFjdHMnKSksXG4gIHJlbW92ZV9jb250YWN0czogcHJvbWlzZWQobm9wKCdyZW1vdmVfY29udGFjdHMnKSksXG4gIHVuZG9fY29udGFjdHM6IHByb21pc2VkKG5vcCgndW5kb19jb250YWN0cycpKSxcblxuICAvLyBHZW5lcmljIGZ1bmN0aW9uc1xuICB1cGRhdGVfbW9kZWw6IHByb21pc2VkKG5vcCgndXBkYXRlX21vZGVsJykpLFxuICByZW1vdmVfZnJvbV9tb2RlbDogcHJvbWlzZWQobm9wKCdyZW1vdmVfZnJvbV9tb2RlbCcpKVxufTtcblxuY29uc3QgeWVzcGxhbmFwaSA9IHtcbiAgX2luc3RhbGw6IChuYW1lLCBmbikgPT4geyBhcGlbbmFtZV0gPSBwcm9taXNlZChmbikgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBuZXcgUHJveHkoeWVzcGxhbmFwaSwge1xuICBnZXQ6ICh0YXJnZXQsIHByb3BlcnR5S2V5KSA9PiB7XG4gICAgaWYoYXBpW3Byb3BlcnR5S2V5XSAhPT0gdW5kZWZpbmVkKSByZXR1cm4gKC4uLmFyZ3MpID0+IGFwaVtwcm9wZXJ0eUtleV0uYXBwbHkodGFyZ2V0LCBhcmdzKTtcbiAgICByZXR1cm4gKC4uLmFyZ3MpID0+IHRhcmdldFtwcm9wZXJ0eUtleV0uYXBwbHkodGFyZ2V0LCBhcmdzKVxuICB9XG59KVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./CommonScripts/sharedscripts/sharedscripts-yesplanapi.js\n");

/***/ }),

/***/ "./Treeview/Coordinate.js":
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": function() { return /* binding */ Coordinate; }\n/* harmony export */ });\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n// Class for a simple X-Y coordinate. Takes zero-to-two arguments:\n// If zero: X and Y coordinate will be null.\n// If one: must be another XY coordinate, and the new one will become a copy.\n// If two: must be two numbers which will become the X and Y values for the\n// new coordinate.\nvar Coordinate = function Coordinate() {\n  _classCallCheck(this, Coordinate);\n  var len = arguments.length;\n  if (len === 0) {\n    this.x = null;\n    this.y = null;\n  } else if (len === 1) {\n    var xy = arguments[0];\n    this.x = xy.x;\n    this.y = xy.y;\n  } else {\n    this.x = arguments[0];\n    this.y = arguments[1];\n  }\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9UcmVldmlldy9Db29yZGluYXRlLmpzLmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL1JlYWN0Q29tcG9uZW50c18vLi9UcmVldmlldy9Db29yZGluYXRlLmpzPzA0M2UiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQ2xhc3MgZm9yIGEgc2ltcGxlIFgtWSBjb29yZGluYXRlLiBUYWtlcyB6ZXJvLXRvLXR3byBhcmd1bWVudHM6XG4vLyBJZiB6ZXJvOiBYIGFuZCBZIGNvb3JkaW5hdGUgd2lsbCBiZSBudWxsLlxuLy8gSWYgb25lOiBtdXN0IGJlIGFub3RoZXIgWFkgY29vcmRpbmF0ZSwgYW5kIHRoZSBuZXcgb25lIHdpbGwgYmVjb21lIGEgY29weS5cbi8vIElmIHR3bzogbXVzdCBiZSB0d28gbnVtYmVycyB3aGljaCB3aWxsIGJlY29tZSB0aGUgWCBhbmQgWSB2YWx1ZXMgZm9yIHRoZVxuLy8gbmV3IGNvb3JkaW5hdGUuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDb29yZGluYXRlIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgY29uc3QgbGVuID0gYXJndW1lbnRzLmxlbmd0aDtcbiAgICBpZiAobGVuID09PSAwKSB7XG4gICAgICB0aGlzLnggPSBudWxsO1xuICAgICAgdGhpcy55ID0gbnVsbDtcbiAgICB9IGVsc2UgaWYgKGxlbiA9PT0gMSkge1xuICAgICAgY29uc3QgeHkgPSBhcmd1bWVudHNbMF07XG4gICAgICB0aGlzLnggPSB4eS54O1xuICAgICAgdGhpcy55ID0geHkueTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy54ID0gYXJndW1lbnRzWzBdO1xuICAgICAgdGhpcy55ID0gYXJndW1lbnRzWzFdO1xuICAgIH1cbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./Treeview/Coordinate.js\n");

/***/ }),

/***/ "./Treeview/DateFormatSettings.js":
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": function() { return /* binding */ DateFormatSettings; }\n/* harmony export */ });\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\nfunction _classStaticPrivateFieldSpecSet(receiver, classConstructor, descriptor, value) { _classCheckPrivateStaticAccess(receiver, classConstructor); _classCheckPrivateStaticFieldDescriptor(descriptor, \"set\"); _classApplyDescriptorSet(receiver, descriptor, value); return value; }\nfunction _classApplyDescriptorSet(receiver, descriptor, value) { if (descriptor.set) { descriptor.set.call(receiver, value); } else { if (!descriptor.writable) { throw new TypeError(\"attempted to set read only private field\"); } descriptor.value = value; } }\nfunction _classStaticPrivateFieldSpecGet(receiver, classConstructor, descriptor) { _classCheckPrivateStaticAccess(receiver, classConstructor); _classCheckPrivateStaticFieldDescriptor(descriptor, \"get\"); return _classApplyDescriptorGet(receiver, descriptor); }\nfunction _classCheckPrivateStaticFieldDescriptor(descriptor, action) { if (descriptor === undefined) { throw new TypeError(\"attempted to \" + action + \" private static field before its declaration\"); } }\nfunction _classCheckPrivateStaticAccess(receiver, classConstructor) { if (receiver !== classConstructor) { throw new TypeError(\"Private static access of wrong provenance\"); } }\nfunction _classApplyDescriptorGet(receiver, descriptor) { if (descriptor.get) { return descriptor.get.call(receiver); } return descriptor.value; }\n// After experimentation, I noticed that the global configuration is already set.\n// Currently how we use it is that we only set it once. So for now, I'm going to leave this in.\nvar DateFormatSettings = /*#__PURE__*/function () {\n  function DateFormatSettings() {\n    _classCallCheck(this, DateFormatSettings);\n  }\n  _createClass(DateFormatSettings, null, [{\n    key: \"getSettings\",\n    value: function getSettings() {\n      return _classStaticPrivateFieldSpecGet(this, DateFormatSettings, _settings);\n    }\n  }, {\n    key: \"setSettings\",\n    value: function setSettings(newSettings) {\n      _classStaticPrivateFieldSpecSet(this, DateFormatSettings, _settings, newSettings);\n    }\n  }]);\n  return DateFormatSettings;\n}();\nvar _settings = {\n  writable: true,\n  value: void 0\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9UcmVldmlldy9EYXRlRm9ybWF0U2V0dGluZ3MuanMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUlBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9SZWFjdENvbXBvbmVudHNfLy4vVHJlZXZpZXcvRGF0ZUZvcm1hdFNldHRpbmdzLmpzPzMyMWMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQWZ0ZXIgZXhwZXJpbWVudGF0aW9uLCBJIG5vdGljZWQgdGhhdCB0aGUgZ2xvYmFsIGNvbmZpZ3VyYXRpb24gaXMgYWxyZWFkeSBzZXQuXG4vLyBDdXJyZW50bHkgaG93IHdlIHVzZSBpdCBpcyB0aGF0IHdlIG9ubHkgc2V0IGl0IG9uY2UuIFNvIGZvciBub3csIEknbSBnb2luZyB0byBsZWF2ZSB0aGlzIGluLlxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRGF0ZUZvcm1hdFNldHRpbmdzIHtcbiAgICBzdGF0aWMgI3NldHRpbmdzO1xuXG4gICAgc3RhdGljIGdldFNldHRpbmdzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy4jc2V0dGluZ3M7XG4gICAgfVxuXG4gICAgc3RhdGljIHNldFNldHRpbmdzKG5ld1NldHRpbmdzKSB7XG4gICAgICAgIHRoaXMuI3NldHRpbmdzID0gbmV3U2V0dGluZ3M7XG4gICAgfVxufSJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./Treeview/DateFormatSettings.js\n");

/***/ }),

/***/ "./Treeview/EventInfoPopover.js":
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": function() { return /* binding */ EventInfoPopover; }\n/* harmony export */ });\n/* harmony import */ var knockout__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./node_modules/knockout/build/output/knockout-latest.js\");\n/* harmony import */ var knockout__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(knockout__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./node_modules/moment/moment.js\");\n/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _CommonScripts_sharedscripts_sharedscripts_datepicker__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"./CommonScripts/sharedscripts/sharedscripts-datepicker.js\");\n/* harmony import */ var _event_treeview__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"./Treeview/event-treeview.js\");\n/* harmony import */ var _DateFormatSettings__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(\"./Treeview/DateFormatSettings.js\");\n/* harmony import */ var _CommonScripts_sharedscripts_sharedscripts_globals__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(\"./CommonScripts/sharedscripts/sharedscripts-globals.js\");\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n/* eslint-disable camelcase, func-names */\n\n\n\n\n\n\nvar EventInfoPopover = /*#__PURE__*/function () {\n  function EventInfoPopover(forest, detached, node, submitOnChange) {\n    _classCallCheck(this, EventInfoPopover);\n    this.forest = forest;\n    this.detached = detached;\n    this.submitOnChange = submitOnChange;\n    this.node = node;\n    if (node) {\n      this.record = node.record;\n    } else {\n      this.record = null;\n    }\n    this.for_group = this.record && (0,_event_treeview__WEBPACK_IMPORTED_MODULE_3__.record_is_group)(this.record);\n    this.popover = this.forest.container.find('.popover.dev-edit-event-popover').clone().removeClass('dev-edit-event-popover'); // we do not want to clone ourselves again when opening multiple popovers\n\n    if (detached) {\n      this.popover.addClass('detached');\n      this.popover.append($('<a class=\"close\" title=\"Close this window.\"></a>'));\n    }\n\n    /* Because React components are not cloned, we recreate them in the current popover */\n    this.commonConfigDatepicker = this.forest.container.find('.popover.dev-edit-event-popover .dev-editevent-datepicker .dev-attachdatepicker').get(0).getConfiguration();\n    var defaultInputDate = null;\n    var defaultPickerDate = null;\n    if (this.record) {\n      var dateForRecord = (0,_event_treeview__WEBPACK_IMPORTED_MODULE_3__.date_for_record)(this.record, this.forest.model);\n      var dateFormat = _DateFormatSettings__WEBPACK_IMPORTED_MODULE_4__[\"default\"].getSettings().dateFormat;\n      defaultInputDate = dateForRecord == null ? null : moment__WEBPACK_IMPORTED_MODULE_1___default()(dateForRecord).format(dateFormat);\n      defaultPickerDate = dateForRecord == null ? null : moment__WEBPACK_IMPORTED_MODULE_1___default()(dateForRecord).format(_CommonScripts_sharedscripts_sharedscripts_globals__WEBPACK_IMPORTED_MODULE_5__.internalJSDateFormat);\n    }\n    var configForDatepicker = Object.assign(this.commonConfigDatepicker, {\n      renderingType: 'input',\n      defaultInputDate: defaultInputDate,\n      defaultPickerDate: defaultPickerDate,\n      scriptOnDateChange: this.record ? EventInfoPopover.prototype.submitChanges.bind(this) : EventInfoPopover.prototype.updateActions.bind(this),\n      datepickerOptions: Object.assign(this.commonConfigDatepicker.datepickerOptions || {}, {\n        attachToElement: null\n      })\n    });\n    if (!this.for_group) {\n      (0,_CommonScripts_sharedscripts_sharedscripts_datepicker__WEBPACK_IMPORTED_MODULE_2__.renderInputDatepickerInElement)(this.popover.find('.dev-editevent-datepicker'), configForDatepicker);\n    } else {\n      (0,_CommonScripts_sharedscripts_sharedscripts_datepicker__WEBPACK_IMPORTED_MODULE_2__.renderInputDatepickerInElement)(this.popover.find('.dev-editgroup-datepicker'), configForDatepicker);\n    }\n    forest.container.append(this.popover);\n    this.lock_icon_holder = this.popover.find('.dev-lock-holder');\n    this.title_field = this.popover.find('input[name=\"title\"]');\n    this.title_field_label = this.popover.find('#treeviewpopover-title-label');\n    this.date_field = this.popover.find('.dev-popover-eventdate .dev-attachdatepicker');\n    this.end_date_field = this.popover.find('input[name=\"enddate\"]');\n    this.date_field_button = this.popover.find('.icon-calendar').parent();\n    this.location_field = this.popover.find('select[name=\"location\"]');\n    this.status_field = this.popover.find('select[name=\"status\"]');\n    this.profile_field = this.popover.find('select[name=\"profile\"]');\n    this.cancel_button = this.popover.find('.cancel');\n    this.submit_button = this.popover.find('.btn-primary');\n    if (!this.for_group) {\n      this.end_date_field.closest('.dev-popover-groupdate').attr('style', 'display: none');\n    } else {\n      this.date_field.closest('.dev-popover-eventdate').attr('style', 'display: none');\n      this.date_field = this.popover.find('.dev-editgroup-datepicker input[data-test-hasdatepicker=\"true\"]');\n    }\n    // Register unlock function\n    if (forest.allow_event_unlocking) {\n      var self = this;\n      this.lock_icon_holder.on('click', '.icon-lock,.icon-lock-open', function () {\n        if (!self.node) return;\n        self.node.set_unlocked(!self.node.is_unlocked());\n        forest.request_update();\n      });\n    }\n\n    // Keep track of the default options\n    this.default_status = this.status_field.find('option[selected=true]');\n    this.default_profile = this.profile_field.find('option[selected=true]');\n    this.default_location = this.location_field.find('option[selected=true]');\n\n    // Set the right label on the title field\n    if (this.for_group) {\n      this.title_field_label.html({\n        intl: intl\n      }.intl.formatMessage({\n        \"id\": \"Group Name\",\n        \"defaultMessage\": \"Group Name\"\n      }));\n    } else {\n      this.title_field_label.html({\n        intl: intl\n      }.intl.formatMessage({\n        \"id\": \"Event Name\",\n        \"defaultMessage\": \"Event Name\"\n      }));\n    }\n    if (this.node && this.node.has_actual_lock()) {\n      this.status_field.prop('title', {\n        intl: intl\n      }.intl.formatMessage({\n        \"id\": \"Some statuses may not be available for selection due to insufficient permissions or because statuses do not allow actuals.\",\n        \"defaultMessage\": \"Some statuses may not be available for selection due to insufficient permissions or because statuses do not allow actuals.\"\n      }));\n    } else {\n      this.status_field.prop('title', {\n        intl: intl\n      }.intl.formatMessage({\n        \"id\": \"Some statuses may not be available for selection due to insufficient permissions.\",\n        \"defaultMessage\": \"Some statuses may not be available for selection due to insufficient permissions.\"\n      }));\n    }\n\n    // The submit and cancel button are not shown if the popover employs submit on change\n    if (submitOnChange) {\n      this.cancel_button.hide();\n      this.submit_button.hide();\n    }\n\n    // Make the popover draggable\n    $(this.popover).draggable();\n\n    // We don't want clicks to seep through to the body, or the popover will get closed\n    this.popover.on('click', function (e) {\n      e.preventDefault();\n    });\n\n    // We need the correctly bound version of this method so it can remove\n    // itself again as a click-listener from the body.\n    this.hide = function (e) {\n      if (e && e.isDefaultPrevented()) return;\n      $('body').off('click', this.hide);\n      // Trigger a blur on the field with the focus to ensure that it is still updated/sending an update to the server\n      this.popover.find(':focus').blur();\n      // Remove the popover from the page\n      this.popover.remove();\n      this.popover = null;\n    }.bind(this);\n\n    // Any change to the input fields should update the popover.\n    // Either we submit the changes immediately, or we update the disablement of the submit button\n    if (submitOnChange) {\n      this.title_field.on('change', EventInfoPopover.prototype.submitChanges.bind(this));\n      this.location_field.on('change', EventInfoPopover.prototype.submitChanges.bind(this));\n      this.status_field.on('change', EventInfoPopover.prototype.submitChanges.bind(this));\n      this.profile_field.on('change', EventInfoPopover.prototype.submitChanges.bind(this));\n    } else {\n      this.title_field.on('input change', EventInfoPopover.prototype.updateActions.bind(this));\n      this.date_field.on('input change', EventInfoPopover.prototype.updateActions.bind(this));\n    }\n\n    // Clicking cancel hides the popover.\n    this.cancel_button.on('click', this.hide.bind(this));\n    this.submit_button.on('click', this.submitChanges.bind(this));\n  }\n\n  // Function that gets the data from the pop over and sends and update to the affected event(s)\n  _createClass(EventInfoPopover, [{\n    key: \"submitChanges\",\n    value: function submitChanges() {\n      if (!this.is_valid()) return;\n      var title = this.title_field.val().trim();\n      var date = this.date_field.val().trim();\n      var location = this.location_field.val();\n      var status = this.status_field.val();\n      var profile = this.profile_field.val();\n      var dateFormat = _DateFormatSettings__WEBPACK_IMPORTED_MODULE_4__[\"default\"].getSettings().dateFormatWithFullYear;\n      date = moment__WEBPACK_IMPORTED_MODULE_1___default()(date, dateFormat);\n      // debugger;\n      if (!this.record) {\n        this.forest.add_event(title, date, location, status, profile);\n      } else if (this.for_group) {\n        this.forest.edit_group((0,_event_treeview__WEBPACK_IMPORTED_MODULE_3__.record_id)(this.record), title, date, status, location, profile);\n      } else {\n        this.forest.edit_event((0,_event_treeview__WEBPACK_IMPORTED_MODULE_3__.record_id)(this.record), title, date, location, status, profile);\n      }\n\n      // If we are not in submit on change modus, then also close the pop-over after the submit of the changes\n      if (!this.submitOnChange) this.hide();\n    }\n  }, {\n    key: \"is_valid\",\n    value: function is_valid() {\n      var title = this.title_field.val().trim();\n      if (title.length === 0) return false;\n      var date = this.date_field.val().trim();\n      if (date.length === 0) return false;\n      try {\n        var dateFormatSettings = _DateFormatSettings__WEBPACK_IMPORTED_MODULE_4__[\"default\"].getSettings();\n        return (0,_CommonScripts_sharedscripts_sharedscripts_datepicker__WEBPACK_IMPORTED_MODULE_2__.isValidDate)(date, dateFormatSettings.dateFormat);\n      } catch (exc) {\n        return false;\n      }\n    }\n  }, {\n    key: \"updateActions\",\n    value:\n    // TODO Clicking outside of a fixed popover enables the submit button...\n    function updateActions() {\n      if (this.is_valid()) {\n        this.submit_button.removeClass('disabled');\n      } else {\n        this.submit_button.addClass('disabled');\n      }\n    }\n  }, {\n    key: \"setData\",\n    value: function setData() {\n      if (this.record) {\n        // Set the lock icon\n        if (this.node && this.node.has_actual_lock()) {\n          this.lock_icon_holder.html('<i class=\"icon-lock-actual\"></i>');\n        } else if (this.node && this.node.has_lock()) {\n          if (this.node.is_not_locked()) {\n            this.lock_icon_holder.html('<i class=\"icon-lock-open\"></i>');\n          } else {\n            this.lock_icon_holder.html('<i class=\"icon-lock\"></i>');\n          }\n        } else {\n          this.lock_icon_holder.html('');\n        }\n\n        // Set the name\n        this.title_field.val(this.record.name());\n\n        // Set the date\n        var date = (0,_event_treeview__WEBPACK_IMPORTED_MODULE_3__.date_for_record)(this.record, this.forest.model);\n        if (date) {\n          this.date_field.trigger('setDate', [moment__WEBPACK_IMPORTED_MODULE_1___default()(date).format(_CommonScripts_sharedscripts_sharedscripts_globals__WEBPACK_IMPORTED_MODULE_5__.internalJSDateFormat)]);\n        } else {\n          this.date_field.val('');\n        }\n\n        // Set the end date if we are editing a group\n        if (this.for_group) {\n          var enddate = (0,_event_treeview__WEBPACK_IMPORTED_MODULE_3__.end_date_for_record)(this.record, this.forest.model);\n          if (enddate) {\n            var dateFormatSettings = _DateFormatSettings__WEBPACK_IMPORTED_MODULE_4__[\"default\"].getSettings();\n            this.end_date_field.val(moment__WEBPACK_IMPORTED_MODULE_1___default()(enddate).format(dateFormatSettings.dateFormatWithFullYear));\n          } else {\n            this.end_date_field.val('');\n          }\n        }\n\n        // Set the location\n        var location = this.node.get_location();\n        var location_id = location ? (0,_event_treeview__WEBPACK_IMPORTED_MODULE_3__.record_id)(location) : false;\n        if (!this.node.is_location_settable()) {\n          /* Hide all other locations */\n          // eslint-disable-next-line func-names\n          this.location_field.find('option').each(function () {\n            $(this).hide();\n          });\n          this.location_field.find('option[value=\"none\"]').show().prop('selected', true);\n        } else if (location_id) {\n          this.location_field.find('option')\n          // eslint-disable-next-line func-names\n          .filter(function () {\n            return $(this).text().trim() === location.name();\n          }).prop('selected', true);\n          this.location_field.find('option[value=\"none\"]').hide();\n        } else {\n          this.location_field.find('option[value=\"none\"]').show().prop('selected', true);\n        }\n\n        // Set the status dropdown values\n        var status = this.node.get_status();\n        var settableStatuses = this.node.get_settable_statuses();\n\n        // Iterate over all the statuses on the page; if they are not in the settable statuses, disable them\n        // eslint-disable-next-line func-names\n        this.status_field.find('option').each(function () {\n          if (settableStatuses.includes($(this).text().trim())) {\n            $(this).prop('disabled', false);\n          } else {\n            $(this).prop('disabled', true);\n          }\n        });\n\n        // If there is a status, then select it, else select the n/a option; hide the n/a if it is not needed\n        if (status || !this.node) {\n          this.status_field.find('option')\n          // eslint-disable-next-line func-names\n          .filter(function () {\n            return $(this).text().trim() === status;\n          }).prop('selected', true);\n          this.status_field.find('option[value=\"none\"]').hide();\n        } else {\n          this.status_field.find('option[value=\"none\"]').show().prop('selected', true);\n        }\n\n        // Set the profile dropdown values\n        var profile = this.node.get_profile();\n\n        // If there is a profile, then select it, else select the n/a option; hide the n/a if it is not needed\n        if (profile || !this.node) {\n          this.profile_field.find('option')\n          // eslint-disable-next-line func-names\n          .filter(function () {\n            return $(this).text().trim() === profile;\n          }).prop('selected', true);\n          this.profile_field.find('option[value=\"none\"]').hide();\n        } else {\n          this.profile_field.find('option[value=\"none\"]').show().prop('selected', true);\n        }\n\n        // Set the locked / write-protected status\n        if (this.node && !this.node.is_not_locked() || !(0,_event_treeview__WEBPACK_IMPORTED_MODULE_3__.record_can_be_written)(this.node.record)) {\n          this.title_field.prop('disabled', true);\n          this.date_field.trigger('setDisablement', [true]);\n          this.location_field.prop('disabled', true);\n          if (!(0,_event_treeview__WEBPACK_IMPORTED_MODULE_3__.record_can_be_written)(this.node.record)) {\n            this.status_field.prop('disabled', true);\n            this.profile_field.prop('disabled', true);\n          }\n        } else {\n          this.title_field.prop('disabled', false);\n          // Check if the date is settable (not a new group without events)\n          if (this.node.is_date_settable()) {\n            this.date_field.trigger('setDisablement', [false]);\n          } else {\n            this.date_field.trigger('setDisablement', [true]);\n          }\n          this.location_field.prop('disabled', false);\n        }\n      } else {\n        // If there is no record... (aka a new event)\n        this.title_field.val('');\n        this.profile_field.find('option[value=\"none\"]').hide();\n        this.status_field.find('option[value=\"none\"]').hide();\n        this.location_field.find('option[value=\"none\"]').hide();\n\n        // Restore the selected options to the defaults of the orginal popover.\n        this.default_status.prop('selected', true);\n        this.default_location.prop('selected', true);\n        this.default_profile.prop('selected', true);\n        this.submit_button.text({\n          intl: intl\n        }.intl.formatMessage({\n          \"id\": \"Add Event\",\n          \"defaultMessage\": \"Add Event\"\n        }));\n      }\n    }\n  }, {\n    key: \"show\",\n    value: function show(e) {\n      var _this = this;\n      // Set all the data of the current record\n      // Use a computed function to make this dependent on the actual record's data\n      knockout__WEBPACK_IMPORTED_MODULE_0___default().computed(function () {\n        _this.setData();\n      }, this)();\n\n      // Update the actions:\n      this.updateActions();\n\n      // Position the popover as needed:\n      if (this.detached && e) {\n        var offset = this.forest.container.offset();\n        var x = e.pageX - offset.left;\n        var y = e.pageY - offset.top;\n\n        // TODO Should take padding/margins into account as well.\n        x = Math.min(x, this.forest.container.width() - this.popover.width());\n        y = Math.min(y, this.forest.container.height() - this.popover.height());\n\n        // TODO Correct positions.\n        this.popover.css('bottom', 'auto').css('right', 'auto').css('left', \"\".concat(x, \"px\")).css('top', \"\".concat(y, \"px\"));\n\n        // Clicking the close icon will close it.\n        this.popover.on('click', '.close', this.hide);\n      } else {\n        // Clicking outside the popover will close it.\n        $('body').on('click', this.hide);\n      }\n      this.popover.css('display', 'block').css('z-index', 100000);\n      this.title_field.focus();\n    }\n  }]);\n  return EventInfoPopover;\n}();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9UcmVldmlldy9FdmVudEluZm9Qb3BvdmVyLmpzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFPQTtBQUNBO0FBQUE7QUFHQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTs7QUFLQTtBQUNBO0FBQ0E7QUFHQTs7QUFFQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUlBO0FBSUE7QUFJQTtBQUNBO0FBSUE7QUFJQTs7QUFFQTtBQUNBO0FBRUE7QUFDQTs7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBUUE7QUFDQTtBQVFBOztBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFFQTtBQUFBO0FBRUE7QUFLQTtBQUVBO0FBQ0E7QUFDQTtBQUlBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUVBO0FBS0E7QUFFQTtBQUNBO0FBQ0E7QUFJQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFFQTtBQUtBO0FBRUE7QUFDQTtBQUNBO0FBSUE7O0FBRUE7QUFDQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9SZWFjdENvbXBvbmVudHNfLy4vVHJlZXZpZXcvRXZlbnRJbmZvUG9wb3Zlci5qcz84MGU3Il0sInNvdXJjZXNDb250ZW50IjpbIi8qIGVzbGludC1kaXNhYmxlIGNhbWVsY2FzZSwgZnVuYy1uYW1lcyAqL1xuaW1wb3J0IGtvIGZyb20gJ2tub2Nrb3V0JztcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcbmltcG9ydCB7aXNWYWxpZERhdGUsIHJlbmRlcklucHV0RGF0ZXBpY2tlckluRWxlbWVudH0gZnJvbSAnLi4vQ29tbW9uU2NyaXB0cy9zaGFyZWRzY3JpcHRzL3NoYXJlZHNjcmlwdHMtZGF0ZXBpY2tlcic7XG5pbXBvcnQge1xuICBkYXRlX2Zvcl9yZWNvcmQsXG4gIGVuZF9kYXRlX2Zvcl9yZWNvcmQsXG4gIHJlY29yZF9jYW5fYmVfd3JpdHRlbixcbiAgcmVjb3JkX2lkLFxuICByZWNvcmRfaXNfZ3JvdXBcbn0gZnJvbSAnLi9ldmVudC10cmVldmlldyc7XG5pbXBvcnQgRGF0ZUZvcm1hdFNldHRpbmdzIGZyb20gJy4vRGF0ZUZvcm1hdFNldHRpbmdzJztcbmltcG9ydCB7aW50ZXJuYWxKU0RhdGVGb3JtYXR9IGZyb20gJy4uL0NvbW1vblNjcmlwdHMvc2hhcmVkc2NyaXB0cy9zaGFyZWRzY3JpcHRzLWdsb2JhbHMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBFdmVudEluZm9Qb3BvdmVyIHtcbiAgY29uc3RydWN0b3IoZm9yZXN0LCBkZXRhY2hlZCwgbm9kZSwgc3VibWl0T25DaGFuZ2UpIHtcbiAgICB0aGlzLmZvcmVzdCA9IGZvcmVzdDtcbiAgICB0aGlzLmRldGFjaGVkID0gZGV0YWNoZWQ7XG4gICAgdGhpcy5zdWJtaXRPbkNoYW5nZSA9IHN1Ym1pdE9uQ2hhbmdlO1xuICAgIHRoaXMubm9kZSA9IG5vZGU7XG5cbiAgICBpZiAobm9kZSkge1xuICAgICAgdGhpcy5yZWNvcmQgPSBub2RlLnJlY29yZDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5yZWNvcmQgPSBudWxsO1xuICAgIH1cblxuICAgIHRoaXMuZm9yX2dyb3VwID0gdGhpcy5yZWNvcmQgJiYgcmVjb3JkX2lzX2dyb3VwKHRoaXMucmVjb3JkKTtcblxuICAgIHRoaXMucG9wb3ZlciA9IHRoaXMuZm9yZXN0LmNvbnRhaW5lclxuICAgICAgLmZpbmQoJy5wb3BvdmVyLmRldi1lZGl0LWV2ZW50LXBvcG92ZXInKVxuICAgICAgLmNsb25lKClcbiAgICAgIC5yZW1vdmVDbGFzcygnZGV2LWVkaXQtZXZlbnQtcG9wb3ZlcicpOyAvLyB3ZSBkbyBub3Qgd2FudCB0byBjbG9uZSBvdXJzZWx2ZXMgYWdhaW4gd2hlbiBvcGVuaW5nIG11bHRpcGxlIHBvcG92ZXJzXG5cbiAgICBpZiAoZGV0YWNoZWQpIHtcbiAgICAgIHRoaXMucG9wb3Zlci5hZGRDbGFzcygnZGV0YWNoZWQnKTtcbiAgICAgIHRoaXMucG9wb3Zlci5hcHBlbmQoXG4gICAgICAgICQoJzxhIGNsYXNzPVwiY2xvc2VcIiB0aXRsZT1cIkNsb3NlIHRoaXMgd2luZG93LlwiPjwvYT4nKVxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvKiBCZWNhdXNlIFJlYWN0IGNvbXBvbmVudHMgYXJlIG5vdCBjbG9uZWQsIHdlIHJlY3JlYXRlIHRoZW0gaW4gdGhlIGN1cnJlbnQgcG9wb3ZlciAqL1xuICAgIHRoaXMuY29tbW9uQ29uZmlnRGF0ZXBpY2tlciA9IHRoaXMuZm9yZXN0LmNvbnRhaW5lclxuICAgICAgLmZpbmQoJy5wb3BvdmVyLmRldi1lZGl0LWV2ZW50LXBvcG92ZXIgLmRldi1lZGl0ZXZlbnQtZGF0ZXBpY2tlciAuZGV2LWF0dGFjaGRhdGVwaWNrZXInKS5nZXQoMCkuZ2V0Q29uZmlndXJhdGlvbigpO1xuXG4gICAgbGV0IGRlZmF1bHRJbnB1dERhdGUgPSBudWxsO1xuICAgIGxldCBkZWZhdWx0UGlja2VyRGF0ZSA9IG51bGw7XG4gICAgaWYgKHRoaXMucmVjb3JkKSB7XG4gICAgICBjb25zdCBkYXRlRm9yUmVjb3JkID0gZGF0ZV9mb3JfcmVjb3JkKHRoaXMucmVjb3JkLCB0aGlzLmZvcmVzdC5tb2RlbCk7XG4gICAgICBjb25zdCBkYXRlRm9ybWF0ID0gRGF0ZUZvcm1hdFNldHRpbmdzLmdldFNldHRpbmdzKCkuZGF0ZUZvcm1hdDtcbiAgICAgIGRlZmF1bHRJbnB1dERhdGUgPSBkYXRlRm9yUmVjb3JkID09IG51bGwgPyBudWxsIDogbW9tZW50KGRhdGVGb3JSZWNvcmQpLmZvcm1hdChkYXRlRm9ybWF0KTtcbiAgICAgIGRlZmF1bHRQaWNrZXJEYXRlID0gZGF0ZUZvclJlY29yZCA9PSBudWxsID8gbnVsbCA6IG1vbWVudChkYXRlRm9yUmVjb3JkKS5mb3JtYXQoaW50ZXJuYWxKU0RhdGVGb3JtYXQpO1xuICAgIH1cblxuICAgIGNvbnN0IGNvbmZpZ0ZvckRhdGVwaWNrZXIgPSAgT2JqZWN0LmFzc2lnbih0aGlzLmNvbW1vbkNvbmZpZ0RhdGVwaWNrZXIsIHtcbiAgICAgIHJlbmRlcmluZ1R5cGU6ICdpbnB1dCcsXG4gICAgICBkZWZhdWx0SW5wdXREYXRlLFxuICAgICAgZGVmYXVsdFBpY2tlckRhdGUsXG4gICAgICBzY3JpcHRPbkRhdGVDaGFuZ2U6IHRoaXMucmVjb3JkID8gRXZlbnRJbmZvUG9wb3Zlci5wcm90b3R5cGUuc3VibWl0Q2hhbmdlcy5iaW5kKHRoaXMpIDogRXZlbnRJbmZvUG9wb3Zlci5wcm90b3R5cGUudXBkYXRlQWN0aW9ucy5iaW5kKHRoaXMpLFxuICAgICAgZGF0ZXBpY2tlck9wdGlvbnM6IE9iamVjdC5hc3NpZ24odGhpcy5jb21tb25Db25maWdEYXRlcGlja2VyLmRhdGVwaWNrZXJPcHRpb25zIHx8IHt9LCB7YXR0YWNoVG9FbGVtZW50OiBudWxsfSlcbiAgICB9KTtcbiAgICBpZiAoIXRoaXMuZm9yX2dyb3VwKSB7XG4gICAgICByZW5kZXJJbnB1dERhdGVwaWNrZXJJbkVsZW1lbnQoXG4gICAgICAgIHRoaXMucG9wb3Zlci5maW5kKCcuZGV2LWVkaXRldmVudC1kYXRlcGlja2VyJyksXG4gICAgICAgIGNvbmZpZ0ZvckRhdGVwaWNrZXJcbiAgICAgICApO1xuICAgIH0gZWxzZSB7XG4gICAgICByZW5kZXJJbnB1dERhdGVwaWNrZXJJbkVsZW1lbnQoXG4gICAgICAgIHRoaXMucG9wb3Zlci5maW5kKCcuZGV2LWVkaXRncm91cC1kYXRlcGlja2VyJyksIGNvbmZpZ0ZvckRhdGVwaWNrZXIpO1xuICAgIH1cblxuICAgIGZvcmVzdC5jb250YWluZXIuYXBwZW5kKHRoaXMucG9wb3Zlcik7XG5cbiAgICB0aGlzLmxvY2tfaWNvbl9ob2xkZXIgPSB0aGlzLnBvcG92ZXIuZmluZCgnLmRldi1sb2NrLWhvbGRlcicpO1xuICAgIHRoaXMudGl0bGVfZmllbGQgPSB0aGlzLnBvcG92ZXIuZmluZCgnaW5wdXRbbmFtZT1cInRpdGxlXCJdJyk7XG4gICAgdGhpcy50aXRsZV9maWVsZF9sYWJlbCA9IHRoaXMucG9wb3Zlci5maW5kKCcjdHJlZXZpZXdwb3BvdmVyLXRpdGxlLWxhYmVsJyk7XG4gICAgdGhpcy5kYXRlX2ZpZWxkID0gdGhpcy5wb3BvdmVyLmZpbmQoJy5kZXYtcG9wb3Zlci1ldmVudGRhdGUgLmRldi1hdHRhY2hkYXRlcGlja2VyJyk7XG4gICAgdGhpcy5lbmRfZGF0ZV9maWVsZCA9IHRoaXMucG9wb3Zlci5maW5kKCdpbnB1dFtuYW1lPVwiZW5kZGF0ZVwiXScpO1xuICAgIHRoaXMuZGF0ZV9maWVsZF9idXR0b24gPSB0aGlzLnBvcG92ZXIuZmluZCgnLmljb24tY2FsZW5kYXInKS5wYXJlbnQoKTtcbiAgICB0aGlzLmxvY2F0aW9uX2ZpZWxkID0gdGhpcy5wb3BvdmVyLmZpbmQoJ3NlbGVjdFtuYW1lPVwibG9jYXRpb25cIl0nKTtcbiAgICB0aGlzLnN0YXR1c19maWVsZCA9IHRoaXMucG9wb3Zlci5maW5kKCdzZWxlY3RbbmFtZT1cInN0YXR1c1wiXScpO1xuICAgIHRoaXMucHJvZmlsZV9maWVsZCA9IHRoaXMucG9wb3Zlci5maW5kKCdzZWxlY3RbbmFtZT1cInByb2ZpbGVcIl0nKTtcbiAgICB0aGlzLmNhbmNlbF9idXR0b24gPSB0aGlzLnBvcG92ZXIuZmluZCgnLmNhbmNlbCcpO1xuICAgIHRoaXMuc3VibWl0X2J1dHRvbiA9IHRoaXMucG9wb3Zlci5maW5kKCcuYnRuLXByaW1hcnknKTtcblxuICAgIGlmICghdGhpcy5mb3JfZ3JvdXApIHtcbiAgICAgIHRoaXMuZW5kX2RhdGVfZmllbGQuY2xvc2VzdCgnLmRldi1wb3BvdmVyLWdyb3VwZGF0ZScpLmF0dHIoJ3N0eWxlJywgJ2Rpc3BsYXk6IG5vbmUnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5kYXRlX2ZpZWxkLmNsb3Nlc3QoJy5kZXYtcG9wb3Zlci1ldmVudGRhdGUnKS5hdHRyKCdzdHlsZScsICdkaXNwbGF5OiBub25lJyk7XG4gICAgICB0aGlzLmRhdGVfZmllbGQgPSB0aGlzLnBvcG92ZXIuZmluZCgnLmRldi1lZGl0Z3JvdXAtZGF0ZXBpY2tlciBpbnB1dFtkYXRhLXRlc3QtaGFzZGF0ZXBpY2tlcj1cInRydWVcIl0nKTtcbiAgICB9XG4gICAgLy8gUmVnaXN0ZXIgdW5sb2NrIGZ1bmN0aW9uXG4gICAgaWYgKGZvcmVzdC5hbGxvd19ldmVudF91bmxvY2tpbmcpIHtcbiAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuICAgICAgdGhpcy5sb2NrX2ljb25faG9sZGVyLm9uKFxuICAgICAgICAnY2xpY2snLFxuICAgICAgICAnLmljb24tbG9jaywuaWNvbi1sb2NrLW9wZW4nLFxuICAgICAgICBmdW5jdGlvbigpIHtcbiAgICAgICAgICBpZiAoIXNlbGYubm9kZSkgcmV0dXJuO1xuICAgICAgICAgIHNlbGYubm9kZS5zZXRfdW5sb2NrZWQoIXNlbGYubm9kZS5pc191bmxvY2tlZCgpKTtcbiAgICAgICAgICBmb3Jlc3QucmVxdWVzdF91cGRhdGUoKTtcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBLZWVwIHRyYWNrIG9mIHRoZSBkZWZhdWx0IG9wdGlvbnNcbiAgICB0aGlzLmRlZmF1bHRfc3RhdHVzID0gdGhpcy5zdGF0dXNfZmllbGQuZmluZCgnb3B0aW9uW3NlbGVjdGVkPXRydWVdJyk7XG4gICAgdGhpcy5kZWZhdWx0X3Byb2ZpbGUgPSB0aGlzLnByb2ZpbGVfZmllbGQuZmluZCgnb3B0aW9uW3NlbGVjdGVkPXRydWVdJyk7XG4gICAgdGhpcy5kZWZhdWx0X2xvY2F0aW9uID0gdGhpcy5sb2NhdGlvbl9maWVsZC5maW5kKCdvcHRpb25bc2VsZWN0ZWQ9dHJ1ZV0nKTtcblxuICAgIC8vIFNldCB0aGUgcmlnaHQgbGFiZWwgb24gdGhlIHRpdGxlIGZpZWxkXG4gICAgaWYgKHRoaXMuZm9yX2dyb3VwKSB7XG4gICAgICB0aGlzLnRpdGxlX2ZpZWxkX2xhYmVsLmh0bWwoaTE4bignR3JvdXAgTmFtZScpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy50aXRsZV9maWVsZF9sYWJlbC5odG1sKGkxOG4oJ0V2ZW50IE5hbWUnKSk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMubm9kZSAmJiB0aGlzLm5vZGUuaGFzX2FjdHVhbF9sb2NrKCkpIHtcbiAgICAgIHRoaXMuc3RhdHVzX2ZpZWxkLnByb3AoJ3RpdGxlJywgaTE4bignU29tZSBzdGF0dXNlcyBtYXkgbm90IGJlIGF2YWlsYWJsZSBmb3Igc2VsZWN0aW9uIGR1ZSB0byBpbnN1ZmZpY2llbnQgcGVybWlzc2lvbnMgb3IgYmVjYXVzZSBzdGF0dXNlcyBkbyBub3QgYWxsb3cgYWN0dWFscy4nKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc3RhdHVzX2ZpZWxkLnByb3AoJ3RpdGxlJywgaTE4bignU29tZSBzdGF0dXNlcyBtYXkgbm90IGJlIGF2YWlsYWJsZSBmb3Igc2VsZWN0aW9uIGR1ZSB0byBpbnN1ZmZpY2llbnQgcGVybWlzc2lvbnMuJykpO1xuICAgIH1cblxuICAgIC8vIFRoZSBzdWJtaXQgYW5kIGNhbmNlbCBidXR0b24gYXJlIG5vdCBzaG93biBpZiB0aGUgcG9wb3ZlciBlbXBsb3lzIHN1Ym1pdCBvbiBjaGFuZ2VcbiAgICBpZiAoc3VibWl0T25DaGFuZ2UpIHtcbiAgICAgIHRoaXMuY2FuY2VsX2J1dHRvbi5oaWRlKCk7XG4gICAgICB0aGlzLnN1Ym1pdF9idXR0b24uaGlkZSgpO1xuICAgIH1cblxuICAgIC8vIE1ha2UgdGhlIHBvcG92ZXIgZHJhZ2dhYmxlXG4gICAgJCh0aGlzLnBvcG92ZXIpLmRyYWdnYWJsZSgpO1xuXG4gICAgLy8gV2UgZG9uJ3Qgd2FudCBjbGlja3MgdG8gc2VlcCB0aHJvdWdoIHRvIHRoZSBib2R5LCBvciB0aGUgcG9wb3ZlciB3aWxsIGdldCBjbG9zZWRcbiAgICB0aGlzLnBvcG92ZXIub24oJ2NsaWNrJywgZnVuY3Rpb24oZSkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH0pO1xuXG4gICAgLy8gV2UgbmVlZCB0aGUgY29ycmVjdGx5IGJvdW5kIHZlcnNpb24gb2YgdGhpcyBtZXRob2Qgc28gaXQgY2FuIHJlbW92ZVxuICAgIC8vIGl0c2VsZiBhZ2FpbiBhcyBhIGNsaWNrLWxpc3RlbmVyIGZyb20gdGhlIGJvZHkuXG4gICAgdGhpcy5oaWRlID0gKGZ1bmN0aW9uKGUpIHtcbiAgICAgIGlmIChlICYmIGUuaXNEZWZhdWx0UHJldmVudGVkKCkpIHJldHVybjtcbiAgICAgICQoJ2JvZHknKS5vZmYoJ2NsaWNrJywgdGhpcy5oaWRlKTtcbiAgICAgIC8vIFRyaWdnZXIgYSBibHVyIG9uIHRoZSBmaWVsZCB3aXRoIHRoZSBmb2N1cyB0byBlbnN1cmUgdGhhdCBpdCBpcyBzdGlsbCB1cGRhdGVkL3NlbmRpbmcgYW4gdXBkYXRlIHRvIHRoZSBzZXJ2ZXJcbiAgICAgIHRoaXMucG9wb3Zlci5maW5kKCc6Zm9jdXMnKS5ibHVyKCk7XG4gICAgICAvLyBSZW1vdmUgdGhlIHBvcG92ZXIgZnJvbSB0aGUgcGFnZVxuICAgICAgdGhpcy5wb3BvdmVyLnJlbW92ZSgpO1xuICAgICAgdGhpcy5wb3BvdmVyID0gbnVsbDtcbiAgICB9KS5iaW5kKHRoaXMpO1xuXG4gICAgLy8gQW55IGNoYW5nZSB0byB0aGUgaW5wdXQgZmllbGRzIHNob3VsZCB1cGRhdGUgdGhlIHBvcG92ZXIuXG4gICAgLy8gRWl0aGVyIHdlIHN1Ym1pdCB0aGUgY2hhbmdlcyBpbW1lZGlhdGVseSwgb3Igd2UgdXBkYXRlIHRoZSBkaXNhYmxlbWVudCBvZiB0aGUgc3VibWl0IGJ1dHRvblxuICAgIGlmIChzdWJtaXRPbkNoYW5nZSkge1xuICAgICAgdGhpcy50aXRsZV9maWVsZC5vbihcbiAgICAgICAgJ2NoYW5nZScsXG4gICAgICAgIEV2ZW50SW5mb1BvcG92ZXIucHJvdG90eXBlLnN1Ym1pdENoYW5nZXMuYmluZCh0aGlzKVxuICAgICAgKTtcbiAgICAgIHRoaXMubG9jYXRpb25fZmllbGQub24oXG4gICAgICAgICdjaGFuZ2UnLFxuICAgICAgICBFdmVudEluZm9Qb3BvdmVyLnByb3RvdHlwZS5zdWJtaXRDaGFuZ2VzLmJpbmQodGhpcylcbiAgICAgICk7XG4gICAgICB0aGlzLnN0YXR1c19maWVsZC5vbihcbiAgICAgICAgJ2NoYW5nZScsXG4gICAgICAgIEV2ZW50SW5mb1BvcG92ZXIucHJvdG90eXBlLnN1Ym1pdENoYW5nZXMuYmluZCh0aGlzKVxuICAgICAgKTtcbiAgICAgIHRoaXMucHJvZmlsZV9maWVsZC5vbihcbiAgICAgICAgJ2NoYW5nZScsXG4gICAgICAgIEV2ZW50SW5mb1BvcG92ZXIucHJvdG90eXBlLnN1Ym1pdENoYW5nZXMuYmluZCh0aGlzKVxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy50aXRsZV9maWVsZC5vbihcbiAgICAgICAgJ2lucHV0IGNoYW5nZScsXG4gICAgICAgIEV2ZW50SW5mb1BvcG92ZXIucHJvdG90eXBlLnVwZGF0ZUFjdGlvbnMuYmluZCh0aGlzKVxuICAgICAgKTtcbiAgICAgIHRoaXMuZGF0ZV9maWVsZC5vbihcbiAgICAgICAgJ2lucHV0IGNoYW5nZScsXG4gICAgICAgIEV2ZW50SW5mb1BvcG92ZXIucHJvdG90eXBlLnVwZGF0ZUFjdGlvbnMuYmluZCh0aGlzKVxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBDbGlja2luZyBjYW5jZWwgaGlkZXMgdGhlIHBvcG92ZXIuXG4gICAgdGhpcy5jYW5jZWxfYnV0dG9uLm9uKCdjbGljaycsIHRoaXMuaGlkZS5iaW5kKHRoaXMpKTtcblxuICAgIHRoaXMuc3VibWl0X2J1dHRvbi5vbignY2xpY2snLCB0aGlzLnN1Ym1pdENoYW5nZXMuYmluZCh0aGlzKSk7XG4gIH1cblxuLy8gRnVuY3Rpb24gdGhhdCBnZXRzIHRoZSBkYXRhIGZyb20gdGhlIHBvcCBvdmVyIGFuZCBzZW5kcyBhbmQgdXBkYXRlIHRvIHRoZSBhZmZlY3RlZCBldmVudChzKVxuICBzdWJtaXRDaGFuZ2VzKCkge1xuICAgIGlmICghdGhpcy5pc192YWxpZCgpKSByZXR1cm47XG5cbiAgICBjb25zdCB0aXRsZSA9IHRoaXMudGl0bGVfZmllbGQudmFsKCkudHJpbSgpO1xuICAgIGxldCBkYXRlID0gdGhpcy5kYXRlX2ZpZWxkLnZhbCgpLnRyaW0oKTtcbiAgICBjb25zdCBsb2NhdGlvbiA9IHRoaXMubG9jYXRpb25fZmllbGQudmFsKCk7XG4gICAgY29uc3Qgc3RhdHVzID0gdGhpcy5zdGF0dXNfZmllbGQudmFsKCk7XG4gICAgY29uc3QgcHJvZmlsZSA9IHRoaXMucHJvZmlsZV9maWVsZC52YWwoKTtcblxuICAgIGNvbnN0IGRhdGVGb3JtYXQgPSBEYXRlRm9ybWF0U2V0dGluZ3MuZ2V0U2V0dGluZ3MoKS5kYXRlRm9ybWF0V2l0aEZ1bGxZZWFyO1xuICAgIGRhdGUgPSBtb21lbnQoZGF0ZSwgZGF0ZUZvcm1hdCk7XG4gICAgLy8gZGVidWdnZXI7XG4gICAgaWYgKCF0aGlzLnJlY29yZCkge1xuICAgICAgdGhpcy5mb3Jlc3QuYWRkX2V2ZW50KHRpdGxlLCBkYXRlLCBsb2NhdGlvbiwgc3RhdHVzLCBwcm9maWxlKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMuZm9yX2dyb3VwKSB7XG4gICAgICB0aGlzLmZvcmVzdC5lZGl0X2dyb3VwKFxuICAgICAgICByZWNvcmRfaWQodGhpcy5yZWNvcmQpLFxuICAgICAgICB0aXRsZSxcbiAgICAgICAgZGF0ZSxcbiAgICAgICAgc3RhdHVzLFxuICAgICAgICBsb2NhdGlvbixcbiAgICAgICAgcHJvZmlsZVxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5mb3Jlc3QuZWRpdF9ldmVudChcbiAgICAgICAgcmVjb3JkX2lkKHRoaXMucmVjb3JkKSxcbiAgICAgICAgdGl0bGUsXG4gICAgICAgIGRhdGUsXG4gICAgICAgIGxvY2F0aW9uLFxuICAgICAgICBzdGF0dXMsXG4gICAgICAgIHByb2ZpbGVcbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gSWYgd2UgYXJlIG5vdCBpbiBzdWJtaXQgb24gY2hhbmdlIG1vZHVzLCB0aGVuIGFsc28gY2xvc2UgdGhlIHBvcC1vdmVyIGFmdGVyIHRoZSBzdWJtaXQgb2YgdGhlIGNoYW5nZXNcbiAgICBpZiAoIXRoaXMuc3VibWl0T25DaGFuZ2UpIHRoaXMuaGlkZSgpO1xuICB9O1xuXG4gIGlzX3ZhbGlkKCkge1xuICAgIGNvbnN0IHRpdGxlID0gdGhpcy50aXRsZV9maWVsZC52YWwoKS50cmltKCk7XG4gICAgaWYgKHRpdGxlLmxlbmd0aCA9PT0gMCkgcmV0dXJuIGZhbHNlO1xuXG4gICAgY29uc3QgZGF0ZSA9IHRoaXMuZGF0ZV9maWVsZC52YWwoKS50cmltKCk7XG4gICAgaWYgKGRhdGUubGVuZ3RoID09PSAwKSByZXR1cm4gZmFsc2U7XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgZGF0ZUZvcm1hdFNldHRpbmdzID0gRGF0ZUZvcm1hdFNldHRpbmdzLmdldFNldHRpbmdzKCk7XG4gICAgICByZXR1cm4gaXNWYWxpZERhdGUoZGF0ZSwgZGF0ZUZvcm1hdFNldHRpbmdzLmRhdGVGb3JtYXQpO1xuICAgIH0gY2F0Y2ggKGV4Yykge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfTtcblxuLy8gVE9ETyBDbGlja2luZyBvdXRzaWRlIG9mIGEgZml4ZWQgcG9wb3ZlciBlbmFibGVzIHRoZSBzdWJtaXQgYnV0dG9uLi4uXG4gIHVwZGF0ZUFjdGlvbnMoKSB7XG4gICAgaWYgKHRoaXMuaXNfdmFsaWQoKSkge1xuICAgICAgdGhpcy5zdWJtaXRfYnV0dG9uLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLnN1Ym1pdF9idXR0b24uYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgfVxuICB9O1xuXG4gIHNldERhdGEoKSB7XG4gICAgaWYgKHRoaXMucmVjb3JkKSB7XG4gICAgICAvLyBTZXQgdGhlIGxvY2sgaWNvblxuICAgICAgaWYgKHRoaXMubm9kZSAmJiB0aGlzLm5vZGUuaGFzX2FjdHVhbF9sb2NrKCkpIHtcbiAgICAgICAgdGhpcy5sb2NrX2ljb25faG9sZGVyLmh0bWwoJzxpIGNsYXNzPVwiaWNvbi1sb2NrLWFjdHVhbFwiPjwvaT4nKTtcbiAgICAgIH0gZWxzZSBpZiAodGhpcy5ub2RlICYmIHRoaXMubm9kZS5oYXNfbG9jaygpKSB7XG4gICAgICAgIGlmICh0aGlzLm5vZGUuaXNfbm90X2xvY2tlZCgpKSB7XG4gICAgICAgICAgdGhpcy5sb2NrX2ljb25faG9sZGVyLmh0bWwoJzxpIGNsYXNzPVwiaWNvbi1sb2NrLW9wZW5cIj48L2k+Jyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5sb2NrX2ljb25faG9sZGVyLmh0bWwoJzxpIGNsYXNzPVwiaWNvbi1sb2NrXCI+PC9pPicpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmxvY2tfaWNvbl9ob2xkZXIuaHRtbCgnJyk7XG4gICAgICB9XG5cbiAgICAgIC8vIFNldCB0aGUgbmFtZVxuICAgICAgdGhpcy50aXRsZV9maWVsZC52YWwodGhpcy5yZWNvcmQubmFtZSgpKTtcblxuICAgICAgLy8gU2V0IHRoZSBkYXRlXG4gICAgICBjb25zdCBkYXRlID0gZGF0ZV9mb3JfcmVjb3JkKHRoaXMucmVjb3JkLCB0aGlzLmZvcmVzdC5tb2RlbCk7XG4gICAgICBpZiAoZGF0ZSkge1xuICAgICAgICB0aGlzLmRhdGVfZmllbGQudHJpZ2dlcignc2V0RGF0ZScsIFttb21lbnQoZGF0ZSkuZm9ybWF0KGludGVybmFsSlNEYXRlRm9ybWF0KV0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5kYXRlX2ZpZWxkLnZhbCgnJyk7XG4gICAgICB9XG5cbiAgICAgIC8vIFNldCB0aGUgZW5kIGRhdGUgaWYgd2UgYXJlIGVkaXRpbmcgYSBncm91cFxuICAgICAgaWYgKHRoaXMuZm9yX2dyb3VwKSB7XG4gICAgICAgIGNvbnN0IGVuZGRhdGUgPSBlbmRfZGF0ZV9mb3JfcmVjb3JkKHRoaXMucmVjb3JkLCB0aGlzLmZvcmVzdC5tb2RlbCk7XG4gICAgICAgIGlmIChlbmRkYXRlKSB7XG4gICAgICAgICAgY29uc3QgZGF0ZUZvcm1hdFNldHRpbmdzID0gRGF0ZUZvcm1hdFNldHRpbmdzLmdldFNldHRpbmdzKCk7XG4gICAgICAgICAgdGhpcy5lbmRfZGF0ZV9maWVsZC52YWwoXG4gICAgICAgICAgICBtb21lbnQoZW5kZGF0ZSkuZm9ybWF0KGRhdGVGb3JtYXRTZXR0aW5ncy5kYXRlRm9ybWF0V2l0aEZ1bGxZZWFyKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5lbmRfZGF0ZV9maWVsZC52YWwoJycpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIFNldCB0aGUgbG9jYXRpb25cbiAgICAgIGNvbnN0IGxvY2F0aW9uID0gdGhpcy5ub2RlLmdldF9sb2NhdGlvbigpO1xuICAgICAgY29uc3QgbG9jYXRpb25faWQgPSBsb2NhdGlvbiA/IHJlY29yZF9pZChsb2NhdGlvbikgOiBmYWxzZTtcblxuICAgICAgaWYgKCF0aGlzLm5vZGUuaXNfbG9jYXRpb25fc2V0dGFibGUoKSkge1xuICAgICAgICAvKiBIaWRlIGFsbCBvdGhlciBsb2NhdGlvbnMgKi9cbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGZ1bmMtbmFtZXNcbiAgICAgICAgdGhpcy5sb2NhdGlvbl9maWVsZC5maW5kKCdvcHRpb24nKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICQodGhpcykuaGlkZSgpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5sb2NhdGlvbl9maWVsZFxuICAgICAgICAgIC5maW5kKCdvcHRpb25bdmFsdWU9XCJub25lXCJdJylcbiAgICAgICAgICAuc2hvdygpXG4gICAgICAgICAgLnByb3AoJ3NlbGVjdGVkJywgdHJ1ZSk7XG4gICAgICB9IGVsc2UgaWYgKGxvY2F0aW9uX2lkKSB7XG4gICAgICAgIHRoaXMubG9jYXRpb25fZmllbGRcbiAgICAgICAgICAuZmluZCgnb3B0aW9uJylcbiAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZnVuYy1uYW1lc1xuICAgICAgICAgIC5maWx0ZXIoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICAkKHRoaXMpXG4gICAgICAgICAgICAgICAgLnRleHQoKVxuICAgICAgICAgICAgICAgIC50cmltKCkgPT09IGxvY2F0aW9uLm5hbWUoKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5wcm9wKCdzZWxlY3RlZCcsIHRydWUpO1xuICAgICAgICB0aGlzLmxvY2F0aW9uX2ZpZWxkLmZpbmQoJ29wdGlvblt2YWx1ZT1cIm5vbmVcIl0nKS5oaWRlKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLmxvY2F0aW9uX2ZpZWxkXG4gICAgICAgICAgLmZpbmQoJ29wdGlvblt2YWx1ZT1cIm5vbmVcIl0nKVxuICAgICAgICAgIC5zaG93KClcbiAgICAgICAgICAucHJvcCgnc2VsZWN0ZWQnLCB0cnVlKTtcbiAgICAgIH1cblxuICAgICAgLy8gU2V0IHRoZSBzdGF0dXMgZHJvcGRvd24gdmFsdWVzXG4gICAgICBjb25zdCBzdGF0dXMgPSB0aGlzLm5vZGUuZ2V0X3N0YXR1cygpO1xuICAgICAgY29uc3Qgc2V0dGFibGVTdGF0dXNlcyA9IHRoaXMubm9kZS5nZXRfc2V0dGFibGVfc3RhdHVzZXMoKTtcblxuICAgICAgLy8gSXRlcmF0ZSBvdmVyIGFsbCB0aGUgc3RhdHVzZXMgb24gdGhlIHBhZ2U7IGlmIHRoZXkgYXJlIG5vdCBpbiB0aGUgc2V0dGFibGUgc3RhdHVzZXMsIGRpc2FibGUgdGhlbVxuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGZ1bmMtbmFtZXNcbiAgICAgIHRoaXMuc3RhdHVzX2ZpZWxkLmZpbmQoJ29wdGlvbicpLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmIChcbiAgICAgICAgICBzZXR0YWJsZVN0YXR1c2VzLmluY2x1ZGVzKFxuICAgICAgICAgICAgJCh0aGlzKVxuICAgICAgICAgICAgICAudGV4dCgpXG4gICAgICAgICAgICAgIC50cmltKClcbiAgICAgICAgICApXG4gICAgICAgICkge1xuICAgICAgICAgICQodGhpcykucHJvcCgnZGlzYWJsZWQnLCBmYWxzZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgJCh0aGlzKS5wcm9wKCdkaXNhYmxlZCcsIHRydWUpO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgLy8gSWYgdGhlcmUgaXMgYSBzdGF0dXMsIHRoZW4gc2VsZWN0IGl0LCBlbHNlIHNlbGVjdCB0aGUgbi9hIG9wdGlvbjsgaGlkZSB0aGUgbi9hIGlmIGl0IGlzIG5vdCBuZWVkZWRcbiAgICAgIGlmIChzdGF0dXMgfHwgIXRoaXMubm9kZSkge1xuICAgICAgICB0aGlzLnN0YXR1c19maWVsZFxuICAgICAgICAgIC5maW5kKCdvcHRpb24nKVxuICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBmdW5jLW5hbWVzXG4gICAgICAgICAgLmZpbHRlcihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICQodGhpcylcbiAgICAgICAgICAgICAgICAudGV4dCgpXG4gICAgICAgICAgICAgICAgLnRyaW0oKSA9PT0gc3RhdHVzXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLnByb3AoJ3NlbGVjdGVkJywgdHJ1ZSk7XG4gICAgICAgIHRoaXMuc3RhdHVzX2ZpZWxkLmZpbmQoJ29wdGlvblt2YWx1ZT1cIm5vbmVcIl0nKS5oaWRlKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnN0YXR1c19maWVsZFxuICAgICAgICAgIC5maW5kKCdvcHRpb25bdmFsdWU9XCJub25lXCJdJylcbiAgICAgICAgICAuc2hvdygpXG4gICAgICAgICAgLnByb3AoJ3NlbGVjdGVkJywgdHJ1ZSk7XG4gICAgICB9XG5cbiAgICAgIC8vIFNldCB0aGUgcHJvZmlsZSBkcm9wZG93biB2YWx1ZXNcbiAgICAgIGNvbnN0IHByb2ZpbGUgPSB0aGlzLm5vZGUuZ2V0X3Byb2ZpbGUoKTtcblxuICAgICAgLy8gSWYgdGhlcmUgaXMgYSBwcm9maWxlLCB0aGVuIHNlbGVjdCBpdCwgZWxzZSBzZWxlY3QgdGhlIG4vYSBvcHRpb247IGhpZGUgdGhlIG4vYSBpZiBpdCBpcyBub3QgbmVlZGVkXG4gICAgICBpZiAocHJvZmlsZSB8fCAhdGhpcy5ub2RlKSB7XG4gICAgICAgIHRoaXMucHJvZmlsZV9maWVsZFxuICAgICAgICAgIC5maW5kKCdvcHRpb24nKVxuICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBmdW5jLW5hbWVzXG4gICAgICAgICAgLmZpbHRlcihmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAgICQodGhpcylcbiAgICAgICAgICAgICAgICAudGV4dCgpXG4gICAgICAgICAgICAgICAgLnRyaW0oKSA9PT0gcHJvZmlsZVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5wcm9wKCdzZWxlY3RlZCcsIHRydWUpO1xuICAgICAgICB0aGlzLnByb2ZpbGVfZmllbGQuZmluZCgnb3B0aW9uW3ZhbHVlPVwibm9uZVwiXScpLmhpZGUoKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMucHJvZmlsZV9maWVsZFxuICAgICAgICAgIC5maW5kKCdvcHRpb25bdmFsdWU9XCJub25lXCJdJylcbiAgICAgICAgICAuc2hvdygpXG4gICAgICAgICAgLnByb3AoJ3NlbGVjdGVkJywgdHJ1ZSk7XG4gICAgICB9XG5cbiAgICAgIC8vIFNldCB0aGUgbG9ja2VkIC8gd3JpdGUtcHJvdGVjdGVkIHN0YXR1c1xuICAgICAgaWYgKFxuICAgICAgICAodGhpcy5ub2RlICYmICF0aGlzLm5vZGUuaXNfbm90X2xvY2tlZCgpKSB8fFxuICAgICAgICAhcmVjb3JkX2Nhbl9iZV93cml0dGVuKHRoaXMubm9kZS5yZWNvcmQpXG4gICAgICApIHtcbiAgICAgICAgdGhpcy50aXRsZV9maWVsZC5wcm9wKCdkaXNhYmxlZCcsIHRydWUpO1xuICAgICAgICB0aGlzLmRhdGVfZmllbGQudHJpZ2dlcignc2V0RGlzYWJsZW1lbnQnLCBbdHJ1ZV0pO1xuICAgICAgICB0aGlzLmxvY2F0aW9uX2ZpZWxkLnByb3AoJ2Rpc2FibGVkJywgdHJ1ZSk7XG4gICAgICAgIGlmICghcmVjb3JkX2Nhbl9iZV93cml0dGVuKHRoaXMubm9kZS5yZWNvcmQpKSB7XG4gICAgICAgICAgdGhpcy5zdGF0dXNfZmllbGQucHJvcCgnZGlzYWJsZWQnLCB0cnVlKTtcbiAgICAgICAgICB0aGlzLnByb2ZpbGVfZmllbGQucHJvcCgnZGlzYWJsZWQnLCB0cnVlKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy50aXRsZV9maWVsZC5wcm9wKCdkaXNhYmxlZCcsIGZhbHNlKTtcbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIGRhdGUgaXMgc2V0dGFibGUgKG5vdCBhIG5ldyBncm91cCB3aXRob3V0IGV2ZW50cylcbiAgICAgICAgaWYgKHRoaXMubm9kZS5pc19kYXRlX3NldHRhYmxlKCkpIHtcbiAgICAgICAgICB0aGlzLmRhdGVfZmllbGQudHJpZ2dlcignc2V0RGlzYWJsZW1lbnQnLCBbZmFsc2VdKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0aGlzLmRhdGVfZmllbGQudHJpZ2dlcignc2V0RGlzYWJsZW1lbnQnLCBbdHJ1ZV0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMubG9jYXRpb25fZmllbGQucHJvcCgnZGlzYWJsZWQnLCBmYWxzZSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIC8vIElmIHRoZXJlIGlzIG5vIHJlY29yZC4uLiAoYWthIGEgbmV3IGV2ZW50KVxuICAgICAgdGhpcy50aXRsZV9maWVsZC52YWwoJycpO1xuXG4gICAgICB0aGlzLnByb2ZpbGVfZmllbGQuZmluZCgnb3B0aW9uW3ZhbHVlPVwibm9uZVwiXScpLmhpZGUoKTtcbiAgICAgIHRoaXMuc3RhdHVzX2ZpZWxkLmZpbmQoJ29wdGlvblt2YWx1ZT1cIm5vbmVcIl0nKS5oaWRlKCk7XG4gICAgICB0aGlzLmxvY2F0aW9uX2ZpZWxkLmZpbmQoJ29wdGlvblt2YWx1ZT1cIm5vbmVcIl0nKS5oaWRlKCk7XG5cbiAgICAgIC8vIFJlc3RvcmUgdGhlIHNlbGVjdGVkIG9wdGlvbnMgdG8gdGhlIGRlZmF1bHRzIG9mIHRoZSBvcmdpbmFsIHBvcG92ZXIuXG4gICAgICB0aGlzLmRlZmF1bHRfc3RhdHVzLnByb3AoJ3NlbGVjdGVkJywgdHJ1ZSk7XG4gICAgICB0aGlzLmRlZmF1bHRfbG9jYXRpb24ucHJvcCgnc2VsZWN0ZWQnLCB0cnVlKTtcbiAgICAgIHRoaXMuZGVmYXVsdF9wcm9maWxlLnByb3AoJ3NlbGVjdGVkJywgdHJ1ZSk7XG5cbiAgICAgIHRoaXMuc3VibWl0X2J1dHRvbi50ZXh0KGkxOG4oJ0FkZCBFdmVudCcpKTtcbiAgICB9XG4gIH07XG5cbiAgc2hvdyhlKSB7XG4gICAgLy8gU2V0IGFsbCB0aGUgZGF0YSBvZiB0aGUgY3VycmVudCByZWNvcmRcbiAgICAvLyBVc2UgYSBjb21wdXRlZCBmdW5jdGlvbiB0byBtYWtlIHRoaXMgZGVwZW5kZW50IG9uIHRoZSBhY3R1YWwgcmVjb3JkJ3MgZGF0YVxuICAgIGtvLmNvbXB1dGVkKCgpID0+IHtcbiAgICAgIHRoaXMuc2V0RGF0YSgpO1xuICAgIH0sIHRoaXMpKCk7XG5cbiAgICAvLyBVcGRhdGUgdGhlIGFjdGlvbnM6XG4gICAgdGhpcy51cGRhdGVBY3Rpb25zKCk7XG5cbiAgICAvLyBQb3NpdGlvbiB0aGUgcG9wb3ZlciBhcyBuZWVkZWQ6XG4gICAgaWYgKHRoaXMuZGV0YWNoZWQgJiYgZSkge1xuICAgICAgY29uc3Qgb2Zmc2V0ID0gdGhpcy5mb3Jlc3QuY29udGFpbmVyLm9mZnNldCgpO1xuICAgICAgbGV0IHggPSBlLnBhZ2VYIC0gb2Zmc2V0LmxlZnQ7XG4gICAgICBsZXQgeSA9IGUucGFnZVkgLSBvZmZzZXQudG9wO1xuXG4gICAgICAvLyBUT0RPIFNob3VsZCB0YWtlIHBhZGRpbmcvbWFyZ2lucyBpbnRvIGFjY291bnQgYXMgd2VsbC5cbiAgICAgIHggPSBNYXRoLm1pbih4LCB0aGlzLmZvcmVzdC5jb250YWluZXIud2lkdGgoKSAtIHRoaXMucG9wb3Zlci53aWR0aCgpKTtcbiAgICAgIHkgPSBNYXRoLm1pbih5LCB0aGlzLmZvcmVzdC5jb250YWluZXIuaGVpZ2h0KCkgLSB0aGlzLnBvcG92ZXIuaGVpZ2h0KCkpO1xuXG4gICAgICAvLyBUT0RPIENvcnJlY3QgcG9zaXRpb25zLlxuICAgICAgdGhpcy5wb3BvdmVyXG4gICAgICAgIC5jc3MoJ2JvdHRvbScsICdhdXRvJylcbiAgICAgICAgLmNzcygncmlnaHQnLCAnYXV0bycpXG4gICAgICAgIC5jc3MoJ2xlZnQnLCBgJHt4fXB4YClcbiAgICAgICAgLmNzcygndG9wJywgYCR7eX1weGApO1xuXG4gICAgICAvLyBDbGlja2luZyB0aGUgY2xvc2UgaWNvbiB3aWxsIGNsb3NlIGl0LlxuICAgICAgdGhpcy5wb3BvdmVyLm9uKCdjbGljaycsICcuY2xvc2UnLCB0aGlzLmhpZGUpO1xuICAgIH0gZWxzZSB7XG4gICAgICAvLyBDbGlja2luZyBvdXRzaWRlIHRoZSBwb3BvdmVyIHdpbGwgY2xvc2UgaXQuXG4gICAgICAkKCdib2R5Jykub24oJ2NsaWNrJywgdGhpcy5oaWRlKTtcbiAgICB9XG5cbiAgICB0aGlzLnBvcG92ZXIuY3NzKCdkaXNwbGF5JywgJ2Jsb2NrJykuY3NzKCd6LWluZGV4JywgMTAwMDAwKTtcblxuICAgIHRoaXMudGl0bGVfZmllbGQuZm9jdXMoKTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./Treeview/EventInfoPopover.js\n");

/***/ }),

/***/ "./Treeview/Forest.js":
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": function() { return /* binding */ Forest; }\n/* harmony export */ });\n/* harmony import */ var knockout__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./node_modules/knockout/build/output/knockout-latest.js\");\n/* harmony import */ var knockout__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(knockout__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _EventInfoPopover__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./Treeview/EventInfoPopover.js\");\n/* harmony import */ var _Tree__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"./Treeview/Tree.js\");\n/* harmony import */ var _Node__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"./Treeview/Node.js\");\n/* harmony import */ var _event_treeview__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(\"./Treeview/event-treeview.js\");\n/* harmony import */ var _PlaceholderNode__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(\"./Treeview/PlaceholderNode.js\");\n/* harmony import */ var _tree_selections__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(\"./Treeview/tree_selections.js\");\n/* harmony import */ var _CommonScripts_sharedscripts_sharedscripts_yesplanapi__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(\"./CommonScripts/sharedscripts/sharedscripts-yesplanapi.js\");\n/* harmony import */ var _CommonScripts_sharedscripts_sharedscripts_modalconfirmation__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(\"./CommonScripts/sharedscripts/sharedscripts-modalconfirmation.js\");\n/* harmony import */ var _CommonScripts_sharedscripts_sharedscripts_npcommon__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(\"./CommonScripts/sharedscripts/sharedscripts-npcommon.js\");\n/* harmony import */ var _CommonScripts_sharedscripts_sharedscripts_contextmenu__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(\"./CommonScripts/sharedscripts/sharedscripts-contextmenu.js\");\n/* harmony import */ var _DateFormatSettings__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(\"./Treeview/DateFormatSettings.js\");\n/* harmony import */ var _CommonScripts_sharedscripts_sharedscripts_globals__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(\"./CommonScripts/sharedscripts/sharedscripts-globals.js\");\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n/* eslint-disable camelcase, func-names */\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar Forest = /*#__PURE__*/function () {\n  function Forest(container_selector, root_ids, initial_selection, permissions, model) {\n    _classCallCheck(this, Forest);\n    this.container_selector = container_selector;\n    this.container = $(container_selector);\n    this.model = model;\n    this.panel = $(\"\".concat(this.container_selector, \" .event-tree\"));\n    this.node_instance_count = 0;\n    this.allow_event_creation = permissions.create_capability;\n    this.allow_event_unlocking = permissions.unlock_capability;\n    this.show_location_abbreviation = permissions.show_locations;\n\n    // D3 does not like it when we continuously create new data elements\n    // for data it already knows about. It seems to ignore the new stuff in\n    // favour of the old. So we want to recycle the existing data elements\n    // instead, which is why we keep track of them.\n    this.nodes = {};\n\n    // This helps restoring tree roots in combination with 'undo' actions:\n    this.once_active_roots = {};\n\n    // The currently selected nodes (if any):\n    this.selected = knockout__WEBPACK_IMPORTED_MODULE_0___default().observableArray([]);\n    var i;\n    // If an initial selection was given, apply it:\n    if ((0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.is_defined)(initial_selection)) {\n      for (i = 0; i < initial_selection.length; i++) {\n        (0,_tree_selections__WEBPACK_IMPORTED_MODULE_6__.select_node)(this.node_for_record(initial_selection[i]));\n      }\n    }\n\n    // This holds the actual trees:\n    this.trees = [];\n    for (i = 0; i < root_ids.length; i++) {\n      this.add_tree(this.node_for_record(root_ids[i]));\n    }\n\n    // The currently running action (if any):\n    this.running_action = knockout__WEBPACK_IMPORTED_MODULE_0___default().observable(null);\n\n    // Clear my undostack\n    _CommonScripts_sharedscripts_sharedscripts_yesplanapi__WEBPACK_IMPORTED_MODULE_7__[\"default\"].reset_undo('treeview');\n    this.node_being_dragged = null;\n\n    // Set up all interactions:\n    this.setup_mouse_actions();\n    this.setup_context_menu();\n    this.setup_buttons();\n    this.setup_drag_and_drop();\n  }\n\n  // Add a new tree with the given node as its root.\n  _createClass(Forest, [{\n    key: \"add_tree\",\n    value: function add_tree(node) {\n      this.trees.push(new _Tree__WEBPACK_IMPORTED_MODULE_2__[\"default\"](this, node));\n      this.once_active_roots[node.get_key()] = true;\n    }\n  }, {\n    key: \"node_for_record_or_null\",\n    value:\n    // Find the existing node for a given record id, or return null if none\n    // exists.\n    function node_for_record_or_null(record_id) {\n      return this.nodes[record_id] || null;\n    }\n  }, {\n    key: \"node_for_record\",\n    value:\n    // Nodes should not be instantiated directly, but fetched through this\n    // function. This will create nodes as needed, reusing existing nodes when\n    // possible.\n    function node_for_record(record_id) {\n      return this.node_for_record_or_null(record_id) || new _Node__WEBPACK_IMPORTED_MODULE_3__[\"default\"](this, this.model.get(record_id));\n    }\n  }, {\n    key: \"index_of_tree\",\n    value:\n    // Where is the given root in this forest ?\n    function index_of_tree(root) {\n      for (var i = 0; i < this.trees.length; i++) {\n        if (this.trees[i].root === root) return i;\n      }\n      return -1;\n    }\n  }, {\n    key: \"has_tree\",\n    value:\n    // Is there a tree for the given root in this forest ?\n    function has_tree(root) {\n      return this.index_of_tree(root) >= 0;\n    }\n  }, {\n    key: \"get_tree\",\n    value:\n    // Return the tree for the given root in this forest.\n    function get_tree(root) {\n      for (var i = 0; i < this.trees.length; i++) {\n        if (this.trees[i].root === root) return this.trees[i];\n      }\n      return null;\n    }\n  }, {\n    key: \"remove_tree\",\n    value:\n    // Remove the tree for the given root from this forest.\n    function remove_tree(root) {\n      var index = this.index_of_tree(root);\n      if (index < 0) return;\n      var tree = this.trees[index];\n      this.trees.splice(index, 1);\n      tree.dispose();\n    }\n  }, {\n    key: \"hide_tree\",\n    value:\n    // Hide the tree for the given root from this forest.\n    function hide_tree(root) {\n      // Need to remove it from the model because it will get restored after an undo otherwise\n      this.model.remove(root.record);\n    }\n  }, {\n    key: \"try_to_restore_former_trees\",\n    value:\n    // Try to display roots that were displayed before when they still are in the model\n    function try_to_restore_former_trees() {\n      var _this = this;\n      var once_active_roots_still_in_model = Object.keys(this.once_active_roots).filter(function (record_id) {\n        return _this.model.get(record_id, null) !== null;\n      });\n      for (var i = 0; i < once_active_roots_still_in_model.length; i++) {\n        this.show_node(once_active_roots_still_in_model[i]);\n      }\n    }\n  }, {\n    key: \"show_node\",\n    value:\n    // Makes sure the requested node is part of a tree rooted in this forest.\n    function show_node(node_or_record_id) {\n      var node = node_or_record_id;\n      if (typeof node_or_record_id === 'string' || node_or_record_id instanceof String) {\n        node = this.node_for_record(node_or_record_id);\n      }\n      if (node === null) return;\n      if (node instanceof _PlaceholderNode__WEBPACK_IMPORTED_MODULE_5__[\"default\"]) {\n        // Expecting this to be a record_id in this case...\n        // TODO Make sure of that.\n        var parent_node = node.parent;\n        node.eject(node_or_record_id);\n        node = this.node_for_record(node_or_record_id);\n        parent_node.rebuild_subnodes();\n      }\n      var root_record = node.record;\n      while (root_record.pt()) {\n        root_record = this.model.get(root_record.pt());\n        this.node_for_record((0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.record_id)(root_record)).collapsed = false;\n      }\n      var root_node = this.node_for_record((0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.record_id)(root_record));\n      if (!this.has_tree(root_node)) this.add_tree(root_node);\n      root_node.collapsed = false;\n    }\n  }, {\n    key: \"request_update\",\n    value: function request_update() {\n      // Remove the 'empty start' page\n      if (this.trees.length > 0) $('.tree-editor-empty').remove();\n      for (var i = 0; i < this.trees.length; i++) {\n        this.trees[i].request_update();\n      }\n    }\n  }, {\n    key: \"request_update_promise\",\n    value: function request_update_promise() {\n      var all_promises = [];\n\n      // Remove the 'empty start' page\n      if (this.trees.length > 0) $('.tree-editor-empty').remove();\n      for (var i = 0; i < this.trees.length; i++) {\n        all_promises.push(this.trees[i].request_update_promise());\n      }\n      return Promise.all(all_promises);\n    }\n  }, {\n    key: \"dispose\",\n    value:\n    // Destroy the forest. (Not recommended in real life.)\n    function dispose() {\n      var i;\n      for (i = 0; i < this.trees.length; i++) {\n        this.trees[i].dispose();\n      }\n      var ids = Object.keys(this.nodes);\n      for (i = 0; i < ids.length; i++) {\n        var node = this.nodes[ids[i]];\n        if (node) node.dispose();\n      }\n    }\n  }, {\n    key: \"productionflag_of_selected_nodes\",\n    value: function productionflag_of_selected_nodes() {\n      return this.selected().reduce(function (value, it) {\n        return it.is_production() && value;\n      }, true);\n    }\n  }, {\n    key: \"is_max_single_node_selected\",\n    value:\n    // Returns true if there is no selection or when there is at most one node selected\n    function is_max_single_node_selected() {\n      return this.selected().length <= 1;\n    }\n  }, {\n    key: \"is_write_events_allowed\",\n    value:\n    // --------------------------------------------------------------------------\n    // Permissions\n\n    function is_write_events_allowed() {\n      return this.selected().every(function (it) {\n        return (0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.record_can_be_written)(it.record);\n      });\n    }\n  }, {\n    key: \"is_delete_events_allowed\",\n    value: function is_delete_events_allowed() {\n      return this.selected().every(function (it) {\n        return it.can_be_deleted();\n      });\n    }\n  }, {\n    key: \"is_delete_group_only_allowed\",\n    value: function is_delete_group_only_allowed() {\n      return this.selected().every(function (it) {\n        return it.can_be_group_only_deleted();\n      });\n    }\n  }, {\n    key: \"create_request\",\n    value:\n    // --------------------------------------------------------------------------\n    // Actions\n\n    function create_request(action_name, object) {\n      return _objectSpread({\n        action_name: action_name,\n        stack_symbol: 'treeview'\n      }, object);\n    }\n  }, {\n    key: \"add_event\",\n    value: function add_event(name, date, location, status, profile) {\n      var forest = this;\n      var request = this.create_request({\n        intl: intl\n      }.intl.formatMessage({\n        \"id\": \"New Event\",\n        \"defaultMessage\": \"New Event\"\n      }), {\n        name: name,\n        date: date.format(_CommonScripts_sharedscripts_sharedscripts_globals__WEBPACK_IMPORTED_MODULE_12__.internalJSDateFormat),\n        location: location,\n        status: status,\n        profile: profile\n      });\n\n      // Where should the new event go ? Depends on the selection.\n      if (this.selected().length === 1) {\n        var selected = forest.selected()[0];\n\n        // In case a group was selected, the new event should belong to that\n        // group.\n        if (selected.is_group()) {\n          request.parent = (0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.record_id)(selected.record);\n        } // Otherwise, if an event in a group was selected, the new event\n        // should become a sibling of the selected event.\n        else if (!selected.is_root() && selected.parent.is_group()) {\n          request.parent = (0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.record_id)(selected.parent.record);\n        }\n\n        // In all other cases the new event will not have a parent defined.\n      }\n\n      this.running_action({\n        add_event: request\n      });\n      var new_event_node = null;\n      _CommonScripts_sharedscripts_sharedscripts_yesplanapi__WEBPACK_IMPORTED_MODULE_7__[\"default\"].add_event(this.model, request).then(function (new_event_ids) {\n        this.show_node(new_event_ids[0]);\n        new_event_node = this.node_for_record(new_event_ids[0]);\n        (0,_tree_selections__WEBPACK_IMPORTED_MODULE_6__.single_select_node)(new_event_node);\n        new_event_node.highlight_as_new = true;\n        this.running_action(null);\n      }.bind(this)).then(function () {\n        return forest.request_update_promise();\n      }).then(function () {\n        new_event_node.scroll_to_it();\n      }).catch(function (error) {\n        forest.running_action(null);\n        (0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.handle_error)(error);\n      });\n    }\n  }, {\n    key: \"edit_event\",\n    value: function edit_event(record_id, name, date, location, status, profile) {\n      var forest = this;\n      var request = this.create_request({\n        intl: intl\n      }.intl.formatMessage({\n        \"id\": \"Edit Event\",\n        \"defaultMessage\": \"Edit Event\"\n      }), {\n        id: record_id,\n        name: name,\n        date: date.format(_CommonScripts_sharedscripts_sharedscripts_globals__WEBPACK_IMPORTED_MODULE_12__.internalJSDateFormat),\n        location: location,\n        status: status,\n        profile: profile\n      });\n      this.running_action({\n        edit_event: request\n      });\n      _CommonScripts_sharedscripts_sharedscripts_yesplanapi__WEBPACK_IMPORTED_MODULE_7__[\"default\"].edit_event(this.model, request).then(function () {\n        this.show_node(record_id);\n        this.running_action(null);\n        forest.request_update();\n      }.bind(this)).catch(function (error) {\n        forest.running_action(null);\n        (0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.handle_error)(error);\n      });\n    }\n  }, {\n    key: \"edit_group\",\n    value: function edit_group(record_id, name, date, status, location, profile) {\n      var forest = this;\n      var request = this.create_request({\n        intl: intl\n      }.intl.formatMessage({\n        \"id\": \"Edit Group\",\n        \"defaultMessage\": \"Edit Group\"\n      }), {\n        id: record_id,\n        name: name,\n        date: date.format(_CommonScripts_sharedscripts_sharedscripts_globals__WEBPACK_IMPORTED_MODULE_12__.internalJSDateFormat),\n        status: status,\n        location: location,\n        profile: profile\n      });\n      this.running_action({\n        edit_group: request\n      });\n      _CommonScripts_sharedscripts_sharedscripts_yesplanapi__WEBPACK_IMPORTED_MODULE_7__[\"default\"].edit_group(this.model, request).then(function () {\n        this.show_node(record_id);\n        this.running_action(null);\n        forest.request_update();\n      }.bind(this)).catch(function (error) {\n        forest.running_action(null);\n        (0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.handle_error)(error);\n      });\n    }\n  }, {\n    key: \"set_productionflag\",\n    value: function set_productionflag() {\n      var forest = this;\n      if (forest.selected().length === 0) return;\n      var selected_event_ids = forest.selected().map(function (it) {\n        return (0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.record_id)(it.record);\n      });\n      var pflag = !this.productionflag_of_selected_nodes();\n      var request = this.create_request({\n        intl: intl\n      }.intl.formatMessage({\n        \"id\": \"Set Production\",\n        \"defaultMessage\": \"Set Production\"\n      }), {\n        events: selected_event_ids,\n        productionflag: pflag\n      });\n      forest.running_action({\n        set_productionflag: request\n      });\n      _CommonScripts_sharedscripts_sharedscripts_yesplanapi__WEBPACK_IMPORTED_MODULE_7__[\"default\"].set_productionflag(this.model, request).then(function () {\n        forest.deselect_all();\n        forest.request_update();\n        forest.running_action(null);\n      }).catch(function (error) {\n        forest.running_action(null);\n        (0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.handle_error)(error);\n      });\n    }\n  }, {\n    key: \"add_new_group\",\n    value: function add_new_group() {\n      var forest = this;\n      var request = this.create_request({\n        intl: intl\n      }.intl.formatMessage({\n        \"id\": \"New Group\",\n        \"defaultMessage\": \"New Group\"\n      }), {});\n\n      // Where should the new group go ? Depends on the selection.\n      if (this.selected().length === 1) {\n        var selected = forest.selected()[0];\n\n        // In case a group was selected, the new group should belong to that\n        // group.\n        if (selected.is_group()) {\n          request.parent = (0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.record_id)(selected.record);\n        } // Otherwise, if an event in a group was selected, the new group\n        // should become a sibling of the selected event.\n        else if (!selected.is_root() && selected.parent.is_group()) {\n          request.parent = (0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.record_id)(selected.parent.record);\n        }\n\n        // In all other cases the new group will not have a parent defined.\n      }\n\n      forest.running_action({\n        add_group: request\n      });\n      var new_group_node = null;\n      _CommonScripts_sharedscripts_sharedscripts_yesplanapi__WEBPACK_IMPORTED_MODULE_7__[\"default\"].add_group(this.model, request).then(function (new_group_ids) {\n        forest.show_node(new_group_ids[0]);\n        new_group_node = forest.node_for_record(new_group_ids[0]);\n        (0,_tree_selections__WEBPACK_IMPORTED_MODULE_6__.single_select_node)(new_group_node);\n        new_group_node.highlight_as_new = true;\n        forest.running_action(null);\n      }).then(function () {\n        return forest.request_update_promise();\n      }).then(function () {\n        new_group_node.scroll_to_it();\n        (0,_tree_selections__WEBPACK_IMPORTED_MODULE_6__.start_editing_event_name)(new_group_node, new_group_node.element.find('.label .name'), forest.model);\n      }).catch(function (error) {\n        forest.running_action(null);\n        (0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.handle_error)(error);\n      });\n    }\n  }, {\n    key: \"group_selected\",\n    value: function group_selected() {\n      var forest = this;\n      if (forest.selected().length === 0) return;\n      var selected_event_ids = forest.selected().map(function (it) {\n        return (0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.record_id)(it.record);\n      });\n      var request = this.create_request({\n        intl: intl\n      }.intl.formatMessage({\n        \"id\": \"#VERB#Group\",\n        \"defaultMessage\": \"#VERB#Group\"\n      }), {\n        events: selected_event_ids\n      });\n      forest.running_action({\n        group_events: request\n      });\n      var new_group_node;\n      _CommonScripts_sharedscripts_sharedscripts_yesplanapi__WEBPACK_IMPORTED_MODULE_7__[\"default\"].group_events(this.model, request).then(function (new_group_ids) {\n        forest.show_node(new_group_ids[0]);\n        new_group_node = forest.node_for_record(new_group_ids[0]);\n        new_group_node.collapsed = false;\n        new_group_node.highlight_as_new = true;\n        forest.deselect_all();\n        forest.request_update();\n        forest.running_action(null);\n      }).then(function () {\n        return forest.request_update_promise();\n      }).then(function () {\n        new_group_node.scroll_to_it();\n      }).catch(function (error) {\n        forest.running_action(null);\n        (0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.handle_error)(error);\n      });\n    }\n  }, {\n    key: \"remove_selected\",\n    value: function remove_selected() {\n      var forest = this;\n      if (forest.selected().length === 0) return;\n      var selected_event_ids = forest.selected().map(function (it) {\n        return (0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.record_id)(it.record);\n      });\n      var request = this.create_request({\n        intl: intl\n      }.intl.formatMessage({\n        \"id\": \"Delete\",\n        \"defaultMessage\": \"Delete\"\n      }), {\n        events: selected_event_ids\n      });\n      var callback = function callback() {\n        forest.running_action({\n          remove_events: request\n        });\n        _CommonScripts_sharedscripts_sharedscripts_yesplanapi__WEBPACK_IMPORTED_MODULE_7__[\"default\"].remove_events(forest.model, request).then(function () {\n          forest.deselect_all();\n          forest.request_update();\n          forest.running_action(null);\n        }).catch(function (error) {\n          forest.running_action(null);\n          (0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.handle_error)(error);\n        });\n      };\n      if (selected_event_ids.length === 1) {\n        callback();\n      } else {\n        (0,_CommonScripts_sharedscripts_sharedscripts_modalconfirmation__WEBPACK_IMPORTED_MODULE_8__.confirmationModal)({\n          title: {\n            intl: intl\n          }.intl.formatMessage({\n            \"id\": \"Are You Sure?\",\n            \"defaultMessage\": \"Are You Sure?\"\n          }),\n          confirmation_label: {\n            intl: intl\n          }.intl.formatMessage({\n            \"id\": \"Continue\",\n            \"defaultMessage\": \"Continue\"\n          }),\n          cancel_label: {\n            intl: intl\n          }.intl.formatMessage({\n            \"id\": \"Cancel\",\n            \"defaultMessage\": \"Cancel\"\n          }),\n          message: \"<p>\".concat({\n            intl: intl\n          }.intl.formatMessage({\n            \"id\": \"This action will delete {number} events. Are you sure you want to continue?\",\n            \"defaultMessage\": \"This action will delete {number} events. Are you sure you want to continue?\"\n          }).replace('{number}', selected_event_ids.length.toString()), \"</p>\"),\n          callback: callback\n        });\n      }\n    }\n  }, {\n    key: \"remove_group_only_selected\",\n    value: function remove_group_only_selected() {\n      var forest = this;\n      if (forest.selected().length === 0) return;\n      var selected_group_ids = forest.selected().filter(function (it) {\n        return it.is_group();\n      }).map(function (it) {\n        return (0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.record_id)(it.record);\n      });\n      var request = this.create_request({\n        intl: intl\n      }.intl.formatMessage({\n        \"id\": \"Delete Group Only\",\n        \"defaultMessage\": \"Delete Group Only\"\n      }), {\n        group_ids: selected_group_ids\n      });\n      forest.running_action({\n        remove_groups_only: request\n      });\n      _CommonScripts_sharedscripts_sharedscripts_yesplanapi__WEBPACK_IMPORTED_MODULE_7__[\"default\"].remove_groups_only(this.model, request).then(function (root_nodes_to_show_ids) {\n        forest.deselect_all();\n        // If any placeholder nodes would become root nodes, first eject them (prevents update error later on)\n        root_nodes_to_show_ids.forEach(function (root_node_to_show_id) {\n          var node = forest.node_for_record(root_node_to_show_id);\n          if (node instanceof _PlaceholderNode__WEBPACK_IMPORTED_MODULE_5__[\"default\"]) node.eject(root_node_to_show_id);\n        });\n        root_nodes_to_show_ids.forEach(function (root_node_to_show_id) {\n          forest.show_node(root_node_to_show_id);\n        });\n        forest.request_update();\n        forest.running_action(null);\n      }).catch(function (error) {\n        forest.running_action(null);\n        (0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.handle_error)(error);\n      });\n    }\n  }, {\n    key: \"undo_last_action\",\n    value: function undo_last_action() {\n      var forest = this;\n      var request = this.create_request({\n        intl: intl\n      }.intl.formatMessage({\n        \"id\": \"Undo\",\n        \"defaultMessage\": \"Undo\"\n      }), {});\n      forest.running_action({\n        undo: request\n      });\n      _CommonScripts_sharedscripts_sharedscripts_yesplanapi__WEBPACK_IMPORTED_MODULE_7__[\"default\"].undo_events(this.model, request).then(function () {\n        forest.deselect_all();\n        forest.try_to_restore_former_trees();\n        forest.request_update();\n        forest.running_action(null);\n      }).catch(function (error) {\n        forest.running_action(null);\n        (0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.handle_error)(error);\n      });\n    }\n  }, {\n    key: \"collapse_selected\",\n    value: function collapse_selected() {\n      var selected = this.selected();\n      for (var i = 0; i < selected.length; i++) {\n        var selected_node = selected[i];\n        if (selected_node instanceof _PlaceholderNode__WEBPACK_IMPORTED_MODULE_5__[\"default\"]) continue;\n        if (!(0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.record_is_group)(selected_node.record)) {\n          selected_node = selected_node.parent;\n        }\n        if (!selected_node) continue;\n        selected_node.rebuild_subnodes();\n      }\n      this.request_update();\n    }\n  }, {\n    key: \"hide_selected\",\n    value: function hide_selected() {\n      var forest = this;\n      var selected_roots = _.uniq(this.selected().map(function (n) {\n        return n.get_root();\n      }));\n      var request = this.create_request('Hide', {\n        ids: selected_roots.map(function (it) {\n          return (0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.record_id)(it.record);\n        })\n      });\n      forest.running_action({\n        remove_from_model: request\n      });\n      _CommonScripts_sharedscripts_sharedscripts_yesplanapi__WEBPACK_IMPORTED_MODULE_7__[\"default\"].remove_from_model(this.model, request).then(function () {\n        selected_roots.forEach(function (n) {\n          forest.hide_tree(n);\n        });\n        forest.request_update();\n        forest.running_action(null);\n      }).catch(function (error) {\n        forest.running_action(null);\n        (0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.handle_error)(error);\n      });\n    }\n  }, {\n    key: \"extend_with\",\n    value: function extend_with(event_id) {\n      var forest = this;\n      var request = this.create_request('Extend', {});\n      forest.running_action({\n        extend: request\n      });\n      var event_node = null;\n      _CommonScripts_sharedscripts_sharedscripts_yesplanapi__WEBPACK_IMPORTED_MODULE_7__[\"default\"].update_model(this.model, request).then(function () {\n        this.show_node(event_id);\n        event_node = this.node_for_record(event_id);\n        if (event_node instanceof _PlaceholderNode__WEBPACK_IMPORTED_MODULE_5__[\"default\"]) {\n          event_node.expand();\n          event_node = this.node_for_record(event_id);\n        }\n        (0,_tree_selections__WEBPACK_IMPORTED_MODULE_6__.single_select_node)(event_node);\n        this.running_action(null);\n      }.bind(this)).then(function () {\n        return forest.request_update_promise();\n      }).then(function () {\n        event_node.scroll_to_it();\n      }).catch(function (error) {\n        forest.running_action(null);\n        (0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.handle_error)(error);\n      });\n    }\n  }, {\n    key: \"setup_mouse_actions\",\n    value:\n    // --------------------------------------------------------------------------\n    // Interactions\n\n    function setup_mouse_actions() {\n      var forest = this;\n\n      // Clicking the \"void\" should deselect all events.\n      this.panel.on('click', function (e) {\n        // Checking whether we actually clicked the \"void\" or not...\n        // if ($(e.target).closest('.tree-event').length) return\n        if (e.isDefaultPrevented()) return;\n        forest.deselect_all();\n        forest.request_update();\n      });\n\n      // Clicking a group's toggle toggles the visibility of its children.\n      this.panel.on('click', '.toggle', function (e) {\n        var node = d3.select(e.target).data()[0];\n        if (!node) return;\n        e.preventDefault();\n        (0,_tree_selections__WEBPACK_IMPORTED_MODULE_6__.toggle_visibility_of_subtree)(node);\n        node.get_tree().request_update();\n      });\n\n      // Hovering over the conflict icon shows the conflict messages\n      this.panel.on('mouseenter', '.icon-conflict', function (e) {\n        // lookup node and conflict item container\n        var popover = $('.dev-conflict-popover');\n        var conflictitems = $('.dev-conflict-popover .popover-container');\n        var node = d3.select(e.target).data()[0];\n\n        // do not show popover when node itself does not have conflicts\n        if (!(0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.node_has_conflicts)(node)) return;\n\n        // remove existing conflicts\n        $('.dev-conflict-popover .conflict-item,.dev-conflict-popover .conflict-title').remove();\n\n        // cancel the action to hide the popover\n        clearTimeout(popover.data('hidepopover'));\n        // remove the handler\n        popover.data('hidepopover', null);\n\n        // render conflicts per conflict category; use the predefined order of the categories\n        var conflictsPerCategory = (0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.node_conflicts)(node);\n        ['event', 'resource', 'contract'].forEach(function (category) {\n          var conflictsInCategory = conflictsPerCategory[category];\n          if (conflictsInCategory) {\n            var conflicts = conflictsInCategory[0];\n            var title = conflictsInCategory[1];\n            var titleMarkup = $('<strong class=\\'conflict-title\\'>').append(title);\n            conflictitems.append(titleMarkup);\n            conflicts.forEach(function (conflictMessage) {\n              var conflictItem = $('<div class=\\'conflict-item\\'>').append(conflictMessage);\n              conflictitems.append(conflictItem);\n            });\n          }\n        });\n\n        // show conflict popover\n        var offset = forest.container.offset();\n        // do not use e.pageX coordinate because the  mouse x position is not always in the middle of the target\n        // hence we need to work with offset of the target\n        var x = $(e.target).offset().left + $(e.target).width() - offset.left;\n        // do not use e.pageY coordinate because the  mouse y position is not always in the middle of the target\n        // hence we need to work with offset of the target\n        // the middle of the target ($(e.target).height() / 2) is compensated by the poper tip correction, so it is okay to take the top\n        var y = $(e.target).offset().top - offset.top;\n\n        // TODO Should take padding/margins into account as well.\n        x = Math.min(x, forest.container.width() - popover.width());\n        y = Math.min(y, forest.container.height() - popover.height());\n\n        // display using positions based on outer bounds of popover\n        // only then we can compensate for the popover tip cause the tip is not present in the dom but only in css\n        popover.css('bottom', 'auto').css('right', 'auto').css('left', \"\".concat(x, \"px\")).css('top', \"\".concat(y, \"px\")).css('display', 'block');\n\n        // adjust positions such that popover tip points right to the click position. Correct the y coordinate with magic number 2\n        y = y - ($('.dev-conflict-popover .popover-container').offset().top - popover.offset().top) - 2;\n        x += $('.dev-conflict-popover .popover-container').offset().left - popover.offset().left;\n        popover.css('bottom', 'auto').css('right', 'auto').css('left', \"\".concat(x, \"px\")).css('top', \"\".concat(y, \"px\")).css('display', 'block');\n      });\n      this.panel.on('mouseleave', '.icon-conflict', function (e) {\n        var node = d3.select(e.target).data()[0];\n\n        // do not show popover when node itself does not have conflicts\n        if (!(0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.node_has_conflicts)(node)) return;\n        var popover = $('.dev-conflict-popover');\n        // only install one handler to delay the action to hide the popover\n        if (popover.data('hidepopover') == null) {\n          popover.data('hidepopover', setTimeout(function () {\n            // hide the popover\n            popover.css('display', 'none');\n            // remove the handler\n            popover.data('hidepopover', null);\n          }, 300));\n        }\n      });\n      $('.dev-conflict-popover').mouseenter(function () {\n        // cancel the action to hide the popover when hovering over the popover\n        clearTimeout($('.dev-conflict-popover').data('hidepopover'));\n        // remove the handler\n        $('.dev-conflict-popover').data('hidepopover', null);\n      }).mouseleave(function () {\n        // immediatly hide the popover when leaving the conflict popover\n        $('.dev-conflict-popover').css('display', 'none');\n      });\n\n      // Clicking an event's label selects it. Unless it's a placeholder node, in\n      // which case we expand the placeholder instead.\n      this.panel.on('click', '.label', function (e) {\n        var node = d3.select(e.target).data()[0];\n        if (!node) return;\n        e.preventDefault();\n        if (node instanceof _PlaceholderNode__WEBPACK_IMPORTED_MODULE_5__[\"default\"]) {\n          // Clicking a placeholder node expands it.\n          node.expand();\n          node.get_tree().request_update();\n          return;\n        }\n\n        // Are we starting a new selection, or are we adding to the old one ?\n        var should_clear_existing_selection = !(0,_CommonScripts_sharedscripts_sharedscripts_npcommon__WEBPACK_IMPORTED_MODULE_9__.hasMetaKey)(e);\n        if (should_clear_existing_selection) node.forest.deselect_all();\n        if (node.selected) {\n          /* if(e.altKey)\n                deselect_subtree(node)\n            else */\n          (0,_tree_selections__WEBPACK_IMPORTED_MODULE_6__.deselect_node)(node);\n        } else {\n          /* if(e.altKey)\n              select_subtree(node)\n            else */\n          (0,_tree_selections__WEBPACK_IMPORTED_MODULE_6__.select_node)(node);\n        }\n        node.get_tree().request_update();\n      });\n\n      // Double clicking an event's name makes it editable:\n      this.panel.on('dblclick', '.name', function (e) {\n        var node = d3.select(e.target).data()[0];\n        if (!node) return;\n        if (!(0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.record_can_be_written)(node.record)) return;\n        if (!node.is_not_locked()) return;\n        e.preventDefault();\n        (0,_tree_selections__WEBPACK_IMPORTED_MODULE_6__.single_select_node)(node);\n\n        // The original label:\n        var label = $(this);\n        (0,_tree_selections__WEBPACK_IMPORTED_MODULE_6__.start_editing_event_name)(node, label, forest.model);\n      });\n      if (this.allow_event_unlocking) {\n        this.panel.on('click', '.lock:not(.lock--actual)', function (e) {\n          var node = d3.select(e.target).data()[0];\n          // If there is no node or if we are clicking on a placeholder node, we call it quits.\n          if (!node) return;\n          if (node instanceof _PlaceholderNode__WEBPACK_IMPORTED_MODULE_5__[\"default\"]) return;\n          e.preventDefault();\n          node.set_unlocked(!node.is_unlocked());\n          forest.request_update();\n        });\n      }\n    }\n  }, {\n    key: \"setup_context_menu\",\n    value: function setup_context_menu() {\n      var forest = this;\n      var menu = null;\n      this.panel.on('contextmenu', function (e) {\n        // If the context menu was invoked on a node in one of the trees, we may\n        // need to do some special logic.\n        var tree_event = $(e.target).closest('.tree-event');\n        if (tree_event.length) {\n          // The context menu was invoked on this node:\n          var node = d3.select(tree_event.get(0)).data()[0];\n\n          // If that node is a placeholder we expand it and call it quits.\n          if (node instanceof _PlaceholderNode__WEBPACK_IMPORTED_MODULE_5__[\"default\"]) {\n            e.preventDefault();\n            node.expand();\n            forest.request_update();\n            if (menu) menu.close();\n            return;\n          }\n\n          // Otherwise we update the node selection before continuing on.\n          if (!node.selected) {\n            if ((0,_CommonScripts_sharedscripts_sharedscripts_npcommon__WEBPACK_IMPORTED_MODULE_9__.hasMetaKey)(e)) {\n              (0,_tree_selections__WEBPACK_IMPORTED_MODULE_6__.select_node)(node);\n            } else {\n              (0,_tree_selections__WEBPACK_IMPORTED_MODULE_6__.single_select_node)(node);\n            }\n          }\n          // If we are not opened on a node (i.e. background), deselect all\n        } else {\n          forest.deselect_all();\n        }\n\n        // The menu is created as needed:\n        if (menu === null) {\n          menu = new _CommonScripts_sharedscripts_sharedscripts_contextmenu__WEBPACK_IMPORTED_MODULE_10__.SharedscriptsContextmenu([{\n            id: 'add-event',\n            text: {\n              intl: intl\n            }.intl.formatMessage({\n              \"id\": \"New Event...\",\n              \"defaultMessage\": \"New Event...\"\n            }),\n            fn: function fn(e) {\n              forest.show_event_info_popover(e, null);\n            }\n          }, {\n            id: 'add-group',\n            text: {\n              intl: intl\n            }.intl.formatMessage({\n              \"id\": \"New Group\",\n              \"defaultMessage\": \"New Group\"\n            }),\n            fn: function fn() {\n              forest.add_new_group();\n            }\n          }, {\n            a: 'separator'\n          }, {\n            id: 'edit',\n            text: {\n              intl: intl\n            }.intl.formatMessage({\n              \"id\": \"Edit Event...\",\n              \"defaultMessage\": \"Edit Event...\"\n            }),\n            fn: function fn(e) {\n              forest.show_event_info_popover(e, forest.selected()[0]);\n            }\n          }, {\n            id: 'setproductionflag',\n            text: {\n              intl: intl\n            }.intl.formatMessage({\n              \"id\": \"Set Production\",\n              \"defaultMessage\": \"Set Production\"\n            }),\n            fn: function fn() {\n              forest.set_productionflag();\n            }\n          }, {\n            a: 'separator'\n          }, {\n            id: 'group',\n            text: {\n              intl: intl\n            }.intl.formatMessage({\n              \"id\": \"#VERB#Group\",\n              \"defaultMessage\": \"#VERB#Group\"\n            }),\n            fn: function fn() {\n              forest.group_selected();\n            }\n          }, {\n            id: 'delete',\n            text: {\n              intl: intl\n            }.intl.formatMessage({\n              \"id\": \"Delete\",\n              \"defaultMessage\": \"Delete\"\n            }),\n            fn: function fn() {\n              forest.remove_selected();\n            }\n          }, {\n            id: 'delete-group',\n            text: {\n              intl: intl\n            }.intl.formatMessage({\n              \"id\": \"Delete Group Only\",\n              \"defaultMessage\": \"Delete Group Only\"\n            }),\n            fn: function fn() {\n              forest.remove_group_only_selected();\n            }\n          }, {\n            a: 'separator'\n          }, {\n            id: 'undo',\n            text: {\n              intl: intl\n            }.intl.formatMessage({\n              \"id\": \"Undo\",\n              \"defaultMessage\": \"Undo\"\n            }),\n            fn: function fn() {\n              forest.undo_last_action();\n            }\n          }, {\n            a: 'separator'\n          }, {\n            id: 'hide',\n            text: {\n              intl: intl\n            }.intl.formatMessage({\n              \"id\": \"Hide\",\n              \"defaultMessage\": \"Hide\"\n            }),\n            fn: function fn() {\n              forest.hide_selected();\n            }\n          }, {\n            id: 'collapse',\n            text: {\n              intl: intl\n            }.intl.formatMessage({\n              \"id\": \"Summarize\",\n              \"defaultMessage\": \"Summarize\"\n            }),\n            fn: function fn() {\n              forest.collapse_selected();\n            }\n          }]);\n        }\n\n        // No actions allowed while one is running:\n        if (forest.running_action() !== null) {\n          menu.disable_all();\n        } // Otherwise actions are allowed:\n        else {\n          menu.enable_all();\n        }\n\n        // Undo action allowed when yesplan says there is an undo action\n        if (!_CommonScripts_sharedscripts_sharedscripts_yesplanapi__WEBPACK_IMPORTED_MODULE_7__[\"default\"].has_undo('treeview')) {\n          menu.disable('undo');\n        } else {\n          menu.set_text('undo', \"\".concat({\n            intl: intl\n          }.intl.formatMessage({\n            \"id\": \"Undo\",\n            \"defaultMessage\": \"Undo\"\n          }), \" \").concat(_CommonScripts_sharedscripts_sharedscripts_yesplanapi__WEBPACK_IMPORTED_MODULE_7__[\"default\"].undo_name('treeview')));\n        }\n\n        // Except for those requiring an active selection when there is none:\n        if (forest.selected().length === 0) {\n          menu.disable('group');\n          menu.disable('delete');\n          menu.disable('delete-group');\n          menu.disable('setproductionflag');\n          menu.disable('collapse');\n          menu.disable('edit');\n          menu.disable('hide');\n        }\n\n        // Except for those requiring maximum a single active selection being a group:\n        if (!forest.is_max_single_node_selected()) {\n          menu.disable('add-group');\n          menu.disable('add-event');\n          menu.disable('edit');\n        }\n\n        // 'Delete Group Only' requires only groups to be selected\n        if (forest.selected().some(function (e) {\n          return !e.is_group();\n        })) {\n          menu.disable('delete-group');\n        }\n\n        // Except for those requiring certain permissions\n        if (!forest.allow_event_creation || !forest.is_write_events_allowed()) {\n          menu.disable('add-event');\n          menu.disable('add-group');\n          menu.disable('group');\n        }\n        if (!forest.is_write_events_allowed()) {\n          menu.disable('group');\n          menu.disable('setproductionflag');\n        }\n        if (!forest.is_delete_events_allowed()) menu.disable('delete');\n        if (!forest.is_delete_group_only_allowed()) menu.disable('delete-group');\n\n        // Show Edit group or Edit event\n        if (forest.selected().length === 1 && forest.selected()[0].is_group()) {\n          menu.set_text('edit', {\n            intl: intl\n          }.intl.formatMessage({\n            \"id\": \"Edit Group...\",\n            \"defaultMessage\": \"Edit Group...\"\n          }));\n        } else {\n          menu.set_text('edit', {\n            intl: intl\n          }.intl.formatMessage({\n            \"id\": \"Edit Event...\",\n            \"defaultMessage\": \"Edit Event...\"\n          }));\n        }\n\n        // Adapt the Set Production action label to indicate if we will set or unset the production\n        if (forest.productionflag_of_selected_nodes()) {\n          menu.set_text('setproductionflag', {\n            intl: intl\n          }.intl.formatMessage({\n            \"id\": \"Unset Production\",\n            \"defaultMessage\": \"Unset Production\"\n          }));\n        } else {\n          menu.set_text('setproductionflag', {\n            intl: intl\n          }.intl.formatMessage({\n            \"id\": \"Set Production\",\n            \"defaultMessage\": \"Set Production\"\n          }));\n        }\n\n        // And shown on the page.\n        e.preventDefault();\n        menu.show(e.pageX, e.pageY);\n      });\n    }\n  }, {\n    key: \"setup_buttons\",\n    value: function setup_buttons() {\n      var forest = this;\n\n      // Enables/Disables the 'group/remove selected' buttons as needed.\n      knockout__WEBPACK_IMPORTED_MODULE_0___default().computed(function () {\n        // No actions allowed while one is running:\n        if (this.running_action() !== null) {\n          $(\"\".concat(this.container_selector, \" .btn\")).addClass('disabled');\n          return;\n        }\n\n        // Otherwise actions are allowed:\n        $(\"\".concat(this.container_selector, \" .btn\")).removeClass('disabled');\n\n        // Undo action allowed when yesplan says there is an undo action\n        if (!_CommonScripts_sharedscripts_sharedscripts_yesplanapi__WEBPACK_IMPORTED_MODULE_7__[\"default\"].has_undo('treeview')) {\n          $(\"\".concat(this.container_selector, \" .btn.action_undo\")).addClass('disabled').html({\n            intl: intl\n          }.intl.formatMessage({\n            \"id\": \"Undo\",\n            \"defaultMessage\": \"Undo\"\n          }));\n        } else {\n          $(\"\".concat(this.container_selector, \" .btn.action_undo\")).html(\"\".concat({\n            intl: intl\n          }.intl.formatMessage({\n            \"id\": \"Undo\",\n            \"defaultMessage\": \"Undo\"\n          }), \" \").concat(_CommonScripts_sharedscripts_sharedscripts_yesplanapi__WEBPACK_IMPORTED_MODULE_7__[\"default\"].undo_name('treeview')));\n        }\n\n        // Except for those requiring certain permissions\n        if (!forest.allow_event_creation || !forest.is_write_events_allowed() || !forest.is_max_single_node_selected()) {\n          $(\"\".concat(this.container_selector, \" .btn.action_new_event\")).addClass('disabled');\n          $(\"\".concat(this.container_selector, \" .btn.action_new_group\")).addClass('disabled');\n        }\n      }, this);\n      this.container.on('click', '.btn.action_new_event:not(.disabled)', function (e) {\n        e.preventDefault();\n        this.show_event_info_popover(null, null);\n      }.bind(this));\n\n      // Clicking the 'new group' button creates a new group.\n      this.container.on('click', '.btn.action_new_group:not(.disabled)', function (e) {\n        e.preventDefault();\n        forest.add_new_group();\n      });\n\n      // Clicking the 'group selected' button creates a new group holding the\n      // selected events.\n      this.container.on('click', '.btn.action_group_selected', function (e) {\n        e.preventDefault();\n        forest.group_selected();\n      });\n\n      // Clicking the 'remove selected' button removes all selected events.\n      this.container.on('click', '.btn.action_remove_selected', function (e) {\n        e.preventDefault();\n        forest.remove_selected();\n      });\n\n      // Clicking the 'undo' button removes all selected events.\n      this.container.on('click', '.btn.action_undo', function (e) {\n        e.preventDefault();\n        forest.undo_last_action();\n      });\n    }\n  }, {\n    key: \"show_event_info_popover\",\n    value: function show_event_info_popover(e, node) {\n      // If invoked via context menu:\n      if (e) {\n        new _EventInfoPopover__WEBPACK_IMPORTED_MODULE_1__[\"default\"](this, true, node, node !== null).show(e);\n        return;\n      }\n\n      // If invoked via action button:\n      new _EventInfoPopover__WEBPACK_IMPORTED_MODULE_1__[\"default\"](this, false, null, false).show();\n    }\n  }, {\n    key: \"is_record_selected\",\n    value: function is_record_selected(id) {\n      var selected = this.selected();\n      for (var i = 0; i < selected.length; i++) {\n        if ((0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.record_id)(selected[i].record) === id) return true;\n      }\n      return false;\n    }\n  }, {\n    key: \"selection_count\",\n    value: function selection_count() {\n      return this.selected().length;\n    }\n  }, {\n    key: \"deselect_all\",\n    value: function deselect_all() {\n      for (var i = 0; i < this.selection_count(); i++) {\n        var node = this.selected()[i];\n        node.selected = false;\n        if (node.element) {\n          node.element.removeClass('selected');\n          (0,_tree_selections__WEBPACK_IMPORTED_MODULE_6__.unmark_children_parent_selected)(node);\n        }\n      }\n      this.selected.removeAll();\n    }\n  }, {\n    key: \"setup_drag_and_drop\",\n    value:\n    // --------------------------------------------------------------------------\n    // Drag 'n drop interactions\n\n    // This is making use of HTML5 support for drag and drop. To make life\n    // easier we track which node is being dragged:\n    function setup_drag_and_drop() {\n      var dropzone = $(\"\".concat(this.container_selector, \" .dropzone\"));\n      var tree = this;\n\n      // When dragging starts we need to correctly set up the dataTransfer.\n      this.panel.on('dragstart', '.tree-event', function (e) {\n        tree.node_being_dragged = d3.select(this).data()[0];\n\n        // Prevent drag/drop when in edit modus\n        if ($(tree.node_being_dragged.element).find('input').length > 0) return false;\n\n        // Dragging selects.\n        if (!tree.node_being_dragged.selected) {\n          if ((0,_CommonScripts_sharedscripts_sharedscripts_npcommon__WEBPACK_IMPORTED_MODULE_9__.hasMetaKey)(e)) {\n            (0,_tree_selections__WEBPACK_IMPORTED_MODULE_6__.select_node)(tree.node_being_dragged);\n          } else {\n            (0,_tree_selections__WEBPACK_IMPORTED_MODULE_6__.single_select_node)(tree.node_being_dragged);\n          }\n        }\n\n        // The actual drag event is getting wrapped by JQuery.\n        var evt = e.originalEvent;\n\n        // We're only interested in moving nodes around.\n        evt.dataTransfer.effectAllowed = 'move';\n        evt.dataTransfer.dropEffect = 'move';\n\n        // Firefox will refuse to drag without setting some data\n        // on the dataTransfer object.\n        evt.dataTransfer.setData('text/plain', (0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.record_id)(tree.node_being_dragged.record));\n\n        // Then we define the \"drag image\"; which is what you see as being\n        // dragged around. Unfortunately there is no really clean way of doing\n        // this, as you can read here:\n        // http://www.kryogenix.org/code/browser/custom-drag-image.html\n        // Firefox actually relaxes the spec a bit, by not insisting on the\n        // element being visible in, or even attached to the document. Chrome\n        // and Safari, however, are not as lenient.\n\n        // Clone the original dragged node and transform it only when a multi-event drag happens\n        var drag_image = $(this).clone();\n        drag_image.addClass('being-dragged');\n        var selected_count = tree.node_being_dragged.forest.selection_count();\n        if (selected_count > 1) {\n          drag_image.addClass('tree-multiple').find('.label').html(\"<span class=\\\"name\\\">\".concat(selected_count, \" items</span>\"));\n        }\n        if (tree.node_being_dragged.is_group()) drag_image.addClass('tree-nodes');\n\n        // Needed by the drag/drop spec to get a valid drag image.\n        $('body').append(drag_image);\n\n        // Set it up on the data transfer object.\n        evt.dataTransfer.setDragImage(drag_image.get(0), 0, 0);\n\n        // And we can then remove the cloned element again. The browsers will\n        // keep using the image generated from this element, rather than the\n        // element itself.\n        setTimeout(function () {\n          $('.being-dragged').remove();\n        }, 0);\n\n        // Show the dropzone, unless we're dragging the root of a tree:\n        if (!tree.node_being_dragged.forest.selected().some(function (el) {\n          return el.is_root();\n        })) {\n          dropzone.addClass('show');\n        }\n      });\n\n      // This clears the tracking.\n      this.panel.on('dragend', '.tree-event', function () {\n        tree.node_being_dragged = null;\n\n        // Hide the dropzone:\n        dropzone.removeClass('show');\n        dropzone.removeClass('active');\n      });\n      var auto_expand_timer_start = null;\n\n      // This lets the droppables respond to the object being dragged whenever\n      // it gets dragged over them.\n      this.panel.on('dragover', '.tree-event', function (e) {\n        // Can not get the actual data in dragover events.\n        // var evt = e.originalEvent\n        // var data = evt.dataTransfer.getData('text/plain')\n        // console.log(data)\n\n        // Here 'this' refers to the droppable.\n        var target_node = d3.select(this).data()[0];\n        if (!target_node || !tree.node_being_dragged) return;\n\n        // If the dragged item gets hovered over something which can be expanded\n        // for a long enough time, we expand that target.\n        if (target_node.has_expanded()) {} else if (auto_expand_timer_start === null) {\n          // NOP\n          auto_expand_timer_start = Date.now();\n        } else if (Date.now() - auto_expand_timer_start > 1000) {\n          target_node.expand();\n          tree.request_update();\n        }\n\n        // If we can't drop the node here we just bail out.\n        if (!(0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.is_legal_drop_target)(target_node, tree.node_being_dragged)) return;\n\n        // If we can drop the node here, we need to mark it as a legal drop\n        // target by preventing further processing of the event (silly, I know).\n        // Doing so enables the drop event on this node should the user\n        // actually decide to drop the event here.\n        e.preventDefault();\n\n        // Give some visual feedback to the users:\n        (0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.highlight_drop_targets)(this, target_node);\n      });\n      this.panel.on('dragleave', '.tree-event', function () {\n        // Reset the auto-expand timer.\n        auto_expand_timer_start = null;\n\n        // Give some visual feedback to the users:\n        (0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.unhighlight_drop_targets)();\n      });\n\n      // Actual dropping of an event onto a valid target:\n      this.panel.on('drop', '.tree-event', function (e) {\n        // Make sure no native browser behaviour triggers when dropping things.\n        // E.g. a page redirect/refresh.\n        e.preventDefault();\n\n        // Here we can access the actual data.\n        // var evt = e.originalEvent\n        // var data = evt.dataTransfer.getData('text/plain')\n        // console.log(data)\n\n        // Grab the nodes and trigger the business logic.\n        var target_node = d3.select(this).data()[0];\n        (0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.move_events_to_target)(tree.node_being_dragged, target_node, tree.model);\n      });\n      dropzone.on('dragover', function (e) {\n        // Can not get the actual data in dragover events.\n        // var evt = e.originalEvent\n        // var data = evt.dataTransfer.getData('text/plain')\n        // console.log(data)\n\n        dropzone.addClass('active');\n\n        // We accept all nodes.\n        if (this.node_being_dragged) e.preventDefault();\n      }.bind(this));\n      dropzone.on('dragleave', function () {\n        dropzone.removeClass('active');\n      });\n      dropzone.on('drop', function (e) {\n        // Make sure no native browser behaviour triggers when dropping things.\n        // E.g. a page redirect/refresh.\n        e.preventDefault();\n\n        // And trigger the business logic.\n        (0,_event_treeview__WEBPACK_IMPORTED_MODULE_4__.move_events_to_own_tree)(tree.node_being_dragged, tree.model);\n      });\n    }\n  }, {\n    key: \"log\",\n    value:\n    // Useful for debugging:\n    function log() {\n      console.log(\"++ \".concat(this.container_selector, \" ++++++++\"));\n      for (var i = 0; i < this.trees.length; i++) {\n        this.trees[i].log('');\n      }\n    }\n  }]);\n  return Forest;\n}();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9UcmVldmlldy9Gb3Jlc3QuanMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBWUE7QUFDQTtBQU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBSUE7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFJQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUVBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7O0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUdBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQUE7QUFBQTtBQUNBO0FBRUE7QUFJQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFHQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBVUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFBQTtBQUVBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQVVBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFFQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFFQTtBQUdBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUdBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBS0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUdBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUVBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBRUE7QUFHQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFFQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFFQTtBQUdBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBRUE7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUFBO0FBR0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUVBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUlBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBSUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQU9BO0FBQ0E7QUFLQTtBQUdBO0FBTUE7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBOztBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUdBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUdBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFHQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUdBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFHQTs7QUFFQTtBQUNBO0FBS0E7QUFHQTtBQUdBO0FBQ0E7QUFFQTtBQUlBO0FBQ0E7QUFDQTs7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUtBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUlBO0FBRUE7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9SZWFjdENvbXBvbmVudHNfLy4vVHJlZXZpZXcvRm9yZXN0LmpzPzE3ZjciXSwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50LWRpc2FibGUgY2FtZWxjYXNlLCBmdW5jLW5hbWVzICovXG5pbXBvcnQga28gZnJvbSAna25vY2tvdXQnO1xuaW1wb3J0IEV2ZW50SW5mb1BvcG92ZXIgZnJvbSAnLi9FdmVudEluZm9Qb3BvdmVyJztcbmltcG9ydCBUcmVlIGZyb20gJy4vVHJlZSc7XG5pbXBvcnQgTm9kZSBmcm9tICcuL05vZGUnO1xuaW1wb3J0IHtcbiAgaGFuZGxlX2Vycm9yLFxuICBoaWdobGlnaHRfZHJvcF90YXJnZXRzLFxuICBpc19kZWZpbmVkLFxuICBpc19sZWdhbF9kcm9wX3RhcmdldCwgbW92ZV9ldmVudHNfdG9fb3duX3RyZWUsIG1vdmVfZXZlbnRzX3RvX3RhcmdldCxcbiAgbm9kZV9jb25mbGljdHMsXG4gIG5vZGVfaGFzX2NvbmZsaWN0cyxcbiAgcmVjb3JkX2Nhbl9iZV93cml0dGVuLFxuICByZWNvcmRfaWQsXG4gIHJlY29yZF9pc19ncm91cCxcbiAgdW5oaWdobGlnaHRfZHJvcF90YXJnZXRzXG59IGZyb20gJy4vZXZlbnQtdHJlZXZpZXcnO1xuaW1wb3J0IFBsYWNlaG9sZGVyTm9kZSBmcm9tICcuL1BsYWNlaG9sZGVyTm9kZSc7XG5pbXBvcnQge1xuICBkZXNlbGVjdF9ub2RlLFxuICBzZWxlY3Rfbm9kZSxcbiAgc2luZ2xlX3NlbGVjdF9ub2RlLFxuICBzdGFydF9lZGl0aW5nX2V2ZW50X25hbWUsXG4gIHRvZ2dsZV92aXNpYmlsaXR5X29mX3N1YnRyZWUsIHVubWFya19jaGlsZHJlbl9wYXJlbnRfc2VsZWN0ZWRcbn0gZnJvbSAnLi90cmVlX3NlbGVjdGlvbnMnO1xuaW1wb3J0ICR5ZXNwbGFuIGZyb20gJy4uL0NvbW1vblNjcmlwdHMvc2hhcmVkc2NyaXB0cy9zaGFyZWRzY3JpcHRzLXllc3BsYW5hcGknO1xuaW1wb3J0IHsgY29uZmlybWF0aW9uTW9kYWwgfSBmcm9tICcuLi9Db21tb25TY3JpcHRzL3NoYXJlZHNjcmlwdHMvc2hhcmVkc2NyaXB0cy1tb2RhbGNvbmZpcm1hdGlvbic7XG5pbXBvcnQgeyBoYXNNZXRhS2V5IH0gZnJvbSAnLi4vQ29tbW9uU2NyaXB0cy9zaGFyZWRzY3JpcHRzL3NoYXJlZHNjcmlwdHMtbnBjb21tb24nO1xuaW1wb3J0IHtTaGFyZWRzY3JpcHRzQ29udGV4dG1lbnV9IGZyb20gJy4uL0NvbW1vblNjcmlwdHMvc2hhcmVkc2NyaXB0cy9zaGFyZWRzY3JpcHRzLWNvbnRleHRtZW51JztcbmltcG9ydCBEYXRlRm9ybWF0U2V0dGluZ3MgZnJvbSAnLi9EYXRlRm9ybWF0U2V0dGluZ3MnO1xuaW1wb3J0IHtpbnRlcm5hbEpTRGF0ZUZvcm1hdH0gZnJvbSAnLi4vQ29tbW9uU2NyaXB0cy9zaGFyZWRzY3JpcHRzL3NoYXJlZHNjcmlwdHMtZ2xvYmFscyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcmVzdCB7XG5cbiAgY29uc3RydWN0b3IoXG4gICAgY29udGFpbmVyX3NlbGVjdG9yLFxuICAgIHJvb3RfaWRzLFxuICAgIGluaXRpYWxfc2VsZWN0aW9uLFxuICAgIHBlcm1pc3Npb25zLFxuICAgIG1vZGVsXG4gICkge1xuICAgIHRoaXMuY29udGFpbmVyX3NlbGVjdG9yID0gY29udGFpbmVyX3NlbGVjdG9yO1xuICAgIHRoaXMuY29udGFpbmVyID0gJChjb250YWluZXJfc2VsZWN0b3IpO1xuICAgIHRoaXMubW9kZWwgPSBtb2RlbDtcblxuICAgIHRoaXMucGFuZWwgPSAkKGAke3RoaXMuY29udGFpbmVyX3NlbGVjdG9yfSAuZXZlbnQtdHJlZWApO1xuXG4gICAgdGhpcy5ub2RlX2luc3RhbmNlX2NvdW50ID0gMDtcblxuICAgIHRoaXMuYWxsb3dfZXZlbnRfY3JlYXRpb24gPSBwZXJtaXNzaW9ucy5jcmVhdGVfY2FwYWJpbGl0eTtcbiAgICB0aGlzLmFsbG93X2V2ZW50X3VubG9ja2luZyA9IHBlcm1pc3Npb25zLnVubG9ja19jYXBhYmlsaXR5O1xuICAgIHRoaXMuc2hvd19sb2NhdGlvbl9hYmJyZXZpYXRpb24gPSBwZXJtaXNzaW9ucy5zaG93X2xvY2F0aW9ucztcblxuICAgIC8vIEQzIGRvZXMgbm90IGxpa2UgaXQgd2hlbiB3ZSBjb250aW51b3VzbHkgY3JlYXRlIG5ldyBkYXRhIGVsZW1lbnRzXG4gICAgLy8gZm9yIGRhdGEgaXQgYWxyZWFkeSBrbm93cyBhYm91dC4gSXQgc2VlbXMgdG8gaWdub3JlIHRoZSBuZXcgc3R1ZmYgaW5cbiAgICAvLyBmYXZvdXIgb2YgdGhlIG9sZC4gU28gd2Ugd2FudCB0byByZWN5Y2xlIHRoZSBleGlzdGluZyBkYXRhIGVsZW1lbnRzXG4gICAgLy8gaW5zdGVhZCwgd2hpY2ggaXMgd2h5IHdlIGtlZXAgdHJhY2sgb2YgdGhlbS5cbiAgICB0aGlzLm5vZGVzID0ge307XG5cbiAgICAvLyBUaGlzIGhlbHBzIHJlc3RvcmluZyB0cmVlIHJvb3RzIGluIGNvbWJpbmF0aW9uIHdpdGggJ3VuZG8nIGFjdGlvbnM6XG4gICAgdGhpcy5vbmNlX2FjdGl2ZV9yb290cyA9IHt9O1xuXG4gICAgLy8gVGhlIGN1cnJlbnRseSBzZWxlY3RlZCBub2RlcyAoaWYgYW55KTpcbiAgICB0aGlzLnNlbGVjdGVkID0ga28ub2JzZXJ2YWJsZUFycmF5KFtdKTtcblxuICAgIGxldCBpO1xuICAgIC8vIElmIGFuIGluaXRpYWwgc2VsZWN0aW9uIHdhcyBnaXZlbiwgYXBwbHkgaXQ6XG4gICAgaWYgKGlzX2RlZmluZWQoaW5pdGlhbF9zZWxlY3Rpb24pKSB7XG4gICAgICBmb3IgKGkgPSAwOyBpIDwgaW5pdGlhbF9zZWxlY3Rpb24ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgc2VsZWN0X25vZGUodGhpcy5ub2RlX2Zvcl9yZWNvcmQoaW5pdGlhbF9zZWxlY3Rpb25baV0pKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBUaGlzIGhvbGRzIHRoZSBhY3R1YWwgdHJlZXM6XG4gICAgdGhpcy50cmVlcyA9IFtdO1xuICAgIGZvciAoaSA9IDA7IGkgPCByb290X2lkcy5sZW5ndGg7IGkrKykge1xuICAgICAgdGhpcy5hZGRfdHJlZSh0aGlzLm5vZGVfZm9yX3JlY29yZChyb290X2lkc1tpXSkpO1xuICAgIH1cblxuICAgIC8vIFRoZSBjdXJyZW50bHkgcnVubmluZyBhY3Rpb24gKGlmIGFueSk6XG4gICAgdGhpcy5ydW5uaW5nX2FjdGlvbiA9IGtvLm9ic2VydmFibGUobnVsbCk7XG5cbiAgICAvLyBDbGVhciBteSB1bmRvc3RhY2tcbiAgICAkeWVzcGxhbi5yZXNldF91bmRvKCd0cmVldmlldycpO1xuXG4gICAgdGhpcy5ub2RlX2JlaW5nX2RyYWdnZWQgPSBudWxsO1xuXG4gICAgLy8gU2V0IHVwIGFsbCBpbnRlcmFjdGlvbnM6XG4gICAgdGhpcy5zZXR1cF9tb3VzZV9hY3Rpb25zKCk7XG4gICAgdGhpcy5zZXR1cF9jb250ZXh0X21lbnUoKTtcbiAgICB0aGlzLnNldHVwX2J1dHRvbnMoKTtcbiAgICB0aGlzLnNldHVwX2RyYWdfYW5kX2Ryb3AoKTtcbiAgfVxuXG4vLyBBZGQgYSBuZXcgdHJlZSB3aXRoIHRoZSBnaXZlbiBub2RlIGFzIGl0cyByb290LlxuICBhZGRfdHJlZShub2RlKSB7XG4gICAgdGhpcy50cmVlcy5wdXNoKG5ldyBUcmVlKHRoaXMsIG5vZGUpKTtcbiAgICB0aGlzLm9uY2VfYWN0aXZlX3Jvb3RzW25vZGUuZ2V0X2tleSgpXSA9IHRydWU7XG4gIH07XG5cbi8vIEZpbmQgdGhlIGV4aXN0aW5nIG5vZGUgZm9yIGEgZ2l2ZW4gcmVjb3JkIGlkLCBvciByZXR1cm4gbnVsbCBpZiBub25lXG4vLyBleGlzdHMuXG4gIG5vZGVfZm9yX3JlY29yZF9vcl9udWxsKHJlY29yZF9pZCkge1xuICAgIHJldHVybiB0aGlzLm5vZGVzW3JlY29yZF9pZF0gfHwgbnVsbDtcbiAgfTtcblxuLy8gTm9kZXMgc2hvdWxkIG5vdCBiZSBpbnN0YW50aWF0ZWQgZGlyZWN0bHksIGJ1dCBmZXRjaGVkIHRocm91Z2ggdGhpc1xuLy8gZnVuY3Rpb24uIFRoaXMgd2lsbCBjcmVhdGUgbm9kZXMgYXMgbmVlZGVkLCByZXVzaW5nIGV4aXN0aW5nIG5vZGVzIHdoZW5cbi8vIHBvc3NpYmxlLlxuICBub2RlX2Zvcl9yZWNvcmQocmVjb3JkX2lkKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIHRoaXMubm9kZV9mb3JfcmVjb3JkX29yX251bGwocmVjb3JkX2lkKSB8fFxuICAgICAgbmV3IE5vZGUodGhpcywgdGhpcy5tb2RlbC5nZXQocmVjb3JkX2lkKSlcbiAgICApO1xuICB9O1xuXG4vLyBXaGVyZSBpcyB0aGUgZ2l2ZW4gcm9vdCBpbiB0aGlzIGZvcmVzdCA/XG4gIGluZGV4X29mX3RyZWUocm9vdCkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy50cmVlcy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHRoaXMudHJlZXNbaV0ucm9vdCA9PT0gcm9vdCkgcmV0dXJuIGk7XG4gICAgfVxuXG4gICAgcmV0dXJuIC0xO1xuICB9O1xuXG4vLyBJcyB0aGVyZSBhIHRyZWUgZm9yIHRoZSBnaXZlbiByb290IGluIHRoaXMgZm9yZXN0ID9cbiAgaGFzX3RyZWUocm9vdCkge1xuICAgIHJldHVybiB0aGlzLmluZGV4X29mX3RyZWUocm9vdCkgPj0gMDtcbiAgfTtcblxuLy8gUmV0dXJuIHRoZSB0cmVlIGZvciB0aGUgZ2l2ZW4gcm9vdCBpbiB0aGlzIGZvcmVzdC5cbiAgZ2V0X3RyZWUocm9vdCkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy50cmVlcy5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHRoaXMudHJlZXNbaV0ucm9vdCA9PT0gcm9vdCkgcmV0dXJuIHRoaXMudHJlZXNbaV07XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bGw7XG4gIH07XG5cbi8vIFJlbW92ZSB0aGUgdHJlZSBmb3IgdGhlIGdpdmVuIHJvb3QgZnJvbSB0aGlzIGZvcmVzdC5cbiAgcmVtb3ZlX3RyZWUocm9vdCkge1xuICAgIGNvbnN0IGluZGV4ID0gdGhpcy5pbmRleF9vZl90cmVlKHJvb3QpO1xuICAgIGlmIChpbmRleCA8IDApIHJldHVybjtcblxuICAgIGNvbnN0IHRyZWUgPSB0aGlzLnRyZWVzW2luZGV4XTtcbiAgICB0aGlzLnRyZWVzLnNwbGljZShpbmRleCwgMSk7XG4gICAgdHJlZS5kaXNwb3NlKCk7XG4gIH07XG5cbi8vIEhpZGUgdGhlIHRyZWUgZm9yIHRoZSBnaXZlbiByb290IGZyb20gdGhpcyBmb3Jlc3QuXG4gIGhpZGVfdHJlZShyb290KSB7XG4gICAgLy8gTmVlZCB0byByZW1vdmUgaXQgZnJvbSB0aGUgbW9kZWwgYmVjYXVzZSBpdCB3aWxsIGdldCByZXN0b3JlZCBhZnRlciBhbiB1bmRvIG90aGVyd2lzZVxuICAgIHRoaXMubW9kZWwucmVtb3ZlKHJvb3QucmVjb3JkKTtcbiAgfTtcblxuLy8gVHJ5IHRvIGRpc3BsYXkgcm9vdHMgdGhhdCB3ZXJlIGRpc3BsYXllZCBiZWZvcmUgd2hlbiB0aGV5IHN0aWxsIGFyZSBpbiB0aGUgbW9kZWxcbiAgdHJ5X3RvX3Jlc3RvcmVfZm9ybWVyX3RyZWVzKCkge1xuICAgIGNvbnN0IG9uY2VfYWN0aXZlX3Jvb3RzX3N0aWxsX2luX21vZGVsID0gT2JqZWN0LmtleXMoXG4gICAgICB0aGlzLm9uY2VfYWN0aXZlX3Jvb3RzXG4gICAgKS5maWx0ZXIoKHJlY29yZF9pZCkgPT4ge1xuICAgICAgcmV0dXJuIHRoaXMubW9kZWwuZ2V0KHJlY29yZF9pZCwgbnVsbCkgIT09IG51bGw7XG4gICAgfSk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBvbmNlX2FjdGl2ZV9yb290c19zdGlsbF9pbl9tb2RlbC5sZW5ndGg7IGkrKykge1xuICAgICAgdGhpcy5zaG93X25vZGUob25jZV9hY3RpdmVfcm9vdHNfc3RpbGxfaW5fbW9kZWxbaV0pO1xuICAgIH1cbiAgfTtcblxuLy8gTWFrZXMgc3VyZSB0aGUgcmVxdWVzdGVkIG5vZGUgaXMgcGFydCBvZiBhIHRyZWUgcm9vdGVkIGluIHRoaXMgZm9yZXN0LlxuICBzaG93X25vZGUobm9kZV9vcl9yZWNvcmRfaWQpIHtcbiAgICBsZXQgbm9kZSA9IG5vZGVfb3JfcmVjb3JkX2lkO1xuXG4gICAgaWYgKFxuICAgICAgdHlwZW9mIG5vZGVfb3JfcmVjb3JkX2lkID09PSAnc3RyaW5nJyB8fFxuICAgICAgbm9kZV9vcl9yZWNvcmRfaWQgaW5zdGFuY2VvZiBTdHJpbmdcbiAgICApIHtcbiAgICAgIG5vZGUgPSB0aGlzLm5vZGVfZm9yX3JlY29yZChub2RlX29yX3JlY29yZF9pZCk7XG4gICAgfVxuXG4gICAgaWYgKG5vZGUgPT09IG51bGwpIHJldHVybjtcblxuICAgIGlmIChub2RlIGluc3RhbmNlb2YgUGxhY2Vob2xkZXJOb2RlKSB7XG4gICAgICAvLyBFeHBlY3RpbmcgdGhpcyB0byBiZSBhIHJlY29yZF9pZCBpbiB0aGlzIGNhc2UuLi5cbiAgICAgIC8vIFRPRE8gTWFrZSBzdXJlIG9mIHRoYXQuXG4gICAgICBjb25zdCBwYXJlbnRfbm9kZSA9IG5vZGUucGFyZW50O1xuICAgICAgbm9kZS5lamVjdChub2RlX29yX3JlY29yZF9pZCk7XG4gICAgICBub2RlID0gdGhpcy5ub2RlX2Zvcl9yZWNvcmQobm9kZV9vcl9yZWNvcmRfaWQpO1xuICAgICAgcGFyZW50X25vZGUucmVidWlsZF9zdWJub2RlcygpO1xuICAgIH1cblxuICAgIGxldCByb290X3JlY29yZCA9IG5vZGUucmVjb3JkO1xuICAgIHdoaWxlIChyb290X3JlY29yZC5wdCgpKSB7XG4gICAgICByb290X3JlY29yZCA9IHRoaXMubW9kZWwuZ2V0KHJvb3RfcmVjb3JkLnB0KCkpO1xuICAgICAgdGhpcy5ub2RlX2Zvcl9yZWNvcmQocmVjb3JkX2lkKHJvb3RfcmVjb3JkKSkuY29sbGFwc2VkID0gZmFsc2U7XG4gICAgfVxuXG4gICAgY29uc3Qgcm9vdF9ub2RlID0gdGhpcy5ub2RlX2Zvcl9yZWNvcmQocmVjb3JkX2lkKHJvb3RfcmVjb3JkKSk7XG4gICAgaWYgKCF0aGlzLmhhc190cmVlKHJvb3Rfbm9kZSkpIHRoaXMuYWRkX3RyZWUocm9vdF9ub2RlKTtcblxuICAgIHJvb3Rfbm9kZS5jb2xsYXBzZWQgPSBmYWxzZTtcbiAgfTtcblxuICByZXF1ZXN0X3VwZGF0ZSgpIHtcbiAgICAvLyBSZW1vdmUgdGhlICdlbXB0eSBzdGFydCcgcGFnZVxuICAgIGlmICh0aGlzLnRyZWVzLmxlbmd0aCA+IDApICQoJy50cmVlLWVkaXRvci1lbXB0eScpLnJlbW92ZSgpO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnRyZWVzLmxlbmd0aDsgaSsrKSB0aGlzLnRyZWVzW2ldLnJlcXVlc3RfdXBkYXRlKCk7XG4gIH07XG5cbiAgcmVxdWVzdF91cGRhdGVfcHJvbWlzZSgpIHtcbiAgICBjb25zdCBhbGxfcHJvbWlzZXMgPSBbXTtcblxuICAgIC8vIFJlbW92ZSB0aGUgJ2VtcHR5IHN0YXJ0JyBwYWdlXG4gICAgaWYgKHRoaXMudHJlZXMubGVuZ3RoID4gMCkgJCgnLnRyZWUtZWRpdG9yLWVtcHR5JykucmVtb3ZlKCk7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMudHJlZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGFsbF9wcm9taXNlcy5wdXNoKHRoaXMudHJlZXNbaV0ucmVxdWVzdF91cGRhdGVfcHJvbWlzZSgpKTtcbiAgICB9XG5cbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoYWxsX3Byb21pc2VzKTtcbiAgfTtcblxuLy8gRGVzdHJveSB0aGUgZm9yZXN0LiAoTm90IHJlY29tbWVuZGVkIGluIHJlYWwgbGlmZS4pXG4gIGRpc3Bvc2UoKSB7XG4gICAgbGV0IGk7XG4gICAgZm9yIChpID0gMDsgaSA8IHRoaXMudHJlZXMubGVuZ3RoOyBpKyspIHRoaXMudHJlZXNbaV0uZGlzcG9zZSgpO1xuXG4gICAgY29uc3QgaWRzID0gT2JqZWN0LmtleXModGhpcy5ub2Rlcyk7XG4gICAgZm9yIChpID0gMDsgaSA8IGlkcy5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3Qgbm9kZSA9IHRoaXMubm9kZXNbaWRzW2ldXTtcbiAgICAgIGlmIChub2RlKSBub2RlLmRpc3Bvc2UoKTtcbiAgICB9XG4gIH07XG5cbiAgcHJvZHVjdGlvbmZsYWdfb2Zfc2VsZWN0ZWRfbm9kZXMoKSB7XG4gICAgcmV0dXJuIHRoaXMuc2VsZWN0ZWQoKS5yZWR1Y2UoZnVuY3Rpb24odmFsdWUsIGl0KSB7XG4gICAgICByZXR1cm4gaXQuaXNfcHJvZHVjdGlvbigpICYmIHZhbHVlO1xuICAgIH0sIHRydWUpO1xuICB9O1xuXG4vLyBSZXR1cm5zIHRydWUgaWYgdGhlcmUgaXMgbm8gc2VsZWN0aW9uIG9yIHdoZW4gdGhlcmUgaXMgYXQgbW9zdCBvbmUgbm9kZSBzZWxlY3RlZFxuICBpc19tYXhfc2luZ2xlX25vZGVfc2VsZWN0ZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuc2VsZWN0ZWQoKS5sZW5ndGggPD0gMTtcbiAgfTtcblxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gUGVybWlzc2lvbnNcblxuICBpc193cml0ZV9ldmVudHNfYWxsb3dlZCgpIHtcbiAgICByZXR1cm4gdGhpcy5zZWxlY3RlZCgpLmV2ZXJ5KChpdCkgPT4ge1xuICAgICAgcmV0dXJuIHJlY29yZF9jYW5fYmVfd3JpdHRlbihpdC5yZWNvcmQpO1xuICAgIH0pO1xuICB9O1xuXG4gIGlzX2RlbGV0ZV9ldmVudHNfYWxsb3dlZCgpIHtcbiAgICByZXR1cm4gdGhpcy5zZWxlY3RlZCgpLmV2ZXJ5KChpdCkgPT4ge1xuICAgICAgcmV0dXJuIGl0LmNhbl9iZV9kZWxldGVkKCk7XG4gICAgfSk7XG4gIH07XG5cbiAgaXNfZGVsZXRlX2dyb3VwX29ubHlfYWxsb3dlZCgpIHtcbiAgICByZXR1cm4gdGhpcy5zZWxlY3RlZCgpLmV2ZXJ5KChpdCkgPT4ge1xuICAgICAgcmV0dXJuIGl0LmNhbl9iZV9ncm91cF9vbmx5X2RlbGV0ZWQoKTtcbiAgICB9KTtcbiAgfTtcblxuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gQWN0aW9uc1xuXG4gIGNyZWF0ZV9yZXF1ZXN0KGFjdGlvbl9uYW1lLCBvYmplY3QpIHtcbiAgICByZXR1cm4ge1xuICAgICAgYWN0aW9uX25hbWUsXG4gICAgICBzdGFja19zeW1ib2w6ICd0cmVldmlldycsXG4gICAgICAuLi5vYmplY3RcbiAgICB9O1xuICB9O1xuXG4gIGFkZF9ldmVudChuYW1lLCBkYXRlLCBsb2NhdGlvbiwgc3RhdHVzLCBwcm9maWxlKSB7XG4gICAgY29uc3QgZm9yZXN0ID0gdGhpcztcbiAgICBjb25zdCByZXF1ZXN0ID0gdGhpcy5jcmVhdGVfcmVxdWVzdChpMThuKCdOZXcgRXZlbnQnKSwge1xuICAgICAgbmFtZSxcbiAgICAgIGRhdGU6IGRhdGUuZm9ybWF0KGludGVybmFsSlNEYXRlRm9ybWF0KSxcbiAgICAgIGxvY2F0aW9uLFxuICAgICAgc3RhdHVzLFxuICAgICAgcHJvZmlsZVxuICAgIH0pO1xuXG4gICAgLy8gV2hlcmUgc2hvdWxkIHRoZSBuZXcgZXZlbnQgZ28gPyBEZXBlbmRzIG9uIHRoZSBzZWxlY3Rpb24uXG4gICAgaWYgKHRoaXMuc2VsZWN0ZWQoKS5sZW5ndGggPT09IDEpIHtcbiAgICAgIGNvbnN0IHNlbGVjdGVkID0gZm9yZXN0LnNlbGVjdGVkKClbMF07XG5cbiAgICAgIC8vIEluIGNhc2UgYSBncm91cCB3YXMgc2VsZWN0ZWQsIHRoZSBuZXcgZXZlbnQgc2hvdWxkIGJlbG9uZyB0byB0aGF0XG4gICAgICAvLyBncm91cC5cbiAgICAgIGlmIChzZWxlY3RlZC5pc19ncm91cCgpKSB7XG4gICAgICAgIHJlcXVlc3QucGFyZW50ID0gcmVjb3JkX2lkKHNlbGVjdGVkLnJlY29yZCk7XG4gICAgICB9Ly8gT3RoZXJ3aXNlLCBpZiBhbiBldmVudCBpbiBhIGdyb3VwIHdhcyBzZWxlY3RlZCwgdGhlIG5ldyBldmVudFxuICAgICAgLy8gc2hvdWxkIGJlY29tZSBhIHNpYmxpbmcgb2YgdGhlIHNlbGVjdGVkIGV2ZW50LlxuICAgICAgZWxzZSBpZiAoIXNlbGVjdGVkLmlzX3Jvb3QoKSAmJiBzZWxlY3RlZC5wYXJlbnQuaXNfZ3JvdXAoKSkge1xuICAgICAgICByZXF1ZXN0LnBhcmVudCA9IHJlY29yZF9pZChzZWxlY3RlZC5wYXJlbnQucmVjb3JkKTtcbiAgICAgIH1cblxuICAgICAgLy8gSW4gYWxsIG90aGVyIGNhc2VzIHRoZSBuZXcgZXZlbnQgd2lsbCBub3QgaGF2ZSBhIHBhcmVudCBkZWZpbmVkLlxuICAgIH1cblxuICAgIHRoaXMucnVubmluZ19hY3Rpb24oe2FkZF9ldmVudDogcmVxdWVzdH0pO1xuICAgIGxldCBuZXdfZXZlbnRfbm9kZSA9IG51bGw7XG5cbiAgICAkeWVzcGxhblxuICAgICAgLmFkZF9ldmVudCh0aGlzLm1vZGVsLCByZXF1ZXN0KVxuICAgICAgLnRoZW4oXG4gICAgICAgIGZ1bmN0aW9uKG5ld19ldmVudF9pZHMpIHtcbiAgICAgICAgICB0aGlzLnNob3dfbm9kZShuZXdfZXZlbnRfaWRzWzBdKTtcblxuICAgICAgICAgIG5ld19ldmVudF9ub2RlID0gdGhpcy5ub2RlX2Zvcl9yZWNvcmQobmV3X2V2ZW50X2lkc1swXSk7XG4gICAgICAgICAgc2luZ2xlX3NlbGVjdF9ub2RlKG5ld19ldmVudF9ub2RlKTtcbiAgICAgICAgICBuZXdfZXZlbnRfbm9kZS5oaWdobGlnaHRfYXNfbmV3ID0gdHJ1ZTtcblxuICAgICAgICAgIHRoaXMucnVubmluZ19hY3Rpb24obnVsbCk7XG4gICAgICAgIH0uYmluZCh0aGlzKVxuICAgICAgKVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICByZXR1cm4gZm9yZXN0LnJlcXVlc3RfdXBkYXRlX3Byb21pc2UoKTtcbiAgICAgIH0pXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIG5ld19ldmVudF9ub2RlLnNjcm9sbF90b19pdCgpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgZm9yZXN0LnJ1bm5pbmdfYWN0aW9uKG51bGwpO1xuICAgICAgICBoYW5kbGVfZXJyb3IoZXJyb3IpO1xuICAgICAgfSlcbiAgfTtcblxuICBlZGl0X2V2ZW50KFxuICAgIHJlY29yZF9pZCxcbiAgICBuYW1lLFxuICAgIGRhdGUsXG4gICAgbG9jYXRpb24sXG4gICAgc3RhdHVzLFxuICAgIHByb2ZpbGVcbiAgKSB7XG4gICAgY29uc3QgZm9yZXN0ID0gdGhpcztcbiAgICBjb25zdCByZXF1ZXN0ID0gdGhpcy5jcmVhdGVfcmVxdWVzdChpMThuKCdFZGl0IEV2ZW50JyksIHtcbiAgICAgIGlkOiByZWNvcmRfaWQsXG4gICAgICBuYW1lLFxuICAgICAgZGF0ZTogZGF0ZS5mb3JtYXQoaW50ZXJuYWxKU0RhdGVGb3JtYXQpLFxuICAgICAgbG9jYXRpb24sXG4gICAgICBzdGF0dXMsXG4gICAgICBwcm9maWxlXG4gICAgfSk7XG5cbiAgICB0aGlzLnJ1bm5pbmdfYWN0aW9uKHtlZGl0X2V2ZW50OiByZXF1ZXN0fSk7XG5cbiAgICAkeWVzcGxhblxuICAgICAgLmVkaXRfZXZlbnQodGhpcy5tb2RlbCwgcmVxdWVzdClcbiAgICAgIC50aGVuKFxuICAgICAgICBmdW5jdGlvbigpIHtcbiAgICAgICAgICB0aGlzLnNob3dfbm9kZShyZWNvcmRfaWQpO1xuICAgICAgICAgIHRoaXMucnVubmluZ19hY3Rpb24obnVsbCk7XG4gICAgICAgICAgZm9yZXN0LnJlcXVlc3RfdXBkYXRlKCk7XG4gICAgICAgIH0uYmluZCh0aGlzKVxuICAgICAgKVxuICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICBmb3Jlc3QucnVubmluZ19hY3Rpb24obnVsbCk7XG4gICAgICAgIGhhbmRsZV9lcnJvcihlcnJvcik7XG4gICAgICB9KVxuICB9O1xuXG4gIGVkaXRfZ3JvdXAoXG4gICAgcmVjb3JkX2lkLFxuICAgIG5hbWUsXG4gICAgZGF0ZSxcbiAgICBzdGF0dXMsXG4gICAgbG9jYXRpb24sXG4gICAgcHJvZmlsZVxuICApIHtcbiAgICBjb25zdCBmb3Jlc3QgPSB0aGlzO1xuXG4gICAgY29uc3QgcmVxdWVzdCA9IHRoaXMuY3JlYXRlX3JlcXVlc3QoaTE4bignRWRpdCBHcm91cCcpLCB7XG4gICAgICBpZDogcmVjb3JkX2lkLFxuICAgICAgbmFtZSxcbiAgICAgIGRhdGU6IGRhdGUuZm9ybWF0KGludGVybmFsSlNEYXRlRm9ybWF0KSxcbiAgICAgIHN0YXR1cyxcbiAgICAgIGxvY2F0aW9uLFxuICAgICAgcHJvZmlsZVxuICAgIH0pO1xuXG4gICAgdGhpcy5ydW5uaW5nX2FjdGlvbih7ZWRpdF9ncm91cDogcmVxdWVzdH0pO1xuXG4gICAgJHllc3BsYW5cbiAgICAgIC5lZGl0X2dyb3VwKHRoaXMubW9kZWwsIHJlcXVlc3QpXG4gICAgICAudGhlbihcbiAgICAgICAgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgdGhpcy5zaG93X25vZGUocmVjb3JkX2lkKTtcbiAgICAgICAgICB0aGlzLnJ1bm5pbmdfYWN0aW9uKG51bGwpO1xuICAgICAgICAgIGZvcmVzdC5yZXF1ZXN0X3VwZGF0ZSgpO1xuICAgICAgICB9LmJpbmQodGhpcylcbiAgICAgIClcbiAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgZm9yZXN0LnJ1bm5pbmdfYWN0aW9uKG51bGwpO1xuICAgICAgICBoYW5kbGVfZXJyb3IoZXJyb3IpO1xuICAgICAgfSk7XG4gIH07XG5cbiAgc2V0X3Byb2R1Y3Rpb25mbGFnKCkge1xuICAgIGNvbnN0IGZvcmVzdCA9IHRoaXM7XG4gICAgaWYgKGZvcmVzdC5zZWxlY3RlZCgpLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuXG4gICAgY29uc3Qgc2VsZWN0ZWRfZXZlbnRfaWRzID0gZm9yZXN0LnNlbGVjdGVkKCkubWFwKGZ1bmN0aW9uKGl0KSB7XG4gICAgICByZXR1cm4gcmVjb3JkX2lkKGl0LnJlY29yZCk7XG4gICAgfSk7XG5cbiAgICBjb25zdCBwZmxhZyA9ICF0aGlzLnByb2R1Y3Rpb25mbGFnX29mX3NlbGVjdGVkX25vZGVzKCk7XG5cbiAgICBjb25zdCByZXF1ZXN0ID0gdGhpcy5jcmVhdGVfcmVxdWVzdChpMThuKCdTZXQgUHJvZHVjdGlvbicpLCB7XG4gICAgICBldmVudHM6IHNlbGVjdGVkX2V2ZW50X2lkcyxcbiAgICAgIHByb2R1Y3Rpb25mbGFnOiBwZmxhZ1xuICAgIH0pO1xuXG4gICAgZm9yZXN0LnJ1bm5pbmdfYWN0aW9uKHtzZXRfcHJvZHVjdGlvbmZsYWc6IHJlcXVlc3R9KTtcblxuICAgICR5ZXNwbGFuXG4gICAgICAuc2V0X3Byb2R1Y3Rpb25mbGFnKHRoaXMubW9kZWwsIHJlcXVlc3QpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGZvcmVzdC5kZXNlbGVjdF9hbGwoKTtcbiAgICAgICAgZm9yZXN0LnJlcXVlc3RfdXBkYXRlKCk7XG5cbiAgICAgICAgZm9yZXN0LnJ1bm5pbmdfYWN0aW9uKG51bGwpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgZm9yZXN0LnJ1bm5pbmdfYWN0aW9uKG51bGwpO1xuICAgICAgICBoYW5kbGVfZXJyb3IoZXJyb3IpO1xuICAgICAgfSk7XG4gIH07XG5cbiAgYWRkX25ld19ncm91cCgpIHtcbiAgICBjb25zdCBmb3Jlc3QgPSB0aGlzO1xuICAgIGNvbnN0IHJlcXVlc3QgPSB0aGlzLmNyZWF0ZV9yZXF1ZXN0KGkxOG4oJ05ldyBHcm91cCcpLCB7fSk7XG5cbiAgICAvLyBXaGVyZSBzaG91bGQgdGhlIG5ldyBncm91cCBnbyA/IERlcGVuZHMgb24gdGhlIHNlbGVjdGlvbi5cbiAgICBpZiAodGhpcy5zZWxlY3RlZCgpLmxlbmd0aCA9PT0gMSkge1xuICAgICAgY29uc3Qgc2VsZWN0ZWQgPSBmb3Jlc3Quc2VsZWN0ZWQoKVswXTtcblxuICAgICAgLy8gSW4gY2FzZSBhIGdyb3VwIHdhcyBzZWxlY3RlZCwgdGhlIG5ldyBncm91cCBzaG91bGQgYmVsb25nIHRvIHRoYXRcbiAgICAgIC8vIGdyb3VwLlxuICAgICAgaWYgKHNlbGVjdGVkLmlzX2dyb3VwKCkpIHtcbiAgICAgICAgcmVxdWVzdC5wYXJlbnQgPSByZWNvcmRfaWQoc2VsZWN0ZWQucmVjb3JkKTtcbiAgICAgIH0vLyBPdGhlcndpc2UsIGlmIGFuIGV2ZW50IGluIGEgZ3JvdXAgd2FzIHNlbGVjdGVkLCB0aGUgbmV3IGdyb3VwXG4gICAgICAvLyBzaG91bGQgYmVjb21lIGEgc2libGluZyBvZiB0aGUgc2VsZWN0ZWQgZXZlbnQuXG4gICAgICBlbHNlIGlmICghc2VsZWN0ZWQuaXNfcm9vdCgpICYmIHNlbGVjdGVkLnBhcmVudC5pc19ncm91cCgpKSB7XG4gICAgICAgIHJlcXVlc3QucGFyZW50ID0gcmVjb3JkX2lkKHNlbGVjdGVkLnBhcmVudC5yZWNvcmQpO1xuICAgICAgfVxuXG4gICAgICAvLyBJbiBhbGwgb3RoZXIgY2FzZXMgdGhlIG5ldyBncm91cCB3aWxsIG5vdCBoYXZlIGEgcGFyZW50IGRlZmluZWQuXG4gICAgfVxuXG4gICAgZm9yZXN0LnJ1bm5pbmdfYWN0aW9uKHthZGRfZ3JvdXA6IHJlcXVlc3R9KTtcbiAgICBsZXQgbmV3X2dyb3VwX25vZGUgPSBudWxsO1xuXG4gICAgJHllc3BsYW5cbiAgICAgIC5hZGRfZ3JvdXAodGhpcy5tb2RlbCwgcmVxdWVzdClcbiAgICAgIC50aGVuKChuZXdfZ3JvdXBfaWRzKSA9PiB7XG4gICAgICAgIGZvcmVzdC5zaG93X25vZGUobmV3X2dyb3VwX2lkc1swXSk7XG5cbiAgICAgICAgbmV3X2dyb3VwX25vZGUgPSBmb3Jlc3Qubm9kZV9mb3JfcmVjb3JkKG5ld19ncm91cF9pZHNbMF0pO1xuICAgICAgICBzaW5nbGVfc2VsZWN0X25vZGUobmV3X2dyb3VwX25vZGUpO1xuICAgICAgICBuZXdfZ3JvdXBfbm9kZS5oaWdobGlnaHRfYXNfbmV3ID0gdHJ1ZTtcblxuICAgICAgICBmb3Jlc3QucnVubmluZ19hY3Rpb24obnVsbCk7XG4gICAgICB9KVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICByZXR1cm4gZm9yZXN0LnJlcXVlc3RfdXBkYXRlX3Byb21pc2UoKTtcbiAgICAgIH0pXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIG5ld19ncm91cF9ub2RlLnNjcm9sbF90b19pdCgpO1xuICAgICAgICBzdGFydF9lZGl0aW5nX2V2ZW50X25hbWUoXG4gICAgICAgICAgbmV3X2dyb3VwX25vZGUsXG4gICAgICAgICAgbmV3X2dyb3VwX25vZGUuZWxlbWVudC5maW5kKCcubGFiZWwgLm5hbWUnKSxcbiAgICAgICAgICBmb3Jlc3QubW9kZWxcbiAgICAgICAgKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgIGZvcmVzdC5ydW5uaW5nX2FjdGlvbihudWxsKTtcbiAgICAgICAgaGFuZGxlX2Vycm9yKGVycm9yKTtcbiAgICAgIH0pXG4gIH07XG5cbiAgZ3JvdXBfc2VsZWN0ZWQoKSB7XG4gICAgY29uc3QgZm9yZXN0ID0gdGhpcztcbiAgICBpZiAoZm9yZXN0LnNlbGVjdGVkKCkubGVuZ3RoID09PSAwKSByZXR1cm47XG5cbiAgICBjb25zdCBzZWxlY3RlZF9ldmVudF9pZHMgPSBmb3Jlc3Quc2VsZWN0ZWQoKS5tYXAoZnVuY3Rpb24oaXQpIHtcbiAgICAgIHJldHVybiByZWNvcmRfaWQoaXQucmVjb3JkKTtcbiAgICB9KTtcblxuICAgIGNvbnN0IHJlcXVlc3QgPSB0aGlzLmNyZWF0ZV9yZXF1ZXN0KGkxOG4oJyNWRVJCI0dyb3VwJyksIHtcbiAgICAgIGV2ZW50czogc2VsZWN0ZWRfZXZlbnRfaWRzXG4gICAgfSk7XG4gICAgZm9yZXN0LnJ1bm5pbmdfYWN0aW9uKHtncm91cF9ldmVudHM6IHJlcXVlc3R9KTtcblxuICAgIGxldCBuZXdfZ3JvdXBfbm9kZTtcbiAgICAkeWVzcGxhblxuICAgICAgLmdyb3VwX2V2ZW50cyh0aGlzLm1vZGVsLCByZXF1ZXN0KVxuICAgICAgLnRoZW4oZnVuY3Rpb24obmV3X2dyb3VwX2lkcykge1xuICAgICAgICBmb3Jlc3Quc2hvd19ub2RlKG5ld19ncm91cF9pZHNbMF0pO1xuXG4gICAgICAgIG5ld19ncm91cF9ub2RlID0gZm9yZXN0Lm5vZGVfZm9yX3JlY29yZChuZXdfZ3JvdXBfaWRzWzBdKTtcbiAgICAgICAgbmV3X2dyb3VwX25vZGUuY29sbGFwc2VkID0gZmFsc2U7XG4gICAgICAgIG5ld19ncm91cF9ub2RlLmhpZ2hsaWdodF9hc19uZXcgPSB0cnVlO1xuXG4gICAgICAgIGZvcmVzdC5kZXNlbGVjdF9hbGwoKTtcbiAgICAgICAgZm9yZXN0LnJlcXVlc3RfdXBkYXRlKCk7XG5cbiAgICAgICAgZm9yZXN0LnJ1bm5pbmdfYWN0aW9uKG51bGwpO1xuICAgICAgfSlcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgcmV0dXJuIGZvcmVzdC5yZXF1ZXN0X3VwZGF0ZV9wcm9taXNlKCk7XG4gICAgICB9KVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICBuZXdfZ3JvdXBfbm9kZS5zY3JvbGxfdG9faXQoKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgIGZvcmVzdC5ydW5uaW5nX2FjdGlvbihudWxsKTtcbiAgICAgICAgaGFuZGxlX2Vycm9yKGVycm9yKTtcbiAgICAgIH0pXG4gIH07XG5cbiAgcmVtb3ZlX3NlbGVjdGVkKCkge1xuICAgIGNvbnN0IGZvcmVzdCA9IHRoaXM7XG4gICAgaWYgKGZvcmVzdC5zZWxlY3RlZCgpLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuXG4gICAgY29uc3Qgc2VsZWN0ZWRfZXZlbnRfaWRzID0gZm9yZXN0LnNlbGVjdGVkKCkubWFwKGZ1bmN0aW9uKGl0KSB7XG4gICAgICByZXR1cm4gcmVjb3JkX2lkKGl0LnJlY29yZCk7XG4gICAgfSk7XG5cbiAgICBjb25zdCByZXF1ZXN0ID0gdGhpcy5jcmVhdGVfcmVxdWVzdChpMThuKCdEZWxldGUnKSwge1xuICAgICAgZXZlbnRzOiBzZWxlY3RlZF9ldmVudF9pZHNcbiAgICB9KTtcblxuICAgIGNvbnN0IGNhbGxiYWNrID0gZnVuY3Rpb24oKSB7XG4gICAgICBmb3Jlc3QucnVubmluZ19hY3Rpb24oe3JlbW92ZV9ldmVudHM6IHJlcXVlc3R9KTtcblxuICAgICAgJHllc3BsYW5cbiAgICAgICAgLnJlbW92ZV9ldmVudHMoZm9yZXN0Lm1vZGVsLHJlcXVlc3QpXG4gICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICBmb3Jlc3QuZGVzZWxlY3RfYWxsKCk7XG4gICAgICAgICAgZm9yZXN0LnJlcXVlc3RfdXBkYXRlKCk7XG4gICAgICAgICAgZm9yZXN0LnJ1bm5pbmdfYWN0aW9uKG51bGwpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgZm9yZXN0LnJ1bm5pbmdfYWN0aW9uKG51bGwpO1xuICAgICAgICAgIGhhbmRsZV9lcnJvcihlcnJvcik7XG4gICAgICAgIH0pXG4gICAgfTtcblxuICAgIGlmIChzZWxlY3RlZF9ldmVudF9pZHMubGVuZ3RoID09PSAxKSB7XG4gICAgICBjYWxsYmFjaygpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25maXJtYXRpb25Nb2RhbCh7XG4gICAgICAgIHRpdGxlOiBpMThuKCdBcmUgWW91IFN1cmU/JyksXG4gICAgICAgIGNvbmZpcm1hdGlvbl9sYWJlbDogaTE4bignQ29udGludWUnKSxcbiAgICAgICAgY2FuY2VsX2xhYmVsOiBpMThuKCdDYW5jZWwnKSxcbiAgICAgICAgbWVzc2FnZTpcbiAgICAgICAgICBgPHA+JHtcbiAgICAgICAgICAgIGkxOG4oXG4gICAgICAgICAgICAgICdUaGlzIGFjdGlvbiB3aWxsIGRlbGV0ZSB7bnVtYmVyfSBldmVudHMuIEFyZSB5b3Ugc3VyZSB5b3Ugd2FudCB0byBjb250aW51ZT8nXG4gICAgICAgICAgICApLnJlcGxhY2UoJ3tudW1iZXJ9Jywgc2VsZWN0ZWRfZXZlbnRfaWRzLmxlbmd0aC50b1N0cmluZygpKVxuICAgICAgICAgIH08L3A+YCxcbiAgICAgICAgY2FsbGJhY2tcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcblxuICByZW1vdmVfZ3JvdXBfb25seV9zZWxlY3RlZCgpIHtcbiAgICBjb25zdCBmb3Jlc3QgPSB0aGlzO1xuICAgIGlmIChmb3Jlc3Quc2VsZWN0ZWQoKS5sZW5ndGggPT09IDApIHJldHVybjtcblxuICAgIGNvbnN0IHNlbGVjdGVkX2dyb3VwX2lkcyA9IGZvcmVzdFxuICAgICAgLnNlbGVjdGVkKClcbiAgICAgIC5maWx0ZXIoZnVuY3Rpb24oaXQpIHtcbiAgICAgICAgcmV0dXJuIGl0LmlzX2dyb3VwKCk7XG4gICAgICB9KVxuICAgICAgLm1hcChmdW5jdGlvbihpdCkge1xuICAgICAgICByZXR1cm4gcmVjb3JkX2lkKGl0LnJlY29yZCk7XG4gICAgICB9KTtcblxuICAgIGNvbnN0IHJlcXVlc3QgPSB0aGlzLmNyZWF0ZV9yZXF1ZXN0KGkxOG4oJ0RlbGV0ZSBHcm91cCBPbmx5JyksIHtcbiAgICAgIGdyb3VwX2lkczogc2VsZWN0ZWRfZ3JvdXBfaWRzXG4gICAgfSk7XG4gICAgZm9yZXN0LnJ1bm5pbmdfYWN0aW9uKHtyZW1vdmVfZ3JvdXBzX29ubHk6IHJlcXVlc3R9KTtcblxuICAgICR5ZXNwbGFuXG4gICAgICAucmVtb3ZlX2dyb3Vwc19vbmx5KHRoaXMubW9kZWwsIHJlcXVlc3QpXG4gICAgICAudGhlbigocm9vdF9ub2Rlc190b19zaG93X2lkcykgPT4ge1xuICAgICAgICBmb3Jlc3QuZGVzZWxlY3RfYWxsKCk7XG4gICAgICAgIC8vIElmIGFueSBwbGFjZWhvbGRlciBub2RlcyB3b3VsZCBiZWNvbWUgcm9vdCBub2RlcywgZmlyc3QgZWplY3QgdGhlbSAocHJldmVudHMgdXBkYXRlIGVycm9yIGxhdGVyIG9uKVxuICAgICAgICByb290X25vZGVzX3RvX3Nob3dfaWRzLmZvckVhY2goKHJvb3Rfbm9kZV90b19zaG93X2lkKSA9PiB7XG4gICAgICAgICAgY29uc3Qgbm9kZSA9IGZvcmVzdC5ub2RlX2Zvcl9yZWNvcmQocm9vdF9ub2RlX3RvX3Nob3dfaWQpO1xuICAgICAgICAgIGlmIChub2RlIGluc3RhbmNlb2YgUGxhY2Vob2xkZXJOb2RlKSBub2RlLmVqZWN0KHJvb3Rfbm9kZV90b19zaG93X2lkKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJvb3Rfbm9kZXNfdG9fc2hvd19pZHMuZm9yRWFjaCgocm9vdF9ub2RlX3RvX3Nob3dfaWQpID0+IHtcbiAgICAgICAgICBmb3Jlc3Quc2hvd19ub2RlKHJvb3Rfbm9kZV90b19zaG93X2lkKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGZvcmVzdC5yZXF1ZXN0X3VwZGF0ZSgpO1xuICAgICAgICBmb3Jlc3QucnVubmluZ19hY3Rpb24obnVsbCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICBmb3Jlc3QucnVubmluZ19hY3Rpb24obnVsbCk7XG4gICAgICAgIGhhbmRsZV9lcnJvcihlcnJvcik7XG4gICAgICB9KVxuICB9O1xuXG4gIHVuZG9fbGFzdF9hY3Rpb24oKSB7XG4gICAgY29uc3QgZm9yZXN0ID0gdGhpcztcblxuICAgIGNvbnN0IHJlcXVlc3QgPSB0aGlzLmNyZWF0ZV9yZXF1ZXN0KGkxOG4oJ1VuZG8nKSwge30pO1xuICAgIGZvcmVzdC5ydW5uaW5nX2FjdGlvbih7dW5kbzogcmVxdWVzdH0pO1xuXG4gICAgJHllc3BsYW5cbiAgICAgIC51bmRvX2V2ZW50cyh0aGlzLm1vZGVsLCByZXF1ZXN0KVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICBmb3Jlc3QuZGVzZWxlY3RfYWxsKCk7XG4gICAgICAgIGZvcmVzdC50cnlfdG9fcmVzdG9yZV9mb3JtZXJfdHJlZXMoKTtcbiAgICAgICAgZm9yZXN0LnJlcXVlc3RfdXBkYXRlKCk7XG5cbiAgICAgICAgZm9yZXN0LnJ1bm5pbmdfYWN0aW9uKG51bGwpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgZm9yZXN0LnJ1bm5pbmdfYWN0aW9uKG51bGwpO1xuICAgICAgICBoYW5kbGVfZXJyb3IoZXJyb3IpO1xuICAgICAgfSlcbiAgfTtcblxuICBjb2xsYXBzZV9zZWxlY3RlZCgpIHtcbiAgICBjb25zdCBzZWxlY3RlZCA9IHRoaXMuc2VsZWN0ZWQoKTtcblxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2VsZWN0ZWQubGVuZ3RoOyBpKyspIHtcbiAgICAgIGxldCBzZWxlY3RlZF9ub2RlID0gc2VsZWN0ZWRbaV07XG5cbiAgICAgIGlmIChzZWxlY3RlZF9ub2RlIGluc3RhbmNlb2YgUGxhY2Vob2xkZXJOb2RlKSBjb250aW51ZTtcblxuICAgICAgaWYgKCFyZWNvcmRfaXNfZ3JvdXAoc2VsZWN0ZWRfbm9kZS5yZWNvcmQpKSB7XG4gICAgICAgIHNlbGVjdGVkX25vZGUgPSBzZWxlY3RlZF9ub2RlLnBhcmVudDtcbiAgICAgIH1cblxuICAgICAgaWYgKCFzZWxlY3RlZF9ub2RlKSBjb250aW51ZTtcblxuICAgICAgc2VsZWN0ZWRfbm9kZS5yZWJ1aWxkX3N1Ym5vZGVzKCk7XG4gICAgfVxuXG4gICAgdGhpcy5yZXF1ZXN0X3VwZGF0ZSgpO1xuICB9O1xuXG4gIGhpZGVfc2VsZWN0ZWQoKSB7XG4gICAgY29uc3QgZm9yZXN0ID0gdGhpcztcbiAgICBjb25zdCBzZWxlY3RlZF9yb290cyA9IF8udW5pcShcbiAgICAgIHRoaXMuc2VsZWN0ZWQoKS5tYXAoKG4pID0+IG4uZ2V0X3Jvb3QoKSlcbiAgICApO1xuXG4gICAgY29uc3QgcmVxdWVzdCA9IHRoaXMuY3JlYXRlX3JlcXVlc3QoJ0hpZGUnLCB7XG4gICAgICBpZHM6IHNlbGVjdGVkX3Jvb3RzLm1hcCgoaXQpID0+IHJlY29yZF9pZChpdC5yZWNvcmQpKVxuICAgIH0pO1xuICAgIGZvcmVzdC5ydW5uaW5nX2FjdGlvbih7cmVtb3ZlX2Zyb21fbW9kZWw6IHJlcXVlc3R9KTtcblxuICAgICR5ZXNwbGFuXG4gICAgICAucmVtb3ZlX2Zyb21fbW9kZWwodGhpcy5tb2RlbCwgcmVxdWVzdClcbiAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgc2VsZWN0ZWRfcm9vdHMuZm9yRWFjaCgobikgPT4ge1xuICAgICAgICAgIGZvcmVzdC5oaWRlX3RyZWUobik7XG4gICAgICAgIH0pO1xuICAgICAgICBmb3Jlc3QucmVxdWVzdF91cGRhdGUoKTtcblxuICAgICAgICBmb3Jlc3QucnVubmluZ19hY3Rpb24obnVsbCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICBmb3Jlc3QucnVubmluZ19hY3Rpb24obnVsbCk7XG4gICAgICAgIGhhbmRsZV9lcnJvcihlcnJvcik7XG4gICAgICB9KVxuICB9O1xuXG4gIGV4dGVuZF93aXRoKGV2ZW50X2lkKSB7XG4gICAgY29uc3QgZm9yZXN0ID0gdGhpcztcblxuICAgIGNvbnN0IHJlcXVlc3QgPSB0aGlzLmNyZWF0ZV9yZXF1ZXN0KCdFeHRlbmQnLCB7fSk7XG4gICAgZm9yZXN0LnJ1bm5pbmdfYWN0aW9uKHtleHRlbmQ6IHJlcXVlc3R9KTtcblxuICAgIGxldCBldmVudF9ub2RlID0gbnVsbDtcbiAgICAkeWVzcGxhblxuICAgICAgLnVwZGF0ZV9tb2RlbCh0aGlzLm1vZGVsLCByZXF1ZXN0KVxuICAgICAgLnRoZW4oXG4gICAgICAgIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHRoaXMuc2hvd19ub2RlKGV2ZW50X2lkKTtcblxuICAgICAgICAgIGV2ZW50X25vZGUgPSB0aGlzLm5vZGVfZm9yX3JlY29yZChldmVudF9pZCk7XG4gICAgICAgICAgaWYgKGV2ZW50X25vZGUgaW5zdGFuY2VvZiBQbGFjZWhvbGRlck5vZGUpIHtcbiAgICAgICAgICAgIGV2ZW50X25vZGUuZXhwYW5kKCk7XG4gICAgICAgICAgICBldmVudF9ub2RlID0gdGhpcy5ub2RlX2Zvcl9yZWNvcmQoZXZlbnRfaWQpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHNpbmdsZV9zZWxlY3Rfbm9kZShldmVudF9ub2RlKTtcbiAgICAgICAgICB0aGlzLnJ1bm5pbmdfYWN0aW9uKG51bGwpO1xuICAgICAgICB9LmJpbmQodGhpcylcbiAgICAgIClcbiAgICAgIC50aGVuKCgpID0+IGZvcmVzdC5yZXF1ZXN0X3VwZGF0ZV9wcm9taXNlKCkpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGV2ZW50X25vZGUuc2Nyb2xsX3RvX2l0KCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICBmb3Jlc3QucnVubmluZ19hY3Rpb24obnVsbCk7XG4gICAgICAgIGhhbmRsZV9lcnJvcihlcnJvcik7XG4gICAgICB9KVxuICB9O1xuXG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBJbnRlcmFjdGlvbnNcblxuICBzZXR1cF9tb3VzZV9hY3Rpb25zKCkge1xuICAgIGNvbnN0IGZvcmVzdCA9IHRoaXM7XG5cbiAgICAvLyBDbGlja2luZyB0aGUgXCJ2b2lkXCIgc2hvdWxkIGRlc2VsZWN0IGFsbCBldmVudHMuXG4gICAgdGhpcy5wYW5lbC5vbignY2xpY2snLCBmdW5jdGlvbihlKSB7XG4gICAgICAvLyBDaGVja2luZyB3aGV0aGVyIHdlIGFjdHVhbGx5IGNsaWNrZWQgdGhlIFwidm9pZFwiIG9yIG5vdC4uLlxuICAgICAgLy8gaWYgKCQoZS50YXJnZXQpLmNsb3Nlc3QoJy50cmVlLWV2ZW50JykubGVuZ3RoKSByZXR1cm5cbiAgICAgIGlmIChlLmlzRGVmYXVsdFByZXZlbnRlZCgpKSByZXR1cm47XG5cbiAgICAgIGZvcmVzdC5kZXNlbGVjdF9hbGwoKTtcbiAgICAgIGZvcmVzdC5yZXF1ZXN0X3VwZGF0ZSgpO1xuICAgIH0pO1xuXG4gICAgLy8gQ2xpY2tpbmcgYSBncm91cCdzIHRvZ2dsZSB0b2dnbGVzIHRoZSB2aXNpYmlsaXR5IG9mIGl0cyBjaGlsZHJlbi5cbiAgICB0aGlzLnBhbmVsLm9uKCdjbGljaycsICcudG9nZ2xlJywgZnVuY3Rpb24oZSkge1xuICAgICAgY29uc3Qgbm9kZSA9IGQzLnNlbGVjdChlLnRhcmdldCkuZGF0YSgpWzBdO1xuICAgICAgaWYgKCFub2RlKSByZXR1cm47XG5cbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRvZ2dsZV92aXNpYmlsaXR5X29mX3N1YnRyZWUobm9kZSk7XG4gICAgICBub2RlLmdldF90cmVlKCkucmVxdWVzdF91cGRhdGUoKTtcbiAgICB9KTtcblxuICAgIC8vIEhvdmVyaW5nIG92ZXIgdGhlIGNvbmZsaWN0IGljb24gc2hvd3MgdGhlIGNvbmZsaWN0IG1lc3NhZ2VzXG4gICAgdGhpcy5wYW5lbC5vbignbW91c2VlbnRlcicsICcuaWNvbi1jb25mbGljdCcsIGZ1bmN0aW9uKGUpIHtcbiAgICAgIC8vIGxvb2t1cCBub2RlIGFuZCBjb25mbGljdCBpdGVtIGNvbnRhaW5lclxuICAgICAgY29uc3QgcG9wb3ZlciA9ICQoJy5kZXYtY29uZmxpY3QtcG9wb3ZlcicpO1xuICAgICAgY29uc3QgY29uZmxpY3RpdGVtcyA9ICQoJy5kZXYtY29uZmxpY3QtcG9wb3ZlciAucG9wb3Zlci1jb250YWluZXInKTtcbiAgICAgIGNvbnN0IG5vZGUgPSBkMy5zZWxlY3QoZS50YXJnZXQpLmRhdGEoKVswXTtcblxuICAgICAgLy8gZG8gbm90IHNob3cgcG9wb3ZlciB3aGVuIG5vZGUgaXRzZWxmIGRvZXMgbm90IGhhdmUgY29uZmxpY3RzXG4gICAgICBpZiAoIW5vZGVfaGFzX2NvbmZsaWN0cyhub2RlKSkgcmV0dXJuO1xuXG4gICAgICAvLyByZW1vdmUgZXhpc3RpbmcgY29uZmxpY3RzXG4gICAgICAkKFxuICAgICAgICAnLmRldi1jb25mbGljdC1wb3BvdmVyIC5jb25mbGljdC1pdGVtLC5kZXYtY29uZmxpY3QtcG9wb3ZlciAuY29uZmxpY3QtdGl0bGUnXG4gICAgICApLnJlbW92ZSgpO1xuXG4gICAgICAvLyBjYW5jZWwgdGhlIGFjdGlvbiB0byBoaWRlIHRoZSBwb3BvdmVyXG4gICAgICBjbGVhclRpbWVvdXQocG9wb3Zlci5kYXRhKCdoaWRlcG9wb3ZlcicpKTtcbiAgICAgIC8vIHJlbW92ZSB0aGUgaGFuZGxlclxuICAgICAgcG9wb3Zlci5kYXRhKCdoaWRlcG9wb3ZlcicsIG51bGwpO1xuXG4gICAgICAvLyByZW5kZXIgY29uZmxpY3RzIHBlciBjb25mbGljdCBjYXRlZ29yeTsgdXNlIHRoZSBwcmVkZWZpbmVkIG9yZGVyIG9mIHRoZSBjYXRlZ29yaWVzXG4gICAgICBjb25zdCBjb25mbGljdHNQZXJDYXRlZ29yeSA9IG5vZGVfY29uZmxpY3RzKG5vZGUpO1xuICAgICAgWydldmVudCcsICdyZXNvdXJjZScsICdjb250cmFjdCddLmZvckVhY2goKGNhdGVnb3J5KSA9PiB7XG4gICAgICAgIGNvbnN0IGNvbmZsaWN0c0luQ2F0ZWdvcnkgPSBjb25mbGljdHNQZXJDYXRlZ29yeVtjYXRlZ29yeV07XG4gICAgICAgIGlmIChjb25mbGljdHNJbkNhdGVnb3J5KSB7XG4gICAgICAgICAgY29uc3QgY29uZmxpY3RzID0gY29uZmxpY3RzSW5DYXRlZ29yeVswXTtcbiAgICAgICAgICBjb25zdCB0aXRsZSA9IGNvbmZsaWN0c0luQ2F0ZWdvcnlbMV07XG4gICAgICAgICAgY29uc3QgdGl0bGVNYXJrdXAgPSAkKCc8c3Ryb25nIGNsYXNzPVxcJ2NvbmZsaWN0LXRpdGxlXFwnPicpLmFwcGVuZCh0aXRsZSk7XG4gICAgICAgICAgY29uZmxpY3RpdGVtcy5hcHBlbmQodGl0bGVNYXJrdXApO1xuICAgICAgICAgIGNvbmZsaWN0cy5mb3JFYWNoKChjb25mbGljdE1lc3NhZ2UpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNvbmZsaWN0SXRlbSA9ICQoJzxkaXYgY2xhc3M9XFwnY29uZmxpY3QtaXRlbVxcJz4nKS5hcHBlbmQoXG4gICAgICAgICAgICAgIGNvbmZsaWN0TWVzc2FnZVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGNvbmZsaWN0aXRlbXMuYXBwZW5kKGNvbmZsaWN0SXRlbSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICAvLyBzaG93IGNvbmZsaWN0IHBvcG92ZXJcbiAgICAgIGNvbnN0IG9mZnNldCA9IGZvcmVzdC5jb250YWluZXIub2Zmc2V0KCk7XG4gICAgICAvLyBkbyBub3QgdXNlIGUucGFnZVggY29vcmRpbmF0ZSBiZWNhdXNlIHRoZSAgbW91c2UgeCBwb3NpdGlvbiBpcyBub3QgYWx3YXlzIGluIHRoZSBtaWRkbGUgb2YgdGhlIHRhcmdldFxuICAgICAgLy8gaGVuY2Ugd2UgbmVlZCB0byB3b3JrIHdpdGggb2Zmc2V0IG9mIHRoZSB0YXJnZXRcbiAgICAgIGxldCB4ID0gJChlLnRhcmdldCkub2Zmc2V0KCkubGVmdCArICQoZS50YXJnZXQpLndpZHRoKCkgLSBvZmZzZXQubGVmdDtcbiAgICAgIC8vIGRvIG5vdCB1c2UgZS5wYWdlWSBjb29yZGluYXRlIGJlY2F1c2UgdGhlICBtb3VzZSB5IHBvc2l0aW9uIGlzIG5vdCBhbHdheXMgaW4gdGhlIG1pZGRsZSBvZiB0aGUgdGFyZ2V0XG4gICAgICAvLyBoZW5jZSB3ZSBuZWVkIHRvIHdvcmsgd2l0aCBvZmZzZXQgb2YgdGhlIHRhcmdldFxuICAgICAgLy8gdGhlIG1pZGRsZSBvZiB0aGUgdGFyZ2V0ICgkKGUudGFyZ2V0KS5oZWlnaHQoKSAvIDIpIGlzIGNvbXBlbnNhdGVkIGJ5IHRoZSBwb3BlciB0aXAgY29ycmVjdGlvbiwgc28gaXQgaXMgb2theSB0byB0YWtlIHRoZSB0b3BcbiAgICAgIGxldCB5ID0gJChlLnRhcmdldCkub2Zmc2V0KCkudG9wIC0gb2Zmc2V0LnRvcDtcblxuICAgICAgLy8gVE9ETyBTaG91bGQgdGFrZSBwYWRkaW5nL21hcmdpbnMgaW50byBhY2NvdW50IGFzIHdlbGwuXG4gICAgICB4ID0gTWF0aC5taW4oeCwgZm9yZXN0LmNvbnRhaW5lci53aWR0aCgpIC0gcG9wb3Zlci53aWR0aCgpKTtcbiAgICAgIHkgPSBNYXRoLm1pbih5LCBmb3Jlc3QuY29udGFpbmVyLmhlaWdodCgpIC0gcG9wb3Zlci5oZWlnaHQoKSk7XG5cbiAgICAgIC8vIGRpc3BsYXkgdXNpbmcgcG9zaXRpb25zIGJhc2VkIG9uIG91dGVyIGJvdW5kcyBvZiBwb3BvdmVyXG4gICAgICAvLyBvbmx5IHRoZW4gd2UgY2FuIGNvbXBlbnNhdGUgZm9yIHRoZSBwb3BvdmVyIHRpcCBjYXVzZSB0aGUgdGlwIGlzIG5vdCBwcmVzZW50IGluIHRoZSBkb20gYnV0IG9ubHkgaW4gY3NzXG4gICAgICBwb3BvdmVyXG4gICAgICAgIC5jc3MoJ2JvdHRvbScsICdhdXRvJylcbiAgICAgICAgLmNzcygncmlnaHQnLCAnYXV0bycpXG4gICAgICAgIC5jc3MoJ2xlZnQnLCBgJHt4fXB4YClcbiAgICAgICAgLmNzcygndG9wJywgYCR7eX1weGApXG4gICAgICAgIC5jc3MoJ2Rpc3BsYXknLCAnYmxvY2snKTtcblxuICAgICAgLy8gYWRqdXN0IHBvc2l0aW9ucyBzdWNoIHRoYXQgcG9wb3ZlciB0aXAgcG9pbnRzIHJpZ2h0IHRvIHRoZSBjbGljayBwb3NpdGlvbi4gQ29ycmVjdCB0aGUgeSBjb29yZGluYXRlIHdpdGggbWFnaWMgbnVtYmVyIDJcbiAgICAgIHkgPVxuICAgICAgICB5IC1cbiAgICAgICAgKCQoJy5kZXYtY29uZmxpY3QtcG9wb3ZlciAucG9wb3Zlci1jb250YWluZXInKS5vZmZzZXQoKS50b3AgLVxuICAgICAgICAgIHBvcG92ZXIub2Zmc2V0KCkudG9wKSAtXG4gICAgICAgIDI7XG4gICAgICB4ICs9XG4gICAgICAgICgkKCcuZGV2LWNvbmZsaWN0LXBvcG92ZXIgLnBvcG92ZXItY29udGFpbmVyJykub2Zmc2V0KCkubGVmdCAtXG4gICAgICAgICAgcG9wb3Zlci5vZmZzZXQoKS5sZWZ0KTtcbiAgICAgIHBvcG92ZXJcbiAgICAgICAgLmNzcygnYm90dG9tJywgJ2F1dG8nKVxuICAgICAgICAuY3NzKCdyaWdodCcsICdhdXRvJylcbiAgICAgICAgLmNzcygnbGVmdCcsIGAke3h9cHhgKVxuICAgICAgICAuY3NzKCd0b3AnLCBgJHt5fXB4YClcbiAgICAgICAgLmNzcygnZGlzcGxheScsICdibG9jaycpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5wYW5lbC5vbignbW91c2VsZWF2ZScsICcuaWNvbi1jb25mbGljdCcsIGZ1bmN0aW9uKGUpIHtcbiAgICAgIGNvbnN0IG5vZGUgPSBkMy5zZWxlY3QoZS50YXJnZXQpLmRhdGEoKVswXTtcblxuICAgICAgLy8gZG8gbm90IHNob3cgcG9wb3ZlciB3aGVuIG5vZGUgaXRzZWxmIGRvZXMgbm90IGhhdmUgY29uZmxpY3RzXG4gICAgICBpZiAoIW5vZGVfaGFzX2NvbmZsaWN0cyhub2RlKSkgcmV0dXJuO1xuXG4gICAgICBjb25zdCBwb3BvdmVyID0gJCgnLmRldi1jb25mbGljdC1wb3BvdmVyJyk7XG4gICAgICAvLyBvbmx5IGluc3RhbGwgb25lIGhhbmRsZXIgdG8gZGVsYXkgdGhlIGFjdGlvbiB0byBoaWRlIHRoZSBwb3BvdmVyXG4gICAgICBpZiAocG9wb3Zlci5kYXRhKCdoaWRlcG9wb3ZlcicpID09IG51bGwpIHtcbiAgICAgICAgcG9wb3Zlci5kYXRhKFxuICAgICAgICAgICdoaWRlcG9wb3ZlcicsXG4gICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAvLyBoaWRlIHRoZSBwb3BvdmVyXG4gICAgICAgICAgICBwb3BvdmVyLmNzcygnZGlzcGxheScsICdub25lJyk7XG4gICAgICAgICAgICAvLyByZW1vdmUgdGhlIGhhbmRsZXJcbiAgICAgICAgICAgIHBvcG92ZXIuZGF0YSgnaGlkZXBvcG92ZXInLCBudWxsKTtcbiAgICAgICAgICB9LCAzMDApXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAkKCcuZGV2LWNvbmZsaWN0LXBvcG92ZXInKVxuICAgICAgLm1vdXNlZW50ZXIoKCkgPT4ge1xuICAgICAgICAvLyBjYW5jZWwgdGhlIGFjdGlvbiB0byBoaWRlIHRoZSBwb3BvdmVyIHdoZW4gaG92ZXJpbmcgb3ZlciB0aGUgcG9wb3ZlclxuICAgICAgICBjbGVhclRpbWVvdXQoJCgnLmRldi1jb25mbGljdC1wb3BvdmVyJykuZGF0YSgnaGlkZXBvcG92ZXInKSk7XG4gICAgICAgIC8vIHJlbW92ZSB0aGUgaGFuZGxlclxuICAgICAgICAkKCcuZGV2LWNvbmZsaWN0LXBvcG92ZXInKS5kYXRhKCdoaWRlcG9wb3ZlcicsIG51bGwpO1xuICAgICAgfSlcbiAgICAgIC5tb3VzZWxlYXZlKCgpID0+IHtcbiAgICAgICAgLy8gaW1tZWRpYXRseSBoaWRlIHRoZSBwb3BvdmVyIHdoZW4gbGVhdmluZyB0aGUgY29uZmxpY3QgcG9wb3ZlclxuICAgICAgICAkKCcuZGV2LWNvbmZsaWN0LXBvcG92ZXInKS5jc3MoJ2Rpc3BsYXknLCAnbm9uZScpO1xuICAgICAgfSk7XG5cbiAgICAvLyBDbGlja2luZyBhbiBldmVudCdzIGxhYmVsIHNlbGVjdHMgaXQuIFVubGVzcyBpdCdzIGEgcGxhY2Vob2xkZXIgbm9kZSwgaW5cbiAgICAvLyB3aGljaCBjYXNlIHdlIGV4cGFuZCB0aGUgcGxhY2Vob2xkZXIgaW5zdGVhZC5cbiAgICB0aGlzLnBhbmVsLm9uKCdjbGljaycsICcubGFiZWwnLCBmdW5jdGlvbihlKSB7XG4gICAgICBjb25zdCBub2RlID0gZDMuc2VsZWN0KGUudGFyZ2V0KS5kYXRhKClbMF07XG4gICAgICBpZiAoIW5vZGUpIHJldHVybjtcblxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICBpZiAobm9kZSBpbnN0YW5jZW9mIFBsYWNlaG9sZGVyTm9kZSkge1xuICAgICAgICAvLyBDbGlja2luZyBhIHBsYWNlaG9sZGVyIG5vZGUgZXhwYW5kcyBpdC5cbiAgICAgICAgbm9kZS5leHBhbmQoKTtcbiAgICAgICAgbm9kZS5nZXRfdHJlZSgpLnJlcXVlc3RfdXBkYXRlKCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gQXJlIHdlIHN0YXJ0aW5nIGEgbmV3IHNlbGVjdGlvbiwgb3IgYXJlIHdlIGFkZGluZyB0byB0aGUgb2xkIG9uZSA/XG4gICAgICBjb25zdCBzaG91bGRfY2xlYXJfZXhpc3Rpbmdfc2VsZWN0aW9uID0gIWhhc01ldGFLZXkoZSk7XG5cbiAgICAgIGlmIChzaG91bGRfY2xlYXJfZXhpc3Rpbmdfc2VsZWN0aW9uKSBub2RlLmZvcmVzdC5kZXNlbGVjdF9hbGwoKTtcblxuICAgICAgaWYgKG5vZGUuc2VsZWN0ZWQpIHtcbiAgICAgICAgLyogaWYoZS5hbHRLZXkpXG4gICAgICAgICAgICAgIGRlc2VsZWN0X3N1YnRyZWUobm9kZSlcbiAgICAgICAgICBlbHNlICovXG4gICAgICAgIGRlc2VsZWN0X25vZGUobm9kZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvKiBpZihlLmFsdEtleSlcbiAgICAgICAgICAgIHNlbGVjdF9zdWJ0cmVlKG5vZGUpXG4gICAgICAgICAgZWxzZSAqL1xuICAgICAgICBzZWxlY3Rfbm9kZShub2RlKTtcbiAgICAgIH1cblxuICAgICAgbm9kZS5nZXRfdHJlZSgpLnJlcXVlc3RfdXBkYXRlKCk7XG4gICAgfSk7XG5cbiAgICAvLyBEb3VibGUgY2xpY2tpbmcgYW4gZXZlbnQncyBuYW1lIG1ha2VzIGl0IGVkaXRhYmxlOlxuICAgIHRoaXMucGFuZWwub24oJ2RibGNsaWNrJywgJy5uYW1lJywgZnVuY3Rpb24oZSkge1xuICAgICAgY29uc3Qgbm9kZSA9IGQzLnNlbGVjdChlLnRhcmdldCkuZGF0YSgpWzBdO1xuICAgICAgaWYgKCFub2RlKSByZXR1cm47XG4gICAgICBpZiAoIXJlY29yZF9jYW5fYmVfd3JpdHRlbihub2RlLnJlY29yZCkpIHJldHVybjtcbiAgICAgIGlmICghbm9kZS5pc19ub3RfbG9ja2VkKCkpIHJldHVybjtcblxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICBzaW5nbGVfc2VsZWN0X25vZGUobm9kZSk7XG5cbiAgICAgIC8vIFRoZSBvcmlnaW5hbCBsYWJlbDpcbiAgICAgIGNvbnN0IGxhYmVsID0gJCh0aGlzKTtcblxuICAgICAgc3RhcnRfZWRpdGluZ19ldmVudF9uYW1lKG5vZGUsIGxhYmVsLCBmb3Jlc3QubW9kZWwpO1xuICAgIH0pO1xuXG4gICAgaWYgKHRoaXMuYWxsb3dfZXZlbnRfdW5sb2NraW5nKSB7XG4gICAgICB0aGlzLnBhbmVsLm9uKCdjbGljaycsICcubG9jazpub3QoLmxvY2stLWFjdHVhbCknLCBmdW5jdGlvbihlKSB7XG4gICAgICAgIGNvbnN0IG5vZGUgPSBkMy5zZWxlY3QoZS50YXJnZXQpLmRhdGEoKVswXTtcbiAgICAgICAgLy8gSWYgdGhlcmUgaXMgbm8gbm9kZSBvciBpZiB3ZSBhcmUgY2xpY2tpbmcgb24gYSBwbGFjZWhvbGRlciBub2RlLCB3ZSBjYWxsIGl0IHF1aXRzLlxuICAgICAgICBpZiAoIW5vZGUpIHJldHVybjtcbiAgICAgICAgaWYgKG5vZGUgaW5zdGFuY2VvZiBQbGFjZWhvbGRlck5vZGUpIHJldHVybjtcblxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIG5vZGUuc2V0X3VubG9ja2VkKCFub2RlLmlzX3VubG9ja2VkKCkpO1xuICAgICAgICBmb3Jlc3QucmVxdWVzdF91cGRhdGUoKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcblxuICBzZXR1cF9jb250ZXh0X21lbnUoKSB7XG4gICAgY29uc3QgZm9yZXN0ID0gdGhpcztcbiAgICBsZXQgbWVudSA9IG51bGw7XG5cbiAgICB0aGlzLnBhbmVsLm9uKCdjb250ZXh0bWVudScsIGZ1bmN0aW9uKGUpIHtcbiAgICAgIC8vIElmIHRoZSBjb250ZXh0IG1lbnUgd2FzIGludm9rZWQgb24gYSBub2RlIGluIG9uZSBvZiB0aGUgdHJlZXMsIHdlIG1heVxuICAgICAgLy8gbmVlZCB0byBkbyBzb21lIHNwZWNpYWwgbG9naWMuXG4gICAgICBjb25zdCB0cmVlX2V2ZW50ID0gJChlLnRhcmdldCkuY2xvc2VzdCgnLnRyZWUtZXZlbnQnKTtcbiAgICAgIGlmICh0cmVlX2V2ZW50Lmxlbmd0aCkge1xuICAgICAgICAvLyBUaGUgY29udGV4dCBtZW51IHdhcyBpbnZva2VkIG9uIHRoaXMgbm9kZTpcbiAgICAgICAgY29uc3Qgbm9kZSA9IGQzLnNlbGVjdCh0cmVlX2V2ZW50LmdldCgwKSkuZGF0YSgpWzBdO1xuXG4gICAgICAgIC8vIElmIHRoYXQgbm9kZSBpcyBhIHBsYWNlaG9sZGVyIHdlIGV4cGFuZCBpdCBhbmQgY2FsbCBpdCBxdWl0cy5cbiAgICAgICAgaWYgKG5vZGUgaW5zdGFuY2VvZiBQbGFjZWhvbGRlck5vZGUpIHtcbiAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgICBub2RlLmV4cGFuZCgpO1xuICAgICAgICAgIGZvcmVzdC5yZXF1ZXN0X3VwZGF0ZSgpO1xuXG4gICAgICAgICAgaWYgKG1lbnUpIG1lbnUuY2xvc2UoKTtcblxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIE90aGVyd2lzZSB3ZSB1cGRhdGUgdGhlIG5vZGUgc2VsZWN0aW9uIGJlZm9yZSBjb250aW51aW5nIG9uLlxuICAgICAgICBpZiAoIW5vZGUuc2VsZWN0ZWQpIHtcbiAgICAgICAgICBpZiAoaGFzTWV0YUtleShlKSkge1xuICAgICAgICAgICAgc2VsZWN0X25vZGUobm9kZSk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNpbmdsZV9zZWxlY3Rfbm9kZShub2RlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gSWYgd2UgYXJlIG5vdCBvcGVuZWQgb24gYSBub2RlIChpLmUuIGJhY2tncm91bmQpLCBkZXNlbGVjdCBhbGxcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZvcmVzdC5kZXNlbGVjdF9hbGwoKTtcbiAgICAgIH1cblxuICAgICAgLy8gVGhlIG1lbnUgaXMgY3JlYXRlZCBhcyBuZWVkZWQ6XG4gICAgICBpZiAobWVudSA9PT0gbnVsbCkge1xuICAgICAgICBtZW51ID0gbmV3IFNoYXJlZHNjcmlwdHNDb250ZXh0bWVudShbXG4gICAgICAgICAge1xuICAgICAgICAgICAgaWQ6ICdhZGQtZXZlbnQnLFxuICAgICAgICAgICAgdGV4dDogaTE4bignTmV3IEV2ZW50Li4uJyksXG4gICAgICAgICAgICBmbihlKSB7XG4gICAgICAgICAgICAgIGZvcmVzdC5zaG93X2V2ZW50X2luZm9fcG9wb3ZlcihlLCBudWxsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGlkOiAnYWRkLWdyb3VwJyxcbiAgICAgICAgICAgIHRleHQ6IGkxOG4oJ05ldyBHcm91cCcpLFxuICAgICAgICAgICAgZm4oKSB7XG4gICAgICAgICAgICAgIGZvcmVzdC5hZGRfbmV3X2dyb3VwKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcblxuICAgICAgICAgIHthOiAnc2VwYXJhdG9yJ30sXG5cbiAgICAgICAgICB7XG4gICAgICAgICAgICBpZDogJ2VkaXQnLFxuICAgICAgICAgICAgdGV4dDogaTE4bignRWRpdCBFdmVudC4uLicpLFxuICAgICAgICAgICAgZm4oZSkge1xuICAgICAgICAgICAgICBmb3Jlc3Quc2hvd19ldmVudF9pbmZvX3BvcG92ZXIoZSwgZm9yZXN0LnNlbGVjdGVkKClbMF0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG5cbiAgICAgICAgICB7XG4gICAgICAgICAgICBpZDogJ3NldHByb2R1Y3Rpb25mbGFnJyxcbiAgICAgICAgICAgIHRleHQ6IGkxOG4oJ1NldCBQcm9kdWN0aW9uJyksXG4gICAgICAgICAgICBmbigpIHtcbiAgICAgICAgICAgICAgZm9yZXN0LnNldF9wcm9kdWN0aW9uZmxhZygpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG5cbiAgICAgICAgICB7YTogJ3NlcGFyYXRvcid9LFxuXG4gICAgICAgICAge1xuICAgICAgICAgICAgaWQ6ICdncm91cCcsXG4gICAgICAgICAgICB0ZXh0OiBpMThuKCcjVkVSQiNHcm91cCcpLFxuICAgICAgICAgICAgZm4oKSB7XG4gICAgICAgICAgICAgIGZvcmVzdC5ncm91cF9zZWxlY3RlZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgaWQ6ICdkZWxldGUnLFxuICAgICAgICAgICAgdGV4dDogaTE4bignRGVsZXRlJyksXG4gICAgICAgICAgICBmbigpIHtcbiAgICAgICAgICAgICAgZm9yZXN0LnJlbW92ZV9zZWxlY3RlZCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgaWQ6ICdkZWxldGUtZ3JvdXAnLFxuICAgICAgICAgICAgdGV4dDogaTE4bignRGVsZXRlIEdyb3VwIE9ubHknKSxcbiAgICAgICAgICAgIGZuKCkge1xuICAgICAgICAgICAgICBmb3Jlc3QucmVtb3ZlX2dyb3VwX29ubHlfc2VsZWN0ZWQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuXG4gICAgICAgICAge2E6ICdzZXBhcmF0b3InfSxcblxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGlkOiAndW5kbycsXG4gICAgICAgICAgICB0ZXh0OiBpMThuKCdVbmRvJyksXG4gICAgICAgICAgICBmbigpIHtcbiAgICAgICAgICAgICAgZm9yZXN0LnVuZG9fbGFzdF9hY3Rpb24oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuXG4gICAgICAgICAge2E6ICdzZXBhcmF0b3InfSxcblxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGlkOiAnaGlkZScsXG4gICAgICAgICAgICB0ZXh0OiBpMThuKCdIaWRlJyksXG4gICAgICAgICAgICBmbigpIHtcbiAgICAgICAgICAgICAgZm9yZXN0LmhpZGVfc2VsZWN0ZWQoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGlkOiAnY29sbGFwc2UnLFxuICAgICAgICAgICAgdGV4dDogaTE4bignU3VtbWFyaXplJyksXG4gICAgICAgICAgICBmbigpIHtcbiAgICAgICAgICAgICAgZm9yZXN0LmNvbGxhcHNlX3NlbGVjdGVkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICBdKTtcbiAgICAgIH1cblxuICAgICAgLy8gTm8gYWN0aW9ucyBhbGxvd2VkIHdoaWxlIG9uZSBpcyBydW5uaW5nOlxuICAgICAgaWYgKGZvcmVzdC5ydW5uaW5nX2FjdGlvbigpICE9PSBudWxsKSB7XG4gICAgICAgIG1lbnUuZGlzYWJsZV9hbGwoKTtcbiAgICAgIH0vLyBPdGhlcndpc2UgYWN0aW9ucyBhcmUgYWxsb3dlZDpcbiAgICAgIGVsc2Uge1xuICAgICAgICBtZW51LmVuYWJsZV9hbGwoKTtcbiAgICAgIH1cblxuICAgICAgLy8gVW5kbyBhY3Rpb24gYWxsb3dlZCB3aGVuIHllc3BsYW4gc2F5cyB0aGVyZSBpcyBhbiB1bmRvIGFjdGlvblxuICAgICAgaWYgKCEkeWVzcGxhbi5oYXNfdW5kbygndHJlZXZpZXcnKSkge1xuICAgICAgICBtZW51LmRpc2FibGUoJ3VuZG8nKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG1lbnUuc2V0X3RleHQoXG4gICAgICAgICAgJ3VuZG8nLFxuICAgICAgICAgIGAke2kxOG4oJ1VuZG8nKX0gJHskeWVzcGxhbi51bmRvX25hbWUoJ3RyZWV2aWV3Jyl9YFxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICAvLyBFeGNlcHQgZm9yIHRob3NlIHJlcXVpcmluZyBhbiBhY3RpdmUgc2VsZWN0aW9uIHdoZW4gdGhlcmUgaXMgbm9uZTpcbiAgICAgIGlmIChmb3Jlc3Quc2VsZWN0ZWQoKS5sZW5ndGggPT09IDApIHtcbiAgICAgICAgbWVudS5kaXNhYmxlKCdncm91cCcpO1xuICAgICAgICBtZW51LmRpc2FibGUoJ2RlbGV0ZScpO1xuICAgICAgICBtZW51LmRpc2FibGUoJ2RlbGV0ZS1ncm91cCcpO1xuICAgICAgICBtZW51LmRpc2FibGUoJ3NldHByb2R1Y3Rpb25mbGFnJyk7XG4gICAgICAgIG1lbnUuZGlzYWJsZSgnY29sbGFwc2UnKTtcbiAgICAgICAgbWVudS5kaXNhYmxlKCdlZGl0Jyk7XG4gICAgICAgIG1lbnUuZGlzYWJsZSgnaGlkZScpO1xuICAgICAgfVxuXG4gICAgICAvLyBFeGNlcHQgZm9yIHRob3NlIHJlcXVpcmluZyBtYXhpbXVtIGEgc2luZ2xlIGFjdGl2ZSBzZWxlY3Rpb24gYmVpbmcgYSBncm91cDpcbiAgICAgIGlmICghZm9yZXN0LmlzX21heF9zaW5nbGVfbm9kZV9zZWxlY3RlZCgpKSB7XG4gICAgICAgIG1lbnUuZGlzYWJsZSgnYWRkLWdyb3VwJyk7XG4gICAgICAgIG1lbnUuZGlzYWJsZSgnYWRkLWV2ZW50Jyk7XG4gICAgICAgIG1lbnUuZGlzYWJsZSgnZWRpdCcpO1xuICAgICAgfVxuXG4gICAgICAvLyAnRGVsZXRlIEdyb3VwIE9ubHknIHJlcXVpcmVzIG9ubHkgZ3JvdXBzIHRvIGJlIHNlbGVjdGVkXG4gICAgICBpZiAoXG4gICAgICAgIGZvcmVzdC5zZWxlY3RlZCgpLnNvbWUoKGUpID0+ICFlLmlzX2dyb3VwKCkpXG4gICAgICApIHtcbiAgICAgICAgbWVudS5kaXNhYmxlKCdkZWxldGUtZ3JvdXAnKTtcbiAgICAgIH1cblxuICAgICAgLy8gRXhjZXB0IGZvciB0aG9zZSByZXF1aXJpbmcgY2VydGFpbiBwZXJtaXNzaW9uc1xuICAgICAgaWYgKCFmb3Jlc3QuYWxsb3dfZXZlbnRfY3JlYXRpb24gfHwgIWZvcmVzdC5pc193cml0ZV9ldmVudHNfYWxsb3dlZCgpKSB7XG4gICAgICAgIG1lbnUuZGlzYWJsZSgnYWRkLWV2ZW50Jyk7XG4gICAgICAgIG1lbnUuZGlzYWJsZSgnYWRkLWdyb3VwJyk7XG4gICAgICAgIG1lbnUuZGlzYWJsZSgnZ3JvdXAnKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFmb3Jlc3QuaXNfd3JpdGVfZXZlbnRzX2FsbG93ZWQoKSkge1xuICAgICAgICBtZW51LmRpc2FibGUoJ2dyb3VwJyk7XG4gICAgICAgIG1lbnUuZGlzYWJsZSgnc2V0cHJvZHVjdGlvbmZsYWcnKTtcbiAgICAgIH1cbiAgICAgIGlmICghZm9yZXN0LmlzX2RlbGV0ZV9ldmVudHNfYWxsb3dlZCgpKSBtZW51LmRpc2FibGUoJ2RlbGV0ZScpO1xuXG4gICAgICBpZiAoIWZvcmVzdC5pc19kZWxldGVfZ3JvdXBfb25seV9hbGxvd2VkKCkpIG1lbnUuZGlzYWJsZSgnZGVsZXRlLWdyb3VwJyk7XG5cbiAgICAgIC8vIFNob3cgRWRpdCBncm91cCBvciBFZGl0IGV2ZW50XG4gICAgICBpZiAoZm9yZXN0LnNlbGVjdGVkKCkubGVuZ3RoID09PSAxICYmIGZvcmVzdC5zZWxlY3RlZCgpWzBdLmlzX2dyb3VwKCkpIHtcbiAgICAgICAgbWVudS5zZXRfdGV4dCgnZWRpdCcsIGkxOG4oJ0VkaXQgR3JvdXAuLi4nKSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBtZW51LnNldF90ZXh0KCdlZGl0JywgaTE4bignRWRpdCBFdmVudC4uLicpKTtcbiAgICAgIH1cblxuICAgICAgLy8gQWRhcHQgdGhlIFNldCBQcm9kdWN0aW9uIGFjdGlvbiBsYWJlbCB0byBpbmRpY2F0ZSBpZiB3ZSB3aWxsIHNldCBvciB1bnNldCB0aGUgcHJvZHVjdGlvblxuICAgICAgaWYgKGZvcmVzdC5wcm9kdWN0aW9uZmxhZ19vZl9zZWxlY3RlZF9ub2RlcygpKSB7XG4gICAgICAgIG1lbnUuc2V0X3RleHQoJ3NldHByb2R1Y3Rpb25mbGFnJywgaTE4bignVW5zZXQgUHJvZHVjdGlvbicpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIG1lbnUuc2V0X3RleHQoJ3NldHByb2R1Y3Rpb25mbGFnJywgaTE4bignU2V0IFByb2R1Y3Rpb24nKSk7XG4gICAgICB9XG5cbiAgICAgIC8vIEFuZCBzaG93biBvbiB0aGUgcGFnZS5cbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIG1lbnUuc2hvdyhlLnBhZ2VYLCBlLnBhZ2VZKTtcbiAgICB9KTtcbiAgfTtcblxuICBzZXR1cF9idXR0b25zKCkge1xuICAgIGNvbnN0IGZvcmVzdCA9IHRoaXM7XG5cbiAgICAvLyBFbmFibGVzL0Rpc2FibGVzIHRoZSAnZ3JvdXAvcmVtb3ZlIHNlbGVjdGVkJyBidXR0b25zIGFzIG5lZWRlZC5cbiAgICBrby5jb21wdXRlZChmdW5jdGlvbigpIHtcbiAgICAgIC8vIE5vIGFjdGlvbnMgYWxsb3dlZCB3aGlsZSBvbmUgaXMgcnVubmluZzpcbiAgICAgIGlmICh0aGlzLnJ1bm5pbmdfYWN0aW9uKCkgIT09IG51bGwpIHtcbiAgICAgICAgJChgJHt0aGlzLmNvbnRhaW5lcl9zZWxlY3Rvcn0gLmJ0bmApLmFkZENsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIE90aGVyd2lzZSBhY3Rpb25zIGFyZSBhbGxvd2VkOlxuICAgICAgJChgJHt0aGlzLmNvbnRhaW5lcl9zZWxlY3Rvcn0gLmJ0bmApLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xuXG4gICAgICAvLyBVbmRvIGFjdGlvbiBhbGxvd2VkIHdoZW4geWVzcGxhbiBzYXlzIHRoZXJlIGlzIGFuIHVuZG8gYWN0aW9uXG4gICAgICBpZiAoISR5ZXNwbGFuLmhhc191bmRvKCd0cmVldmlldycpKSB7XG4gICAgICAgICQoYCR7dGhpcy5jb250YWluZXJfc2VsZWN0b3J9IC5idG4uYWN0aW9uX3VuZG9gKVxuICAgICAgICAgIC5hZGRDbGFzcygnZGlzYWJsZWQnKVxuICAgICAgICAgIC5odG1sKGkxOG4oJ1VuZG8nKSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAkKGAke3RoaXMuY29udGFpbmVyX3NlbGVjdG9yfSAuYnRuLmFjdGlvbl91bmRvYCkuaHRtbChcbiAgICAgICAgICBgJHtpMThuKCdVbmRvJyl9ICR7JHllc3BsYW4udW5kb19uYW1lKCd0cmVldmlldycpfWBcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgLy8gRXhjZXB0IGZvciB0aG9zZSByZXF1aXJpbmcgY2VydGFpbiBwZXJtaXNzaW9uc1xuICAgICAgaWYgKFxuICAgICAgICAhZm9yZXN0LmFsbG93X2V2ZW50X2NyZWF0aW9uIHx8XG4gICAgICAgICFmb3Jlc3QuaXNfd3JpdGVfZXZlbnRzX2FsbG93ZWQoKSB8fFxuICAgICAgICAhZm9yZXN0LmlzX21heF9zaW5nbGVfbm9kZV9zZWxlY3RlZCgpXG4gICAgICApIHtcbiAgICAgICAgJChgJHt0aGlzLmNvbnRhaW5lcl9zZWxlY3Rvcn0gLmJ0bi5hY3Rpb25fbmV3X2V2ZW50YCkuYWRkQ2xhc3MoXG4gICAgICAgICAgJ2Rpc2FibGVkJ1xuICAgICAgICApO1xuICAgICAgICAkKGAke3RoaXMuY29udGFpbmVyX3NlbGVjdG9yfSAuYnRuLmFjdGlvbl9uZXdfZ3JvdXBgKS5hZGRDbGFzcyhcbiAgICAgICAgICAnZGlzYWJsZWQnXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfSwgdGhpcyk7XG5cbiAgICB0aGlzLmNvbnRhaW5lci5vbihcbiAgICAgICdjbGljaycsXG4gICAgICAnLmJ0bi5hY3Rpb25fbmV3X2V2ZW50Om5vdCguZGlzYWJsZWQpJyxcbiAgICAgIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB0aGlzLnNob3dfZXZlbnRfaW5mb19wb3BvdmVyKG51bGwsIG51bGwpO1xuICAgICAgfS5iaW5kKHRoaXMpXG4gICAgKTtcblxuICAgIC8vIENsaWNraW5nIHRoZSAnbmV3IGdyb3VwJyBidXR0b24gY3JlYXRlcyBhIG5ldyBncm91cC5cbiAgICB0aGlzLmNvbnRhaW5lci5vbignY2xpY2snLCAnLmJ0bi5hY3Rpb25fbmV3X2dyb3VwOm5vdCguZGlzYWJsZWQpJywgZnVuY3Rpb24oZSkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgZm9yZXN0LmFkZF9uZXdfZ3JvdXAoKTtcbiAgICB9KTtcblxuICAgIC8vIENsaWNraW5nIHRoZSAnZ3JvdXAgc2VsZWN0ZWQnIGJ1dHRvbiBjcmVhdGVzIGEgbmV3IGdyb3VwIGhvbGRpbmcgdGhlXG4gICAgLy8gc2VsZWN0ZWQgZXZlbnRzLlxuICAgIHRoaXMuY29udGFpbmVyLm9uKCdjbGljaycsICcuYnRuLmFjdGlvbl9ncm91cF9zZWxlY3RlZCcsIGZ1bmN0aW9uKGUpIHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGZvcmVzdC5ncm91cF9zZWxlY3RlZCgpO1xuICAgIH0pO1xuXG4gICAgLy8gQ2xpY2tpbmcgdGhlICdyZW1vdmUgc2VsZWN0ZWQnIGJ1dHRvbiByZW1vdmVzIGFsbCBzZWxlY3RlZCBldmVudHMuXG4gICAgdGhpcy5jb250YWluZXIub24oJ2NsaWNrJywgJy5idG4uYWN0aW9uX3JlbW92ZV9zZWxlY3RlZCcsZnVuY3Rpb24oZSkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgZm9yZXN0LnJlbW92ZV9zZWxlY3RlZCgpO1xuICAgIH0pO1xuXG4gICAgLy8gQ2xpY2tpbmcgdGhlICd1bmRvJyBidXR0b24gcmVtb3ZlcyBhbGwgc2VsZWN0ZWQgZXZlbnRzLlxuICAgIHRoaXMuY29udGFpbmVyLm9uKCdjbGljaycsICcuYnRuLmFjdGlvbl91bmRvJywgZnVuY3Rpb24oZSkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgZm9yZXN0LnVuZG9fbGFzdF9hY3Rpb24oKTtcbiAgICB9KTtcbiAgfTtcblxuICBzaG93X2V2ZW50X2luZm9fcG9wb3ZlcihlLCBub2RlKSB7XG4gICAgLy8gSWYgaW52b2tlZCB2aWEgY29udGV4dCBtZW51OlxuICAgIGlmIChlKSB7XG4gICAgICBuZXcgRXZlbnRJbmZvUG9wb3Zlcih0aGlzLCB0cnVlLCBub2RlLCBub2RlICE9PSBudWxsKS5zaG93KGUpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIElmIGludm9rZWQgdmlhIGFjdGlvbiBidXR0b246XG4gICAgbmV3IEV2ZW50SW5mb1BvcG92ZXIodGhpcywgZmFsc2UsIG51bGwsIGZhbHNlKS5zaG93KCk7XG4gIH07XG5cbiAgaXNfcmVjb3JkX3NlbGVjdGVkKGlkKSB7XG4gICAgY29uc3Qgc2VsZWN0ZWQgPSB0aGlzLnNlbGVjdGVkKCk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzZWxlY3RlZC5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHJlY29yZF9pZChzZWxlY3RlZFtpXS5yZWNvcmQpID09PSBpZCkgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICBzZWxlY3Rpb25fY291bnQoKSB7XG4gICAgcmV0dXJuIHRoaXMuc2VsZWN0ZWQoKS5sZW5ndGg7XG4gIH07XG5cbiAgZGVzZWxlY3RfYWxsKCkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5zZWxlY3Rpb25fY291bnQoKTsgaSsrKSB7XG4gICAgICBjb25zdCBub2RlID0gdGhpcy5zZWxlY3RlZCgpW2ldO1xuICAgICAgbm9kZS5zZWxlY3RlZCA9IGZhbHNlO1xuICAgICAgaWYgKG5vZGUuZWxlbWVudCkge1xuICAgICAgICBub2RlLmVsZW1lbnQucmVtb3ZlQ2xhc3MoJ3NlbGVjdGVkJyk7XG4gICAgICAgIHVubWFya19jaGlsZHJlbl9wYXJlbnRfc2VsZWN0ZWQobm9kZSk7XG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMuc2VsZWN0ZWQucmVtb3ZlQWxsKCk7XG4gIH07XG5cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy8gRHJhZyAnbiBkcm9wIGludGVyYWN0aW9uc1xuXG4gIC8vIFRoaXMgaXMgbWFraW5nIHVzZSBvZiBIVE1MNSBzdXBwb3J0IGZvciBkcmFnIGFuZCBkcm9wLiBUbyBtYWtlIGxpZmVcbiAgLy8gZWFzaWVyIHdlIHRyYWNrIHdoaWNoIG5vZGUgaXMgYmVpbmcgZHJhZ2dlZDpcbiAgc2V0dXBfZHJhZ19hbmRfZHJvcCgpIHtcbiAgICBjb25zdCBkcm9wem9uZSA9ICQoYCR7dGhpcy5jb250YWluZXJfc2VsZWN0b3J9IC5kcm9wem9uZWApO1xuICAgIGNvbnN0IHRyZWUgPSB0aGlzO1xuXG4gICAgLy8gV2hlbiBkcmFnZ2luZyBzdGFydHMgd2UgbmVlZCB0byBjb3JyZWN0bHkgc2V0IHVwIHRoZSBkYXRhVHJhbnNmZXIuXG4gICAgdGhpcy5wYW5lbC5vbignZHJhZ3N0YXJ0JywgJy50cmVlLWV2ZW50JywgZnVuY3Rpb24oZSkge1xuICAgICAgdHJlZS5ub2RlX2JlaW5nX2RyYWdnZWQgPSBkMy5zZWxlY3QodGhpcykuZGF0YSgpWzBdO1xuXG4gICAgICAvLyBQcmV2ZW50IGRyYWcvZHJvcCB3aGVuIGluIGVkaXQgbW9kdXNcbiAgICAgIGlmICgkKHRyZWUubm9kZV9iZWluZ19kcmFnZ2VkLmVsZW1lbnQpLmZpbmQoJ2lucHV0JykubGVuZ3RoID4gMCkgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAvLyBEcmFnZ2luZyBzZWxlY3RzLlxuICAgICAgaWYgKCF0cmVlLm5vZGVfYmVpbmdfZHJhZ2dlZC5zZWxlY3RlZCkge1xuICAgICAgICBpZiAoaGFzTWV0YUtleShlKSkge1xuICAgICAgICAgIHNlbGVjdF9ub2RlKHRyZWUubm9kZV9iZWluZ19kcmFnZ2VkKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBzaW5nbGVfc2VsZWN0X25vZGUodHJlZS5ub2RlX2JlaW5nX2RyYWdnZWQpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIC8vIFRoZSBhY3R1YWwgZHJhZyBldmVudCBpcyBnZXR0aW5nIHdyYXBwZWQgYnkgSlF1ZXJ5LlxuICAgICAgY29uc3QgZXZ0ID0gZS5vcmlnaW5hbEV2ZW50O1xuXG4gICAgICAvLyBXZSdyZSBvbmx5IGludGVyZXN0ZWQgaW4gbW92aW5nIG5vZGVzIGFyb3VuZC5cbiAgICAgIGV2dC5kYXRhVHJhbnNmZXIuZWZmZWN0QWxsb3dlZCA9ICdtb3ZlJztcbiAgICAgIGV2dC5kYXRhVHJhbnNmZXIuZHJvcEVmZmVjdCA9ICdtb3ZlJztcblxuICAgICAgLy8gRmlyZWZveCB3aWxsIHJlZnVzZSB0byBkcmFnIHdpdGhvdXQgc2V0dGluZyBzb21lIGRhdGFcbiAgICAgIC8vIG9uIHRoZSBkYXRhVHJhbnNmZXIgb2JqZWN0LlxuICAgICAgZXZ0LmRhdGFUcmFuc2Zlci5zZXREYXRhKFxuICAgICAgICAndGV4dC9wbGFpbicsXG4gICAgICAgIHJlY29yZF9pZCh0cmVlLm5vZGVfYmVpbmdfZHJhZ2dlZC5yZWNvcmQpXG4gICAgICApO1xuXG4gICAgICAvLyBUaGVuIHdlIGRlZmluZSB0aGUgXCJkcmFnIGltYWdlXCI7IHdoaWNoIGlzIHdoYXQgeW91IHNlZSBhcyBiZWluZ1xuICAgICAgLy8gZHJhZ2dlZCBhcm91bmQuIFVuZm9ydHVuYXRlbHkgdGhlcmUgaXMgbm8gcmVhbGx5IGNsZWFuIHdheSBvZiBkb2luZ1xuICAgICAgLy8gdGhpcywgYXMgeW91IGNhbiByZWFkIGhlcmU6XG4gICAgICAvLyBodHRwOi8vd3d3LmtyeW9nZW5peC5vcmcvY29kZS9icm93c2VyL2N1c3RvbS1kcmFnLWltYWdlLmh0bWxcbiAgICAgIC8vIEZpcmVmb3ggYWN0dWFsbHkgcmVsYXhlcyB0aGUgc3BlYyBhIGJpdCwgYnkgbm90IGluc2lzdGluZyBvbiB0aGVcbiAgICAgIC8vIGVsZW1lbnQgYmVpbmcgdmlzaWJsZSBpbiwgb3IgZXZlbiBhdHRhY2hlZCB0byB0aGUgZG9jdW1lbnQuIENocm9tZVxuICAgICAgLy8gYW5kIFNhZmFyaSwgaG93ZXZlciwgYXJlIG5vdCBhcyBsZW5pZW50LlxuXG4gICAgICAvLyBDbG9uZSB0aGUgb3JpZ2luYWwgZHJhZ2dlZCBub2RlIGFuZCB0cmFuc2Zvcm0gaXQgb25seSB3aGVuIGEgbXVsdGktZXZlbnQgZHJhZyBoYXBwZW5zXG4gICAgICBjb25zdCBkcmFnX2ltYWdlID0gJCh0aGlzKS5jbG9uZSgpO1xuICAgICAgZHJhZ19pbWFnZS5hZGRDbGFzcygnYmVpbmctZHJhZ2dlZCcpO1xuXG4gICAgICBjb25zdCBzZWxlY3RlZF9jb3VudCA9IHRyZWUubm9kZV9iZWluZ19kcmFnZ2VkLmZvcmVzdC5zZWxlY3Rpb25fY291bnQoKTtcbiAgICAgIGlmIChzZWxlY3RlZF9jb3VudCA+IDEpIHtcbiAgICAgICAgZHJhZ19pbWFnZVxuICAgICAgICAgIC5hZGRDbGFzcygndHJlZS1tdWx0aXBsZScpXG4gICAgICAgICAgLmZpbmQoJy5sYWJlbCcpXG4gICAgICAgICAgLmh0bWwoYDxzcGFuIGNsYXNzPVwibmFtZVwiPiR7c2VsZWN0ZWRfY291bnR9IGl0ZW1zPC9zcGFuPmApO1xuICAgICAgfVxuXG4gICAgICBpZiAodHJlZS5ub2RlX2JlaW5nX2RyYWdnZWQuaXNfZ3JvdXAoKSkgZHJhZ19pbWFnZS5hZGRDbGFzcygndHJlZS1ub2RlcycpO1xuXG4gICAgICAvLyBOZWVkZWQgYnkgdGhlIGRyYWcvZHJvcCBzcGVjIHRvIGdldCBhIHZhbGlkIGRyYWcgaW1hZ2UuXG4gICAgICAkKCdib2R5JykuYXBwZW5kKGRyYWdfaW1hZ2UpO1xuXG4gICAgICAvLyBTZXQgaXQgdXAgb24gdGhlIGRhdGEgdHJhbnNmZXIgb2JqZWN0LlxuICAgICAgZXZ0LmRhdGFUcmFuc2Zlci5zZXREcmFnSW1hZ2UoZHJhZ19pbWFnZS5nZXQoMCksIDAsIDApO1xuXG4gICAgICAvLyBBbmQgd2UgY2FuIHRoZW4gcmVtb3ZlIHRoZSBjbG9uZWQgZWxlbWVudCBhZ2Fpbi4gVGhlIGJyb3dzZXJzIHdpbGxcbiAgICAgIC8vIGtlZXAgdXNpbmcgdGhlIGltYWdlIGdlbmVyYXRlZCBmcm9tIHRoaXMgZWxlbWVudCwgcmF0aGVyIHRoYW4gdGhlXG4gICAgICAvLyBlbGVtZW50IGl0c2VsZi5cbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAkKCcuYmVpbmctZHJhZ2dlZCcpLnJlbW92ZSgpO1xuICAgICAgfSwgMCk7XG5cbiAgICAgIC8vIFNob3cgdGhlIGRyb3B6b25lLCB1bmxlc3Mgd2UncmUgZHJhZ2dpbmcgdGhlIHJvb3Qgb2YgYSB0cmVlOlxuICAgICAgaWYgKFxuICAgICAgICAhdHJlZS5ub2RlX2JlaW5nX2RyYWdnZWQuZm9yZXN0LnNlbGVjdGVkKCkuc29tZSgoZWwpID0+IHtcbiAgICAgICAgICByZXR1cm4gZWwuaXNfcm9vdCgpO1xuICAgICAgICB9KVxuICAgICAgKSB7XG4gICAgICAgIGRyb3B6b25lLmFkZENsYXNzKCdzaG93Jyk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBUaGlzIGNsZWFycyB0aGUgdHJhY2tpbmcuXG4gICAgdGhpcy5wYW5lbC5vbignZHJhZ2VuZCcsICcudHJlZS1ldmVudCcsIGZ1bmN0aW9uKCkge1xuICAgICAgdHJlZS5ub2RlX2JlaW5nX2RyYWdnZWQgPSBudWxsO1xuXG4gICAgICAvLyBIaWRlIHRoZSBkcm9wem9uZTpcbiAgICAgIGRyb3B6b25lLnJlbW92ZUNsYXNzKCdzaG93Jyk7XG4gICAgICBkcm9wem9uZS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG4gICAgfSk7XG5cbiAgICBsZXQgYXV0b19leHBhbmRfdGltZXJfc3RhcnQgPSBudWxsO1xuXG4gICAgLy8gVGhpcyBsZXRzIHRoZSBkcm9wcGFibGVzIHJlc3BvbmQgdG8gdGhlIG9iamVjdCBiZWluZyBkcmFnZ2VkIHdoZW5ldmVyXG4gICAgLy8gaXQgZ2V0cyBkcmFnZ2VkIG92ZXIgdGhlbS5cbiAgICB0aGlzLnBhbmVsLm9uKCdkcmFnb3ZlcicsICcudHJlZS1ldmVudCcsIGZ1bmN0aW9uKGUpIHtcbiAgICAgIC8vIENhbiBub3QgZ2V0IHRoZSBhY3R1YWwgZGF0YSBpbiBkcmFnb3ZlciBldmVudHMuXG4gICAgICAvLyB2YXIgZXZ0ID0gZS5vcmlnaW5hbEV2ZW50XG4gICAgICAvLyB2YXIgZGF0YSA9IGV2dC5kYXRhVHJhbnNmZXIuZ2V0RGF0YSgndGV4dC9wbGFpbicpXG4gICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKVxuXG4gICAgICAvLyBIZXJlICd0aGlzJyByZWZlcnMgdG8gdGhlIGRyb3BwYWJsZS5cbiAgICAgIGNvbnN0IHRhcmdldF9ub2RlID0gZDMuc2VsZWN0KHRoaXMpLmRhdGEoKVswXTtcbiAgICAgIGlmICghdGFyZ2V0X25vZGUgfHwgIXRyZWUubm9kZV9iZWluZ19kcmFnZ2VkKSByZXR1cm47XG5cbiAgICAgIC8vIElmIHRoZSBkcmFnZ2VkIGl0ZW0gZ2V0cyBob3ZlcmVkIG92ZXIgc29tZXRoaW5nIHdoaWNoIGNhbiBiZSBleHBhbmRlZFxuICAgICAgLy8gZm9yIGEgbG9uZyBlbm91Z2ggdGltZSwgd2UgZXhwYW5kIHRoYXQgdGFyZ2V0LlxuICAgICAgaWYgKHRhcmdldF9ub2RlLmhhc19leHBhbmRlZCgpKSB7XG4gICAgICB9IGVsc2UgaWYgKGF1dG9fZXhwYW5kX3RpbWVyX3N0YXJ0ID09PSBudWxsKSB7XG4gICAgICAgIC8vIE5PUFxuICAgICAgICBhdXRvX2V4cGFuZF90aW1lcl9zdGFydCA9IERhdGUubm93KCk7XG4gICAgICB9IGVsc2UgaWYgKERhdGUubm93KCkgLSBhdXRvX2V4cGFuZF90aW1lcl9zdGFydCA+IDEwMDApIHtcbiAgICAgICAgdGFyZ2V0X25vZGUuZXhwYW5kKCk7XG4gICAgICAgIHRyZWUucmVxdWVzdF91cGRhdGUoKTtcbiAgICAgIH1cblxuICAgICAgLy8gSWYgd2UgY2FuJ3QgZHJvcCB0aGUgbm9kZSBoZXJlIHdlIGp1c3QgYmFpbCBvdXQuXG4gICAgICBpZiAoIWlzX2xlZ2FsX2Ryb3BfdGFyZ2V0KHRhcmdldF9ub2RlLCB0cmVlLm5vZGVfYmVpbmdfZHJhZ2dlZCkpIHJldHVybjtcblxuICAgICAgLy8gSWYgd2UgY2FuIGRyb3AgdGhlIG5vZGUgaGVyZSwgd2UgbmVlZCB0byBtYXJrIGl0IGFzIGEgbGVnYWwgZHJvcFxuICAgICAgLy8gdGFyZ2V0IGJ5IHByZXZlbnRpbmcgZnVydGhlciBwcm9jZXNzaW5nIG9mIHRoZSBldmVudCAoc2lsbHksIEkga25vdykuXG4gICAgICAvLyBEb2luZyBzbyBlbmFibGVzIHRoZSBkcm9wIGV2ZW50IG9uIHRoaXMgbm9kZSBzaG91bGQgdGhlIHVzZXJcbiAgICAgIC8vIGFjdHVhbGx5IGRlY2lkZSB0byBkcm9wIHRoZSBldmVudCBoZXJlLlxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgICAvLyBHaXZlIHNvbWUgdmlzdWFsIGZlZWRiYWNrIHRvIHRoZSB1c2VyczpcbiAgICAgIGhpZ2hsaWdodF9kcm9wX3RhcmdldHModGhpcywgdGFyZ2V0X25vZGUpO1xuICAgIH0pO1xuXG4gICAgdGhpcy5wYW5lbC5vbignZHJhZ2xlYXZlJywgJy50cmVlLWV2ZW50JywgZnVuY3Rpb24oKSB7XG4gICAgICAvLyBSZXNldCB0aGUgYXV0by1leHBhbmQgdGltZXIuXG4gICAgICBhdXRvX2V4cGFuZF90aW1lcl9zdGFydCA9IG51bGw7XG5cbiAgICAgIC8vIEdpdmUgc29tZSB2aXN1YWwgZmVlZGJhY2sgdG8gdGhlIHVzZXJzOlxuICAgICAgdW5oaWdobGlnaHRfZHJvcF90YXJnZXRzKCk7XG4gICAgfSk7XG5cbiAgICAvLyBBY3R1YWwgZHJvcHBpbmcgb2YgYW4gZXZlbnQgb250byBhIHZhbGlkIHRhcmdldDpcbiAgICB0aGlzLnBhbmVsLm9uKCdkcm9wJywgJy50cmVlLWV2ZW50JywgZnVuY3Rpb24oZSkge1xuICAgICAgLy8gTWFrZSBzdXJlIG5vIG5hdGl2ZSBicm93c2VyIGJlaGF2aW91ciB0cmlnZ2VycyB3aGVuIGRyb3BwaW5nIHRoaW5ncy5cbiAgICAgIC8vIEUuZy4gYSBwYWdlIHJlZGlyZWN0L3JlZnJlc2guXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgIC8vIEhlcmUgd2UgY2FuIGFjY2VzcyB0aGUgYWN0dWFsIGRhdGEuXG4gICAgICAvLyB2YXIgZXZ0ID0gZS5vcmlnaW5hbEV2ZW50XG4gICAgICAvLyB2YXIgZGF0YSA9IGV2dC5kYXRhVHJhbnNmZXIuZ2V0RGF0YSgndGV4dC9wbGFpbicpXG4gICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKVxuXG4gICAgICAvLyBHcmFiIHRoZSBub2RlcyBhbmQgdHJpZ2dlciB0aGUgYnVzaW5lc3MgbG9naWMuXG4gICAgICBjb25zdCB0YXJnZXRfbm9kZSA9IGQzLnNlbGVjdCh0aGlzKS5kYXRhKClbMF07XG4gICAgICBtb3ZlX2V2ZW50c190b190YXJnZXQodHJlZS5ub2RlX2JlaW5nX2RyYWdnZWQsIHRhcmdldF9ub2RlLCB0cmVlLm1vZGVsKTtcbiAgICB9KTtcblxuICAgIGRyb3B6b25lLm9uKCdkcmFnb3ZlcicsIGZ1bmN0aW9uKGUpIHtcbiAgICAgIC8vIENhbiBub3QgZ2V0IHRoZSBhY3R1YWwgZGF0YSBpbiBkcmFnb3ZlciBldmVudHMuXG4gICAgICAvLyB2YXIgZXZ0ID0gZS5vcmlnaW5hbEV2ZW50XG4gICAgICAvLyB2YXIgZGF0YSA9IGV2dC5kYXRhVHJhbnNmZXIuZ2V0RGF0YSgndGV4dC9wbGFpbicpXG4gICAgICAvLyBjb25zb2xlLmxvZyhkYXRhKVxuXG4gICAgICBkcm9wem9uZS5hZGRDbGFzcygnYWN0aXZlJyk7XG5cbiAgICAgIC8vIFdlIGFjY2VwdCBhbGwgbm9kZXMuXG4gICAgICBpZiAodGhpcy5ub2RlX2JlaW5nX2RyYWdnZWQpIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB9LmJpbmQodGhpcykpO1xuXG4gICAgZHJvcHpvbmUub24oJ2RyYWdsZWF2ZScsIGZ1bmN0aW9uKCkge1xuICAgICAgZHJvcHpvbmUucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuICAgIH0pO1xuXG4gICAgZHJvcHpvbmUub24oJ2Ryb3AnLCBmdW5jdGlvbihlKSB7XG4gICAgICAvLyBNYWtlIHN1cmUgbm8gbmF0aXZlIGJyb3dzZXIgYmVoYXZpb3VyIHRyaWdnZXJzIHdoZW4gZHJvcHBpbmcgdGhpbmdzLlxuICAgICAgLy8gRS5nLiBhIHBhZ2UgcmVkaXJlY3QvcmVmcmVzaC5cbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgLy8gQW5kIHRyaWdnZXIgdGhlIGJ1c2luZXNzIGxvZ2ljLlxuICAgICAgbW92ZV9ldmVudHNfdG9fb3duX3RyZWUodHJlZS5ub2RlX2JlaW5nX2RyYWdnZWQsIHRyZWUubW9kZWwpO1xuICAgIH0pO1xuICB9O1xuXG4vLyBVc2VmdWwgZm9yIGRlYnVnZ2luZzpcbiAgbG9nKCkge1xuICAgIGNvbnNvbGUubG9nKGArKyAke3RoaXMuY29udGFpbmVyX3NlbGVjdG9yfSArKysrKysrK2ApO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy50cmVlcy5sZW5ndGg7IGkrKykgdGhpcy50cmVlc1tpXS5sb2coJycpO1xuICB9O1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./Treeview/Forest.js\n");

/***/ }),

/***/ "./Treeview/Node.js":
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": function() { return /* binding */ Node; }\n/* harmony export */ });\n/* harmony import */ var knockout__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./node_modules/knockout/build/output/knockout-latest.js\");\n/* harmony import */ var knockout__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(knockout__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./Treeview/constants.js\");\n/* harmony import */ var _event_treeview__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"./Treeview/event-treeview.js\");\n/* harmony import */ var _PlaceholderNode__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"./Treeview/PlaceholderNode.js\");\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n// Definition of a single node in the tree.\n/* eslint-disable camelcase, func-names */\n\n\n\n\nvar Node = /*#__PURE__*/function () {\n  function Node(forest, record) {\n    _classCallCheck(this, Node);\n    this.forest = forest;\n    this.record = record;\n\n    // The parent node. This gets managed by D3.\n    this.parent = null;\n\n    // The associated DOM element. This gets tracked by us.\n    this.element = null;\n\n    // The id helps out with debugging.\n    this.id = this.forest.node_instance_count++;\n\n    // The tree tracks all nodes by key, for easy retrieval.\n    this.forest.nodes[(0,_event_treeview__WEBPACK_IMPORTED_MODULE_2__.record_id)(this.record)] = this;\n\n    // The children for this node.\n    this.subnodes = null;\n    // And whether or not they're hidden.\n    this.collapsed = false;\n\n    // Are we currently selected ?\n    this.selected = false;\n\n    // Has this node been unlocked ?\n    this.is_unlocked = knockout__WEBPACK_IMPORTED_MODULE_0___default().observable(false);\n\n    // Whether or not this node should get highlighted as being a newly\n    // created node.\n    this.highlight_as_new = false;\n\n    // Coordinates for positioning this element.\n    this.x = null; // Absolute position (managed by D3)\n    this.y = null; // Absolute position (managed by D3)\n    this.position = null; // Absolute position\n    this.start_position = null; // Absolute position\n    this.indent = 0; // Level (depth) of this node in the tree.\n\n    // Index in the overall tree.\n    this.d3_index = -1;\n\n    // Knockout subscriptions for responding to changes in the view model.\n    this.ko_subscriptions = [];\n\n    // This one listens specifically to changes in the list of children\n    // for the record, so we can modify the list of child nodes accordingly.\n    if (record.c) {\n      this.ko_subscriptions.push(record.c.subscribe(this.rebuild_subnodes, this));\n    }\n\n    // When a date changes we have to rebuild the subnodes for all parent\n    // nodes, as the order may have changed.\n    if (record.d) {\n      this.ko_subscriptions.push(record.d.subscribe(function () {\n        var pt = this.parent;\n        while (pt) {\n          pt.rebuild_subnodes();\n          pt = pt.parent;\n        }\n      }.bind(this)));\n    }\n\n    // This one listens to changes in parentage, which is important for the\n    // root nodes in the tree view.\n    this.ko_subscriptions.push(record.pt.subscribe(this.resync_parentage, this));\n\n    // This one listens to any change in the record, which will trigger an\n    // update of the tree view.\n    this.ko_subscriptions.push(record.$self.subscribe(this.on_record_changed, this));\n  }\n  _createClass(Node, [{\n    key: \"get_tree\",\n    value: function get_tree() {\n      if (this.parent) return this.parent.get_tree();\n      return this.forest.get_tree(this);\n    }\n  }, {\n    key: \"get_key\",\n    value:\n    // The unique key for an event. This basically encodes\n    // NPQueryableObject uniqueIdentifierWithTimestamp .\n    function get_key() {\n      return (0,_event_treeview__WEBPACK_IMPORTED_MODULE_2__.record_id)(this.record);\n    }\n  }, {\n    key: \"get_name_with_abbreviation\",\n    value: function get_name_with_abbreviation() {\n      var location = this.get_location();\n      var show = this.forest.show_location_abbreviation;\n      if (show && this.is_leafevent() && location && location.abbr().length > 0) {\n        return \"\".concat(location.abbr(), \", \").concat(this.record.name());\n      } else {\n        return this.record.name();\n      }\n    }\n  }, {\n    key: \"get_name\",\n    value: function get_name() {\n      return this.record.name();\n    }\n  }, {\n    key: \"is_production\",\n    value: function is_production() {\n      var p = this.record.p;\n      return p && p();\n    }\n  }, {\n    key: \"is_placeholder\",\n    value: function is_placeholder() {\n      return false;\n    }\n  }, {\n    key: \"get_subnodes_without_empty_groups\",\n    value: function get_subnodes_without_empty_groups() {\n      return this.subnodes.filter(function (e) {\n        return !(e.is_group() && e.get_subnodes_without_empty_groups().length === 0);\n      });\n    }\n  }, {\n    key: \"is_date_settable\",\n    value: function is_date_settable() {\n      if (this.is_group()) {\n        var subnodes_without_empty_groups = this.get_subnodes_without_empty_groups();\n        return subnodes_without_empty_groups.length !== 0;\n      } else {\n        return true;\n      }\n    }\n  }, {\n    key: \"get_location\",\n    value: function get_location() {\n      if (this.is_group()) {\n        var subnodes_without_empty_groups = this.get_subnodes_without_empty_groups();\n        if (subnodes_without_empty_groups.length === 0) {\n          return null;\n        } else {\n          return _.reduce(subnodes_without_empty_groups, function (memo, subnode) {\n            if (memo === subnode.get_location()) {\n              return memo;\n            } else {\n              return null;\n            }\n          }, subnodes_without_empty_groups[0].get_location());\n        }\n      } else {\n        return (0,_event_treeview__WEBPACK_IMPORTED_MODULE_2__.location_for_record)(this.record, this.forest.model);\n      }\n    }\n  }, {\n    key: \"is_location_settable\",\n    value: function is_location_settable() {\n      if (this.is_group()) {\n        var subnodes_without_empty_groups = this.get_subnodes_without_empty_groups();\n        return subnodes_without_empty_groups.length !== 0;\n      } else {\n        return true;\n      }\n    }\n  }, {\n    key: \"get_status\",\n    value: function get_status() {\n      // If the node is a group, then return null if the status of the group is heterogenous and the status if it is not\n      if (this.is_group()) {\n        // Empty subgroups are to be ignored because their profile is not heterogenous\n        var subnodes_without_empty_groups = this.get_subnodes_without_empty_groups();\n        if (subnodes_without_empty_groups.length === 0) {\n          return null;\n        } else {\n          return _.reduce(subnodes_without_empty_groups, function (memo, subnode) {\n            if (memo === subnode.get_status()) {\n              return memo;\n            } else {\n              return null;\n            }\n          }, subnodes_without_empty_groups[0].get_status());\n        }\n      } else {\n        return (0,_event_treeview__WEBPACK_IMPORTED_MODULE_2__.status_for_record)(this.record);\n      }\n    }\n  }, {\n    key: \"get_settable_statuses\",\n    value: function get_settable_statuses() {\n      // If the node is a group, take the intersection of all the statuses from its subnodes\n      // Else take them from the record\n      if (this.is_group()) {\n        // Empty subgroups are to be ignored because their status is not heterogenous\n        var subnodes_without_empty_groups = this.get_subnodes_without_empty_groups();\n        if (subnodes_without_empty_groups.length === 0) {\n          return [];\n        } else {\n          return _.reduce(subnodes_without_empty_groups, function (memo, node) {\n            return _.intersection(memo, node.get_settable_statuses());\n          }, subnodes_without_empty_groups[0].get_settable_statuses());\n        }\n      } else {\n        return (0,_event_treeview__WEBPACK_IMPORTED_MODULE_2__.settable_statuses_for_record)(this.record);\n      }\n    }\n  }, {\n    key: \"get_profile\",\n    value: function get_profile() {\n      // If the node is a group, then return null if the profile of the group is heterogenous and the profile if it is not\n      if (this.is_group()) {\n        // Empty subgroups are to be ignored because their profile is not heterogenous\n        var subnodes_without_empty_groups = this.get_subnodes_without_empty_groups();\n        if (subnodes_without_empty_groups.length === 0) {\n          return null;\n        } else {\n          return _.reduce(subnodes_without_empty_groups, function (memo, node) {\n            if (memo === node.get_profile()) {\n              return memo;\n            } else {\n              return null;\n            }\n          }, subnodes_without_empty_groups[0].get_profile());\n        }\n      } else {\n        return (0,_event_treeview__WEBPACK_IMPORTED_MODULE_2__.profile_for_record)(this.record);\n      }\n    }\n  }, {\n    key: \"is_group\",\n    value: function is_group() {\n      return (0,_event_treeview__WEBPACK_IMPORTED_MODULE_2__.record_is_group)(this.record);\n    }\n  }, {\n    key: \"is_leafevent\",\n    value: function is_leafevent() {\n      return !(0,_event_treeview__WEBPACK_IMPORTED_MODULE_2__.record_is_group)(this.record);\n    }\n  }, {\n    key: \"has_conflicts\",\n    value: function has_conflicts() {\n      return (0,_event_treeview__WEBPACK_IMPORTED_MODULE_2__.record_has_conflicts)(this.record);\n    }\n  }, {\n    key: \"has_nodes_with_conflicts\",\n    value: function has_nodes_with_conflicts() {\n      return (0,_event_treeview__WEBPACK_IMPORTED_MODULE_2__.record_has_conflicts)(this.record);\n    }\n  }, {\n    key: \"conflicts\",\n    value: function conflicts() {\n      return (0,_event_treeview__WEBPACK_IMPORTED_MODULE_2__.conflicts_for_record)(this.record);\n    }\n  }, {\n    key: \"is_root\",\n    value: function is_root() {\n      return this.forest.has_tree(this);\n    }\n  }, {\n    key: \"get_root\",\n    value: function get_root() {\n      var root = this;\n      while (root.parent) {\n        root = root.parent;\n      }\n      return root;\n    }\n  }, {\n    key: \"is_dated\",\n    value: function is_dated() {\n      return (0,_event_treeview__WEBPACK_IMPORTED_MODULE_2__.is_defined)(this.record.d) && this.record.d();\n    }\n  }, {\n    key: \"has_expanded\",\n    value: function has_expanded() {\n      return !this.is_group() || !this.collapsed;\n    }\n  }, {\n    key: \"expand\",\n    value: function expand() {\n      this.collapsed = false;\n    }\n  }, {\n    key: \"rebuild_subnodes\",\n    value:\n    // This should get called whenever the record's children change. We then need\n    // to rebuild the subnodes for this node to match the record's children.\n    function rebuild_subnodes() {\n      var _this = this;\n      if (this.subnodes === null) return;\n\n      // Ask how they should get rebuilt.\n      // We sort the events on the client, not on the server.\n      var record_ids = (0,_event_treeview__WEBPACK_IMPORTED_MODULE_2__.children_of_record)(this.record).slice(0).filter(function (id) {\n        return _this.forest.model.get(id, false);\n      }) // filter out non-existent records\n      .sort(function (id1, id2) {\n        return (0,_event_treeview__WEBPACK_IMPORTED_MODULE_2__.compare_by_announceddatetime_recursive_then_name)(id1, id2, _this.forest.model);\n      });\n\n      // Figure out which records should stay hidden. This is to remove visual\n      // clutter and make working with larger trees more manageable.\n      var hidden_record_ids = this.get_hidden_record_ids(record_ids);\n\n      // We want to reuse existing placeholder nodes as much as possible. Mostly\n      // to prevent some unwanted animations when updating the event tree. So we\n      // grab all existing placeholders, and clear them out for reuse.\n      var recycled_placeholders = this.subnodes.filter(function (it) {\n        return it instanceof _PlaceholderNode__WEBPACK_IMPORTED_MODULE_3__[\"default\"];\n      });\n      recycled_placeholders.forEach(function (it) {\n        it.eject_all();\n      });\n\n      // We now have everything to start (re)building the subnodes. Which means\n      // we can clear out the old list (if needed).\n      if (this.subnodes.length > 0) this.subnodes = [];\n\n      // We iterate over the child record ids this node should have:\n      for (var i = 0; i < record_ids.length; i++) {\n        var _record_id = record_ids[i];\n        var hidden = hidden_record_ids.indexOf(_record_id) >= 0;\n\n        // If the record id is still part of a placeholder node (which would have\n        // to be one for another parent) we need to eject it from that first.\n        var node = this.forest.node_for_record_or_null(_record_id);\n        if (node !== null && node instanceof _PlaceholderNode__WEBPACK_IMPORTED_MODULE_3__[\"default\"]) {\n          node.eject(_record_id);\n        }\n\n        // Now it all depends on whether or not the node should be hidden.\n        if (!hidden) {\n          // If it shouldn't be hidden we can just add it to the list.\n          var subnode = this.forest.node_for_record(_record_id);\n          subnode.parent = this;\n          this.subnodes.push(subnode);\n        } else {\n          // If it should be hidden we need to add it to a placeholder node.\n          // So we first check if there already is one available.\n          var length = this.subnodes.length;\n          var last = length === 0 ? null : this.subnodes[length - 1];\n          if (last && last instanceof _PlaceholderNode__WEBPACK_IMPORTED_MODULE_3__[\"default\"]) {\n            // There is, and so we can just add the child record id to it.\n            last.insert(_record_id);\n          } else if (recycled_placeholders.length > 0) {\n            // There is not, but we can recycle an existing placeholder.\n            var placeholder = recycled_placeholders.shift();\n            placeholder.insert(_record_id);\n            this.subnodes.push(placeholder);\n          } else {\n            // There is not, and we must create a new placeholder.\n            this.subnodes.push(new _PlaceholderNode__WEBPACK_IMPORTED_MODULE_3__[\"default\"](this, [_record_id]));\n          }\n        }\n      }\n    }\n  }, {\n    key: \"resync_parentage\",\n    value:\n    // This should get called whenever the record's parent id changes. In such a\n    // case we may need to update the roots of the tree view.\n    function resync_parentage() {\n      // The parent link gets maintained by D3, except for root nodes... So, for\n      // those cases, we clear it ourselves.\n      if (this.record.pt() === null) this.parent = null;\n      if (this.forest.has_tree(this)) {\n        this.forest.remove_tree(this);\n        this.forest.show_node(this);\n      }\n    }\n  }, {\n    key: \"on_record_changed\",\n    value:\n    // This should get called whenever the record ('s $self) changes. We may\n    // either have to update the tree view, or dispose of the node.\n    function on_record_changed(record) {\n      if (!record) {\n        if (this.forest.has_tree(this)) this.forest.remove_tree(this);\n        this.dispose();\n        // Make sure no parent pointers are still referring to me.\n        if (this.has_subnodes()) {\n          this.subnodes.forEach(function (x) {\n            x.resync_parentage();\n          });\n        }\n      }\n      this.forest.request_update();\n    }\n  }, {\n    key: \"can_be_group_only_deleted\",\n    value: function can_be_group_only_deleted() {\n      return this.is_group() && this.is_not_locked() && (0,_event_treeview__WEBPACK_IMPORTED_MODULE_2__.record_can_be_deleted)(this.record);\n    }\n  }, {\n    key: \"can_be_deleted\",\n    value: function can_be_deleted() {\n      return this.is_not_locked() && (0,_event_treeview__WEBPACK_IMPORTED_MODULE_2__.record_can_be_deleted)(this.record) && !this.has_nodes_with_actual_lock();\n    }\n  }, {\n    key: \"has_nodes_with_actual_lock\",\n    value: function has_nodes_with_actual_lock() {\n      if (this.is_group()) {\n        return this.subnodes.some(function (subnode) {\n          return subnode.has_nodes_with_actual_lock();\n        });\n      } else {\n        return this.has_actual_lock();\n      }\n    }\n  }, {\n    key: \"has_subnode\",\n    value:\n    // Is the given node a subnode of this one ?\n    function has_subnode(node) {\n      return this.subnodes && this.subnodes.indexOf(node) >= 0;\n    }\n  }, {\n    key: \"has_subnodes\",\n    value:\n    // Does the node have subnodes ?\n    function has_subnodes() {\n      return this.subnodes && this.subnodes.length > 0;\n    }\n  }, {\n    key: \"remove_subnode\",\n    value:\n    // Remove the given node as a subnode from this one.\n    function remove_subnode(node) {\n      var index = this.subnodes.indexOf(node);\n      if (index >= 0) this.subnodes.splice(index, 1);\n    }\n  }, {\n    key: \"is_last_child\",\n    value: function is_last_child() {\n      if (!this.parent) return false;\n      var siblings = this.parent.subnodes;\n      var index = siblings.indexOf(this);\n      return index === siblings.length - 1;\n    }\n  }, {\n    key: \"has_lock\",\n    value:\n    // Do we need to be displayed with a lock?\n    function has_lock() {\n      if (this.is_leafevent()) {\n        return (0,_event_treeview__WEBPACK_IMPORTED_MODULE_2__.record_has_lock)(this.record);\n      } else {\n        return this.subnodes.some(function (subnode) {\n          return subnode.has_lock();\n        });\n      }\n    }\n  }, {\n    key: \"can_be_unlocked\",\n    value:\n    // Can we be unlocked ?\n    // A leaf event can be unlocked if we have write permissions\n    // A group event can be unlocked if we have write permissions -or- any of its subevents can be unlocked\n    function can_be_unlocked() {\n      if (this.has_actual_lock()) return false;\n      if (this.is_leafevent()) {\n        return (0,_event_treeview__WEBPACK_IMPORTED_MODULE_2__.record_can_be_written)(this.record);\n      } else {\n        return (0,_event_treeview__WEBPACK_IMPORTED_MODULE_2__.record_can_be_written)(this.record) || this.subnodes.some(function (subnode) {\n          return subnode.can_be_unlocked();\n        });\n      }\n    }\n  }, {\n    key: \"is_not_locked\",\n    value:\n    // Are we unlocked or do we not have a lock?\n    function is_not_locked() {\n      return (!this.has_lock() || this.is_unlocked()) && !this.has_actual_lock();\n    }\n  }, {\n    key: \"set_unlocked\",\n    value:\n    // Set this node's unlocked state, updating children and parent unlocked status appropriately\n    // If the node cannot be unlocked, we do nothing\n    function set_unlocked(value) {\n      if (!this.can_be_unlocked()) return;\n      this.is_unlocked(value);\n      if (this.subnodes) {\n        this.subnodes.forEach(function (subnode) {\n          return subnode.set_unlocked(value);\n        });\n      }\n      if (this.parent) this.parent.propagate_parent_unlocked(value);\n    }\n  }, {\n    key: \"propagate_parent_unlocked\",\n    value: function propagate_parent_unlocked(value) {\n      // Locking propagates upwards in the tree, unlocking only if all children are unlocked\n      // (we do tolerate actual locks on the children)\n      if (!value || this.subnodes.every(function (subnode) {\n        return subnode.has_actual_lock() || subnode.is_not_locked();\n      })) {\n        this.is_unlocked(value);\n        if (this.parent) this.parent.propagate_parent_unlocked(value);\n      }\n    }\n  }, {\n    key: \"has_actual_lock\",\n    value: function has_actual_lock() {\n      return (0,_event_treeview__WEBPACK_IMPORTED_MODULE_2__.record_has_actual_lock)(this.record);\n    }\n  }, {\n    key: \"hasselectedancestor\",\n    value: function hasselectedancestor() {\n      if (!this.parent) return false;\n      return this.parent.selected || this.parent.hasselectedancestor();\n    }\n  }, {\n    key: \"dispose\",\n    value:\n    // Cleaning up a node.\n    function dispose() {\n      // This means disposing all knockout subscriptions.\n      for (var i = 0; i < this.ko_subscriptions.length; i++) {\n        this.ko_subscriptions[i].dispose();\n        this.ko_subscriptions[i] = null;\n      }\n      delete this.forest.nodes[(0,_event_treeview__WEBPACK_IMPORTED_MODULE_2__.record_id)(this.record)];\n    }\n  }, {\n    key: \"get_classes\",\n    value:\n    // This helps drive the styling of the tree:\n    function get_classes() {\n      var classes = 'tree-event';\n      if (this.is_production()) classes += ' production';\n      if (this.is_group()) classes += ' tree-group';\n      if (this.selected) classes += ' selected';\n      if (this.highlight_as_new) classes += ' newly-created';\n      if (this.is_sticky) classes += ' sticky';\n      if (this.is_root()) classes += ' tree-root';\n      if (this.collapsed) classes += ' collapsed';\n      if (this.hasselectedancestor()) classes += ' parent-selected';\n      return classes;\n    }\n  }, {\n    key: \"scroll_to_it\",\n    value:\n    // Adjust the relevant scroll values so that this node becomes visible.\n    function scroll_to_it() {\n      var tree = this.get_tree();\n\n      // Horizontal positioning..................................................\n\n      var forest_panel = this.forest.panel.get(0);\n      var y = Math.max(0, this.position.y + tree.scrolling_panel.position().left + forest_panel.scrollLeft);\n      if (y < forest_panel.scrollLeft || y > forest_panel.scrollLeft + this.forest.panel.width() - 200) {\n        forest_panel.scrollLeft = y;\n      }\n\n      // Vertical positioning....................................................\n\n      var scrolling_panel = tree.scrolling_panel.get(0);\n      var x = this.position.x;\n      var scroll_top = scrolling_panel.scrollTop;\n      if (x < scroll_top || x > scroll_top + tree.scrolling_panel.height() - _constants__WEBPACK_IMPORTED_MODULE_1__.NODE.height) {\n        scrolling_panel.scrollTop = x;\n        tree.update_for_scrolling();\n      }\n    }\n  }, {\n    key: \"eddy_naerts_rule_for_hiding_events\",\n    value:\n    // If events need to be hidden, here's how to do it:\n    //\n    // Events should get hidden once there are at least four consecutive ones\n    // with the same exact name. In which case all but the first and last in that\n    // sequence should get hidden.\n    //\n    // Groups should never get hidden. Neither should selected events.\n    function eddy_naerts_rule_for_hiding_events(record_ids) {\n      // This will collect the record ids for the hidden events.\n      var hidden = [];\n\n      // We're checking for runs of a given name. So we need to track the current\n      // name, and how many times it has appeared.\n      var previous_name = null;\n      var count = 0;\n      for (var i = 0; i < record_ids.length; i++) {\n        var id = record_ids[i];\n        var record = this.forest.model.get(id);\n        var name = record.name();\n\n        // When the name is different from the last one, we start a new run.\n        if (!previous_name || name !== previous_name) {\n          previous_name = name;\n          count = 1;\n          continue;\n        }\n\n        // If it is the same we increment the count.\n        count += 1;\n        if (count === 4) {\n          // The first time we hit the required number we add the previous two\n          // record ids to the hidden set. Which leaves the first and current\n          // event still visible.\n          hidden.push(record_ids[i - 2]);\n          hidden.push(record_ids[i - 1]);\n        } else if (count > 4) {\n          // After the initial limit has been reached we simply add the previous\n          // record id to the hidden set. This way the current/last event will\n          // still be visible.\n          hidden.push(record_ids[i - 1]);\n        }\n\n        // Groups are never hidden. Neither are selected items.\n        if ((0,_event_treeview__WEBPACK_IMPORTED_MODULE_2__.record_is_group)(record) || this.forest.is_record_selected(id)) {\n          previous_name = name;\n          count = 1;\n        }\n      }\n      return hidden;\n    }\n  }, {\n    key: \"get_hidden_record_ids\",\n    value:\n    // For the given child record ids: which should be hidden/compacted ?\n    function get_hidden_record_ids(record_ids) {\n      // Should we be hiding anything ?\n      if (!this.should_compact_events()) return [];\n\n      // If so, apply Eddy's rules:\n      return this.eddy_naerts_rule_for_hiding_events(record_ids);\n    }\n  }, {\n    key: \"should_compact_events\",\n    value:\n    // Should this node be compacting its child events ? This gets decided per\n    // subtree in TreeView.prototype.decide_whether_to_compact_subtree . Here\n    // we just look up that decision.\n    function should_compact_events() {\n      if (this.parent) return this.parent.should_compact_events();\n      return this.compact === true;\n    }\n  }, {\n    key: \"log\",\n    value:\n    // Useful for debugging:\n    function log(dent) {\n      console.log(\"\".concat(dent + this.id, \".\").concat(this.get_key(), \": \").concat(this.get_name()));\n      if (this.subnodes) {\n        for (var i = 0; i < this.subnodes.length; i++) {\n          this.subnodes[i].log(\"\".concat(dent, \"  \"));\n        }\n      }\n    }\n  }]);\n  return Node;\n}();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9UcmVldmlldy9Ob2RlLmpzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFpQkE7QUFBQTtBQUdBO0FBQUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTs7QUFFQTtBQUNBO0FBQ0E7O0FBSUE7QUFDQTtBQUNBO0FBR0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUdBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUtBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFLQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFFQTtBQU9BO0FBSUE7QUFDQTs7QUFFQTs7QUFFQTtBQUVBO0FBRUE7QUFFQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9SZWFjdENvbXBvbmVudHNfLy4vVHJlZXZpZXcvTm9kZS5qcz9kMTM4Il0sInNvdXJjZXNDb250ZW50IjpbIi8vIERlZmluaXRpb24gb2YgYSBzaW5nbGUgbm9kZSBpbiB0aGUgdHJlZS5cbi8qIGVzbGludC1kaXNhYmxlIGNhbWVsY2FzZSwgZnVuYy1uYW1lcyAqL1xuaW1wb3J0IGtvIGZyb20gJ2tub2Nrb3V0JztcbmltcG9ydCB7Tk9ERX0gZnJvbSAnLi9jb25zdGFudHMnO1xuaW1wb3J0IHtcbiAgY2hpbGRyZW5fb2ZfcmVjb3JkLFxuICBjb21wYXJlX2J5X2Fubm91bmNlZGRhdGV0aW1lX3JlY3Vyc2l2ZV90aGVuX25hbWUsXG4gIGNvbmZsaWN0c19mb3JfcmVjb3JkLFxuICBpc19kZWZpbmVkLFxuICBsb2NhdGlvbl9mb3JfcmVjb3JkLFxuICBwcm9maWxlX2Zvcl9yZWNvcmQsXG4gIHJlY29yZF9jYW5fYmVfZGVsZXRlZCxcbiAgcmVjb3JkX2Nhbl9iZV93cml0dGVuLFxuICByZWNvcmRfaGFzX2FjdHVhbF9sb2NrLFxuICByZWNvcmRfaGFzX2NvbmZsaWN0cyxcbiAgcmVjb3JkX2hhc19sb2NrLFxuICByZWNvcmRfaWQsXG4gIHJlY29yZF9pc19ncm91cCxcbiAgc2V0dGFibGVfc3RhdHVzZXNfZm9yX3JlY29yZCxcbiAgc3RhdHVzX2Zvcl9yZWNvcmRcbn0gZnJvbSAnLi9ldmVudC10cmVldmlldyc7XG5pbXBvcnQgUGxhY2Vob2xkZXJOb2RlIGZyb20gJy4vUGxhY2Vob2xkZXJOb2RlJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTm9kZSB7XG4gIGNvbnN0cnVjdG9yKGZvcmVzdCwgcmVjb3JkKSB7XG4gICAgdGhpcy5mb3Jlc3QgPSBmb3Jlc3Q7XG4gICAgdGhpcy5yZWNvcmQgPSByZWNvcmQ7XG5cbiAgICAvLyBUaGUgcGFyZW50IG5vZGUuIFRoaXMgZ2V0cyBtYW5hZ2VkIGJ5IEQzLlxuICAgIHRoaXMucGFyZW50ID0gbnVsbDtcblxuICAgIC8vIFRoZSBhc3NvY2lhdGVkIERPTSBlbGVtZW50LiBUaGlzIGdldHMgdHJhY2tlZCBieSB1cy5cbiAgICB0aGlzLmVsZW1lbnQgPSBudWxsO1xuXG4gICAgLy8gVGhlIGlkIGhlbHBzIG91dCB3aXRoIGRlYnVnZ2luZy5cbiAgICB0aGlzLmlkID0gdGhpcy5mb3Jlc3Qubm9kZV9pbnN0YW5jZV9jb3VudCsrO1xuXG4gICAgLy8gVGhlIHRyZWUgdHJhY2tzIGFsbCBub2RlcyBieSBrZXksIGZvciBlYXN5IHJldHJpZXZhbC5cbiAgICB0aGlzLmZvcmVzdC5ub2Rlc1tyZWNvcmRfaWQodGhpcy5yZWNvcmQpXSA9IHRoaXM7XG5cbiAgICAvLyBUaGUgY2hpbGRyZW4gZm9yIHRoaXMgbm9kZS5cbiAgICB0aGlzLnN1Ym5vZGVzID0gbnVsbDtcbiAgICAvLyBBbmQgd2hldGhlciBvciBub3QgdGhleSdyZSBoaWRkZW4uXG4gICAgdGhpcy5jb2xsYXBzZWQgPSBmYWxzZTtcblxuICAgIC8vIEFyZSB3ZSBjdXJyZW50bHkgc2VsZWN0ZWQgP1xuICAgIHRoaXMuc2VsZWN0ZWQgPSBmYWxzZTtcblxuICAgIC8vIEhhcyB0aGlzIG5vZGUgYmVlbiB1bmxvY2tlZCA/XG4gICAgdGhpcy5pc191bmxvY2tlZCA9IGtvLm9ic2VydmFibGUoZmFsc2UpO1xuXG4gICAgLy8gV2hldGhlciBvciBub3QgdGhpcyBub2RlIHNob3VsZCBnZXQgaGlnaGxpZ2h0ZWQgYXMgYmVpbmcgYSBuZXdseVxuICAgIC8vIGNyZWF0ZWQgbm9kZS5cbiAgICB0aGlzLmhpZ2hsaWdodF9hc19uZXcgPSBmYWxzZTtcblxuICAgIC8vIENvb3JkaW5hdGVzIGZvciBwb3NpdGlvbmluZyB0aGlzIGVsZW1lbnQuXG4gICAgdGhpcy54ID0gbnVsbDsgLy8gQWJzb2x1dGUgcG9zaXRpb24gKG1hbmFnZWQgYnkgRDMpXG4gICAgdGhpcy55ID0gbnVsbDsgLy8gQWJzb2x1dGUgcG9zaXRpb24gKG1hbmFnZWQgYnkgRDMpXG4gICAgdGhpcy5wb3NpdGlvbiA9IG51bGw7IC8vIEFic29sdXRlIHBvc2l0aW9uXG4gICAgdGhpcy5zdGFydF9wb3NpdGlvbiA9IG51bGw7IC8vIEFic29sdXRlIHBvc2l0aW9uXG4gICAgdGhpcy5pbmRlbnQgPSAwOyAvLyBMZXZlbCAoZGVwdGgpIG9mIHRoaXMgbm9kZSBpbiB0aGUgdHJlZS5cblxuICAgIC8vIEluZGV4IGluIHRoZSBvdmVyYWxsIHRyZWUuXG4gICAgdGhpcy5kM19pbmRleCA9IC0xO1xuXG4gICAgLy8gS25vY2tvdXQgc3Vic2NyaXB0aW9ucyBmb3IgcmVzcG9uZGluZyB0byBjaGFuZ2VzIGluIHRoZSB2aWV3IG1vZGVsLlxuICAgIHRoaXMua29fc3Vic2NyaXB0aW9ucyA9IFtdO1xuXG4gICAgLy8gVGhpcyBvbmUgbGlzdGVucyBzcGVjaWZpY2FsbHkgdG8gY2hhbmdlcyBpbiB0aGUgbGlzdCBvZiBjaGlsZHJlblxuICAgIC8vIGZvciB0aGUgcmVjb3JkLCBzbyB3ZSBjYW4gbW9kaWZ5IHRoZSBsaXN0IG9mIGNoaWxkIG5vZGVzIGFjY29yZGluZ2x5LlxuICAgIGlmIChyZWNvcmQuYykge1xuICAgICAgdGhpcy5rb19zdWJzY3JpcHRpb25zLnB1c2goXG4gICAgICAgIHJlY29yZC5jLnN1YnNjcmliZSh0aGlzLnJlYnVpbGRfc3Vibm9kZXMsIHRoaXMpXG4gICAgICApO1xuICAgIH1cblxuICAgIC8vIFdoZW4gYSBkYXRlIGNoYW5nZXMgd2UgaGF2ZSB0byByZWJ1aWxkIHRoZSBzdWJub2RlcyBmb3IgYWxsIHBhcmVudFxuICAgIC8vIG5vZGVzLCBhcyB0aGUgb3JkZXIgbWF5IGhhdmUgY2hhbmdlZC5cbiAgICBpZiAocmVjb3JkLmQpIHtcbiAgICAgIHRoaXMua29fc3Vic2NyaXB0aW9ucy5wdXNoKFxuICAgICAgICByZWNvcmQuZC5zdWJzY3JpYmUoXG4gICAgICAgICAgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICBsZXQgcHQgPSB0aGlzLnBhcmVudDtcbiAgICAgICAgICAgIHdoaWxlIChwdCkge1xuICAgICAgICAgICAgICBwdC5yZWJ1aWxkX3N1Ym5vZGVzKCk7XG4gICAgICAgICAgICAgIHB0ID0gcHQucGFyZW50O1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0uYmluZCh0aGlzKVxuICAgICAgICApXG4gICAgICApO1xuICAgIH1cblxuICAgIC8vIFRoaXMgb25lIGxpc3RlbnMgdG8gY2hhbmdlcyBpbiBwYXJlbnRhZ2UsIHdoaWNoIGlzIGltcG9ydGFudCBmb3IgdGhlXG4gICAgLy8gcm9vdCBub2RlcyBpbiB0aGUgdHJlZSB2aWV3LlxuICAgIHRoaXMua29fc3Vic2NyaXB0aW9ucy5wdXNoKFxuICAgICAgcmVjb3JkLnB0LnN1YnNjcmliZSh0aGlzLnJlc3luY19wYXJlbnRhZ2UsIHRoaXMpXG4gICAgKTtcblxuICAgIC8vIFRoaXMgb25lIGxpc3RlbnMgdG8gYW55IGNoYW5nZSBpbiB0aGUgcmVjb3JkLCB3aGljaCB3aWxsIHRyaWdnZXIgYW5cbiAgICAvLyB1cGRhdGUgb2YgdGhlIHRyZWUgdmlldy5cbiAgICB0aGlzLmtvX3N1YnNjcmlwdGlvbnMucHVzaChcbiAgICAgIHJlY29yZC4kc2VsZi5zdWJzY3JpYmUodGhpcy5vbl9yZWNvcmRfY2hhbmdlZCwgdGhpcylcbiAgICApO1xuICB9XG5cbiAgZ2V0X3RyZWUoKSB7XG4gICAgaWYgKHRoaXMucGFyZW50KSByZXR1cm4gdGhpcy5wYXJlbnQuZ2V0X3RyZWUoKTtcbiAgICByZXR1cm4gdGhpcy5mb3Jlc3QuZ2V0X3RyZWUodGhpcyk7XG4gIH07XG5cbi8vIFRoZSB1bmlxdWUga2V5IGZvciBhbiBldmVudC4gVGhpcyBiYXNpY2FsbHkgZW5jb2Rlc1xuLy8gTlBRdWVyeWFibGVPYmplY3QgdW5pcXVlSWRlbnRpZmllcldpdGhUaW1lc3RhbXAgLlxuICBnZXRfa2V5KCkge1xuICAgIHJldHVybiByZWNvcmRfaWQodGhpcy5yZWNvcmQpO1xuICB9O1xuXG4gIGdldF9uYW1lX3dpdGhfYWJicmV2aWF0aW9uKCkge1xuICAgIGNvbnN0IGxvY2F0aW9uID0gdGhpcy5nZXRfbG9jYXRpb24oKTtcbiAgICBjb25zdCBzaG93ID0gdGhpcy5mb3Jlc3Quc2hvd19sb2NhdGlvbl9hYmJyZXZpYXRpb247XG4gICAgaWYgKHNob3cgJiYgdGhpcy5pc19sZWFmZXZlbnQoKSAmJiBsb2NhdGlvbiAmJiBsb2NhdGlvbi5hYmJyKCkubGVuZ3RoID4gMCkge1xuICAgICAgcmV0dXJuIGAke2xvY2F0aW9uLmFiYnIoKX0sICR7dGhpcy5yZWNvcmQubmFtZSgpfWA7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLnJlY29yZC5uYW1lKCk7XG4gICAgfVxuICB9O1xuXG4gIGdldF9uYW1lKCkge1xuICAgIHJldHVybiB0aGlzLnJlY29yZC5uYW1lKCk7XG4gIH07XG5cbiAgaXNfcHJvZHVjdGlvbigpIHtcbiAgICBjb25zdCB7cH0gPSB0aGlzLnJlY29yZDtcbiAgICByZXR1cm4gcCAmJiBwKCk7XG4gIH07XG5cbiAgaXNfcGxhY2Vob2xkZXIoKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuXG4gIGdldF9zdWJub2Rlc193aXRob3V0X2VtcHR5X2dyb3VwcygpIHtcbiAgICByZXR1cm4gdGhpcy5zdWJub2Rlcy5maWx0ZXIoKGUpID0+IHtcbiAgICAgIHJldHVybiAhKFxuICAgICAgICBlLmlzX2dyb3VwKCkgJiYgZS5nZXRfc3Vibm9kZXNfd2l0aG91dF9lbXB0eV9ncm91cHMoKS5sZW5ndGggPT09IDBcbiAgICAgICk7XG4gICAgfSk7XG4gIH07XG5cbiAgaXNfZGF0ZV9zZXR0YWJsZSgpIHtcbiAgICBpZiAodGhpcy5pc19ncm91cCgpKSB7XG4gICAgICBjb25zdCBzdWJub2Rlc193aXRob3V0X2VtcHR5X2dyb3VwcyA9IHRoaXMuZ2V0X3N1Ym5vZGVzX3dpdGhvdXRfZW1wdHlfZ3JvdXBzKCk7XG4gICAgICByZXR1cm4gc3Vibm9kZXNfd2l0aG91dF9lbXB0eV9ncm91cHMubGVuZ3RoICE9PSAwO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH07XG5cbiAgZ2V0X2xvY2F0aW9uKCkge1xuICAgIGlmICh0aGlzLmlzX2dyb3VwKCkpIHtcbiAgICAgIGNvbnN0IHN1Ym5vZGVzX3dpdGhvdXRfZW1wdHlfZ3JvdXBzID0gdGhpcy5nZXRfc3Vibm9kZXNfd2l0aG91dF9lbXB0eV9ncm91cHMoKTtcbiAgICAgIGlmIChzdWJub2Rlc193aXRob3V0X2VtcHR5X2dyb3Vwcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gXy5yZWR1Y2UoXG4gICAgICAgICAgc3Vibm9kZXNfd2l0aG91dF9lbXB0eV9ncm91cHMsXG4gICAgICAgICAgKG1lbW8sIHN1Ym5vZGUpID0+IHtcbiAgICAgICAgICAgIGlmIChtZW1vID09PSBzdWJub2RlLmdldF9sb2NhdGlvbigpKSB7XG4gICAgICAgICAgICAgIHJldHVybiBtZW1vO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICBzdWJub2Rlc193aXRob3V0X2VtcHR5X2dyb3Vwc1swXS5nZXRfbG9jYXRpb24oKVxuICAgICAgICApO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gbG9jYXRpb25fZm9yX3JlY29yZCh0aGlzLnJlY29yZCwgdGhpcy5mb3Jlc3QubW9kZWwpO1xuICAgIH1cbiAgfTtcblxuICBpc19sb2NhdGlvbl9zZXR0YWJsZSgpIHtcbiAgICBpZiAodGhpcy5pc19ncm91cCgpKSB7XG4gICAgICBjb25zdCBzdWJub2Rlc193aXRob3V0X2VtcHR5X2dyb3VwcyA9IHRoaXMuZ2V0X3N1Ym5vZGVzX3dpdGhvdXRfZW1wdHlfZ3JvdXBzKCk7XG4gICAgICByZXR1cm4gc3Vibm9kZXNfd2l0aG91dF9lbXB0eV9ncm91cHMubGVuZ3RoICE9PSAwO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH07XG5cbiAgZ2V0X3N0YXR1cygpIHtcbiAgICAvLyBJZiB0aGUgbm9kZSBpcyBhIGdyb3VwLCB0aGVuIHJldHVybiBudWxsIGlmIHRoZSBzdGF0dXMgb2YgdGhlIGdyb3VwIGlzIGhldGVyb2dlbm91cyBhbmQgdGhlIHN0YXR1cyBpZiBpdCBpcyBub3RcbiAgICBpZiAodGhpcy5pc19ncm91cCgpKSB7XG4gICAgICAvLyBFbXB0eSBzdWJncm91cHMgYXJlIHRvIGJlIGlnbm9yZWQgYmVjYXVzZSB0aGVpciBwcm9maWxlIGlzIG5vdCBoZXRlcm9nZW5vdXNcbiAgICAgIGNvbnN0IHN1Ym5vZGVzX3dpdGhvdXRfZW1wdHlfZ3JvdXBzID0gdGhpcy5nZXRfc3Vibm9kZXNfd2l0aG91dF9lbXB0eV9ncm91cHMoKTtcbiAgICAgIGlmIChzdWJub2Rlc193aXRob3V0X2VtcHR5X2dyb3Vwcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gXy5yZWR1Y2UoXG4gICAgICAgICAgc3Vibm9kZXNfd2l0aG91dF9lbXB0eV9ncm91cHMsXG4gICAgICAgICAgKG1lbW8sIHN1Ym5vZGUpID0+IHtcbiAgICAgICAgICAgIGlmIChtZW1vID09PSBzdWJub2RlLmdldF9zdGF0dXMoKSkge1xuICAgICAgICAgICAgICByZXR1cm4gbWVtbztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgc3Vibm9kZXNfd2l0aG91dF9lbXB0eV9ncm91cHNbMF0uZ2V0X3N0YXR1cygpXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBzdGF0dXNfZm9yX3JlY29yZCh0aGlzLnJlY29yZCk7XG4gICAgfVxuICB9O1xuXG4gIGdldF9zZXR0YWJsZV9zdGF0dXNlcygpIHtcbiAgICAvLyBJZiB0aGUgbm9kZSBpcyBhIGdyb3VwLCB0YWtlIHRoZSBpbnRlcnNlY3Rpb24gb2YgYWxsIHRoZSBzdGF0dXNlcyBmcm9tIGl0cyBzdWJub2Rlc1xuICAgIC8vIEVsc2UgdGFrZSB0aGVtIGZyb20gdGhlIHJlY29yZFxuICAgIGlmICh0aGlzLmlzX2dyb3VwKCkpIHtcbiAgICAgIC8vIEVtcHR5IHN1Ymdyb3VwcyBhcmUgdG8gYmUgaWdub3JlZCBiZWNhdXNlIHRoZWlyIHN0YXR1cyBpcyBub3QgaGV0ZXJvZ2Vub3VzXG4gICAgICBjb25zdCBzdWJub2Rlc193aXRob3V0X2VtcHR5X2dyb3VwcyA9IHRoaXMuZ2V0X3N1Ym5vZGVzX3dpdGhvdXRfZW1wdHlfZ3JvdXBzKCk7XG4gICAgICBpZiAoc3Vibm9kZXNfd2l0aG91dF9lbXB0eV9ncm91cHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBfLnJlZHVjZShcbiAgICAgICAgICBzdWJub2Rlc193aXRob3V0X2VtcHR5X2dyb3VwcyxcbiAgICAgICAgICAobWVtbywgbm9kZSkgPT4gXy5pbnRlcnNlY3Rpb24obWVtbywgbm9kZS5nZXRfc2V0dGFibGVfc3RhdHVzZXMoKSksXG4gICAgICAgICAgc3Vibm9kZXNfd2l0aG91dF9lbXB0eV9ncm91cHNbMF0uZ2V0X3NldHRhYmxlX3N0YXR1c2VzKClcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHNldHRhYmxlX3N0YXR1c2VzX2Zvcl9yZWNvcmQodGhpcy5yZWNvcmQpO1xuICAgIH1cbiAgfTtcblxuICBnZXRfcHJvZmlsZSgpIHtcbiAgICAvLyBJZiB0aGUgbm9kZSBpcyBhIGdyb3VwLCB0aGVuIHJldHVybiBudWxsIGlmIHRoZSBwcm9maWxlIG9mIHRoZSBncm91cCBpcyBoZXRlcm9nZW5vdXMgYW5kIHRoZSBwcm9maWxlIGlmIGl0IGlzIG5vdFxuICAgIGlmICh0aGlzLmlzX2dyb3VwKCkpIHtcbiAgICAgIC8vIEVtcHR5IHN1Ymdyb3VwcyBhcmUgdG8gYmUgaWdub3JlZCBiZWNhdXNlIHRoZWlyIHByb2ZpbGUgaXMgbm90IGhldGVyb2dlbm91c1xuICAgICAgY29uc3Qgc3Vibm9kZXNfd2l0aG91dF9lbXB0eV9ncm91cHMgPSB0aGlzLmdldF9zdWJub2Rlc193aXRob3V0X2VtcHR5X2dyb3VwcygpO1xuICAgICAgaWYgKHN1Ym5vZGVzX3dpdGhvdXRfZW1wdHlfZ3JvdXBzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBfLnJlZHVjZShcbiAgICAgICAgICBzdWJub2Rlc193aXRob3V0X2VtcHR5X2dyb3VwcyxcbiAgICAgICAgICAobWVtbywgbm9kZSkgPT4ge1xuICAgICAgICAgICAgaWYgKG1lbW8gPT09IG5vZGUuZ2V0X3Byb2ZpbGUoKSkge1xuICAgICAgICAgICAgICByZXR1cm4gbWVtbztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgc3Vibm9kZXNfd2l0aG91dF9lbXB0eV9ncm91cHNbMF0uZ2V0X3Byb2ZpbGUoKVxuICAgICAgICApO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gcHJvZmlsZV9mb3JfcmVjb3JkKHRoaXMucmVjb3JkKTtcbiAgICB9XG4gIH07XG5cbiAgaXNfZ3JvdXAoKSB7XG4gICAgcmV0dXJuIHJlY29yZF9pc19ncm91cCh0aGlzLnJlY29yZCk7XG4gIH07XG5cbiAgaXNfbGVhZmV2ZW50KCkge1xuICAgIHJldHVybiAhcmVjb3JkX2lzX2dyb3VwKHRoaXMucmVjb3JkKTtcbiAgfTtcblxuICBoYXNfY29uZmxpY3RzKCkge1xuICAgIHJldHVybiByZWNvcmRfaGFzX2NvbmZsaWN0cyh0aGlzLnJlY29yZCk7XG4gIH07XG5cbiAgaGFzX25vZGVzX3dpdGhfY29uZmxpY3RzKCkge1xuICAgIHJldHVybiByZWNvcmRfaGFzX2NvbmZsaWN0cyh0aGlzLnJlY29yZCk7XG4gIH07XG5cbiAgY29uZmxpY3RzKCkge1xuICAgIHJldHVybiBjb25mbGljdHNfZm9yX3JlY29yZCh0aGlzLnJlY29yZCk7XG4gIH07XG5cbiAgaXNfcm9vdCgpIHtcbiAgICByZXR1cm4gdGhpcy5mb3Jlc3QuaGFzX3RyZWUodGhpcyk7XG4gIH07XG5cbiAgZ2V0X3Jvb3QoKSB7XG4gICAgbGV0IHJvb3QgPSB0aGlzO1xuICAgIHdoaWxlIChyb290LnBhcmVudCkgcm9vdCA9IHJvb3QucGFyZW50O1xuICAgIHJldHVybiByb290O1xuICB9O1xuXG4gIGlzX2RhdGVkKCkge1xuICAgIHJldHVybiBpc19kZWZpbmVkKHRoaXMucmVjb3JkLmQpICYmIHRoaXMucmVjb3JkLmQoKTtcbiAgfTtcblxuICBoYXNfZXhwYW5kZWQoKSB7XG4gICAgcmV0dXJuICF0aGlzLmlzX2dyb3VwKCkgfHwgIXRoaXMuY29sbGFwc2VkO1xuICB9O1xuXG4gIGV4cGFuZCgpIHtcbiAgICB0aGlzLmNvbGxhcHNlZCA9IGZhbHNlO1xuICB9O1xuXG4vLyBUaGlzIHNob3VsZCBnZXQgY2FsbGVkIHdoZW5ldmVyIHRoZSByZWNvcmQncyBjaGlsZHJlbiBjaGFuZ2UuIFdlIHRoZW4gbmVlZFxuLy8gdG8gcmVidWlsZCB0aGUgc3Vibm9kZXMgZm9yIHRoaXMgbm9kZSB0byBtYXRjaCB0aGUgcmVjb3JkJ3MgY2hpbGRyZW4uXG4gIHJlYnVpbGRfc3Vibm9kZXMoKSB7XG4gICAgaWYgKHRoaXMuc3Vibm9kZXMgPT09IG51bGwpIHJldHVybjtcblxuICAgIC8vIEFzayBob3cgdGhleSBzaG91bGQgZ2V0IHJlYnVpbHQuXG4gICAgLy8gV2Ugc29ydCB0aGUgZXZlbnRzIG9uIHRoZSBjbGllbnQsIG5vdCBvbiB0aGUgc2VydmVyLlxuICAgIGNvbnN0IHJlY29yZF9pZHMgPSBjaGlsZHJlbl9vZl9yZWNvcmQodGhpcy5yZWNvcmQpXG4gICAgICAuc2xpY2UoMClcbiAgICAgIC5maWx0ZXIoKGlkKSA9PiB0aGlzLmZvcmVzdC5tb2RlbC5nZXQoaWQsIGZhbHNlKSkgLy8gZmlsdGVyIG91dCBub24tZXhpc3RlbnQgcmVjb3Jkc1xuICAgICAgLnNvcnQoKGlkMSwgaWQyKSA9PiBjb21wYXJlX2J5X2Fubm91bmNlZGRhdGV0aW1lX3JlY3Vyc2l2ZV90aGVuX25hbWUoaWQxLCBpZDIsIHRoaXMuZm9yZXN0Lm1vZGVsKSk7XG5cbiAgICAvLyBGaWd1cmUgb3V0IHdoaWNoIHJlY29yZHMgc2hvdWxkIHN0YXkgaGlkZGVuLiBUaGlzIGlzIHRvIHJlbW92ZSB2aXN1YWxcbiAgICAvLyBjbHV0dGVyIGFuZCBtYWtlIHdvcmtpbmcgd2l0aCBsYXJnZXIgdHJlZXMgbW9yZSBtYW5hZ2VhYmxlLlxuICAgIGNvbnN0IGhpZGRlbl9yZWNvcmRfaWRzID0gdGhpcy5nZXRfaGlkZGVuX3JlY29yZF9pZHMocmVjb3JkX2lkcyk7XG5cbiAgICAvLyBXZSB3YW50IHRvIHJldXNlIGV4aXN0aW5nIHBsYWNlaG9sZGVyIG5vZGVzIGFzIG11Y2ggYXMgcG9zc2libGUuIE1vc3RseVxuICAgIC8vIHRvIHByZXZlbnQgc29tZSB1bndhbnRlZCBhbmltYXRpb25zIHdoZW4gdXBkYXRpbmcgdGhlIGV2ZW50IHRyZWUuIFNvIHdlXG4gICAgLy8gZ3JhYiBhbGwgZXhpc3RpbmcgcGxhY2Vob2xkZXJzLCBhbmQgY2xlYXIgdGhlbSBvdXQgZm9yIHJldXNlLlxuICAgIGNvbnN0IHJlY3ljbGVkX3BsYWNlaG9sZGVycyA9IHRoaXMuc3Vibm9kZXMuZmlsdGVyKChpdCkgPT4gaXQgaW5zdGFuY2VvZiBQbGFjZWhvbGRlck5vZGUpO1xuICAgIHJlY3ljbGVkX3BsYWNlaG9sZGVycy5mb3JFYWNoKChpdCkgPT4ge1xuICAgICAgaXQuZWplY3RfYWxsKCk7XG4gICAgfSk7XG5cbiAgICAvLyBXZSBub3cgaGF2ZSBldmVyeXRoaW5nIHRvIHN0YXJ0IChyZSlidWlsZGluZyB0aGUgc3Vibm9kZXMuIFdoaWNoIG1lYW5zXG4gICAgLy8gd2UgY2FuIGNsZWFyIG91dCB0aGUgb2xkIGxpc3QgKGlmIG5lZWRlZCkuXG4gICAgaWYgKHRoaXMuc3Vibm9kZXMubGVuZ3RoID4gMCkgdGhpcy5zdWJub2RlcyA9IFtdO1xuXG4gICAgLy8gV2UgaXRlcmF0ZSBvdmVyIHRoZSBjaGlsZCByZWNvcmQgaWRzIHRoaXMgbm9kZSBzaG91bGQgaGF2ZTpcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlY29yZF9pZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IHJlY29yZF9pZCA9IHJlY29yZF9pZHNbaV07XG4gICAgICBjb25zdCBoaWRkZW4gPSBoaWRkZW5fcmVjb3JkX2lkcy5pbmRleE9mKHJlY29yZF9pZCkgPj0gMDtcblxuICAgICAgLy8gSWYgdGhlIHJlY29yZCBpZCBpcyBzdGlsbCBwYXJ0IG9mIGEgcGxhY2Vob2xkZXIgbm9kZSAod2hpY2ggd291bGQgaGF2ZVxuICAgICAgLy8gdG8gYmUgb25lIGZvciBhbm90aGVyIHBhcmVudCkgd2UgbmVlZCB0byBlamVjdCBpdCBmcm9tIHRoYXQgZmlyc3QuXG4gICAgICBjb25zdCBub2RlID0gdGhpcy5mb3Jlc3Qubm9kZV9mb3JfcmVjb3JkX29yX251bGwocmVjb3JkX2lkKTtcbiAgICAgIGlmIChub2RlICE9PSBudWxsICYmIG5vZGUgaW5zdGFuY2VvZiBQbGFjZWhvbGRlck5vZGUpIHtcbiAgICAgICAgbm9kZS5lamVjdChyZWNvcmRfaWQpO1xuICAgICAgfVxuXG4gICAgICAvLyBOb3cgaXQgYWxsIGRlcGVuZHMgb24gd2hldGhlciBvciBub3QgdGhlIG5vZGUgc2hvdWxkIGJlIGhpZGRlbi5cbiAgICAgIGlmICghaGlkZGVuKSB7XG4gICAgICAgIC8vIElmIGl0IHNob3VsZG4ndCBiZSBoaWRkZW4gd2UgY2FuIGp1c3QgYWRkIGl0IHRvIHRoZSBsaXN0LlxuICAgICAgICBjb25zdCBzdWJub2RlID0gdGhpcy5mb3Jlc3Qubm9kZV9mb3JfcmVjb3JkKHJlY29yZF9pZCk7XG4gICAgICAgIHN1Ym5vZGUucGFyZW50ID0gdGhpcztcbiAgICAgICAgdGhpcy5zdWJub2Rlcy5wdXNoKHN1Ym5vZGUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gSWYgaXQgc2hvdWxkIGJlIGhpZGRlbiB3ZSBuZWVkIHRvIGFkZCBpdCB0byBhIHBsYWNlaG9sZGVyIG5vZGUuXG4gICAgICAgIC8vIFNvIHdlIGZpcnN0IGNoZWNrIGlmIHRoZXJlIGFscmVhZHkgaXMgb25lIGF2YWlsYWJsZS5cbiAgICAgICAgY29uc3Qge2xlbmd0aH0gPSB0aGlzLnN1Ym5vZGVzO1xuICAgICAgICBjb25zdCBsYXN0ID0gbGVuZ3RoID09PSAwID8gbnVsbCA6IHRoaXMuc3Vibm9kZXNbbGVuZ3RoIC0gMV07XG5cbiAgICAgICAgaWYgKGxhc3QgJiYgbGFzdCBpbnN0YW5jZW9mIFBsYWNlaG9sZGVyTm9kZSkge1xuICAgICAgICAgIC8vIFRoZXJlIGlzLCBhbmQgc28gd2UgY2FuIGp1c3QgYWRkIHRoZSBjaGlsZCByZWNvcmQgaWQgdG8gaXQuXG4gICAgICAgICAgbGFzdC5pbnNlcnQocmVjb3JkX2lkKTtcbiAgICAgICAgfSBlbHNlIGlmIChyZWN5Y2xlZF9wbGFjZWhvbGRlcnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIC8vIFRoZXJlIGlzIG5vdCwgYnV0IHdlIGNhbiByZWN5Y2xlIGFuIGV4aXN0aW5nIHBsYWNlaG9sZGVyLlxuICAgICAgICAgIGNvbnN0IHBsYWNlaG9sZGVyID0gcmVjeWNsZWRfcGxhY2Vob2xkZXJzLnNoaWZ0KCk7XG4gICAgICAgICAgcGxhY2Vob2xkZXIuaW5zZXJ0KHJlY29yZF9pZCk7XG4gICAgICAgICAgdGhpcy5zdWJub2Rlcy5wdXNoKHBsYWNlaG9sZGVyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBUaGVyZSBpcyBub3QsIGFuZCB3ZSBtdXN0IGNyZWF0ZSBhIG5ldyBwbGFjZWhvbGRlci5cbiAgICAgICAgICB0aGlzLnN1Ym5vZGVzLnB1c2gobmV3IFBsYWNlaG9sZGVyTm9kZSh0aGlzLCBbcmVjb3JkX2lkXSkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4vLyBUaGlzIHNob3VsZCBnZXQgY2FsbGVkIHdoZW5ldmVyIHRoZSByZWNvcmQncyBwYXJlbnQgaWQgY2hhbmdlcy4gSW4gc3VjaCBhXG4vLyBjYXNlIHdlIG1heSBuZWVkIHRvIHVwZGF0ZSB0aGUgcm9vdHMgb2YgdGhlIHRyZWUgdmlldy5cbiAgcmVzeW5jX3BhcmVudGFnZSgpIHtcbiAgICAvLyBUaGUgcGFyZW50IGxpbmsgZ2V0cyBtYWludGFpbmVkIGJ5IEQzLCBleGNlcHQgZm9yIHJvb3Qgbm9kZXMuLi4gU28sIGZvclxuICAgIC8vIHRob3NlIGNhc2VzLCB3ZSBjbGVhciBpdCBvdXJzZWx2ZXMuXG4gICAgaWYgKHRoaXMucmVjb3JkLnB0KCkgPT09IG51bGwpIHRoaXMucGFyZW50ID0gbnVsbDtcblxuICAgIGlmICh0aGlzLmZvcmVzdC5oYXNfdHJlZSh0aGlzKSkge1xuICAgICAgdGhpcy5mb3Jlc3QucmVtb3ZlX3RyZWUodGhpcyk7XG4gICAgICB0aGlzLmZvcmVzdC5zaG93X25vZGUodGhpcyk7XG4gICAgfVxuICB9O1xuXG4vLyBUaGlzIHNob3VsZCBnZXQgY2FsbGVkIHdoZW5ldmVyIHRoZSByZWNvcmQgKCdzICRzZWxmKSBjaGFuZ2VzLiBXZSBtYXlcbi8vIGVpdGhlciBoYXZlIHRvIHVwZGF0ZSB0aGUgdHJlZSB2aWV3LCBvciBkaXNwb3NlIG9mIHRoZSBub2RlLlxuICBvbl9yZWNvcmRfY2hhbmdlZChyZWNvcmQpIHtcbiAgICBpZiAoIXJlY29yZCkge1xuICAgICAgaWYgKHRoaXMuZm9yZXN0Lmhhc190cmVlKHRoaXMpKSB0aGlzLmZvcmVzdC5yZW1vdmVfdHJlZSh0aGlzKTtcblxuICAgICAgdGhpcy5kaXNwb3NlKCk7XG4gICAgICAvLyBNYWtlIHN1cmUgbm8gcGFyZW50IHBvaW50ZXJzIGFyZSBzdGlsbCByZWZlcnJpbmcgdG8gbWUuXG4gICAgICBpZiAodGhpcy5oYXNfc3Vibm9kZXMoKSkge1xuICAgICAgICB0aGlzLnN1Ym5vZGVzLmZvckVhY2goKHgpID0+IHtcbiAgICAgICAgICB4LnJlc3luY19wYXJlbnRhZ2UoKTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5mb3Jlc3QucmVxdWVzdF91cGRhdGUoKTtcbiAgfTtcblxuICBjYW5fYmVfZ3JvdXBfb25seV9kZWxldGVkKCkge1xuICAgIHJldHVybiAoXG4gICAgICB0aGlzLmlzX2dyb3VwKCkgJiZcbiAgICAgIHRoaXMuaXNfbm90X2xvY2tlZCgpICYmXG4gICAgICByZWNvcmRfY2FuX2JlX2RlbGV0ZWQodGhpcy5yZWNvcmQpXG4gICAgKTtcbiAgfTtcblxuICBjYW5fYmVfZGVsZXRlZCgpIHtcbiAgICByZXR1cm4gKFxuICAgICAgdGhpcy5pc19ub3RfbG9ja2VkKCkgJiZcbiAgICAgIHJlY29yZF9jYW5fYmVfZGVsZXRlZCh0aGlzLnJlY29yZCkgJiZcbiAgICAgICF0aGlzLmhhc19ub2Rlc193aXRoX2FjdHVhbF9sb2NrKClcbiAgICApO1xuICB9O1xuXG4gIGhhc19ub2Rlc193aXRoX2FjdHVhbF9sb2NrKCkge1xuICAgIGlmICh0aGlzLmlzX2dyb3VwKCkpIHtcbiAgICAgIHJldHVybiB0aGlzLnN1Ym5vZGVzLnNvbWUoKHN1Ym5vZGUpID0+IHN1Ym5vZGUuaGFzX25vZGVzX3dpdGhfYWN0dWFsX2xvY2soKSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLmhhc19hY3R1YWxfbG9jaygpO1xuICAgIH1cbiAgfTtcblxuLy8gSXMgdGhlIGdpdmVuIG5vZGUgYSBzdWJub2RlIG9mIHRoaXMgb25lID9cbiAgaGFzX3N1Ym5vZGUobm9kZSkge1xuICAgIHJldHVybiB0aGlzLnN1Ym5vZGVzICYmIHRoaXMuc3Vibm9kZXMuaW5kZXhPZihub2RlKSA+PSAwO1xuICB9O1xuXG4vLyBEb2VzIHRoZSBub2RlIGhhdmUgc3Vibm9kZXMgP1xuICBoYXNfc3Vibm9kZXMoKSB7XG4gICAgcmV0dXJuIHRoaXMuc3Vibm9kZXMgJiYgdGhpcy5zdWJub2Rlcy5sZW5ndGggPiAwO1xuICB9O1xuXG4vLyBSZW1vdmUgdGhlIGdpdmVuIG5vZGUgYXMgYSBzdWJub2RlIGZyb20gdGhpcyBvbmUuXG4gIHJlbW92ZV9zdWJub2RlKG5vZGUpIHtcbiAgICBjb25zdCBpbmRleCA9IHRoaXMuc3Vibm9kZXMuaW5kZXhPZihub2RlKTtcbiAgICBpZiAoaW5kZXggPj0gMCkgdGhpcy5zdWJub2Rlcy5zcGxpY2UoaW5kZXgsIDEpO1xuICB9O1xuXG4gIGlzX2xhc3RfY2hpbGQoKSB7XG4gICAgaWYgKCF0aGlzLnBhcmVudCkgcmV0dXJuIGZhbHNlO1xuICAgIGNvbnN0IHNpYmxpbmdzID0gdGhpcy5wYXJlbnQuc3Vibm9kZXM7XG4gICAgY29uc3QgaW5kZXggPSBzaWJsaW5ncy5pbmRleE9mKHRoaXMpO1xuICAgIHJldHVybiBpbmRleCA9PT0gc2libGluZ3MubGVuZ3RoIC0gMTtcbiAgfTtcblxuLy8gRG8gd2UgbmVlZCB0byBiZSBkaXNwbGF5ZWQgd2l0aCBhIGxvY2s/XG4gIGhhc19sb2NrKCkge1xuICAgIGlmICh0aGlzLmlzX2xlYWZldmVudCgpKSB7XG4gICAgICByZXR1cm4gcmVjb3JkX2hhc19sb2NrKHRoaXMucmVjb3JkKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHRoaXMuc3Vibm9kZXMuc29tZSgoc3Vibm9kZSkgPT4gc3Vibm9kZS5oYXNfbG9jaygpKTtcbiAgICB9XG4gIH07XG5cbi8vIENhbiB3ZSBiZSB1bmxvY2tlZCA/XG4vLyBBIGxlYWYgZXZlbnQgY2FuIGJlIHVubG9ja2VkIGlmIHdlIGhhdmUgd3JpdGUgcGVybWlzc2lvbnNcbi8vIEEgZ3JvdXAgZXZlbnQgY2FuIGJlIHVubG9ja2VkIGlmIHdlIGhhdmUgd3JpdGUgcGVybWlzc2lvbnMgLW9yLSBhbnkgb2YgaXRzIHN1YmV2ZW50cyBjYW4gYmUgdW5sb2NrZWRcbiAgY2FuX2JlX3VubG9ja2VkKCkge1xuICAgIGlmICh0aGlzLmhhc19hY3R1YWxfbG9jaygpKSByZXR1cm4gZmFsc2U7XG4gICAgaWYgKHRoaXMuaXNfbGVhZmV2ZW50KCkpIHtcbiAgICAgIHJldHVybiByZWNvcmRfY2FuX2JlX3dyaXR0ZW4odGhpcy5yZWNvcmQpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gKFxuICAgICAgICByZWNvcmRfY2FuX2JlX3dyaXR0ZW4odGhpcy5yZWNvcmQpIHx8XG4gICAgICAgIHRoaXMuc3Vibm9kZXMuc29tZSgoc3Vibm9kZSkgPT4gc3Vibm9kZS5jYW5fYmVfdW5sb2NrZWQoKSlcbiAgICAgICk7XG4gICAgfVxuICB9O1xuXG4vLyBBcmUgd2UgdW5sb2NrZWQgb3IgZG8gd2Ugbm90IGhhdmUgYSBsb2NrP1xuICBpc19ub3RfbG9ja2VkKCkge1xuICAgIHJldHVybiAoIXRoaXMuaGFzX2xvY2soKSB8fCB0aGlzLmlzX3VubG9ja2VkKCkpICYmICF0aGlzLmhhc19hY3R1YWxfbG9jaygpO1xuICB9O1xuXG4vLyBTZXQgdGhpcyBub2RlJ3MgdW5sb2NrZWQgc3RhdGUsIHVwZGF0aW5nIGNoaWxkcmVuIGFuZCBwYXJlbnQgdW5sb2NrZWQgc3RhdHVzIGFwcHJvcHJpYXRlbHlcbi8vIElmIHRoZSBub2RlIGNhbm5vdCBiZSB1bmxvY2tlZCwgd2UgZG8gbm90aGluZ1xuICBzZXRfdW5sb2NrZWQodmFsdWUpIHtcbiAgICBpZiAoIXRoaXMuY2FuX2JlX3VubG9ja2VkKCkpIHJldHVybjtcblxuICAgIHRoaXMuaXNfdW5sb2NrZWQodmFsdWUpO1xuICAgIGlmICh0aGlzLnN1Ym5vZGVzKSB7XG4gICAgICB0aGlzLnN1Ym5vZGVzLmZvckVhY2goKHN1Ym5vZGUpID0+IHN1Ym5vZGUuc2V0X3VubG9ja2VkKHZhbHVlKSk7XG4gICAgfVxuICAgIGlmICh0aGlzLnBhcmVudCkgdGhpcy5wYXJlbnQucHJvcGFnYXRlX3BhcmVudF91bmxvY2tlZCh2YWx1ZSk7XG4gIH07XG5cbiAgcHJvcGFnYXRlX3BhcmVudF91bmxvY2tlZCh2YWx1ZSkge1xuICAgIC8vIExvY2tpbmcgcHJvcGFnYXRlcyB1cHdhcmRzIGluIHRoZSB0cmVlLCB1bmxvY2tpbmcgb25seSBpZiBhbGwgY2hpbGRyZW4gYXJlIHVubG9ja2VkXG4gICAgLy8gKHdlIGRvIHRvbGVyYXRlIGFjdHVhbCBsb2NrcyBvbiB0aGUgY2hpbGRyZW4pXG4gICAgaWYgKFxuICAgICAgIXZhbHVlIHx8XG4gICAgICB0aGlzLnN1Ym5vZGVzLmV2ZXJ5KChzdWJub2RlKSA9PiBzdWJub2RlLmhhc19hY3R1YWxfbG9jaygpIHx8IHN1Ym5vZGUuaXNfbm90X2xvY2tlZCgpKVxuICAgICkge1xuICAgICAgdGhpcy5pc191bmxvY2tlZCh2YWx1ZSk7XG4gICAgICBpZiAodGhpcy5wYXJlbnQpIHRoaXMucGFyZW50LnByb3BhZ2F0ZV9wYXJlbnRfdW5sb2NrZWQodmFsdWUpO1xuICAgIH1cbiAgfTtcblxuICBoYXNfYWN0dWFsX2xvY2soKSB7XG4gICAgcmV0dXJuIHJlY29yZF9oYXNfYWN0dWFsX2xvY2sodGhpcy5yZWNvcmQpO1xuICB9O1xuXG4gIGhhc3NlbGVjdGVkYW5jZXN0b3IoKSB7XG4gICAgaWYgKCF0aGlzLnBhcmVudCkgcmV0dXJuIGZhbHNlO1xuICAgIHJldHVybiB0aGlzLnBhcmVudC5zZWxlY3RlZCB8fCB0aGlzLnBhcmVudC5oYXNzZWxlY3RlZGFuY2VzdG9yKCk7XG4gIH07XG5cbi8vIENsZWFuaW5nIHVwIGEgbm9kZS5cbiAgZGlzcG9zZSgpIHtcbiAgICAvLyBUaGlzIG1lYW5zIGRpc3Bvc2luZyBhbGwga25vY2tvdXQgc3Vic2NyaXB0aW9ucy5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMua29fc3Vic2NyaXB0aW9ucy5sZW5ndGg7IGkrKykge1xuICAgICAgdGhpcy5rb19zdWJzY3JpcHRpb25zW2ldLmRpc3Bvc2UoKTtcbiAgICAgIHRoaXMua29fc3Vic2NyaXB0aW9uc1tpXSA9IG51bGw7XG4gICAgfVxuXG4gICAgZGVsZXRlIHRoaXMuZm9yZXN0Lm5vZGVzW3JlY29yZF9pZCh0aGlzLnJlY29yZCldO1xuICB9O1xuXG4vLyBUaGlzIGhlbHBzIGRyaXZlIHRoZSBzdHlsaW5nIG9mIHRoZSB0cmVlOlxuICBnZXRfY2xhc3NlcygpIHtcbiAgICBsZXQgY2xhc3NlcyA9ICd0cmVlLWV2ZW50JztcbiAgICBpZiAodGhpcy5pc19wcm9kdWN0aW9uKCkpIGNsYXNzZXMgKz0gJyBwcm9kdWN0aW9uJztcbiAgICBpZiAodGhpcy5pc19ncm91cCgpKSBjbGFzc2VzICs9ICcgdHJlZS1ncm91cCc7XG4gICAgaWYgKHRoaXMuc2VsZWN0ZWQpIGNsYXNzZXMgKz0gJyBzZWxlY3RlZCc7XG4gICAgaWYgKHRoaXMuaGlnaGxpZ2h0X2FzX25ldykgY2xhc3NlcyArPSAnIG5ld2x5LWNyZWF0ZWQnO1xuICAgIGlmICh0aGlzLmlzX3N0aWNreSkgY2xhc3NlcyArPSAnIHN0aWNreSc7XG4gICAgaWYgKHRoaXMuaXNfcm9vdCgpKSBjbGFzc2VzICs9ICcgdHJlZS1yb290JztcbiAgICBpZiAodGhpcy5jb2xsYXBzZWQpIGNsYXNzZXMgKz0gJyBjb2xsYXBzZWQnO1xuICAgIGlmICh0aGlzLmhhc3NlbGVjdGVkYW5jZXN0b3IoKSkgY2xhc3NlcyArPSAnIHBhcmVudC1zZWxlY3RlZCc7XG4gICAgcmV0dXJuIGNsYXNzZXM7XG4gIH07XG5cbiAgLy8gQWRqdXN0IHRoZSByZWxldmFudCBzY3JvbGwgdmFsdWVzIHNvIHRoYXQgdGhpcyBub2RlIGJlY29tZXMgdmlzaWJsZS5cbiAgc2Nyb2xsX3RvX2l0KCkge1xuICAgIGNvbnN0IHRyZWUgPSB0aGlzLmdldF90cmVlKCk7XG5cbiAgICAvLyBIb3Jpem9udGFsIHBvc2l0aW9uaW5nLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi5cblxuICAgIGNvbnN0IGZvcmVzdF9wYW5lbCA9IHRoaXMuZm9yZXN0LnBhbmVsLmdldCgwKTtcblxuICAgIGNvbnN0IHkgPSBNYXRoLm1heChcbiAgICAgIDAsXG4gICAgICB0aGlzLnBvc2l0aW9uLnkgK1xuICAgICAgdHJlZS5zY3JvbGxpbmdfcGFuZWwucG9zaXRpb24oKS5sZWZ0ICtcbiAgICAgIGZvcmVzdF9wYW5lbC5zY3JvbGxMZWZ0XG4gICAgKTtcblxuICAgIGlmIChcbiAgICAgIHkgPCBmb3Jlc3RfcGFuZWwuc2Nyb2xsTGVmdCB8fFxuICAgICAgeSA+IGZvcmVzdF9wYW5lbC5zY3JvbGxMZWZ0ICsgdGhpcy5mb3Jlc3QucGFuZWwud2lkdGgoKSAtIDIwMFxuICAgICkge1xuICAgICAgZm9yZXN0X3BhbmVsLnNjcm9sbExlZnQgPSB5O1xuICAgIH1cblxuICAgIC8vIFZlcnRpY2FsIHBvc2l0aW9uaW5nLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLlxuXG4gICAgY29uc3Qgc2Nyb2xsaW5nX3BhbmVsID0gdHJlZS5zY3JvbGxpbmdfcGFuZWwuZ2V0KDApO1xuXG4gICAgY29uc3Qge3h9ID0gdGhpcy5wb3NpdGlvbjtcblxuICAgIGNvbnN0IHNjcm9sbF90b3AgPSBzY3JvbGxpbmdfcGFuZWwuc2Nyb2xsVG9wO1xuXG4gICAgaWYgKFxuICAgICAgeCA8IHNjcm9sbF90b3AgfHxcbiAgICAgIHggPiBzY3JvbGxfdG9wICsgdHJlZS5zY3JvbGxpbmdfcGFuZWwuaGVpZ2h0KCkgLSBOT0RFLmhlaWdodFxuICAgICkge1xuICAgICAgc2Nyb2xsaW5nX3BhbmVsLnNjcm9sbFRvcCA9IHg7XG4gICAgICB0cmVlLnVwZGF0ZV9mb3Jfc2Nyb2xsaW5nKCk7XG4gICAgfVxuICB9O1xuXG4gIC8vIElmIGV2ZW50cyBuZWVkIHRvIGJlIGhpZGRlbiwgaGVyZSdzIGhvdyB0byBkbyBpdDpcbi8vXG4vLyBFdmVudHMgc2hvdWxkIGdldCBoaWRkZW4gb25jZSB0aGVyZSBhcmUgYXQgbGVhc3QgZm91ciBjb25zZWN1dGl2ZSBvbmVzXG4vLyB3aXRoIHRoZSBzYW1lIGV4YWN0IG5hbWUuIEluIHdoaWNoIGNhc2UgYWxsIGJ1dCB0aGUgZmlyc3QgYW5kIGxhc3QgaW4gdGhhdFxuLy8gc2VxdWVuY2Ugc2hvdWxkIGdldCBoaWRkZW4uXG4vL1xuLy8gR3JvdXBzIHNob3VsZCBuZXZlciBnZXQgaGlkZGVuLiBOZWl0aGVyIHNob3VsZCBzZWxlY3RlZCBldmVudHMuXG4gIGVkZHlfbmFlcnRzX3J1bGVfZm9yX2hpZGluZ19ldmVudHMocmVjb3JkX2lkcykge1xuICAgIC8vIFRoaXMgd2lsbCBjb2xsZWN0IHRoZSByZWNvcmQgaWRzIGZvciB0aGUgaGlkZGVuIGV2ZW50cy5cbiAgICBjb25zdCBoaWRkZW4gPSBbXTtcblxuICAgIC8vIFdlJ3JlIGNoZWNraW5nIGZvciBydW5zIG9mIGEgZ2l2ZW4gbmFtZS4gU28gd2UgbmVlZCB0byB0cmFjayB0aGUgY3VycmVudFxuICAgIC8vIG5hbWUsIGFuZCBob3cgbWFueSB0aW1lcyBpdCBoYXMgYXBwZWFyZWQuXG4gICAgbGV0IHByZXZpb3VzX25hbWUgPSBudWxsO1xuICAgIGxldCBjb3VudCA9IDA7XG5cbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHJlY29yZF9pZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGNvbnN0IGlkID0gcmVjb3JkX2lkc1tpXTtcbiAgICAgIGNvbnN0IHJlY29yZCA9IHRoaXMuZm9yZXN0Lm1vZGVsLmdldChpZCk7XG5cbiAgICAgIGNvbnN0IG5hbWUgPSByZWNvcmQubmFtZSgpO1xuXG4gICAgICAvLyBXaGVuIHRoZSBuYW1lIGlzIGRpZmZlcmVudCBmcm9tIHRoZSBsYXN0IG9uZSwgd2Ugc3RhcnQgYSBuZXcgcnVuLlxuICAgICAgaWYgKCFwcmV2aW91c19uYW1lIHx8IG5hbWUgIT09IHByZXZpb3VzX25hbWUpIHtcbiAgICAgICAgcHJldmlvdXNfbmFtZSA9IG5hbWU7XG4gICAgICAgIGNvdW50ID0gMTtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG5cbiAgICAgIC8vIElmIGl0IGlzIHRoZSBzYW1lIHdlIGluY3JlbWVudCB0aGUgY291bnQuXG4gICAgICBjb3VudCArPSAxO1xuXG4gICAgICBpZiAoY291bnQgPT09IDQpIHtcbiAgICAgICAgLy8gVGhlIGZpcnN0IHRpbWUgd2UgaGl0IHRoZSByZXF1aXJlZCBudW1iZXIgd2UgYWRkIHRoZSBwcmV2aW91cyB0d29cbiAgICAgICAgLy8gcmVjb3JkIGlkcyB0byB0aGUgaGlkZGVuIHNldC4gV2hpY2ggbGVhdmVzIHRoZSBmaXJzdCBhbmQgY3VycmVudFxuICAgICAgICAvLyBldmVudCBzdGlsbCB2aXNpYmxlLlxuICAgICAgICBoaWRkZW4ucHVzaChyZWNvcmRfaWRzW2kgLSAyXSk7XG4gICAgICAgIGhpZGRlbi5wdXNoKHJlY29yZF9pZHNbaSAtIDFdKTtcbiAgICAgIH0gZWxzZSBpZiAoY291bnQgPiA0KSB7XG4gICAgICAgIC8vIEFmdGVyIHRoZSBpbml0aWFsIGxpbWl0IGhhcyBiZWVuIHJlYWNoZWQgd2Ugc2ltcGx5IGFkZCB0aGUgcHJldmlvdXNcbiAgICAgICAgLy8gcmVjb3JkIGlkIHRvIHRoZSBoaWRkZW4gc2V0LiBUaGlzIHdheSB0aGUgY3VycmVudC9sYXN0IGV2ZW50IHdpbGxcbiAgICAgICAgLy8gc3RpbGwgYmUgdmlzaWJsZS5cbiAgICAgICAgaGlkZGVuLnB1c2gocmVjb3JkX2lkc1tpIC0gMV0pO1xuICAgICAgfVxuXG4gICAgICAvLyBHcm91cHMgYXJlIG5ldmVyIGhpZGRlbi4gTmVpdGhlciBhcmUgc2VsZWN0ZWQgaXRlbXMuXG4gICAgICBpZiAocmVjb3JkX2lzX2dyb3VwKHJlY29yZCkgfHwgdGhpcy5mb3Jlc3QuaXNfcmVjb3JkX3NlbGVjdGVkKGlkKSkge1xuICAgICAgICBwcmV2aW91c19uYW1lID0gbmFtZTtcbiAgICAgICAgY291bnQgPSAxO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBoaWRkZW47XG4gIH07XG5cbiAgLy8gRm9yIHRoZSBnaXZlbiBjaGlsZCByZWNvcmQgaWRzOiB3aGljaCBzaG91bGQgYmUgaGlkZGVuL2NvbXBhY3RlZCA/XG4gIGdldF9oaWRkZW5fcmVjb3JkX2lkcyhyZWNvcmRfaWRzKSB7XG4gICAgLy8gU2hvdWxkIHdlIGJlIGhpZGluZyBhbnl0aGluZyA/XG4gICAgaWYgKCF0aGlzLnNob3VsZF9jb21wYWN0X2V2ZW50cygpKSByZXR1cm4gW107XG5cbiAgICAvLyBJZiBzbywgYXBwbHkgRWRkeSdzIHJ1bGVzOlxuICAgIHJldHVybiB0aGlzLmVkZHlfbmFlcnRzX3J1bGVfZm9yX2hpZGluZ19ldmVudHMocmVjb3JkX2lkcyk7XG4gIH07XG5cbi8vIFNob3VsZCB0aGlzIG5vZGUgYmUgY29tcGFjdGluZyBpdHMgY2hpbGQgZXZlbnRzID8gVGhpcyBnZXRzIGRlY2lkZWQgcGVyXG4vLyBzdWJ0cmVlIGluIFRyZWVWaWV3LnByb3RvdHlwZS5kZWNpZGVfd2hldGhlcl90b19jb21wYWN0X3N1YnRyZWUgLiBIZXJlXG4vLyB3ZSBqdXN0IGxvb2sgdXAgdGhhdCBkZWNpc2lvbi5cbiAgc2hvdWxkX2NvbXBhY3RfZXZlbnRzKCkge1xuICAgIGlmICh0aGlzLnBhcmVudCkgcmV0dXJuIHRoaXMucGFyZW50LnNob3VsZF9jb21wYWN0X2V2ZW50cygpO1xuXG4gICAgcmV0dXJuIHRoaXMuY29tcGFjdCA9PT0gdHJ1ZTtcbiAgfTtcblxuLy8gVXNlZnVsIGZvciBkZWJ1Z2dpbmc6XG4gIGxvZyhkZW50KSB7XG4gICAgY29uc29sZS5sb2coYCR7ZGVudCArIHRoaXMuaWR9LiR7dGhpcy5nZXRfa2V5KCl9OiAke3RoaXMuZ2V0X25hbWUoKX1gKTtcbiAgICBpZiAodGhpcy5zdWJub2Rlcykge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnN1Ym5vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHRoaXMuc3Vibm9kZXNbaV0ubG9nKGAke2RlbnR9ICBgKTtcbiAgICAgIH1cbiAgICB9XG4gIH07XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./Treeview/Node.js\n");

/***/ }),

/***/ "./Treeview/PlaceholderNode.js":
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": function() { return /* binding */ PlaceholderNode; }\n/* harmony export */ });\n/* harmony import */ var _Coordinate__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./Treeview/Coordinate.js\");\n/* harmony import */ var _event_treeview__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./Treeview/event-treeview.js\");\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\n/* eslint-disable camelcase */\n\n// Definition of a placeholder node. This is used to group a number of\n// siblings under a single node, which should aut-expend into the actual\n// sibling nodes as/when needed.\n\n\nvar PlaceholderNode = /*#__PURE__*/function () {\n  function PlaceholderNode(parent_node, record_ids) {\n    _classCallCheck(this, PlaceholderNode);\n    this.forest = parent_node.forest;\n    this.parent = parent_node;\n\n    // Keep track if we have been unlocked (normally only because our group was unlocked)\n    this.unlocked = false;\n\n    // The associated DOM element. This gets tracked by us.\n    this.element = null;\n    this.id = this.forest.node_instance_count++;\n    this.record_ids = record_ids.slice(0);\n    for (var i = 0; i < record_ids.length; i++) {\n      this.forest.nodes[record_ids[i]] = this;\n    }\n    this.x = null; // Absolute position (managed by D3)\n    this.y = null; // Absolute position (managed by D3)\n    this.position = null; // Absolute position\n\n    // Index in the overall tree.\n    this.d3_index = -1;\n  }\n  _createClass(PlaceholderNode, [{\n    key: \"resync_parentage\",\n    value: function resync_parentage() {\n      if (this.forest.has_tree(this)) {\n        this.forest.remove_tree(this);\n        this.forest.show_node(this);\n      }\n    }\n  }, {\n    key: \"get_tree\",\n    value: function get_tree() {\n      return this.parent.get_tree();\n    }\n  }, {\n    key: \"get_key\",\n    value: function get_key() {\n      return this.id;\n    }\n  }, {\n    key: \"get_name\",\n    value: function get_name() {\n      return {\n        intl: intl\n      }.intl.formatMessage({\n        \"id\": \"... {number} more\",\n        \"defaultMessage\": \"... {number} more\"\n      }, {\n        number: this.record_ids.length\n      });\n    }\n  }, {\n    key: \"get_name_with_abbreviation\",\n    value: function get_name_with_abbreviation() {\n      return this.get_name();\n    }\n  }, {\n    key: \"is_production\",\n    value: function is_production() {\n      return false;\n    }\n  }, {\n    key: \"is_placeholder\",\n    value: function is_placeholder() {\n      return true;\n    }\n  }, {\n    key: \"has_nodes_with_conflicts\",\n    value: function has_nodes_with_conflicts() {\n      var _this = this;\n      return this.leaf_record_ids().some(function (record_id) {\n        // It may happen the update of a tree is triggered when it's being deleted\n        if (_this.forest.model.get(record_id, null) !== null) {\n          return (0,_event_treeview__WEBPACK_IMPORTED_MODULE_1__.record_has_conflicts)(_this.forest.model.get(record_id));\n        } else {\n          return false;\n        }\n      });\n    }\n  }, {\n    key: \"has_conflicts\",\n    value: function has_conflicts() {\n      return false;\n    }\n  }, {\n    key: \"conflicts\",\n    value: function conflicts() {\n      return [];\n    }\n  }, {\n    key: \"is_leafevent\",\n    value: function is_leafevent() {\n      return false;\n    }\n  }, {\n    key: \"is_group\",\n    value: function is_group() {\n      return false;\n    }\n  }, {\n    key: \"is_root\",\n    value: function is_root() {\n      return false;\n    }\n  }, {\n    key: \"is_dated\",\n    value: function is_dated() {\n      return false;\n    }\n  }, {\n    key: \"is_unlocked\",\n    value: function is_unlocked() {\n      return this.unlocked;\n    }\n  }, {\n    key: \"can_be_unlocked\",\n    value: function can_be_unlocked() {\n      return true;\n    }\n  }, {\n    key: \"set_unlocked\",\n    value: function set_unlocked(value) {\n      if (!this.forest.allow_event_unlocking) return;\n      this.unlocked = value;\n    }\n  }, {\n    key: \"get_classes\",\n    value: function get_classes() {\n      return 'tree-event tree-placeholder';\n    }\n  }, {\n    key: \"leaf_record_ids\",\n    value: function leaf_record_ids() {\n      var _this2 = this;\n      return _.reduce(this.record_ids, function (leaf_ids, id) {\n        return leaf_ids.concat((0,_event_treeview__WEBPACK_IMPORTED_MODULE_1__.leaf_children_of_record)(_this2.forest.model.get(id)).map(_event_treeview__WEBPACK_IMPORTED_MODULE_1__.record_id));\n      }, []);\n    }\n  }, {\n    key: \"get_location\",\n    value: function get_location() {\n      var _this3 = this;\n      var leaf_record_ids = this.leaf_record_ids();\n      if (leaf_record_ids.length > 0) {\n        return _.reduce(leaf_record_ids, function (memo, record_id) {\n          if (memo === (0,_event_treeview__WEBPACK_IMPORTED_MODULE_1__.location_for_record)(_this3.forest.model.get(record_id), _this3.forest.model)) {\n            return memo;\n          } else {\n            return null;\n          }\n        }, (0,_event_treeview__WEBPACK_IMPORTED_MODULE_1__.location_for_record)(this.forest.model.get(this.record_ids[0]), this.forest.model));\n      }\n      return null;\n    }\n  }, {\n    key: \"is_location_settable\",\n    value: function is_location_settable() {\n      if (this.is_group()) {\n        var subnodes_without_empty_groups = this.get_subnodes_without_empty_groups();\n        return subnodes_without_empty_groups.length !== 0;\n      } else {\n        return true;\n      }\n    }\n  }, {\n    key: \"get_status\",\n    value: function get_status() {\n      var _this4 = this;\n      var leaf_record_ids = this.leaf_record_ids();\n      if (leaf_record_ids.length > 0) {\n        return _.reduce(leaf_record_ids, function (memo, record_id) {\n          if (memo === (0,_event_treeview__WEBPACK_IMPORTED_MODULE_1__.status_for_record)(_this4.forest.model.get(record_id))) {\n            return memo;\n          } else {\n            return null;\n          }\n        }, (0,_event_treeview__WEBPACK_IMPORTED_MODULE_1__.status_for_record)(this.forest.model.get(this.record_ids[0])));\n      }\n      return null;\n    }\n  }, {\n    key: \"get_settable_statuses\",\n    value: function get_settable_statuses() {\n      var _this5 = this;\n      var leaf_record_ids = this.leaf_record_ids();\n      if (leaf_record_ids.length > 0) {\n        return _.reduce(leaf_record_ids, function (memo, record_id) {\n          return _.intersection((0,_event_treeview__WEBPACK_IMPORTED_MODULE_1__.settable_statuses_for_record)(_this5.forest.model.get(record_id)), memo);\n        }, (0,_event_treeview__WEBPACK_IMPORTED_MODULE_1__.settable_statuses_for_record)(this.forest.model.get(this.record_ids[0])));\n      }\n      return null;\n    }\n  }, {\n    key: \"get_profile\",\n    value: function get_profile() {\n      var _this6 = this;\n      var leaf_record_ids = this.leaf_record_ids();\n      if (leaf_record_ids.length > 0) {\n        return _.reduce(leaf_record_ids, function (memo, record_id) {\n          if (memo === (0,_event_treeview__WEBPACK_IMPORTED_MODULE_1__.profile_for_record)(_this6.forest.model.get(record_id))) {\n            return memo;\n          } else {\n            return null;\n          }\n        }, (0,_event_treeview__WEBPACK_IMPORTED_MODULE_1__.profile_for_record)(this.forest.model.get(this.record_ids[0])));\n      }\n      return null;\n    }\n  }, {\n    key: \"eject\",\n    value: function eject(record_id) {\n      var index = this.record_ids.indexOf(record_id);\n      if (index >= 0) {\n        this.record_ids.splice(index, 1);\n        this.forest.nodes[record_id] = null;\n      }\n\n      // Actual removal of the placeholder node when it is empty gets handled\n      // automatically by the rebuild_subnodes logic.\n    }\n  }, {\n    key: \"eject_all\",\n    value: function eject_all() {\n      for (var i = 0; i < this.record_ids.length; i++) {\n        var _record_id = this.record_ids[i];\n        this.forest.nodes[_record_id] = null;\n      }\n      this.record_ids = [];\n    }\n  }, {\n    key: \"insert\",\n    value: function insert(record_id) {\n      this.record_ids.push(record_id);\n      this.forest.nodes[record_id] = this;\n    }\n  }, {\n    key: \"has_expanded\",\n    value: function has_expanded() {\n      return this.record_ids.length === 0;\n    }\n  }, {\n    key: \"expand\",\n    value: function expand() {\n      var sibling_nodes = this.parent.subnodes;\n\n      // Find the point at which to expand.\n      var index = sibling_nodes.indexOf(this);\n\n      // Remove the placeholder from that point.\n      sibling_nodes.splice(index, 1);\n\n      // And insert all actual nodes.\n      while (this.record_ids.length > 0) {\n        var _record_id2 = this.record_ids.shift();\n        this.forest.nodes[_record_id2] = null;\n        var node = this.forest.node_for_record(_record_id2);\n        node.start_position = new _Coordinate__WEBPACK_IMPORTED_MODULE_0__[\"default\"](this.x, this.y);\n        node.set_unlocked(this.unlocked);\n        sibling_nodes.splice(index, 0, node);\n        index += 1;\n      }\n    }\n  }, {\n    key: \"is_last_child\",\n    value: function is_last_child() {\n      if (!this.parent) return false;\n      var siblings = this.parent.subnodes;\n      var index = siblings.indexOf(this);\n      return index === siblings.length - 1;\n    }\n  }, {\n    key: \"has_lock\",\n    value: function has_lock() {\n      var _this7 = this;\n      return this.leaf_record_ids().some(function (record_id) {\n        // It may happen the update of a tree is triggered when it's being deleted\n        if (_this7.forest.model.get(record_id, null) !== null) {\n          return (0,_event_treeview__WEBPACK_IMPORTED_MODULE_1__.record_has_lock)(_this7.forest.model.get(record_id));\n        } else {\n          return false;\n        }\n      });\n    }\n  }, {\n    key: \"is_not_locked\",\n    value: function is_not_locked() {\n      return !this.has_actual_lock();\n    }\n  }, {\n    key: \"has_actual_lock\",\n    value: function has_actual_lock() {\n      var _this8 = this;\n      return this.leaf_record_ids().some(function (record_id) {\n        if (_this8.forest.model.get(record_id, null) !== null) {\n          return (0,_event_treeview__WEBPACK_IMPORTED_MODULE_1__.record_has_actual_lock)(_this8.forest.model.get(record_id));\n        } else {\n          return false;\n        }\n      });\n    }\n  }, {\n    key: \"has_nodes_with_actual_lock\",\n    value: function has_nodes_with_actual_lock() {\n      return this.has_actual_lock();\n    }\n  }, {\n    key: \"dispose\",\n    value: function dispose() {\n      this.eject_all();\n    }\n  }, {\n    key: \"log\",\n    value: function log(dent) {\n      console.log(\"\".concat(dent + this.id, \". (\").concat(this.record_ids, \")\"));\n    }\n  }]);\n  return PlaceholderNode;\n}();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9UcmVldmlldy9QbGFjZWhvbGRlck5vZGUuanMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUE7QUFDQTs7QUFHQTtBQUNBO0FBQ0E7O0FBRUE7QUFLQTtBQUdBO0FBQUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUVBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBRUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUdBO0FBR0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFBQTtBQUFBO0FBQUEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9SZWFjdENvbXBvbmVudHNfLy4vVHJlZXZpZXcvUGxhY2Vob2xkZXJOb2RlLmpzPzdmZDIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFhZIGZyb20gJy4vQ29vcmRpbmF0ZSc7XG4vKiBlc2xpbnQtZGlzYWJsZSBjYW1lbGNhc2UgKi9cblxuXG4vLyBEZWZpbml0aW9uIG9mIGEgcGxhY2Vob2xkZXIgbm9kZS4gVGhpcyBpcyB1c2VkIHRvIGdyb3VwIGEgbnVtYmVyIG9mXG4vLyBzaWJsaW5ncyB1bmRlciBhIHNpbmdsZSBub2RlLCB3aGljaCBzaG91bGQgYXV0LWV4cGVuZCBpbnRvIHRoZSBhY3R1YWxcbi8vIHNpYmxpbmcgbm9kZXMgYXMvd2hlbiBuZWVkZWQuXG5cbmltcG9ydCB7XG4gIGxlYWZfY2hpbGRyZW5fb2ZfcmVjb3JkLFxuICBsb2NhdGlvbl9mb3JfcmVjb3JkLCBwcm9maWxlX2Zvcl9yZWNvcmQsIHJlY29yZF9oYXNfYWN0dWFsX2xvY2ssIHJlY29yZF9oYXNfY29uZmxpY3RzLCByZWNvcmRfaGFzX2xvY2ssIHJlY29yZF9pZCxcbiAgc2V0dGFibGVfc3RhdHVzZXNfZm9yX3JlY29yZCxcbiAgc3RhdHVzX2Zvcl9yZWNvcmRcbn0gZnJvbSAnLi9ldmVudC10cmVldmlldyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBsYWNlaG9sZGVyTm9kZSB7XG4gIGNvbnN0cnVjdG9yKHBhcmVudF9ub2RlLCByZWNvcmRfaWRzKSB7XG4gICAgdGhpcy5mb3Jlc3QgPSBwYXJlbnRfbm9kZS5mb3Jlc3Q7XG4gICAgdGhpcy5wYXJlbnQgPSBwYXJlbnRfbm9kZTtcblxuICAgIC8vIEtlZXAgdHJhY2sgaWYgd2UgaGF2ZSBiZWVuIHVubG9ja2VkIChub3JtYWxseSBvbmx5IGJlY2F1c2Ugb3VyIGdyb3VwIHdhcyB1bmxvY2tlZClcbiAgICB0aGlzLnVubG9ja2VkID0gZmFsc2U7XG5cbiAgICAvLyBUaGUgYXNzb2NpYXRlZCBET00gZWxlbWVudC4gVGhpcyBnZXRzIHRyYWNrZWQgYnkgdXMuXG4gICAgdGhpcy5lbGVtZW50ID0gbnVsbDtcblxuICAgIHRoaXMuaWQgPSB0aGlzLmZvcmVzdC5ub2RlX2luc3RhbmNlX2NvdW50Kys7XG5cbiAgICB0aGlzLnJlY29yZF9pZHMgPSByZWNvcmRfaWRzLnNsaWNlKDApO1xuXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCByZWNvcmRfaWRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB0aGlzLmZvcmVzdC5ub2Rlc1tyZWNvcmRfaWRzW2ldXSA9IHRoaXM7XG4gICAgfVxuXG4gICAgdGhpcy54ID0gbnVsbDsgLy8gQWJzb2x1dGUgcG9zaXRpb24gKG1hbmFnZWQgYnkgRDMpXG4gICAgdGhpcy55ID0gbnVsbDsgLy8gQWJzb2x1dGUgcG9zaXRpb24gKG1hbmFnZWQgYnkgRDMpXG4gICAgdGhpcy5wb3NpdGlvbiA9IG51bGw7IC8vIEFic29sdXRlIHBvc2l0aW9uXG5cbiAgICAvLyBJbmRleCBpbiB0aGUgb3ZlcmFsbCB0cmVlLlxuICAgIHRoaXMuZDNfaW5kZXggPSAtMTtcbiAgfVxuXG4gIHJlc3luY19wYXJlbnRhZ2UoKSB7XG4gICAgaWYgKHRoaXMuZm9yZXN0Lmhhc190cmVlKHRoaXMpKSB7XG4gICAgICB0aGlzLmZvcmVzdC5yZW1vdmVfdHJlZSh0aGlzKTtcbiAgICAgIHRoaXMuZm9yZXN0LnNob3dfbm9kZSh0aGlzKTtcbiAgICB9XG4gIH07XG5cbiAgZ2V0X3RyZWUoKSB7XG4gICAgcmV0dXJuIHRoaXMucGFyZW50LmdldF90cmVlKCk7XG4gIH07XG5cbiAgZ2V0X2tleSgpIHtcbiAgICByZXR1cm4gdGhpcy5pZDtcbiAgfTtcblxuICBnZXRfbmFtZSgpIHtcbiAgICByZXR1cm4gaTE4bignLi4uIHtudW1iZXJ9IG1vcmUnLCB7bnVtYmVyOiB0aGlzLnJlY29yZF9pZHMubGVuZ3RofSk7XG4gIH07XG5cbiAgZ2V0X25hbWVfd2l0aF9hYmJyZXZpYXRpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0X25hbWUoKTtcbiAgfTtcblxuICBpc19wcm9kdWN0aW9uKCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICBpc19wbGFjZWhvbGRlcigpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfTtcblxuICBoYXNfbm9kZXNfd2l0aF9jb25mbGljdHMoKSB7XG4gICAgcmV0dXJuIHRoaXMubGVhZl9yZWNvcmRfaWRzKCkuc29tZSgocmVjb3JkX2lkKSA9PiB7XG4gICAgICAvLyBJdCBtYXkgaGFwcGVuIHRoZSB1cGRhdGUgb2YgYSB0cmVlIGlzIHRyaWdnZXJlZCB3aGVuIGl0J3MgYmVpbmcgZGVsZXRlZFxuICAgICAgaWYgKHRoaXMuZm9yZXN0Lm1vZGVsLmdldChyZWNvcmRfaWQsIG51bGwpICE9PSBudWxsKSB7XG4gICAgICAgIHJldHVybiByZWNvcmRfaGFzX2NvbmZsaWN0cyh0aGlzLmZvcmVzdC5tb2RlbC5nZXQocmVjb3JkX2lkKSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG5cbiAgaGFzX2NvbmZsaWN0cygpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH07XG5cbiAgY29uZmxpY3RzKCkge1xuICAgIHJldHVybiBbXTtcbiAgfTtcblxuICBpc19sZWFmZXZlbnQoKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9O1xuXG4gIGlzX2dyb3VwKCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICBpc19yb290KCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICBpc19kYXRlZCgpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH07XG5cbiAgaXNfdW5sb2NrZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMudW5sb2NrZWQ7XG4gIH07XG5cbiAgY2FuX2JlX3VubG9ja2VkKCkge1xuICAgIHJldHVybiB0cnVlO1xuICB9O1xuXG4gIHNldF91bmxvY2tlZCh2YWx1ZSkge1xuICAgIGlmICghdGhpcy5mb3Jlc3QuYWxsb3dfZXZlbnRfdW5sb2NraW5nKSByZXR1cm47XG4gICAgdGhpcy51bmxvY2tlZCA9IHZhbHVlO1xuICB9O1xuXG4gIGdldF9jbGFzc2VzKCkge1xuICAgIHJldHVybiAndHJlZS1ldmVudCB0cmVlLXBsYWNlaG9sZGVyJztcbiAgfTtcblxuICBsZWFmX3JlY29yZF9pZHMoKSB7XG4gICAgcmV0dXJuIF8ucmVkdWNlKFxuICAgICAgdGhpcy5yZWNvcmRfaWRzLFxuICAgICAgKGxlYWZfaWRzLCBpZCkgPT4gbGVhZl9pZHMuY29uY2F0KGxlYWZfY2hpbGRyZW5fb2ZfcmVjb3JkKHRoaXMuZm9yZXN0Lm1vZGVsLmdldChpZCkpLm1hcChyZWNvcmRfaWQpKSxcbiAgICAgIFtdKTtcbiAgfTtcblxuICBnZXRfbG9jYXRpb24oKSB7XG4gICAgY29uc3QgbGVhZl9yZWNvcmRfaWRzID0gdGhpcy5sZWFmX3JlY29yZF9pZHMoKTtcbiAgICBpZiAobGVhZl9yZWNvcmRfaWRzLmxlbmd0aCA+IDApIHtcbiAgICAgIHJldHVybiBfLnJlZHVjZShcbiAgICAgICAgbGVhZl9yZWNvcmRfaWRzLFxuICAgICAgICAobWVtbywgcmVjb3JkX2lkKSA9PiB7XG4gICAgICAgICAgaWYgKG1lbW8gPT09IGxvY2F0aW9uX2Zvcl9yZWNvcmQodGhpcy5mb3Jlc3QubW9kZWwuZ2V0KHJlY29yZF9pZCksIHRoaXMuZm9yZXN0Lm1vZGVsKSkge1xuICAgICAgICAgICAgcmV0dXJuIG1lbW87XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgbG9jYXRpb25fZm9yX3JlY29yZCh0aGlzLmZvcmVzdC5tb2RlbC5nZXQodGhpcy5yZWNvcmRfaWRzWzBdKSwgdGhpcy5mb3Jlc3QubW9kZWwpXG4gICAgICApO1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfTtcblxuICBpc19sb2NhdGlvbl9zZXR0YWJsZSgpIHtcbiAgICBpZiAodGhpcy5pc19ncm91cCgpKSB7XG4gICAgICBjb25zdCBzdWJub2Rlc193aXRob3V0X2VtcHR5X2dyb3VwcyA9IHRoaXMuZ2V0X3N1Ym5vZGVzX3dpdGhvdXRfZW1wdHlfZ3JvdXBzKCk7XG4gICAgICByZXR1cm4gc3Vibm9kZXNfd2l0aG91dF9lbXB0eV9ncm91cHMubGVuZ3RoICE9PSAwO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gIH07XG5cbiAgZ2V0X3N0YXR1cygpIHtcbiAgICBjb25zdCBsZWFmX3JlY29yZF9pZHMgPSB0aGlzLmxlYWZfcmVjb3JkX2lkcygpO1xuICAgIGlmIChsZWFmX3JlY29yZF9pZHMubGVuZ3RoID4gMCkge1xuICAgICAgcmV0dXJuIF8ucmVkdWNlKFxuICAgICAgICBsZWFmX3JlY29yZF9pZHMsXG4gICAgICAgIChtZW1vLCByZWNvcmRfaWQpID0+IHtcbiAgICAgICAgICBpZiAobWVtbyA9PT0gc3RhdHVzX2Zvcl9yZWNvcmQodGhpcy5mb3Jlc3QubW9kZWwuZ2V0KHJlY29yZF9pZCkpKSB7XG4gICAgICAgICAgICByZXR1cm4gbWVtbztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBzdGF0dXNfZm9yX3JlY29yZCh0aGlzLmZvcmVzdC5tb2RlbC5nZXQodGhpcy5yZWNvcmRfaWRzWzBdKSlcbiAgICAgICk7XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9O1xuXG4gIGdldF9zZXR0YWJsZV9zdGF0dXNlcygpIHtcbiAgICBjb25zdCBsZWFmX3JlY29yZF9pZHMgPSB0aGlzLmxlYWZfcmVjb3JkX2lkcygpO1xuICAgIGlmIChsZWFmX3JlY29yZF9pZHMubGVuZ3RoID4gMCkge1xuICAgICAgcmV0dXJuIF8ucmVkdWNlKFxuICAgICAgICBsZWFmX3JlY29yZF9pZHMsXG4gICAgICAgIChtZW1vLCByZWNvcmRfaWQpID0+IF8uaW50ZXJzZWN0aW9uKFxuICAgICAgICAgICAgc2V0dGFibGVfc3RhdHVzZXNfZm9yX3JlY29yZCh0aGlzLmZvcmVzdC5tb2RlbC5nZXQocmVjb3JkX2lkKSksXG4gICAgICAgICAgICBtZW1vXG4gICAgICAgICAgKSxcbiAgICAgICAgc2V0dGFibGVfc3RhdHVzZXNfZm9yX3JlY29yZCh0aGlzLmZvcmVzdC5tb2RlbC5nZXQodGhpcy5yZWNvcmRfaWRzWzBdKSlcbiAgICAgICk7XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9O1xuXG4gIGdldF9wcm9maWxlKCkge1xuICAgIGNvbnN0IGxlYWZfcmVjb3JkX2lkcyA9IHRoaXMubGVhZl9yZWNvcmRfaWRzKCk7XG4gICAgaWYgKGxlYWZfcmVjb3JkX2lkcy5sZW5ndGggPiAwKSB7XG4gICAgICByZXR1cm4gXy5yZWR1Y2UoXG4gICAgICAgIGxlYWZfcmVjb3JkX2lkcyxcbiAgICAgICAgKG1lbW8sIHJlY29yZF9pZCkgPT4ge1xuICAgICAgICAgIGlmIChtZW1vID09PSBwcm9maWxlX2Zvcl9yZWNvcmQodGhpcy5mb3Jlc3QubW9kZWwuZ2V0KHJlY29yZF9pZCkpKSB7XG4gICAgICAgICAgICByZXR1cm4gbWVtbztcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBwcm9maWxlX2Zvcl9yZWNvcmQodGhpcy5mb3Jlc3QubW9kZWwuZ2V0KHRoaXMucmVjb3JkX2lkc1swXSkpXG4gICAgICApO1xuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfTtcblxuICBlamVjdChyZWNvcmRfaWQpIHtcbiAgICBjb25zdCBpbmRleCA9IHRoaXMucmVjb3JkX2lkcy5pbmRleE9mKHJlY29yZF9pZCk7XG4gICAgaWYgKGluZGV4ID49IDApIHtcbiAgICAgIHRoaXMucmVjb3JkX2lkcy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgdGhpcy5mb3Jlc3Qubm9kZXNbcmVjb3JkX2lkXSA9IG51bGw7XG4gICAgfVxuXG4gICAgLy8gQWN0dWFsIHJlbW92YWwgb2YgdGhlIHBsYWNlaG9sZGVyIG5vZGUgd2hlbiBpdCBpcyBlbXB0eSBnZXRzIGhhbmRsZWRcbiAgICAvLyBhdXRvbWF0aWNhbGx5IGJ5IHRoZSByZWJ1aWxkX3N1Ym5vZGVzIGxvZ2ljLlxuICB9O1xuXG5cbiAgZWplY3RfYWxsKCkge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5yZWNvcmRfaWRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCByZWNvcmRfaWQgPSB0aGlzLnJlY29yZF9pZHNbaV07XG4gICAgICB0aGlzLmZvcmVzdC5ub2Rlc1tyZWNvcmRfaWRdID0gbnVsbDtcbiAgICB9XG5cbiAgICB0aGlzLnJlY29yZF9pZHMgPSBbXTtcbiAgfTtcblxuICBpbnNlcnQocmVjb3JkX2lkKSB7XG4gICAgdGhpcy5yZWNvcmRfaWRzLnB1c2gocmVjb3JkX2lkKTtcbiAgICB0aGlzLmZvcmVzdC5ub2Rlc1tyZWNvcmRfaWRdID0gdGhpcztcbiAgfTtcblxuICBoYXNfZXhwYW5kZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMucmVjb3JkX2lkcy5sZW5ndGggPT09IDA7XG4gIH07XG5cbiAgZXhwYW5kKCkge1xuICAgIGNvbnN0IHNpYmxpbmdfbm9kZXMgPSB0aGlzLnBhcmVudC5zdWJub2RlcztcblxuICAgIC8vIEZpbmQgdGhlIHBvaW50IGF0IHdoaWNoIHRvIGV4cGFuZC5cbiAgICBsZXQgaW5kZXggPSBzaWJsaW5nX25vZGVzLmluZGV4T2YodGhpcyk7XG5cbiAgICAvLyBSZW1vdmUgdGhlIHBsYWNlaG9sZGVyIGZyb20gdGhhdCBwb2ludC5cbiAgICBzaWJsaW5nX25vZGVzLnNwbGljZShpbmRleCwgMSk7XG5cbiAgICAvLyBBbmQgaW5zZXJ0IGFsbCBhY3R1YWwgbm9kZXMuXG4gICAgd2hpbGUgKHRoaXMucmVjb3JkX2lkcy5sZW5ndGggPiAwKSB7XG4gICAgICBjb25zdCByZWNvcmRfaWQgPSB0aGlzLnJlY29yZF9pZHMuc2hpZnQoKTtcbiAgICAgIHRoaXMuZm9yZXN0Lm5vZGVzW3JlY29yZF9pZF0gPSBudWxsO1xuICAgICAgY29uc3Qgbm9kZSA9IHRoaXMuZm9yZXN0Lm5vZGVfZm9yX3JlY29yZChyZWNvcmRfaWQpO1xuICAgICAgbm9kZS5zdGFydF9wb3NpdGlvbiA9IG5ldyBYWSh0aGlzLngsIHRoaXMueSk7XG4gICAgICBub2RlLnNldF91bmxvY2tlZCh0aGlzLnVubG9ja2VkKTtcbiAgICAgIHNpYmxpbmdfbm9kZXMuc3BsaWNlKGluZGV4LCAwLCBub2RlKTtcbiAgICAgIGluZGV4ICs9IDE7XG4gICAgfVxuICB9O1xuXG4gIGlzX2xhc3RfY2hpbGQoKSB7XG4gICAgaWYgKCF0aGlzLnBhcmVudCkgcmV0dXJuIGZhbHNlO1xuICAgIGNvbnN0IHNpYmxpbmdzID0gdGhpcy5wYXJlbnQuc3Vibm9kZXM7XG4gICAgY29uc3QgaW5kZXggPSBzaWJsaW5ncy5pbmRleE9mKHRoaXMpO1xuICAgIHJldHVybiBpbmRleCA9PT0gc2libGluZ3MubGVuZ3RoIC0gMTtcbiAgfTtcblxuICBoYXNfbG9jaygpIHtcbiAgICByZXR1cm4gdGhpcy5sZWFmX3JlY29yZF9pZHMoKS5zb21lKChyZWNvcmRfaWQpID0+IHtcbiAgICAgIC8vIEl0IG1heSBoYXBwZW4gdGhlIHVwZGF0ZSBvZiBhIHRyZWUgaXMgdHJpZ2dlcmVkIHdoZW4gaXQncyBiZWluZyBkZWxldGVkXG4gICAgICBpZiAodGhpcy5mb3Jlc3QubW9kZWwuZ2V0KHJlY29yZF9pZCwgbnVsbCkgIT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIHJlY29yZF9oYXNfbG9jayh0aGlzLmZvcmVzdC5tb2RlbC5nZXQocmVjb3JkX2lkKSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfSk7XG4gIH07XG5cbiAgaXNfbm90X2xvY2tlZCgpIHtcbiAgICByZXR1cm4gIXRoaXMuaGFzX2FjdHVhbF9sb2NrKCk7XG4gIH07XG5cbiAgaGFzX2FjdHVhbF9sb2NrKCkge1xuICAgIHJldHVybiB0aGlzLmxlYWZfcmVjb3JkX2lkcygpLnNvbWUoKHJlY29yZF9pZCkgPT4ge1xuICAgICAgaWYgKHRoaXMuZm9yZXN0Lm1vZGVsLmdldChyZWNvcmRfaWQsIG51bGwpICE9PSBudWxsKSB7XG4gICAgICAgIHJldHVybiByZWNvcmRfaGFzX2FjdHVhbF9sb2NrKHRoaXMuZm9yZXN0Lm1vZGVsLmdldChyZWNvcmRfaWQpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcblxuICBoYXNfbm9kZXNfd2l0aF9hY3R1YWxfbG9jaygpIHtcbiAgICByZXR1cm4gdGhpcy5oYXNfYWN0dWFsX2xvY2soKTtcbiAgfTtcblxuICBkaXNwb3NlKCkge1xuICAgIHRoaXMuZWplY3RfYWxsKCk7XG4gIH07XG5cbiAgbG9nKGRlbnQpIHtcbiAgICBjb25zb2xlLmxvZyhgJHtkZW50ICsgdGhpcy5pZH0uICgke3RoaXMucmVjb3JkX2lkc30pYCk7XG4gIH07XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./Treeview/PlaceholderNode.js\n");

/***/ }),

/***/ "./Treeview/Tree.js":
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": function() { return /* binding */ Tree; }\n/* harmony export */ });\n/* harmony import */ var _Coordinate__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./Treeview/Coordinate.js\");\n/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./Treeview/constants.js\");\n/* harmony import */ var _PlaceholderNode__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"./Treeview/PlaceholderNode.js\");\n/* harmony import */ var _event_treeview__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"./Treeview/event-treeview.js\");\n/* harmony import */ var _DateFormatSettings__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(\"./Treeview/DateFormatSettings.js\");\n/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(\"./node_modules/moment/moment.js\");\n/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_5__);\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n/* eslint-disable camelcase, func-names */\n\n\n\n\n\n\nvar Tree = /*#__PURE__*/function () {\n  function Tree(forest, root) {\n    _classCallCheck(this, Tree);\n    this.forest = forest;\n    this.root = root;\n    this.scrolling_panel = $('<div>').addClass('scrolling-event-tree');\n    this.forest.panel.append(this.scrolling_panel);\n    this.tree_panel = $('<div>');\n    this.scrolling_panel.append(this.tree_panel);\n    this.decide_whether_to_compact_subtree();\n\n    // The root is always expanded.\n    this.root.collapsed = false;\n\n    // For throttling rendering of this tree:\n    this.next_scheduled_update = null;\n\n    // Tracking D3 elements:\n    this.d3_tree = null;\n    this.d3_nodes = null;\n    this.d3_links = null;\n    this.event_tree = null;\n    this.svg = null;\n\n    // Set it all up:\n    this.initialize_d3();\n    this.setup_scrolling();\n  }\n\n  // Destroy the tree view.\n  _createClass(Tree, [{\n    key: \"dispose\",\n    value: function dispose() {\n      this.scrolling_panel.remove();\n      this.scrolling_panel = null;\n    }\n  }, {\n    key: \"initialize_d3\",\n    value:\n    // This sets up the necessary support for the D3 tree.\n    function initialize_d3() {\n      // The D3 tree:\n      // Because the default layout is not what we want, we will be managing\n      // the X coordinates ourselves, which is why we set the node size's\n      // height to zero.\n      this.d3TreeFunction = d3.tree().nodeSize([0, _constants__WEBPACK_IMPORTED_MODULE_1__.INDENT]);\n      var d3Root = d3.hierarchy(this.root, function (node) {\n        // If the node is collapsed then we don't tell D3 about its children.\n        if (node.collapsed) return null;\n        // Placeholders have no children.\n        if (node instanceof _PlaceholderNode__WEBPACK_IMPORTED_MODULE_2__[\"default\"]) return null;\n        // If the subnodes have already been defined we return them.\n        if (node.subnodes !== null) return node.subnodes;\n        // If the record defines no children, then we don't return any.\n        if (!(0,_event_treeview__WEBPACK_IMPORTED_MODULE_3__.record_is_group)(node.record)) return null;\n        // Otherwise we create them before returning them.\n        node.subnodes = [];\n        node.rebuild_subnodes();\n        return node.subnodes;\n      });\n      this.d3_tree = this.d3TreeFunction(d3Root);\n\n      // The tree will be housed inside a DIV. This DIV sets up a positioning\n      // context against relative to which all events will be placed.\n      this.event_tree = d3.select(this.tree_panel.get(0)).style('position', 'relative').style('width', '10px');\n\n      // The connecting lines will be drawn using SVG. So we add an SVG\n      // container which takes up the same space as the DIV.\n      this.svg = this.event_tree.append('svg').attr('width', '100%').attr('height', '100%');\n    }\n  }, {\n    key: \"request_update_promise\",\n    value:\n    // We want to be able to throttle the UI update so that it does not\n    // trigger on every minor change to the model, of which there may be many\n    // in a short time. So instead we schedule an update, and we reschedule\n    // until there are no more changes being reported within a certain time\n    // interval.\n    //\n    // In addition we return a promise for the update so that other code can\n    // chain on to it for things which have to await the updated tree. (E.g.\n    // scrolling to a certain node.)\n    function request_update_promise() {\n      var _this = this;\n      if (this.next_scheduled_update !== null) {\n        clearTimeout(this.next_scheduled_update);\n      } else {\n        this.deferred_update = new Promise(function (resolve, reject) {\n          _this.resolve_deferred_update = resolve;\n        });\n      }\n      this.next_scheduled_update = setTimeout(function () {\n        this.next_scheduled_update = null;\n        this.update_now();\n        this.resolve_deferred_update();\n        this.deferred_update = null;\n      }.bind(this), 100);\n      return this.deferred_update;\n    }\n  }, {\n    key: \"request_update\",\n    value: function request_update() {\n      return this.request_update_promise();\n    }\n  }, {\n    key: \"update_now\",\n    value:\n    // Following function creates/updates the event tree.\n    // The source is the event which triggered the update.\n    function update_now() {\n      var _this2 = this;\n      // Check if this tree has been disposed of in the meantime...\n      if (this.scrolling_panel === null) return;\n\n      // this.log()\n\n      // Retrieve the flattened node list:\n      var d3Root = d3.hierarchy(this.root, function (node) {\n        // If the node is collapsed then we don't tell D3 about its children.\n        if (node.collapsed) return null;\n        // Placeholders have no children.\n        if (node instanceof _PlaceholderNode__WEBPACK_IMPORTED_MODULE_2__[\"default\"]) return null;\n        // If the node still exists (not deleted) and the subnodes have already been defined we return them.\n        if (node.forest.model.get((0,_event_treeview__WEBPACK_IMPORTED_MODULE_3__.record_id)(node.record), false) && node.subnodes !== null) {\n          return node.subnodes;\n        }\n        // If the record defines no children, then we don't return any.\n        if (!(0,_event_treeview__WEBPACK_IMPORTED_MODULE_3__.record_is_group)(node.record)) return null;\n        // Otherwise we create them before returning them.\n        node.subnodes = [];\n        node.rebuild_subnodes();\n        return node.subnodes;\n      });\n      this.d3_tree = this.d3TreeFunction(d3Root);\n      this.d3_nodes = [];\n      this.d3_tree.eachBefore(function (n) {\n        this.d3_nodes.push(n.data);\n      }.bind(this));\n      var i;\n      // Keep track of the reverse mapping. This helps the scrolling\n      // calculations.\n      for (i = 0; i < this.d3_nodes.length; i++) {\n        this.d3_nodes[i].d3_index = i;\n      }\n\n      // We then figure out where the nodes must go. This will also grow the\n      // container so the nodes can fit.\n      // Extra complication: if the tree was scrolled we need to maintain the\n      // scroll position as well.\n      var scroll_top = this.scrolling_panel.scrollTop();\n      this.calculate_node_positions();\n      this.adjust_node_positions_for_scrolling(scroll_top);\n      this.scrolling_panel.scrollTop(scroll_top);\n\n      // ........................................................................\n      // Node creation/update\n\n      // First we match the event nodes with the actual events, using the\n      // event key to ensure a consistent mapping.\n      var all_event_nodes = this.event_tree.selectAll('div.tree-event').data(this.d3_nodes, _event_treeview__WEBPACK_IMPORTED_MODULE_3__.node_key);\n\n      // D3 EXIT\n      // Existing nodes need to move and become hidden.\n      all_event_nodes.exit().transition().duration(_constants__WEBPACK_IMPORTED_MODULE_1__.DURATION).style('opacity', 0.0).remove();\n\n      // The data for exiting nodes gets retained by the tree. When they\n      // show again we want to make sure they are not getting highlighted as\n      // newly created once more.\n      var exiting_nodes = all_event_nodes.exit().data();\n      for (i = 0; i < exiting_nodes.length; i++) {\n        if (exiting_nodes[i]) exiting_nodes[i].highlight_as_new = false;\n      }\n\n      // D3 JOIN:\n      //  - D3 ENTER for new events\n\n      // For any new events we can now create nodes. They start their life\n      // initially invisible. We also make sure that parent nodes appear on top\n      // of child nodes.\n      var newNodes = all_event_nodes.enter().append('div');\n      all_event_nodes = newNodes\n      // The node is draggable if it is writable, if its parent is writable, and if it is not a placeholder\n      .attr('draggable', function (d) {\n        var nodeParent = d.parent;\n        var nodeParentCanBeWritten;\n        if (nodeParent) {\n          nodeParentCanBeWritten = (0,_event_treeview__WEBPACK_IMPORTED_MODULE_3__.record_can_be_written)(nodeParent.record);\n        } else {\n          nodeParentCanBeWritten = true;\n        }\n        return !(d instanceof _PlaceholderNode__WEBPACK_IMPORTED_MODULE_2__[\"default\"]) && (0,_event_treeview__WEBPACK_IMPORTED_MODULE_3__.record_can_be_written)(d.record) && (0,_event_treeview__WEBPACK_IMPORTED_MODULE_3__.record_can_be_written)(d.record) && nodeParentCanBeWritten;\n      }).style('position', 'absolute').style('left', function (d) {\n        if (d.start_position && d.start_position !== null) {\n          return \"\".concat(d.start_position.y, \"px\");\n        } else if (d.parent) {\n          return \"\".concat(d.parent.y, \"px\");\n        } else {\n          return '0px';\n        }\n      }).style('top', function (d) {\n        if (d.start_position && d.start_position !== null) {\n          return \"\".concat(d.start_position.x, \"px\");\n        } else if (d.parent) {\n          return \"\".concat(d.parent.x, \"px\");\n        } else {\n          return '0px';\n        }\n      }).style('opacity', function () {\n        return 0;\n      })\n\n      // - D3 merge for new and existing events\n      .merge(all_event_nodes);\n\n      // These are used for expanding/collapsing an event group.\n      var toggle = newNodes.filter(_event_treeview__WEBPACK_IMPORTED_MODULE_3__.node_is_group).append('div').attr('class', 'toggle');\n      toggle.style('display', function (d) {\n        if (d.has_subnodes()) {\n          return 'inline-block';\n        } else {\n          return 'none';\n        }\n      });\n\n      // Each node has a (compound) label:\n      var label = newNodes.append('div').attr('class', 'label').style('position', 'relative').style('height', _constants__WEBPACK_IMPORTED_MODULE_1__.NODE.height);\n\n      // Locked events need a lock icon:\n      newNodes.selectAll('.label').append('a').attr('class', 'lock');\n\n      // Each node label needs a production icon:\n      label.append('div').attr('class', 'production-icon');\n\n      // We set the production flag on every update, as it may have changed.\n      all_event_nodes.selectAll('.label>.production-icon').style('display', function (d) {\n        if ((0,_event_treeview__WEBPACK_IMPORTED_MODULE_3__.node_is_production)(d)) {\n          return 'inline-block';\n        } else {\n          return 'none';\n        }\n      });\n\n      // Each node label needs a conflict icon:\n      label.append('div').attr('class', 'icon-conflict').attr('title', '');\n\n      // We set the conflict icon on every update, as it may have changed.\n      all_event_nodes.selectAll('.label>.icon-conflict').style('display', function (d) {\n        if ((0,_event_treeview__WEBPACK_IMPORTED_MODULE_3__.has_nodes_with_conflicts)(d)) {\n          return 'inline-block';\n        } else {\n          return 'none';\n        }\n      });\n\n      // Events which have date info need to present this info:\n      newNodes.filter(_event_treeview__WEBPACK_IMPORTED_MODULE_3__.node_is_dated).selectAll('.label').append('span').attr('class', 'date');\n\n      // All events show their name:\n      label.append('span').attr('class', 'name');\n\n      // We set the name on every update, as it may have changed.\n      all_event_nodes.selectAll('span.name').text(_event_treeview__WEBPACK_IMPORTED_MODULE_3__.get_node_name);\n\n      // We set the location title attribute\n      all_event_nodes.attr('title', function (node) {\n        return (0,_event_treeview__WEBPACK_IMPORTED_MODULE_3__.node_titlestring)(node, _this2.forest.model);\n      });\n\n      // We set the date on every update, as it may also have changed.\n      var dateFormatSettings = _DateFormatSettings__WEBPACK_IMPORTED_MODULE_4__[\"default\"].getSettings();\n      all_event_nodes.filter(_event_treeview__WEBPACK_IMPORTED_MODULE_3__.node_is_dated).selectAll('.date').text(function (node) {\n        var date = (0,_event_treeview__WEBPACK_IMPORTED_MODULE_3__.date_for_record)(node.record);\n        return moment__WEBPACK_IMPORTED_MODULE_5___default()(date).format(dateFormatSettings.dateFormatWithoutYear);\n      });\n\n      // Locks may have changed, so we update those as well.\n      var allow_event_unlocking = this.forest.allow_event_unlocking;\n      all_event_nodes.select('.lock').attr('class', function (d) {\n        if ((0,_event_treeview__WEBPACK_IMPORTED_MODULE_3__.node_has_actual_lock)(d)) {\n          return 'lock lock--actual';\n        } else if ((0,_event_treeview__WEBPACK_IMPORTED_MODULE_3__.node_has_lock)(d) && d.is_unlocked()) {\n          return 'lock unlocked action';\n        } else if ((0,_event_treeview__WEBPACK_IMPORTED_MODULE_3__.node_has_lock)(d)) {\n          if (allow_event_unlocking && d.can_be_unlocked()) {\n            return 'lock action';\n          } else {\n            return 'lock disabled action';\n          }\n        } else {\n          return 'lock lock--none';\n        }\n      });\n\n      // Depth sorting:\n      all_event_nodes.sort(_event_treeview__WEBPACK_IMPORTED_MODULE_3__.compare_for_layering);\n\n      // Existing nodes may need to move, and remain visible.\n      all_event_nodes.transition().duration(_constants__WEBPACK_IMPORTED_MODULE_1__.DURATION).attr('class', _event_treeview__WEBPACK_IMPORTED_MODULE_3__.classes_for_node).style('left', function (d) {\n        return \"\".concat(d.y, \"px\");\n      }).style('top', function (d) {\n        return \"\".concat(d.x, \"px\");\n      }).style('opacity', function (d) {\n        return d.opacity;\n      });\n\n      // ........................................................................\n      // Links\n\n      this.d3_links = this.d3_tree.links(this.d3_tree.descendants());\n\n      // Set up the links to be drawn. A parent-child link is \"owned\" by the\n      // child, as it can have only one. Which means we can use the child's\n      // data key as the link selector.\n      var link = this.svg.selectAll('path.link').data(this.d3_links, function (d) {\n        return d.target.data.get_key();\n      });\n\n      // Position exiting links, and hide them.\n      link.exit().transition().duration(_constants__WEBPACK_IMPORTED_MODULE_1__.DURATION).attr('opacity', 0.0).remove();\n\n      // Enter any new links.\n      var new_links = link.enter().insert('path', 'g').attr('class', 'link').attr('opacity', 0.0);\n\n      // Position new links, and make them visible.\n      new_links.transition().duration(_constants__WEBPACK_IMPORTED_MODULE_1__.DURATION).attr('d', function (link, d) {\n        return (0,_event_treeview__WEBPACK_IMPORTED_MODULE_3__.svg_path_for_link)({\n          source: link.source.data,\n          target: link.target.data\n        });\n      }).attr('opacity', 1.0);\n      // .attr('stroke', link_color)\n\n      link = new_links.merge(link);\n\n      // Reposition links as needed.\n      link.transition().duration(_constants__WEBPACK_IMPORTED_MODULE_1__.DURATION).attr('d', function (link, d) {\n        return (0,_event_treeview__WEBPACK_IMPORTED_MODULE_3__.svg_path_for_link)({\n          source: link.source.data,\n          target: link.target.data\n        });\n      }).attr('opacity', 1.0);\n      // .attr('stroke', link_color)\n\n      // ........................................................................\n      // Tracking and sizing\n\n      // By tracking the correct DOM element on each node we can do some direct\n      // DOM manipulation more easily in other spots (e.g. selection).\n      //\n      // In addition, we also make sure the tree panel is wide enough to show\n      // all nodes.\n\n      var overall_width = 0;\n      all_event_nodes.each(function (d) {\n        d.element = $(this);\n        var local_width = d.y + parseInt($(this).css('width'));\n        overall_width = Math.max(local_width, overall_width);\n      });\n\n      // We do impose a minimum width:\n      overall_width = Math.max(_constants__WEBPACK_IMPORTED_MODULE_1__.MINIMUM_TREE_WIDTH, overall_width + 10);\n      this.tree_panel.css('width', \"\".concat(overall_width, \"px\"));\n    }\n  }, {\n    key: \"calculate_node_positions\",\n    value:\n    // This calculates the actual X coordinate for each node. We do this by\n    // tracking the current X position and incrementing this as needed.\n    function calculate_node_positions() {\n      var _x = 0;\n      var max_x = 0;\n      var previous;\n\n      // Function that loops over every node, starting at the root node and traverses depth-first.\n      function doForNode(node) {\n        var dataNode = node.data;\n        dataNode.parent = node.parent ? node.parent.data : null;\n        dataNode.d3Parent = node.parent;\n        if (node.parent) {\n          if (dataNode.is_group()) {\n            _x += _constants__WEBPACK_IMPORTED_MODULE_1__.NODE.big_vertical_spacing;\n          } else if (previous && previous.is_group()) {\n            _x += _constants__WEBPACK_IMPORTED_MODULE_1__.NODE.big_vertical_spacing;\n          } else {\n            _x += _constants__WEBPACK_IMPORTED_MODULE_1__.NODE.vertical_spacing;\n          }\n        }\n        dataNode.indent = Math.floor(node.y / _constants__WEBPACK_IMPORTED_MODULE_1__.INDENT);\n        if (node.parent === null && dataNode.start_position === null) {\n          dataNode.start_position = new _Coordinate__WEBPACK_IMPORTED_MODULE_0__[\"default\"](node.x, node.y);\n        }\n\n        // Set the node's new position.\n        node.x = dataNode.x = _x;\n        // d.y gets managed by D3; so that's fine as is, but we need to copy it to the datanode.\n        dataNode.y = node.y;\n        if (node.parent === null && dataNode.start_position === null) {\n          dataNode.start_position = new _Coordinate__WEBPACK_IMPORTED_MODULE_0__[\"default\"](node.x, node.y);\n        }\n\n        // This will be the position for the next node.\n        _x = node.x + _constants__WEBPACK_IMPORTED_MODULE_1__.NODE.height;\n\n        // We need to track the max height so we can grow the container as\n        // needed.\n        if (_x > max_x) max_x = _x;\n        if (!dataNode.position) dataNode.position = new _Coordinate__WEBPACK_IMPORTED_MODULE_0__[\"default\"]();\n        dataNode.position.x = node.x;\n        dataNode.position.y = node.y;\n        previous = dataNode;\n        if (node.children) {\n          node.children.forEach(function (child) {\n            doForNode(child, _x);\n          });\n        }\n      }\n      doForNode(this.d3_tree);\n\n      // We ensure that the tree view is large enough to hold the nodes:\n      this.event_tree.style('height', function () {\n        return \"\".concat(max_x + 30, \"px\");\n      });\n    }\n  }, {\n    key: \"setup_scrolling\",\n    value: function setup_scrolling() {\n      var tree = this;\n      this.scrolling_panel.on('scroll resize', function (e) {\n        tree.update_for_scrolling(e);\n      });\n\n      // This thing is needed by Safari to handle a weird issue. Put briefly:\n      // swiping the touchpad makes the sticky nodes wiggle about, whereas using\n      // the scrollbar does not. I found a similar issue here:\n      // http://stackoverflow.com/questions/27041685/\n      //   dom-element-position-slow-while-scrolling-difference-between-scrollbar-scrolli\n      // The solution (as I described on stackoverflow as well) is to handle the\n      // mousewheel event and to calculate the scroll values ourselves.\n      this.scrolling_panel.on('mousewheel', function (e) {\n        e.preventDefault();\n\n        // Vertical scrolling is handled by the individual tree:\n        var maxY = this.scrollHeight - this.offsetHeight;\n        this.scrollTop = Math.max(0, Math.min(maxY, this.scrollTop - e.originalEvent.wheelDeltaY));\n\n        // Horizontal scrolling is handled by the forest:\n        var forest_panel = tree.forest.panel.get(0);\n        var maxX = forest_panel.scrollWidth - forest_panel.offsetWidth;\n        forest_panel.scrollLeft = Math.max(0, Math.min(maxX, forest_panel.scrollLeft - e.originalEvent.wheelDeltaX));\n        tree.update_for_scrolling(e);\n      });\n    }\n  }, {\n    key: \"update_for_scrolling\",\n    value: function update_for_scrolling() {\n      this.adjust_node_positions_for_scrolling();\n\n      // TODO Can we merge the following D3 updates with the default rendering ?\n\n      // Update all nodes to match the new positions. And re-evaluate their\n      // insertion order, as some events may have become sticky.\n      this.event_tree.selectAll('div.tree-event').attr('class', _event_treeview__WEBPACK_IMPORTED_MODULE_3__.classes_for_node).style('top', function (d) {\n        return \"\".concat(d.x, \"px\");\n      }).style('opacity', function (d) {\n        return d.opacity;\n      }).sort(_event_treeview__WEBPACK_IMPORTED_MODULE_3__.compare_for_layering);\n\n      // Update all links to match the new positions.\n      this.svg.selectAll('path.link').attr('d', function (link) {\n        return (0,_event_treeview__WEBPACK_IMPORTED_MODULE_3__.svg_path_for_link)({\n          source: link.source.data,\n          target: link.target.data\n        });\n      });\n    }\n  }, {\n    key: \"should_remain_visible_while_scrolling\",\n    value:\n    // Whether or not a node should remain visible while scrolling. This will\n    // also make it sticky. But it should disallow it from getting hidden under\n    // its parent node.\n    function should_remain_visible_while_scrolling(event) {\n      function it_should_remain_visible(e) {\n        return e.selected;\n      }\n      if (it_should_remain_visible(event)) return true;\n\n      // TODO Memoization to reduce runtime cost.\n\n      for (var i = event.d3_index + 1; i < this.d3_nodes.length; i++) {\n        var e = this.d3_nodes[i];\n        if (e.indent <= event.indent) return false;\n        if (it_should_remain_visible(e)) return true;\n      }\n      return false;\n    }\n  }, {\n    key: \"should_be_stickied_while_scrolling\",\n    value:\n    // Whether or not an event should be \"stickied\" during scrolling. Whether or\n    // not it will actually get stickied depends on its position, the current\n    // scroll offset, and the available space.\n    function should_be_stickied_while_scrolling(event) {\n      return event.is_group() || this.should_remain_visible_while_scrolling(event);\n    }\n  }, {\n    key: \"decide_whether_to_compact_subtree\",\n    value:\n    // --------------------------------------------------------------------------\n    // Tree compaction\n\n    // We need to decide whether or not this tree should try compact itself\n    // when drawn. This means that if a subtree does not fit the available\n    // vertical space it should try to collapse events to make up for that.\n    function decide_whether_to_compact_subtree() {\n      var available_height = this.scrolling_panel.height();\n      if (!available_height) {\n        this.compact = true;\n        return;\n      }\n      var padding_bottom = this.scrolling_panel.css('padding-bottom');\n      if (padding_bottom) available_height += parseInt(padding_bottom, 10);\n      var needed_height = (0,_event_treeview__WEBPACK_IMPORTED_MODULE_3__.required_height_for_subtree)(this.root.record, this.forest.model);\n      this.root.compact = needed_height > available_height;\n    }\n  }, {\n    key: \"adjust_node_positions_for_scrolling\",\n    value:\n    // This combines the calculated node positions with the scroll offset, and\n    // repositions nodes so that groups remain visible as much as possible.\n    function adjust_node_positions_for_scrolling(scroll_top) {\n      // The adjustment can be triggered as part of an overall calculation, in\n      // which case the scrollTop will be provided to us. Or it can be triggered\n      // by actual scrolling events, in which case we need to ask for the\n      // scrollTop value ourselves.\n      if (!scroll_top) scroll_top = this.scrolling_panel.scrollTop();\n      var event;\n      var i;\n      // The easiest thing to do is to not scroll at all.\n      if (!scroll_top) {\n        for (i = 0; i < this.d3_nodes.length; i++) {\n          event = this.d3_nodes[i];\n          event.x = event.position.x;\n          event.is_sticky = false;\n          event.opacity = 1;\n        }\n        return;\n      }\n\n      // But on to the hard part...\n      //\n      // The way the algorithm works is by scrolling up individual nodes until we\n      // have spent our scrolling \"budget\". The initial budget we have is that\n      // which matches the position of the scrollbars (= scroll_top).\n      var scroll_budget = scroll_top;\n\n      // We count the combined scroll we have applied at any given step, so that\n      // we can build it up.\n      var scroll_applied = 0;\n      // And we need to know when the fixed nodes have taken up all available\n      // space, in which case we'll push them up anyway to make more space.\n      var bottom_edge = 0;\n      // How much space do we have available for fixed nodes ? Well, exactly as\n      // much as the height of the panel.\n      var available_height = this.scrolling_panel.height();\n\n      // The algorithm is iterative, and needs to know about the current node, the\n      // previous node and the previous sticky node.\n      var previous_node = null;\n\n      // Stickiness is somewhat ambiguous. A sticky node may still get pushed up\n      // by nodes which are at a lower indentation level. Or, as explained by\n      // Eddy: \"subgroups zouden enkel stickcy moeten zijn tijdens het scrollen\n      // door de eigen branch, anders moeten ze mee verdwijnen\". So we need to\n      // keep track of sticky nodes per indentation level. Which is why we\n      // maintain following stack:\n      var sticky_nodes_per_level = [];\n      // Each element in the stack is the last sticky node for the corresponding\n      // indentation level.\n\n      // This sets a sticky node for its level. And clears all sticky nodes\n      // below that level.\n      function track_sticky_node(node) {\n        var level = event.indent;\n        while (sticky_nodes_per_level.length > level + 1) {\n          sticky_nodes_per_level.pop();\n        }\n        while (level >= sticky_nodes_per_level.length) {\n          sticky_nodes_per_level.push(null);\n        }\n        sticky_nodes_per_level[level] = node;\n      }\n\n      // This gets the sticky node at a given level.\n      function get_last_sticky_node(level) {\n        if ((0,_event_treeview__WEBPACK_IMPORTED_MODULE_3__.is_undefined)(level) || level === null) {\n          level = sticky_nodes_per_level.length - 1;\n        }\n        if (level < 0) return null;\n        if (level >= sticky_nodes_per_level.length) {\n          level = sticky_nodes_per_level.length - 1;\n        }\n        do {\n          var sticky_node_at_level = sticky_nodes_per_level[level];\n          if (sticky_node_at_level) return sticky_node_at_level;\n        } while (--level >= 0);\n        return null;\n      }\n\n      // At times we may have to shift up part of the tree we have already\n      // covered before. This function takes care of that.\n      //\n      // There is some prioritization we need to apply to this shifting:\n      // the deepest levels should shift upwards first. Put differently,\n      // children should shift up before we shift their parent nodes.\n      //\n      //\n      // [DEBUGGING TIPS]\n      //\n      // If you have to change this code, and it's not doing what you expect it\n      // to, here are some debugging tips:\n      // * Visualize the value for 'bottom_edge' by adding a line (hr, or 1px\n      //   high div) and positioning it at that value (beware of padding and\n      //   margins when doing so). It should always appear at the bottom of the\n      //   lowest sticky node. If it doesn't you're mismanaging the budget.\n      // * Don't write to console, as you'll quickly get lost in the amount of\n      //   data you'll get. Finding the start and end of things is also tricky.\n      //   What helped me was to set up an extra div on top op everything which\n      //   gets cleared on the start of the method, and then collects all info\n      //   you need (by appending text elements). This way you can more easily\n      //   see values change as you scroll, which helps you pinpoint the moment\n      //   something goes wrong.\n      var shift_up = function (shifting_budget, event, lower_level) {\n        var upper_level = get_last_sticky_node().indent;\n        for (var level = upper_level; level > lower_level; level--) {\n          var node_to_start_after = get_last_sticky_node(level - 1);\n          var start_index = node_to_start_after.d3_index + 1;\n          var shifting_applied = 0;\n          for (var _i = start_index; _i < event.d3_index; _i++) {\n            var e = this.d3_nodes[_i];\n            var p = this.d3_nodes[_i - 1];\n            var available_shifting_amount = void 0;\n            if (this.should_remain_visible_while_scrolling(e)) {\n              available_shifting_amount = e.x - p.x - _constants__WEBPACK_IMPORTED_MODULE_1__.NODE.height - _constants__WEBPACK_IMPORTED_MODULE_1__.NODE.big_vertical_spacing;\n              available_shifting_amount = Math.max(available_shifting_amount, 0);\n            } else {\n              available_shifting_amount = e.x - p.x;\n            }\n            available_shifting_amount = Math.min(shifting_budget, available_shifting_amount);\n            shifting_applied = Math.max(shifting_applied, available_shifting_amount);\n            e.x -= available_shifting_amount;\n            if (e.opacity > 0) {\n              e.opacity = Math.min((e.x - p.x) / _constants__WEBPACK_IMPORTED_MODULE_1__.NODE.height, 1.0);\n            }\n          }\n          shifting_budget -= shifting_applied;\n          if (shifting_budget <= 0) break;\n        }\n\n        // As we may have shifted up some sticky nodes, we need to redefine the\n        // bottom edge.\n        bottom_edge = get_last_sticky_node().x + _constants__WEBPACK_IMPORTED_MODULE_1__.NODE.height;\n      }.bind(this);\n      for (var index = 0; index < this.d3_nodes.length; index++) {\n        // So we want to apply scroll on this event:\n        event = this.d3_nodes[index];\n\n        // If we have gone past our scroll budget we just move the event by the\n        // overall scroll amount. And then we're done with that event.\n        if (scroll_budget < 0) {\n          event.x = event.position.x;\n          event.is_sticky = false;\n          event.opacity = 1;\n          continue;\n        }\n\n        // If we still need to scroll but have already filled the available space\n        // with sticky nodes, then we need to move the sticky nodes up to free up\n        // extra space.\n        var over_the_edge = scroll_budget > 0 && bottom_edge > available_height;\n        var correction = void 0;\n        if (over_the_edge) {\n          // We want to track the amount of shift.\n          var x_before = get_last_sticky_node().x;\n\n          // This is the amount by which to push up the sticky nodes:\n          correction = Math.min(bottom_edge - available_height, scroll_budget);\n\n          // We ask to shift everything we have seen so far up by that amount.\n          // TODO In case there is a deep tree, and the path can't fit in within\n          // the available height, this causes weird scrolling.\n          shift_up(correction, event, 0);\n\n          // So how much did we shift ?\n          var x_after = get_last_sticky_node().x;\n          var shifted_by = x_before - x_after;\n\n          // Add that to the bookkeeping.\n          scroll_applied += shifted_by;\n          scroll_budget -= shifted_by;\n        }\n\n        // It may be that we could not shift the sticky nodes up (enough). In\n        // which case we must shift up of everything instead.\n        over_the_edge = scroll_budget > 0 && bottom_edge > available_height;\n        if (over_the_edge) {\n          // This is the amount by which to push up:\n          correction = Math.min(bottom_edge - available_height, scroll_budget);\n\n          // And this applies it to everything we've seen so far.\n          for (i = 0; i < event.d3_index; i++) {\n            this.d3_nodes[i].x -= correction;\n          }\n\n          // Having scrolled, we need to update out budget and overall count.\n          scroll_applied += correction;\n          scroll_budget -= correction;\n        }\n\n        // This is the node the current node can't move beyond.\n        var limiting_sticky_node = get_last_sticky_node(event.indent);\n\n        // When scrolling we also need to take the required space between the\n        // current node and the limiting one into account.\n        var space_between_nodes = void 0;\n        var available_scroll_amount = void 0;\n        if (limiting_sticky_node === null) space_between_nodes = 0;\n        if (event.is_group() || limiting_sticky_node.is_group()) {\n          space_between_nodes = _constants__WEBPACK_IMPORTED_MODULE_1__.NODE.big_vertical_spacing;\n        } else {\n          space_between_nodes = _constants__WEBPACK_IMPORTED_MODULE_1__.NODE.vertical_spacing;\n        }\n        if (previous_node === null) {\n          // The first node of any tree will always get stickied.\n\n          event.x = event.position.x;\n          event.is_sticky = true;\n          event.opacity = 1;\n        } else if (this.should_be_stickied_while_scrolling(event) && event.position.x - scroll_applied <= bottom_edge + space_between_nodes) {\n          // We have a node which has crossed the current bottom edge of sticky\n          // nodes, but which shouldn't. So it should either become sticky, or\n          // some of the existing sticky nodes will have to shift to make room.\n\n          // This is the bottom sticky node; i.e. the one defining the botttom\n          // edge.\n          var last_sticky_node = get_last_sticky_node();\n          if (limiting_sticky_node !== last_sticky_node) {\n            // So we have some sticky nodes which can be made to shift upwards.\n            shift_up(scroll_budget, event, event.indent);\n\n            // And now we can handle the actual node.\n            available_scroll_amount = Math.min(scroll_budget, event.position.x - scroll_applied - last_sticky_node.x - _constants__WEBPACK_IMPORTED_MODULE_1__.NODE.height - space_between_nodes);\n            scroll_applied += available_scroll_amount;\n            scroll_budget -= available_scroll_amount;\n            event.x = event.position.x - scroll_applied;\n            event.is_sticky = scroll_budget > 0;\n            event.opacity = Math.min((event.x - last_sticky_node.x) / _constants__WEBPACK_IMPORTED_MODULE_1__.NODE.height, 1.0);\n          } else {\n            // There is nothing we can shift up. So we make the current node\n            // sticky.\n            event.x = limiting_sticky_node.x + _constants__WEBPACK_IMPORTED_MODULE_1__.NODE.height + space_between_nodes;\n            event.is_sticky = true;\n            event.opacity = 1;\n          }\n        } else {\n          // In all other cases we can move the node upwards to match the scroll.\n          available_scroll_amount = Math.min(scroll_budget, event.position.x - previous_node.position.x);\n          scroll_applied += available_scroll_amount;\n          scroll_budget -= available_scroll_amount;\n          event.x = event.position.x - scroll_applied;\n          event.is_sticky = false;\n          event.opacity = Math.min((event.x - get_last_sticky_node().x) / _constants__WEBPACK_IMPORTED_MODULE_1__.NODE.height, 1.0);\n        }\n\n        // We need to track the bottom edge of all sticky nodes, as well as the\n        // sticky nodes per indentation level...\n        if (event.is_sticky) {\n          bottom_edge = event.x + _constants__WEBPACK_IMPORTED_MODULE_1__.NODE.height;\n          track_sticky_node(event);\n        }\n        previous_node = event;\n      }\n\n      // Up to now we have actually been pushing nodes up, but they should really\n      // be moved down to the scroll position (beware of hurting your gray mass\n      // trying to think that one out). So we now apply the final repositioning.\n      for (i = 0; i < this.d3_nodes.length; i++) {\n        this.d3_nodes[i].x += scroll_top;\n      }\n    }\n  }, {\n    key: \"log\",\n    value:\n    // Useful for debugging:\n    function log() {\n      this.root.log('');\n    }\n  }]);\n  return Tree;\n}();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9UcmVldmlldy9UcmVlLmpzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQWNBO0FBQ0E7QUFBQTtBQUlBO0FBQUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUtBO0FBQ0E7QUFDQTtBQUlBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBTUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7O0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFJQTtBQUNBO0FBQ0E7O0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFNQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTs7QUFFQTtBQUFBOztBQUdBO0FBQ0E7QUFLQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQU1BO0FBQ0E7O0FBS0E7QUFDQTs7QUFFQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBS0E7QUFDQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQU1BO0FBQ0E7O0FBRUE7QUFDQTs7QUFJQTtBQUNBO0FBQUE7QUFBQTs7QUFFQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFLQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFPQTtBQUNBOztBQU1BO0FBQ0E7QUFJQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBRUE7O0FBRUE7O0FBRUE7QUFDQTtBQUlBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFFQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBRUE7QUFDQTs7QUFHQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFHQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFJQTtBQUtBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBS0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFLQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUlBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQVNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUtBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFJQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUEiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9SZWFjdENvbXBvbmVudHNfLy4vVHJlZXZpZXcvVHJlZS5qcz9iMzg1Il0sInNvdXJjZXNDb250ZW50IjpbIi8qIGVzbGludC1kaXNhYmxlIGNhbWVsY2FzZSwgZnVuYy1uYW1lcyAqL1xuaW1wb3J0IFhZIGZyb20gJy4vQ29vcmRpbmF0ZSc7XG5pbXBvcnQge0RVUkFUSU9OLCBJTkRFTlQsIE1JTklNVU1fVFJFRV9XSURUSCwgTk9ERX0gZnJvbSAnLi9jb25zdGFudHMnO1xuaW1wb3J0IFBsYWNlaG9sZGVyTm9kZSBmcm9tICcuL1BsYWNlaG9sZGVyTm9kZSc7XG5pbXBvcnQge1xuICBjbGFzc2VzX2Zvcl9ub2RlLFxuICBjb21wYXJlX2Zvcl9sYXllcmluZyxcbiAgZGF0ZV9mb3JfcmVjb3JkLFxuICBnZXRfbm9kZV9uYW1lLCBpc191bmRlZmluZWQsIG5vZGVfaGFzX2FjdHVhbF9sb2NrLCBub2RlX2hhc19sb2NrLFxuICBub2RlX2lzX2RhdGVkLFxuICBub2RlX2lzX2dyb3VwLFxuICBub2RlX2lzX3Byb2R1Y3Rpb24sXG4gIG5vZGVfa2V5LCBub2RlX3RpdGxlc3RyaW5nLFxuICByZWNvcmRfY2FuX2JlX3dyaXR0ZW4sXG4gIHJlY29yZF9pZCxcbiAgcmVjb3JkX2lzX2dyb3VwLCByZXF1aXJlZF9oZWlnaHRfZm9yX3N1YnRyZWUsIHN2Z19wYXRoX2Zvcl9saW5rLFxuICBoYXNfbm9kZXNfd2l0aF9jb25mbGljdHNcbn0gZnJvbSAnLi9ldmVudC10cmVldmlldyc7XG5pbXBvcnQgRGF0ZUZvcm1hdFNldHRpbmdzIGZyb20gJy4vRGF0ZUZvcm1hdFNldHRpbmdzJztcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcblxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBUcmVlIHtcbiAgY29uc3RydWN0b3IoZm9yZXN0LCByb290KSB7XG4gICAgdGhpcy5mb3Jlc3QgPSBmb3Jlc3Q7XG4gICAgdGhpcy5yb290ID0gcm9vdDtcblxuICAgIHRoaXMuc2Nyb2xsaW5nX3BhbmVsID0gJCgnPGRpdj4nKS5hZGRDbGFzcygnc2Nyb2xsaW5nLWV2ZW50LXRyZWUnKTtcbiAgICB0aGlzLmZvcmVzdC5wYW5lbC5hcHBlbmQodGhpcy5zY3JvbGxpbmdfcGFuZWwpO1xuXG4gICAgdGhpcy50cmVlX3BhbmVsID0gJCgnPGRpdj4nKTtcbiAgICB0aGlzLnNjcm9sbGluZ19wYW5lbC5hcHBlbmQodGhpcy50cmVlX3BhbmVsKTtcblxuICAgIHRoaXMuZGVjaWRlX3doZXRoZXJfdG9fY29tcGFjdF9zdWJ0cmVlKCk7XG5cbiAgICAvLyBUaGUgcm9vdCBpcyBhbHdheXMgZXhwYW5kZWQuXG4gICAgdGhpcy5yb290LmNvbGxhcHNlZCA9IGZhbHNlO1xuXG4gICAgLy8gRm9yIHRocm90dGxpbmcgcmVuZGVyaW5nIG9mIHRoaXMgdHJlZTpcbiAgICB0aGlzLm5leHRfc2NoZWR1bGVkX3VwZGF0ZSA9IG51bGw7XG5cbiAgICAvLyBUcmFja2luZyBEMyBlbGVtZW50czpcbiAgICB0aGlzLmQzX3RyZWUgPSBudWxsO1xuICAgIHRoaXMuZDNfbm9kZXMgPSBudWxsO1xuICAgIHRoaXMuZDNfbGlua3MgPSBudWxsO1xuICAgIHRoaXMuZXZlbnRfdHJlZSA9IG51bGw7XG4gICAgdGhpcy5zdmcgPSBudWxsO1xuXG4gICAgLy8gU2V0IGl0IGFsbCB1cDpcbiAgICB0aGlzLmluaXRpYWxpemVfZDMoKTtcbiAgICB0aGlzLnNldHVwX3Njcm9sbGluZygpO1xuICB9XG5cbiAgLy8gRGVzdHJveSB0aGUgdHJlZSB2aWV3LlxuICBkaXNwb3NlKCkge1xuICAgIHRoaXMuc2Nyb2xsaW5nX3BhbmVsLnJlbW92ZSgpO1xuICAgIHRoaXMuc2Nyb2xsaW5nX3BhbmVsID0gbnVsbDtcbiAgfTtcblxuICAvLyBUaGlzIHNldHMgdXAgdGhlIG5lY2Vzc2FyeSBzdXBwb3J0IGZvciB0aGUgRDMgdHJlZS5cbiAgaW5pdGlhbGl6ZV9kMygpIHtcbiAgICAvLyBUaGUgRDMgdHJlZTpcbiAgICAvLyBCZWNhdXNlIHRoZSBkZWZhdWx0IGxheW91dCBpcyBub3Qgd2hhdCB3ZSB3YW50LCB3ZSB3aWxsIGJlIG1hbmFnaW5nXG4gICAgLy8gdGhlIFggY29vcmRpbmF0ZXMgb3Vyc2VsdmVzLCB3aGljaCBpcyB3aHkgd2Ugc2V0IHRoZSBub2RlIHNpemUnc1xuICAgIC8vIGhlaWdodCB0byB6ZXJvLlxuICAgIHRoaXMuZDNUcmVlRnVuY3Rpb24gPSBkMy50cmVlKCkubm9kZVNpemUoWzAsIElOREVOVF0pO1xuICAgIGNvbnN0IGQzUm9vdCA9IGQzLmhpZXJhcmNoeSh0aGlzLnJvb3QsIGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgIC8vIElmIHRoZSBub2RlIGlzIGNvbGxhcHNlZCB0aGVuIHdlIGRvbid0IHRlbGwgRDMgYWJvdXQgaXRzIGNoaWxkcmVuLlxuICAgICAgaWYgKG5vZGUuY29sbGFwc2VkKSByZXR1cm4gbnVsbDtcbiAgICAgIC8vIFBsYWNlaG9sZGVycyBoYXZlIG5vIGNoaWxkcmVuLlxuICAgICAgaWYgKG5vZGUgaW5zdGFuY2VvZiBQbGFjZWhvbGRlck5vZGUpIHJldHVybiBudWxsO1xuICAgICAgLy8gSWYgdGhlIHN1Ym5vZGVzIGhhdmUgYWxyZWFkeSBiZWVuIGRlZmluZWQgd2UgcmV0dXJuIHRoZW0uXG4gICAgICBpZiAobm9kZS5zdWJub2RlcyAhPT0gbnVsbCkgcmV0dXJuIG5vZGUuc3Vibm9kZXM7XG4gICAgICAvLyBJZiB0aGUgcmVjb3JkIGRlZmluZXMgbm8gY2hpbGRyZW4sIHRoZW4gd2UgZG9uJ3QgcmV0dXJuIGFueS5cbiAgICAgIGlmICghcmVjb3JkX2lzX2dyb3VwKG5vZGUucmVjb3JkKSkgcmV0dXJuIG51bGw7XG4gICAgICAvLyBPdGhlcndpc2Ugd2UgY3JlYXRlIHRoZW0gYmVmb3JlIHJldHVybmluZyB0aGVtLlxuICAgICAgbm9kZS5zdWJub2RlcyA9IFtdO1xuICAgICAgbm9kZS5yZWJ1aWxkX3N1Ym5vZGVzKCk7XG4gICAgICByZXR1cm4gbm9kZS5zdWJub2RlcztcbiAgICB9KTtcbiAgICB0aGlzLmQzX3RyZWUgPSB0aGlzLmQzVHJlZUZ1bmN0aW9uKGQzUm9vdCk7XG5cbiAgICAvLyBUaGUgdHJlZSB3aWxsIGJlIGhvdXNlZCBpbnNpZGUgYSBESVYuIFRoaXMgRElWIHNldHMgdXAgYSBwb3NpdGlvbmluZ1xuICAgIC8vIGNvbnRleHQgYWdhaW5zdCByZWxhdGl2ZSB0byB3aGljaCBhbGwgZXZlbnRzIHdpbGwgYmUgcGxhY2VkLlxuICAgIHRoaXMuZXZlbnRfdHJlZSA9IGQzXG4gICAgICAuc2VsZWN0KHRoaXMudHJlZV9wYW5lbC5nZXQoMCkpXG4gICAgICAuc3R5bGUoJ3Bvc2l0aW9uJywgJ3JlbGF0aXZlJylcbiAgICAgIC5zdHlsZSgnd2lkdGgnLCAnMTBweCcpO1xuXG4gICAgLy8gVGhlIGNvbm5lY3RpbmcgbGluZXMgd2lsbCBiZSBkcmF3biB1c2luZyBTVkcuIFNvIHdlIGFkZCBhbiBTVkdcbiAgICAvLyBjb250YWluZXIgd2hpY2ggdGFrZXMgdXAgdGhlIHNhbWUgc3BhY2UgYXMgdGhlIERJVi5cbiAgICB0aGlzLnN2ZyA9IHRoaXMuZXZlbnRfdHJlZVxuICAgICAgLmFwcGVuZCgnc3ZnJylcbiAgICAgIC5hdHRyKCd3aWR0aCcsICcxMDAlJylcbiAgICAgIC5hdHRyKCdoZWlnaHQnLCAnMTAwJScpO1xuICB9O1xuXG4gIC8vIFdlIHdhbnQgdG8gYmUgYWJsZSB0byB0aHJvdHRsZSB0aGUgVUkgdXBkYXRlIHNvIHRoYXQgaXQgZG9lcyBub3Rcbi8vIHRyaWdnZXIgb24gZXZlcnkgbWlub3IgY2hhbmdlIHRvIHRoZSBtb2RlbCwgb2Ygd2hpY2ggdGhlcmUgbWF5IGJlIG1hbnlcbi8vIGluIGEgc2hvcnQgdGltZS4gU28gaW5zdGVhZCB3ZSBzY2hlZHVsZSBhbiB1cGRhdGUsIGFuZCB3ZSByZXNjaGVkdWxlXG4vLyB1bnRpbCB0aGVyZSBhcmUgbm8gbW9yZSBjaGFuZ2VzIGJlaW5nIHJlcG9ydGVkIHdpdGhpbiBhIGNlcnRhaW4gdGltZVxuLy8gaW50ZXJ2YWwuXG4vL1xuLy8gSW4gYWRkaXRpb24gd2UgcmV0dXJuIGEgcHJvbWlzZSBmb3IgdGhlIHVwZGF0ZSBzbyB0aGF0IG90aGVyIGNvZGUgY2FuXG4vLyBjaGFpbiBvbiB0byBpdCBmb3IgdGhpbmdzIHdoaWNoIGhhdmUgdG8gYXdhaXQgdGhlIHVwZGF0ZWQgdHJlZS4gKEUuZy5cbi8vIHNjcm9sbGluZyB0byBhIGNlcnRhaW4gbm9kZS4pXG4gIHJlcXVlc3RfdXBkYXRlX3Byb21pc2UoKSB7XG4gICAgaWYgKHRoaXMubmV4dF9zY2hlZHVsZWRfdXBkYXRlICE9PSBudWxsKSB7XG4gICAgICBjbGVhclRpbWVvdXQodGhpcy5uZXh0X3NjaGVkdWxlZF91cGRhdGUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLmRlZmVycmVkX3VwZGF0ZSA9IG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgdGhpcy5yZXNvbHZlX2RlZmVycmVkX3VwZGF0ZSA9IHJlc29sdmVcbiAgICAgIH0pXG4gICAgfVxuICAgIHRoaXMubmV4dF9zY2hlZHVsZWRfdXBkYXRlID0gc2V0VGltZW91dChcbiAgICAgIGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLm5leHRfc2NoZWR1bGVkX3VwZGF0ZSA9IG51bGw7XG5cbiAgICAgICAgdGhpcy51cGRhdGVfbm93KCk7XG5cbiAgICAgICAgdGhpcy5yZXNvbHZlX2RlZmVycmVkX3VwZGF0ZSgpO1xuICAgICAgICB0aGlzLmRlZmVycmVkX3VwZGF0ZSA9IG51bGw7XG4gICAgICB9LmJpbmQodGhpcyksXG4gICAgICAxMDBcbiAgICApO1xuXG5cblxuICAgIHJldHVybiB0aGlzLmRlZmVycmVkX3VwZGF0ZTtcbiAgfTtcblxuICByZXF1ZXN0X3VwZGF0ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5yZXF1ZXN0X3VwZGF0ZV9wcm9taXNlKCk7XG4gIH07XG5cbi8vIEZvbGxvd2luZyBmdW5jdGlvbiBjcmVhdGVzL3VwZGF0ZXMgdGhlIGV2ZW50IHRyZWUuXG4vLyBUaGUgc291cmNlIGlzIHRoZSBldmVudCB3aGljaCB0cmlnZ2VyZWQgdGhlIHVwZGF0ZS5cbiAgdXBkYXRlX25vdygpIHtcbiAgICAvLyBDaGVjayBpZiB0aGlzIHRyZWUgaGFzIGJlZW4gZGlzcG9zZWQgb2YgaW4gdGhlIG1lYW50aW1lLi4uXG4gICAgaWYgKHRoaXMuc2Nyb2xsaW5nX3BhbmVsID09PSBudWxsKSByZXR1cm47XG5cbiAgICAvLyB0aGlzLmxvZygpXG5cbiAgICAvLyBSZXRyaWV2ZSB0aGUgZmxhdHRlbmVkIG5vZGUgbGlzdDpcbiAgICBjb25zdCBkM1Jvb3QgPSBkMy5oaWVyYXJjaHkodGhpcy5yb290LCBmdW5jdGlvbihub2RlKSB7XG4gICAgICAvLyBJZiB0aGUgbm9kZSBpcyBjb2xsYXBzZWQgdGhlbiB3ZSBkb24ndCB0ZWxsIEQzIGFib3V0IGl0cyBjaGlsZHJlbi5cbiAgICAgIGlmIChub2RlLmNvbGxhcHNlZCkgcmV0dXJuIG51bGw7XG4gICAgICAvLyBQbGFjZWhvbGRlcnMgaGF2ZSBubyBjaGlsZHJlbi5cbiAgICAgIGlmIChub2RlIGluc3RhbmNlb2YgUGxhY2Vob2xkZXJOb2RlKSByZXR1cm4gbnVsbDtcbiAgICAgIC8vIElmIHRoZSBub2RlIHN0aWxsIGV4aXN0cyAobm90IGRlbGV0ZWQpIGFuZCB0aGUgc3Vibm9kZXMgaGF2ZSBhbHJlYWR5IGJlZW4gZGVmaW5lZCB3ZSByZXR1cm4gdGhlbS5cbiAgICAgIGlmIChub2RlLmZvcmVzdC5tb2RlbC5nZXQocmVjb3JkX2lkKG5vZGUucmVjb3JkKSwgZmFsc2UpICYmIG5vZGUuc3Vibm9kZXMgIT09IG51bGwpIHtcbiAgICAgICAgcmV0dXJuIG5vZGUuc3Vibm9kZXM7XG4gICAgICB9XG4gICAgICAvLyBJZiB0aGUgcmVjb3JkIGRlZmluZXMgbm8gY2hpbGRyZW4sIHRoZW4gd2UgZG9uJ3QgcmV0dXJuIGFueS5cbiAgICAgIGlmICghcmVjb3JkX2lzX2dyb3VwKG5vZGUucmVjb3JkKSkgcmV0dXJuIG51bGw7XG4gICAgICAvLyBPdGhlcndpc2Ugd2UgY3JlYXRlIHRoZW0gYmVmb3JlIHJldHVybmluZyB0aGVtLlxuICAgICAgbm9kZS5zdWJub2RlcyA9IFtdO1xuICAgICAgbm9kZS5yZWJ1aWxkX3N1Ym5vZGVzKCk7XG4gICAgICByZXR1cm4gbm9kZS5zdWJub2RlcztcbiAgICB9KTtcbiAgICB0aGlzLmQzX3RyZWUgPSB0aGlzLmQzVHJlZUZ1bmN0aW9uKGQzUm9vdCk7XG4gICAgdGhpcy5kM19ub2RlcyA9IFtdO1xuXG4gICAgdGhpcy5kM190cmVlLmVhY2hCZWZvcmUoZnVuY3Rpb24obikge1xuICAgICAgdGhpcy5kM19ub2Rlcy5wdXNoKG4uZGF0YSk7XG4gICAgfS5iaW5kKHRoaXMpKTtcblxuICAgIGxldCBpO1xuICAgIC8vIEtlZXAgdHJhY2sgb2YgdGhlIHJldmVyc2UgbWFwcGluZy4gVGhpcyBoZWxwcyB0aGUgc2Nyb2xsaW5nXG4gICAgLy8gY2FsY3VsYXRpb25zLlxuICAgIGZvciAoaSA9IDA7IGkgPCB0aGlzLmQzX25vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB0aGlzLmQzX25vZGVzW2ldLmQzX2luZGV4ID0gaTtcbiAgICB9XG5cbiAgICAvLyBXZSB0aGVuIGZpZ3VyZSBvdXQgd2hlcmUgdGhlIG5vZGVzIG11c3QgZ28uIFRoaXMgd2lsbCBhbHNvIGdyb3cgdGhlXG4gICAgLy8gY29udGFpbmVyIHNvIHRoZSBub2RlcyBjYW4gZml0LlxuICAgIC8vIEV4dHJhIGNvbXBsaWNhdGlvbjogaWYgdGhlIHRyZWUgd2FzIHNjcm9sbGVkIHdlIG5lZWQgdG8gbWFpbnRhaW4gdGhlXG4gICAgLy8gc2Nyb2xsIHBvc2l0aW9uIGFzIHdlbGwuXG4gICAgY29uc3Qgc2Nyb2xsX3RvcCA9IHRoaXMuc2Nyb2xsaW5nX3BhbmVsLnNjcm9sbFRvcCgpO1xuICAgIHRoaXMuY2FsY3VsYXRlX25vZGVfcG9zaXRpb25zKCk7XG4gICAgdGhpcy5hZGp1c3Rfbm9kZV9wb3NpdGlvbnNfZm9yX3Njcm9sbGluZyhzY3JvbGxfdG9wKTtcbiAgICB0aGlzLnNjcm9sbGluZ19wYW5lbC5zY3JvbGxUb3Aoc2Nyb2xsX3RvcCk7XG5cbiAgICAvLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi5cbiAgICAvLyBOb2RlIGNyZWF0aW9uL3VwZGF0ZVxuXG4gICAgLy8gRmlyc3Qgd2UgbWF0Y2ggdGhlIGV2ZW50IG5vZGVzIHdpdGggdGhlIGFjdHVhbCBldmVudHMsIHVzaW5nIHRoZVxuICAgIC8vIGV2ZW50IGtleSB0byBlbnN1cmUgYSBjb25zaXN0ZW50IG1hcHBpbmcuXG4gICAgbGV0IGFsbF9ldmVudF9ub2RlcyA9IHRoaXMuZXZlbnRfdHJlZVxuICAgICAgLnNlbGVjdEFsbCgnZGl2LnRyZWUtZXZlbnQnKVxuICAgICAgLmRhdGEodGhpcy5kM19ub2Rlcywgbm9kZV9rZXkpO1xuXG4gICAgLy8gRDMgRVhJVFxuICAgIC8vIEV4aXN0aW5nIG5vZGVzIG5lZWQgdG8gbW92ZSBhbmQgYmVjb21lIGhpZGRlbi5cbiAgICBhbGxfZXZlbnRfbm9kZXNcbiAgICAgIC5leGl0KClcbiAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgIC5kdXJhdGlvbihEVVJBVElPTilcbiAgICAgIC5zdHlsZSgnb3BhY2l0eScsIDAuMClcbiAgICAgIC5yZW1vdmUoKTtcblxuICAgIC8vIFRoZSBkYXRhIGZvciBleGl0aW5nIG5vZGVzIGdldHMgcmV0YWluZWQgYnkgdGhlIHRyZWUuIFdoZW4gdGhleVxuICAgIC8vIHNob3cgYWdhaW4gd2Ugd2FudCB0byBtYWtlIHN1cmUgdGhleSBhcmUgbm90IGdldHRpbmcgaGlnaGxpZ2h0ZWQgYXNcbiAgICAvLyBuZXdseSBjcmVhdGVkIG9uY2UgbW9yZS5cbiAgICBjb25zdCBleGl0aW5nX25vZGVzID0gYWxsX2V2ZW50X25vZGVzLmV4aXQoKS5kYXRhKCk7XG4gICAgZm9yIChpID0gMDsgaSA8IGV4aXRpbmdfbm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChleGl0aW5nX25vZGVzW2ldKSBleGl0aW5nX25vZGVzW2ldLmhpZ2hsaWdodF9hc19uZXcgPSBmYWxzZTtcbiAgICB9XG5cbiAgICAvLyBEMyBKT0lOOlxuICAgIC8vICAtIEQzIEVOVEVSIGZvciBuZXcgZXZlbnRzXG5cbiAgICAvLyBGb3IgYW55IG5ldyBldmVudHMgd2UgY2FuIG5vdyBjcmVhdGUgbm9kZXMuIFRoZXkgc3RhcnQgdGhlaXIgbGlmZVxuICAgIC8vIGluaXRpYWxseSBpbnZpc2libGUuIFdlIGFsc28gbWFrZSBzdXJlIHRoYXQgcGFyZW50IG5vZGVzIGFwcGVhciBvbiB0b3BcbiAgICAvLyBvZiBjaGlsZCBub2Rlcy5cbiAgICBjb25zdCBuZXdOb2RlcyA9IGFsbF9ldmVudF9ub2Rlcy5lbnRlcigpLmFwcGVuZCgnZGl2Jyk7XG4gICAgYWxsX2V2ZW50X25vZGVzID0gbmV3Tm9kZXNcbiAgICAgIC8vIFRoZSBub2RlIGlzIGRyYWdnYWJsZSBpZiBpdCBpcyB3cml0YWJsZSwgaWYgaXRzIHBhcmVudCBpcyB3cml0YWJsZSwgYW5kIGlmIGl0IGlzIG5vdCBhIHBsYWNlaG9sZGVyXG4gICAgICAuYXR0cignZHJhZ2dhYmxlJywgZnVuY3Rpb24oZCkge1xuICAgICAgICBjb25zdCBub2RlUGFyZW50ID0gZC5wYXJlbnQ7XG4gICAgICAgIGxldCBub2RlUGFyZW50Q2FuQmVXcml0dGVuO1xuICAgICAgICBpZiAobm9kZVBhcmVudCkge1xuICAgICAgICAgIG5vZGVQYXJlbnRDYW5CZVdyaXR0ZW4gPSByZWNvcmRfY2FuX2JlX3dyaXR0ZW4obm9kZVBhcmVudC5yZWNvcmQpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG5vZGVQYXJlbnRDYW5CZVdyaXR0ZW4gPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgIShkIGluc3RhbmNlb2YgUGxhY2Vob2xkZXJOb2RlKSAmJlxuICAgICAgICAgIHJlY29yZF9jYW5fYmVfd3JpdHRlbihkLnJlY29yZCkgJiZcbiAgICAgICAgICByZWNvcmRfY2FuX2JlX3dyaXR0ZW4oZC5yZWNvcmQpICYmXG4gICAgICAgICAgbm9kZVBhcmVudENhbkJlV3JpdHRlblxuICAgICAgICApO1xuICAgICAgfSlcbiAgICAgIC5zdHlsZSgncG9zaXRpb24nLCAnYWJzb2x1dGUnKVxuICAgICAgLnN0eWxlKCdsZWZ0JywgZnVuY3Rpb24oZCkge1xuICAgICAgICBpZiAoZC5zdGFydF9wb3NpdGlvbiAmJiBkLnN0YXJ0X3Bvc2l0aW9uICE9PSBudWxsKSB7XG4gICAgICAgICAgcmV0dXJuIGAke2Quc3RhcnRfcG9zaXRpb24ueX1weGA7XG4gICAgICAgIH0gZWxzZSBpZiAoZC5wYXJlbnQpIHtcbiAgICAgICAgICByZXR1cm4gYCR7ZC5wYXJlbnQueX1weGA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuICcwcHgnO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgLnN0eWxlKCd0b3AnLCBmdW5jdGlvbihkKSB7XG4gICAgICAgIGlmIChkLnN0YXJ0X3Bvc2l0aW9uICYmIGQuc3RhcnRfcG9zaXRpb24gIT09IG51bGwpIHtcbiAgICAgICAgICByZXR1cm4gYCR7ZC5zdGFydF9wb3NpdGlvbi54fXB4YDtcbiAgICAgICAgfSBlbHNlIGlmIChkLnBhcmVudCkge1xuICAgICAgICAgIHJldHVybiBgJHtkLnBhcmVudC54fXB4YDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gJzBweCc7XG4gICAgICAgIH1cbiAgICAgIH0pXG4gICAgICAuc3R5bGUoJ29wYWNpdHknLCBmdW5jdGlvbigpIHtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgICB9KVxuXG4gICAgICAvLyAtIEQzIG1lcmdlIGZvciBuZXcgYW5kIGV4aXN0aW5nIGV2ZW50c1xuICAgICAgLm1lcmdlKGFsbF9ldmVudF9ub2Rlcyk7XG5cbiAgICAvLyBUaGVzZSBhcmUgdXNlZCBmb3IgZXhwYW5kaW5nL2NvbGxhcHNpbmcgYW4gZXZlbnQgZ3JvdXAuXG4gICAgY29uc3QgdG9nZ2xlID0gbmV3Tm9kZXNcbiAgICAgIC5maWx0ZXIobm9kZV9pc19ncm91cClcbiAgICAgIC5hcHBlbmQoJ2RpdicpXG4gICAgICAuYXR0cignY2xhc3MnLCAndG9nZ2xlJyk7XG5cbiAgICB0b2dnbGVcbiAgICAgIC5zdHlsZSgnZGlzcGxheScsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgaWYgKGQuaGFzX3N1Ym5vZGVzKCkpIHtcbiAgICAgICAgICByZXR1cm4gJ2lubGluZS1ibG9jayc7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuICdub25lJztcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAvLyBFYWNoIG5vZGUgaGFzIGEgKGNvbXBvdW5kKSBsYWJlbDpcbiAgICBjb25zdCBsYWJlbCA9IG5ld05vZGVzXG4gICAgICAuYXBwZW5kKCdkaXYnKVxuICAgICAgLmF0dHIoJ2NsYXNzJywgJ2xhYmVsJylcbiAgICAgIC5zdHlsZSgncG9zaXRpb24nLCAncmVsYXRpdmUnKVxuICAgICAgLnN0eWxlKCdoZWlnaHQnLCBOT0RFLmhlaWdodCk7XG5cbiAgICAvLyBMb2NrZWQgZXZlbnRzIG5lZWQgYSBsb2NrIGljb246XG4gICAgbmV3Tm9kZXNcbiAgICAgIC5zZWxlY3RBbGwoJy5sYWJlbCcpXG4gICAgICAuYXBwZW5kKCdhJylcbiAgICAgIC5hdHRyKCdjbGFzcycsICdsb2NrJyk7XG5cbiAgICAvLyBFYWNoIG5vZGUgbGFiZWwgbmVlZHMgYSBwcm9kdWN0aW9uIGljb246XG4gICAgbGFiZWwuYXBwZW5kKCdkaXYnKS5hdHRyKCdjbGFzcycsICdwcm9kdWN0aW9uLWljb24nKTtcblxuICAgIC8vIFdlIHNldCB0aGUgcHJvZHVjdGlvbiBmbGFnIG9uIGV2ZXJ5IHVwZGF0ZSwgYXMgaXQgbWF5IGhhdmUgY2hhbmdlZC5cbiAgICBhbGxfZXZlbnRfbm9kZXNcbiAgICAgIC5zZWxlY3RBbGwoJy5sYWJlbD4ucHJvZHVjdGlvbi1pY29uJylcbiAgICAgIC5zdHlsZSgnZGlzcGxheScsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgaWYgKG5vZGVfaXNfcHJvZHVjdGlvbihkKSkge1xuICAgICAgICAgIHJldHVybiAnaW5saW5lLWJsb2NrJztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gJ25vbmUnO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgIC8vIEVhY2ggbm9kZSBsYWJlbCBuZWVkcyBhIGNvbmZsaWN0IGljb246XG4gICAgbGFiZWxcbiAgICAgIC5hcHBlbmQoJ2RpdicpXG4gICAgICAuYXR0cignY2xhc3MnLCAnaWNvbi1jb25mbGljdCcpXG4gICAgICAuYXR0cigndGl0bGUnLCAnJyk7XG5cbiAgICAvLyBXZSBzZXQgdGhlIGNvbmZsaWN0IGljb24gb24gZXZlcnkgdXBkYXRlLCBhcyBpdCBtYXkgaGF2ZSBjaGFuZ2VkLlxuICAgIGFsbF9ldmVudF9ub2Rlc1xuICAgICAgLnNlbGVjdEFsbCgnLmxhYmVsPi5pY29uLWNvbmZsaWN0JylcbiAgICAgIC5zdHlsZSgnZGlzcGxheScsIGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgaWYgKGhhc19ub2Rlc193aXRoX2NvbmZsaWN0cyhkKSkge1xuICAgICAgICAgIHJldHVybiAnaW5saW5lLWJsb2NrJztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gJ25vbmUnO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgIC8vIEV2ZW50cyB3aGljaCBoYXZlIGRhdGUgaW5mbyBuZWVkIHRvIHByZXNlbnQgdGhpcyBpbmZvOlxuICAgIG5ld05vZGVzXG4gICAgICAuZmlsdGVyKG5vZGVfaXNfZGF0ZWQpXG4gICAgICAuc2VsZWN0QWxsKCcubGFiZWwnKVxuICAgICAgLmFwcGVuZCgnc3BhbicpXG4gICAgICAuYXR0cignY2xhc3MnLCAnZGF0ZScpO1xuXG4gICAgLy8gQWxsIGV2ZW50cyBzaG93IHRoZWlyIG5hbWU6XG4gICAgbGFiZWwuYXBwZW5kKCdzcGFuJykuYXR0cignY2xhc3MnLCAnbmFtZScpO1xuXG4gICAgLy8gV2Ugc2V0IHRoZSBuYW1lIG9uIGV2ZXJ5IHVwZGF0ZSwgYXMgaXQgbWF5IGhhdmUgY2hhbmdlZC5cbiAgICBhbGxfZXZlbnRfbm9kZXNcbiAgICAgIC5zZWxlY3RBbGwoJ3NwYW4ubmFtZScpXG4gICAgICAudGV4dChnZXRfbm9kZV9uYW1lKTtcblxuICAgIC8vIFdlIHNldCB0aGUgbG9jYXRpb24gdGl0bGUgYXR0cmlidXRlXG4gICAgYWxsX2V2ZW50X25vZGVzLmF0dHIoJ3RpdGxlJywgKG5vZGUpID0+IG5vZGVfdGl0bGVzdHJpbmcobm9kZSwgdGhpcy5mb3Jlc3QubW9kZWwpKTtcblxuICAgIC8vIFdlIHNldCB0aGUgZGF0ZSBvbiBldmVyeSB1cGRhdGUsIGFzIGl0IG1heSBhbHNvIGhhdmUgY2hhbmdlZC5cbiAgICBjb25zdCBkYXRlRm9ybWF0U2V0dGluZ3MgPSBEYXRlRm9ybWF0U2V0dGluZ3MuZ2V0U2V0dGluZ3MoKTtcbiAgICBhbGxfZXZlbnRfbm9kZXNcbiAgICAgIC5maWx0ZXIobm9kZV9pc19kYXRlZClcbiAgICAgIC5zZWxlY3RBbGwoJy5kYXRlJylcbiAgICAgIC50ZXh0KGZ1bmN0aW9uKG5vZGUpIHtcbiAgICAgICAgY29uc3QgZGF0ZSA9IGRhdGVfZm9yX3JlY29yZChub2RlLnJlY29yZCk7XG4gICAgICAgIHJldHVybiBtb21lbnQoZGF0ZSkuZm9ybWF0KGRhdGVGb3JtYXRTZXR0aW5ncy5kYXRlRm9ybWF0V2l0aG91dFllYXIpO1xuICAgICAgfSk7XG5cbiAgICAvLyBMb2NrcyBtYXkgaGF2ZSBjaGFuZ2VkLCBzbyB3ZSB1cGRhdGUgdGhvc2UgYXMgd2VsbC5cbiAgICBjb25zdCB7YWxsb3dfZXZlbnRfdW5sb2NraW5nfSA9IHRoaXMuZm9yZXN0O1xuICAgIGFsbF9ldmVudF9ub2Rlcy5zZWxlY3QoJy5sb2NrJykuYXR0cignY2xhc3MnLCBmdW5jdGlvbihkKSB7XG4gICAgICBpZiAobm9kZV9oYXNfYWN0dWFsX2xvY2soZCkpIHtcbiAgICAgICAgcmV0dXJuICdsb2NrIGxvY2stLWFjdHVhbCc7XG4gICAgICB9IGVsc2UgaWYgKG5vZGVfaGFzX2xvY2soZCkgJiYgZC5pc191bmxvY2tlZCgpKSB7XG4gICAgICAgIHJldHVybiAnbG9jayB1bmxvY2tlZCBhY3Rpb24nO1xuICAgICAgfSBlbHNlIGlmIChub2RlX2hhc19sb2NrKGQpKSB7XG4gICAgICAgIGlmIChhbGxvd19ldmVudF91bmxvY2tpbmcgJiYgZC5jYW5fYmVfdW5sb2NrZWQoKSkge1xuICAgICAgICAgIHJldHVybiAnbG9jayBhY3Rpb24nO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiAnbG9jayBkaXNhYmxlZCBhY3Rpb24nO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gJ2xvY2sgbG9jay0tbm9uZSc7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAvLyBEZXB0aCBzb3J0aW5nOlxuICAgIGFsbF9ldmVudF9ub2Rlcy5zb3J0KGNvbXBhcmVfZm9yX2xheWVyaW5nKTtcblxuICAgIC8vIEV4aXN0aW5nIG5vZGVzIG1heSBuZWVkIHRvIG1vdmUsIGFuZCByZW1haW4gdmlzaWJsZS5cbiAgICBhbGxfZXZlbnRfbm9kZXNcbiAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgIC5kdXJhdGlvbihEVVJBVElPTilcbiAgICAgIC5hdHRyKCdjbGFzcycsIGNsYXNzZXNfZm9yX25vZGUpXG4gICAgICAuc3R5bGUoJ2xlZnQnLCBmdW5jdGlvbihkKSB7XG4gICAgICAgIHJldHVybiBgJHtkLnl9cHhgO1xuICAgICAgfSlcbiAgICAgIC5zdHlsZSgndG9wJywgZnVuY3Rpb24oZCkge1xuICAgICAgICByZXR1cm4gYCR7ZC54fXB4YDtcbiAgICAgIH0pXG4gICAgICAuc3R5bGUoJ29wYWNpdHknLCBmdW5jdGlvbihkKSB7XG4gICAgICAgIHJldHVybiBkLm9wYWNpdHk7XG4gICAgICB9KTtcblxuICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLlxuICAgIC8vIExpbmtzXG5cbiAgICB0aGlzLmQzX2xpbmtzID0gdGhpcy5kM190cmVlLmxpbmtzKHRoaXMuZDNfdHJlZS5kZXNjZW5kYW50cygpKTtcblxuICAgIC8vIFNldCB1cCB0aGUgbGlua3MgdG8gYmUgZHJhd24uIEEgcGFyZW50LWNoaWxkIGxpbmsgaXMgXCJvd25lZFwiIGJ5IHRoZVxuICAgIC8vIGNoaWxkLCBhcyBpdCBjYW4gaGF2ZSBvbmx5IG9uZS4gV2hpY2ggbWVhbnMgd2UgY2FuIHVzZSB0aGUgY2hpbGQnc1xuICAgIC8vIGRhdGEga2V5IGFzIHRoZSBsaW5rIHNlbGVjdG9yLlxuICAgIGxldCBsaW5rID0gdGhpcy5zdmcuc2VsZWN0QWxsKCdwYXRoLmxpbmsnKS5kYXRhKHRoaXMuZDNfbGlua3MsIGZ1bmN0aW9uKGQpIHtcbiAgICAgIHJldHVybiBkLnRhcmdldC5kYXRhLmdldF9rZXkoKTtcbiAgICB9KTtcblxuICAgIC8vIFBvc2l0aW9uIGV4aXRpbmcgbGlua3MsIGFuZCBoaWRlIHRoZW0uXG4gICAgbGlua1xuICAgICAgLmV4aXQoKVxuICAgICAgLnRyYW5zaXRpb24oKVxuICAgICAgLmR1cmF0aW9uKERVUkFUSU9OKVxuICAgICAgLmF0dHIoJ29wYWNpdHknLCAwLjApXG4gICAgICAucmVtb3ZlKCk7XG5cbiAgICAvLyBFbnRlciBhbnkgbmV3IGxpbmtzLlxuICAgIGNvbnN0IG5ld19saW5rcyA9IGxpbmtcbiAgICAgIC5lbnRlcigpXG4gICAgICAuaW5zZXJ0KCdwYXRoJywgJ2cnKVxuICAgICAgLmF0dHIoJ2NsYXNzJywgJ2xpbmsnKVxuICAgICAgLmF0dHIoJ29wYWNpdHknLCAwLjApO1xuXG4gICAgLy8gUG9zaXRpb24gbmV3IGxpbmtzLCBhbmQgbWFrZSB0aGVtIHZpc2libGUuXG4gICAgbmV3X2xpbmtzXG4gICAgICAudHJhbnNpdGlvbigpXG4gICAgICAuZHVyYXRpb24oRFVSQVRJT04pXG4gICAgICAuYXR0cignZCcsIGZ1bmN0aW9uKGxpbmssIGQpIHtcbiAgICAgICAgcmV0dXJuIHN2Z19wYXRoX2Zvcl9saW5rKHtzb3VyY2U6IGxpbmsuc291cmNlLmRhdGEsIHRhcmdldDogbGluay50YXJnZXQuZGF0YX0pO1xuICAgICAgfSlcbiAgICAgIC5hdHRyKCdvcGFjaXR5JywgMS4wKTtcbiAgICAvLyAuYXR0cignc3Ryb2tlJywgbGlua19jb2xvcilcblxuICAgIGxpbmsgPSBuZXdfbGlua3MubWVyZ2UobGluayk7XG5cbiAgICAvLyBSZXBvc2l0aW9uIGxpbmtzIGFzIG5lZWRlZC5cbiAgICBsaW5rXG4gICAgICAudHJhbnNpdGlvbigpXG4gICAgICAuZHVyYXRpb24oRFVSQVRJT04pXG4gICAgICAuYXR0cignZCcsIGZ1bmN0aW9uKGxpbmssIGQpIHtcbiAgICAgICAgcmV0dXJuIHN2Z19wYXRoX2Zvcl9saW5rKHtzb3VyY2U6IGxpbmsuc291cmNlLmRhdGEsIHRhcmdldDogbGluay50YXJnZXQuZGF0YX0pO1xuICAgICAgfSlcbiAgICAgIC5hdHRyKCdvcGFjaXR5JywgMS4wKTtcbiAgICAvLyAuYXR0cignc3Ryb2tlJywgbGlua19jb2xvcilcblxuICAgIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLlxuICAgIC8vIFRyYWNraW5nIGFuZCBzaXppbmdcblxuICAgIC8vIEJ5IHRyYWNraW5nIHRoZSBjb3JyZWN0IERPTSBlbGVtZW50IG9uIGVhY2ggbm9kZSB3ZSBjYW4gZG8gc29tZSBkaXJlY3RcbiAgICAvLyBET00gbWFuaXB1bGF0aW9uIG1vcmUgZWFzaWx5IGluIG90aGVyIHNwb3RzIChlLmcuIHNlbGVjdGlvbikuXG4gICAgLy9cbiAgICAvLyBJbiBhZGRpdGlvbiwgd2UgYWxzbyBtYWtlIHN1cmUgdGhlIHRyZWUgcGFuZWwgaXMgd2lkZSBlbm91Z2ggdG8gc2hvd1xuICAgIC8vIGFsbCBub2Rlcy5cblxuICAgIGxldCBvdmVyYWxsX3dpZHRoID0gMDtcblxuICAgIGFsbF9ldmVudF9ub2Rlcy5lYWNoKGZ1bmN0aW9uKGQpIHtcbiAgICAgIGQuZWxlbWVudCA9ICQodGhpcyk7XG5cbiAgICAgIGNvbnN0IGxvY2FsX3dpZHRoID0gZC55ICsgcGFyc2VJbnQoJCh0aGlzKS5jc3MoJ3dpZHRoJykpO1xuICAgICAgb3ZlcmFsbF93aWR0aCA9IE1hdGgubWF4KGxvY2FsX3dpZHRoLCBvdmVyYWxsX3dpZHRoKTtcbiAgICB9KTtcblxuICAgIC8vIFdlIGRvIGltcG9zZSBhIG1pbmltdW0gd2lkdGg6XG4gICAgb3ZlcmFsbF93aWR0aCA9IE1hdGgubWF4KE1JTklNVU1fVFJFRV9XSURUSCwgb3ZlcmFsbF93aWR0aCArIDEwKTtcblxuICAgIHRoaXMudHJlZV9wYW5lbC5jc3MoJ3dpZHRoJywgYCR7b3ZlcmFsbF93aWR0aH1weGApO1xuICB9O1xuXG4vLyBUaGlzIGNhbGN1bGF0ZXMgdGhlIGFjdHVhbCBYIGNvb3JkaW5hdGUgZm9yIGVhY2ggbm9kZS4gV2UgZG8gdGhpcyBieVxuLy8gdHJhY2tpbmcgdGhlIGN1cnJlbnQgWCBwb3NpdGlvbiBhbmQgaW5jcmVtZW50aW5nIHRoaXMgYXMgbmVlZGVkLlxuICBjYWxjdWxhdGVfbm9kZV9wb3NpdGlvbnMoKSB7XG4gICAgbGV0IF94ID0gMDtcbiAgICBsZXQgbWF4X3ggPSAwO1xuICAgIGxldCBwcmV2aW91cztcblxuICAgIC8vIEZ1bmN0aW9uIHRoYXQgbG9vcHMgb3ZlciBldmVyeSBub2RlLCBzdGFydGluZyBhdCB0aGUgcm9vdCBub2RlIGFuZCB0cmF2ZXJzZXMgZGVwdGgtZmlyc3QuXG4gICAgZnVuY3Rpb24gZG9Gb3JOb2RlKG5vZGUpIHtcbiAgICAgIGNvbnN0IGRhdGFOb2RlID0gbm9kZS5kYXRhO1xuICAgICAgZGF0YU5vZGUucGFyZW50ID0gbm9kZS5wYXJlbnQgPyBub2RlLnBhcmVudC5kYXRhIDogbnVsbDtcbiAgICAgIGRhdGFOb2RlLmQzUGFyZW50ID0gbm9kZS5wYXJlbnQ7XG5cbiAgICAgIGlmIChub2RlLnBhcmVudCkge1xuICAgICAgICBpZiAoZGF0YU5vZGUuaXNfZ3JvdXAoKSkge1xuICAgICAgICAgIF94ICs9IE5PREUuYmlnX3ZlcnRpY2FsX3NwYWNpbmc7XG4gICAgICAgIH0gZWxzZSBpZiAocHJldmlvdXMgJiYgcHJldmlvdXMuaXNfZ3JvdXAoKSkge1xuICAgICAgICAgIF94ICs9IE5PREUuYmlnX3ZlcnRpY2FsX3NwYWNpbmc7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgX3ggKz0gTk9ERS52ZXJ0aWNhbF9zcGFjaW5nO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGRhdGFOb2RlLmluZGVudCA9IE1hdGguZmxvb3Iobm9kZS55IC8gSU5ERU5UKTtcblxuICAgICAgaWYgKG5vZGUucGFyZW50ID09PSBudWxsICYmIGRhdGFOb2RlLnN0YXJ0X3Bvc2l0aW9uID09PSBudWxsKSB7XG4gICAgICAgIGRhdGFOb2RlLnN0YXJ0X3Bvc2l0aW9uID0gbmV3IFhZKG5vZGUueCwgbm9kZS55KTtcbiAgICAgIH1cblxuICAgICAgLy8gU2V0IHRoZSBub2RlJ3MgbmV3IHBvc2l0aW9uLlxuICAgICAgbm9kZS54ID0gZGF0YU5vZGUueCA9IF94O1xuICAgICAgLy8gZC55IGdldHMgbWFuYWdlZCBieSBEMzsgc28gdGhhdCdzIGZpbmUgYXMgaXMsIGJ1dCB3ZSBuZWVkIHRvIGNvcHkgaXQgdG8gdGhlIGRhdGFub2RlLlxuICAgICAgZGF0YU5vZGUueSA9IG5vZGUueTtcblxuICAgICAgaWYgKG5vZGUucGFyZW50ID09PSBudWxsICYmIGRhdGFOb2RlLnN0YXJ0X3Bvc2l0aW9uID09PSBudWxsKSB7XG4gICAgICAgIGRhdGFOb2RlLnN0YXJ0X3Bvc2l0aW9uID0gbmV3IFhZKG5vZGUueCwgbm9kZS55KTtcbiAgICAgIH1cblxuICAgICAgLy8gVGhpcyB3aWxsIGJlIHRoZSBwb3NpdGlvbiBmb3IgdGhlIG5leHQgbm9kZS5cbiAgICAgIF94ID0gbm9kZS54ICsgTk9ERS5oZWlnaHQ7XG5cbiAgICAgIC8vIFdlIG5lZWQgdG8gdHJhY2sgdGhlIG1heCBoZWlnaHQgc28gd2UgY2FuIGdyb3cgdGhlIGNvbnRhaW5lciBhc1xuICAgICAgLy8gbmVlZGVkLlxuICAgICAgaWYgKF94ID4gbWF4X3gpIG1heF94ID0gX3g7XG5cbiAgICAgIGlmICghZGF0YU5vZGUucG9zaXRpb24pIGRhdGFOb2RlLnBvc2l0aW9uID0gbmV3IFhZKCk7XG4gICAgICBkYXRhTm9kZS5wb3NpdGlvbi54ID0gbm9kZS54O1xuICAgICAgZGF0YU5vZGUucG9zaXRpb24ueSA9IG5vZGUueTtcblxuICAgICAgcHJldmlvdXMgPSBkYXRhTm9kZTtcblxuICAgICAgaWYgKG5vZGUuY2hpbGRyZW4pIHtcbiAgICAgICAgbm9kZS5jaGlsZHJlbi5mb3JFYWNoKChjaGlsZCkgPT4ge1xuICAgICAgICAgIGRvRm9yTm9kZShjaGlsZCwgX3gpO1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBkb0Zvck5vZGUodGhpcy5kM190cmVlKTtcblxuICAgIC8vIFdlIGVuc3VyZSB0aGF0IHRoZSB0cmVlIHZpZXcgaXMgbGFyZ2UgZW5vdWdoIHRvIGhvbGQgdGhlIG5vZGVzOlxuICAgIHRoaXMuZXZlbnRfdHJlZS5zdHlsZSgnaGVpZ2h0JywgKCkgPT4ge1xuICAgICAgcmV0dXJuIGAke21heF94ICsgMzB9cHhgO1xuICAgIH0pO1xuICB9O1xuXG4gIHNldHVwX3Njcm9sbGluZygpIHtcbiAgICBjb25zdCB0cmVlID0gdGhpcztcblxuICAgIHRoaXMuc2Nyb2xsaW5nX3BhbmVsLm9uKCdzY3JvbGwgcmVzaXplJywgZnVuY3Rpb24oZSkge1xuICAgICAgdHJlZS51cGRhdGVfZm9yX3Njcm9sbGluZyhlKTtcbiAgICB9KTtcblxuICAgIC8vIFRoaXMgdGhpbmcgaXMgbmVlZGVkIGJ5IFNhZmFyaSB0byBoYW5kbGUgYSB3ZWlyZCBpc3N1ZS4gUHV0IGJyaWVmbHk6XG4gICAgLy8gc3dpcGluZyB0aGUgdG91Y2hwYWQgbWFrZXMgdGhlIHN0aWNreSBub2RlcyB3aWdnbGUgYWJvdXQsIHdoZXJlYXMgdXNpbmdcbiAgICAvLyB0aGUgc2Nyb2xsYmFyIGRvZXMgbm90LiBJIGZvdW5kIGEgc2ltaWxhciBpc3N1ZSBoZXJlOlxuICAgIC8vIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMjcwNDE2ODUvXG4gICAgLy8gICBkb20tZWxlbWVudC1wb3NpdGlvbi1zbG93LXdoaWxlLXNjcm9sbGluZy1kaWZmZXJlbmNlLWJldHdlZW4tc2Nyb2xsYmFyLXNjcm9sbGlcbiAgICAvLyBUaGUgc29sdXRpb24gKGFzIEkgZGVzY3JpYmVkIG9uIHN0YWNrb3ZlcmZsb3cgYXMgd2VsbCkgaXMgdG8gaGFuZGxlIHRoZVxuICAgIC8vIG1vdXNld2hlZWwgZXZlbnQgYW5kIHRvIGNhbGN1bGF0ZSB0aGUgc2Nyb2xsIHZhbHVlcyBvdXJzZWx2ZXMuXG4gICAgdGhpcy5zY3JvbGxpbmdfcGFuZWwub24oJ21vdXNld2hlZWwnLCBmdW5jdGlvbihlKSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgIC8vIFZlcnRpY2FsIHNjcm9sbGluZyBpcyBoYW5kbGVkIGJ5IHRoZSBpbmRpdmlkdWFsIHRyZWU6XG4gICAgICBjb25zdCBtYXhZID0gdGhpcy5zY3JvbGxIZWlnaHQgLSB0aGlzLm9mZnNldEhlaWdodDtcbiAgICAgIHRoaXMuc2Nyb2xsVG9wID0gTWF0aC5tYXgoXG4gICAgICAgIDAsXG4gICAgICAgIE1hdGgubWluKG1heFksIHRoaXMuc2Nyb2xsVG9wIC0gZS5vcmlnaW5hbEV2ZW50LndoZWVsRGVsdGFZKVxuICAgICAgKTtcblxuICAgICAgLy8gSG9yaXpvbnRhbCBzY3JvbGxpbmcgaXMgaGFuZGxlZCBieSB0aGUgZm9yZXN0OlxuICAgICAgY29uc3QgZm9yZXN0X3BhbmVsID0gdHJlZS5mb3Jlc3QucGFuZWwuZ2V0KDApO1xuICAgICAgY29uc3QgbWF4WCA9IGZvcmVzdF9wYW5lbC5zY3JvbGxXaWR0aCAtIGZvcmVzdF9wYW5lbC5vZmZzZXRXaWR0aDtcbiAgICAgIGZvcmVzdF9wYW5lbC5zY3JvbGxMZWZ0ID0gTWF0aC5tYXgoXG4gICAgICAgIDAsXG4gICAgICAgIE1hdGgubWluKG1heFgsIGZvcmVzdF9wYW5lbC5zY3JvbGxMZWZ0IC0gZS5vcmlnaW5hbEV2ZW50LndoZWVsRGVsdGFYKVxuICAgICAgKTtcblxuICAgICAgdHJlZS51cGRhdGVfZm9yX3Njcm9sbGluZyhlKTtcbiAgICB9KTtcbiAgfTtcblxuICB1cGRhdGVfZm9yX3Njcm9sbGluZygpIHtcbiAgICB0aGlzLmFkanVzdF9ub2RlX3Bvc2l0aW9uc19mb3Jfc2Nyb2xsaW5nKCk7XG5cbiAgICAvLyBUT0RPIENhbiB3ZSBtZXJnZSB0aGUgZm9sbG93aW5nIEQzIHVwZGF0ZXMgd2l0aCB0aGUgZGVmYXVsdCByZW5kZXJpbmcgP1xuXG4gICAgLy8gVXBkYXRlIGFsbCBub2RlcyB0byBtYXRjaCB0aGUgbmV3IHBvc2l0aW9ucy4gQW5kIHJlLWV2YWx1YXRlIHRoZWlyXG4gICAgLy8gaW5zZXJ0aW9uIG9yZGVyLCBhcyBzb21lIGV2ZW50cyBtYXkgaGF2ZSBiZWNvbWUgc3RpY2t5LlxuICAgIHRoaXMuZXZlbnRfdHJlZVxuICAgICAgLnNlbGVjdEFsbCgnZGl2LnRyZWUtZXZlbnQnKVxuICAgICAgLmF0dHIoJ2NsYXNzJywgY2xhc3Nlc19mb3Jfbm9kZSlcbiAgICAgIC5zdHlsZSgndG9wJywgZnVuY3Rpb24oZCkge1xuICAgICAgICByZXR1cm4gYCR7ZC54fXB4YDtcbiAgICAgIH0pXG4gICAgICAuc3R5bGUoJ29wYWNpdHknLCBmdW5jdGlvbihkKSB7XG4gICAgICAgIHJldHVybiBkLm9wYWNpdHk7XG4gICAgICB9KVxuICAgICAgLnNvcnQoY29tcGFyZV9mb3JfbGF5ZXJpbmcpO1xuXG4gICAgLy8gVXBkYXRlIGFsbCBsaW5rcyB0byBtYXRjaCB0aGUgbmV3IHBvc2l0aW9ucy5cbiAgICB0aGlzLnN2Zy5zZWxlY3RBbGwoJ3BhdGgubGluaycpLmF0dHIoJ2QnLCBmdW5jdGlvbihsaW5rKSB7XG4gICAgICByZXR1cm4gc3ZnX3BhdGhfZm9yX2xpbmsoe3NvdXJjZTogbGluay5zb3VyY2UuZGF0YSwgdGFyZ2V0OiBsaW5rLnRhcmdldC5kYXRhfSk7XG4gICAgfSk7XG4gIH07XG5cbi8vIFdoZXRoZXIgb3Igbm90IGEgbm9kZSBzaG91bGQgcmVtYWluIHZpc2libGUgd2hpbGUgc2Nyb2xsaW5nLiBUaGlzIHdpbGxcbi8vIGFsc28gbWFrZSBpdCBzdGlja3kuIEJ1dCBpdCBzaG91bGQgZGlzYWxsb3cgaXQgZnJvbSBnZXR0aW5nIGhpZGRlbiB1bmRlclxuLy8gaXRzIHBhcmVudCBub2RlLlxuICBzaG91bGRfcmVtYWluX3Zpc2libGVfd2hpbGVfc2Nyb2xsaW5nKGV2ZW50KSB7XG4gICAgZnVuY3Rpb24gaXRfc2hvdWxkX3JlbWFpbl92aXNpYmxlKGUpIHtcbiAgICAgIHJldHVybiBlLnNlbGVjdGVkO1xuICAgIH1cblxuICAgIGlmIChpdF9zaG91bGRfcmVtYWluX3Zpc2libGUoZXZlbnQpKSByZXR1cm4gdHJ1ZTtcblxuICAgIC8vIFRPRE8gTWVtb2l6YXRpb24gdG8gcmVkdWNlIHJ1bnRpbWUgY29zdC5cblxuICAgIGZvciAobGV0IGkgPSBldmVudC5kM19pbmRleCArIDE7IGkgPCB0aGlzLmQzX25vZGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBlID0gdGhpcy5kM19ub2Rlc1tpXTtcbiAgICAgIGlmIChlLmluZGVudCA8PSBldmVudC5pbmRlbnQpIHJldHVybiBmYWxzZTtcbiAgICAgIGlmIChpdF9zaG91bGRfcmVtYWluX3Zpc2libGUoZSkpIHJldHVybiB0cnVlO1xuICAgIH1cblxuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuLy8gV2hldGhlciBvciBub3QgYW4gZXZlbnQgc2hvdWxkIGJlIFwic3RpY2tpZWRcIiBkdXJpbmcgc2Nyb2xsaW5nLiBXaGV0aGVyIG9yXG4vLyBub3QgaXQgd2lsbCBhY3R1YWxseSBnZXQgc3RpY2tpZWQgZGVwZW5kcyBvbiBpdHMgcG9zaXRpb24sIHRoZSBjdXJyZW50XG4vLyBzY3JvbGwgb2Zmc2V0LCBhbmQgdGhlIGF2YWlsYWJsZSBzcGFjZS5cbiAgc2hvdWxkX2JlX3N0aWNraWVkX3doaWxlX3Njcm9sbGluZyhldmVudCkge1xuICAgIHJldHVybiAoXG4gICAgICBldmVudC5pc19ncm91cCgpIHx8IHRoaXMuc2hvdWxkX3JlbWFpbl92aXNpYmxlX3doaWxlX3Njcm9sbGluZyhldmVudClcbiAgICApO1xuICB9O1xuXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBUcmVlIGNvbXBhY3Rpb25cblxuLy8gV2UgbmVlZCB0byBkZWNpZGUgd2hldGhlciBvciBub3QgdGhpcyB0cmVlIHNob3VsZCB0cnkgY29tcGFjdCBpdHNlbGZcbi8vIHdoZW4gZHJhd24uIFRoaXMgbWVhbnMgdGhhdCBpZiBhIHN1YnRyZWUgZG9lcyBub3QgZml0IHRoZSBhdmFpbGFibGVcbi8vIHZlcnRpY2FsIHNwYWNlIGl0IHNob3VsZCB0cnkgdG8gY29sbGFwc2UgZXZlbnRzIHRvIG1ha2UgdXAgZm9yIHRoYXQuXG4gIGRlY2lkZV93aGV0aGVyX3RvX2NvbXBhY3Rfc3VidHJlZSgpIHtcbiAgICBsZXQgYXZhaWxhYmxlX2hlaWdodCA9IHRoaXMuc2Nyb2xsaW5nX3BhbmVsLmhlaWdodCgpO1xuICAgIGlmICghYXZhaWxhYmxlX2hlaWdodCkge1xuICAgICAgdGhpcy5jb21wYWN0ID0gdHJ1ZTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBjb25zdCBwYWRkaW5nX2JvdHRvbSA9IHRoaXMuc2Nyb2xsaW5nX3BhbmVsLmNzcygncGFkZGluZy1ib3R0b20nKTtcbiAgICBpZiAocGFkZGluZ19ib3R0b20pIGF2YWlsYWJsZV9oZWlnaHQgKz0gcGFyc2VJbnQocGFkZGluZ19ib3R0b20sIDEwKTtcblxuICAgIGNvbnN0IG5lZWRlZF9oZWlnaHQgPSByZXF1aXJlZF9oZWlnaHRfZm9yX3N1YnRyZWUodGhpcy5yb290LnJlY29yZCwgdGhpcy5mb3Jlc3QubW9kZWwpO1xuXG4gICAgdGhpcy5yb290LmNvbXBhY3QgPSBuZWVkZWRfaGVpZ2h0ID4gYXZhaWxhYmxlX2hlaWdodDtcbiAgfTtcblxuLy8gVGhpcyBjb21iaW5lcyB0aGUgY2FsY3VsYXRlZCBub2RlIHBvc2l0aW9ucyB3aXRoIHRoZSBzY3JvbGwgb2Zmc2V0LCBhbmRcbi8vIHJlcG9zaXRpb25zIG5vZGVzIHNvIHRoYXQgZ3JvdXBzIHJlbWFpbiB2aXNpYmxlIGFzIG11Y2ggYXMgcG9zc2libGUuXG4gIGFkanVzdF9ub2RlX3Bvc2l0aW9uc19mb3Jfc2Nyb2xsaW5nKHNjcm9sbF90b3ApIHtcbiAgICAvLyBUaGUgYWRqdXN0bWVudCBjYW4gYmUgdHJpZ2dlcmVkIGFzIHBhcnQgb2YgYW4gb3ZlcmFsbCBjYWxjdWxhdGlvbiwgaW5cbiAgICAvLyB3aGljaCBjYXNlIHRoZSBzY3JvbGxUb3Agd2lsbCBiZSBwcm92aWRlZCB0byB1cy4gT3IgaXQgY2FuIGJlIHRyaWdnZXJlZFxuICAgIC8vIGJ5IGFjdHVhbCBzY3JvbGxpbmcgZXZlbnRzLCBpbiB3aGljaCBjYXNlIHdlIG5lZWQgdG8gYXNrIGZvciB0aGVcbiAgICAvLyBzY3JvbGxUb3AgdmFsdWUgb3Vyc2VsdmVzLlxuICAgIGlmICghc2Nyb2xsX3RvcCkgc2Nyb2xsX3RvcCA9IHRoaXMuc2Nyb2xsaW5nX3BhbmVsLnNjcm9sbFRvcCgpO1xuXG4gICAgbGV0IGV2ZW50O1xuICAgIGxldCBpO1xuICAgIC8vIFRoZSBlYXNpZXN0IHRoaW5nIHRvIGRvIGlzIHRvIG5vdCBzY3JvbGwgYXQgYWxsLlxuICAgIGlmICghc2Nyb2xsX3RvcCkge1xuICAgICAgZm9yIChpID0gMDsgaSA8IHRoaXMuZDNfbm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgZXZlbnQgPSB0aGlzLmQzX25vZGVzW2ldO1xuICAgICAgICBldmVudC54ID0gZXZlbnQucG9zaXRpb24ueDtcbiAgICAgICAgZXZlbnQuaXNfc3RpY2t5ID0gZmFsc2U7XG4gICAgICAgIGV2ZW50Lm9wYWNpdHkgPSAxO1xuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIEJ1dCBvbiB0byB0aGUgaGFyZCBwYXJ0Li4uXG4gICAgLy9cbiAgICAvLyBUaGUgd2F5IHRoZSBhbGdvcml0aG0gd29ya3MgaXMgYnkgc2Nyb2xsaW5nIHVwIGluZGl2aWR1YWwgbm9kZXMgdW50aWwgd2VcbiAgICAvLyBoYXZlIHNwZW50IG91ciBzY3JvbGxpbmcgXCJidWRnZXRcIi4gVGhlIGluaXRpYWwgYnVkZ2V0IHdlIGhhdmUgaXMgdGhhdFxuICAgIC8vIHdoaWNoIG1hdGNoZXMgdGhlIHBvc2l0aW9uIG9mIHRoZSBzY3JvbGxiYXJzICg9IHNjcm9sbF90b3ApLlxuICAgIGxldCBzY3JvbGxfYnVkZ2V0ID0gc2Nyb2xsX3RvcDtcblxuICAgIC8vIFdlIGNvdW50IHRoZSBjb21iaW5lZCBzY3JvbGwgd2UgaGF2ZSBhcHBsaWVkIGF0IGFueSBnaXZlbiBzdGVwLCBzbyB0aGF0XG4gICAgLy8gd2UgY2FuIGJ1aWxkIGl0IHVwLlxuICAgIGxldCBzY3JvbGxfYXBwbGllZCA9IDA7XG4gICAgLy8gQW5kIHdlIG5lZWQgdG8ga25vdyB3aGVuIHRoZSBmaXhlZCBub2RlcyBoYXZlIHRha2VuIHVwIGFsbCBhdmFpbGFibGVcbiAgICAvLyBzcGFjZSwgaW4gd2hpY2ggY2FzZSB3ZSdsbCBwdXNoIHRoZW0gdXAgYW55d2F5IHRvIG1ha2UgbW9yZSBzcGFjZS5cbiAgICBsZXQgYm90dG9tX2VkZ2UgPSAwO1xuICAgIC8vIEhvdyBtdWNoIHNwYWNlIGRvIHdlIGhhdmUgYXZhaWxhYmxlIGZvciBmaXhlZCBub2RlcyA/IFdlbGwsIGV4YWN0bHkgYXNcbiAgICAvLyBtdWNoIGFzIHRoZSBoZWlnaHQgb2YgdGhlIHBhbmVsLlxuICAgIGNvbnN0IGF2YWlsYWJsZV9oZWlnaHQgPSB0aGlzLnNjcm9sbGluZ19wYW5lbC5oZWlnaHQoKTtcblxuICAgIC8vIFRoZSBhbGdvcml0aG0gaXMgaXRlcmF0aXZlLCBhbmQgbmVlZHMgdG8ga25vdyBhYm91dCB0aGUgY3VycmVudCBub2RlLCB0aGVcbiAgICAvLyBwcmV2aW91cyBub2RlIGFuZCB0aGUgcHJldmlvdXMgc3RpY2t5IG5vZGUuXG4gICAgbGV0IHByZXZpb3VzX25vZGUgPSBudWxsO1xuXG4gICAgLy8gU3RpY2tpbmVzcyBpcyBzb21ld2hhdCBhbWJpZ3VvdXMuIEEgc3RpY2t5IG5vZGUgbWF5IHN0aWxsIGdldCBwdXNoZWQgdXBcbiAgICAvLyBieSBub2RlcyB3aGljaCBhcmUgYXQgYSBsb3dlciBpbmRlbnRhdGlvbiBsZXZlbC4gT3IsIGFzIGV4cGxhaW5lZCBieVxuICAgIC8vIEVkZHk6IFwic3ViZ3JvdXBzIHpvdWRlbiBlbmtlbCBzdGlja2N5IG1vZXRlbiB6aWpuIHRpamRlbnMgaGV0IHNjcm9sbGVuXG4gICAgLy8gZG9vciBkZSBlaWdlbiBicmFuY2gsIGFuZGVycyBtb2V0ZW4gemUgbWVlIHZlcmR3aWpuZW5cIi4gU28gd2UgbmVlZCB0b1xuICAgIC8vIGtlZXAgdHJhY2sgb2Ygc3RpY2t5IG5vZGVzIHBlciBpbmRlbnRhdGlvbiBsZXZlbC4gV2hpY2ggaXMgd2h5IHdlXG4gICAgLy8gbWFpbnRhaW4gZm9sbG93aW5nIHN0YWNrOlxuICAgIGNvbnN0IHN0aWNreV9ub2Rlc19wZXJfbGV2ZWwgPSBbXTtcbiAgICAvLyBFYWNoIGVsZW1lbnQgaW4gdGhlIHN0YWNrIGlzIHRoZSBsYXN0IHN0aWNreSBub2RlIGZvciB0aGUgY29ycmVzcG9uZGluZ1xuICAgIC8vIGluZGVudGF0aW9uIGxldmVsLlxuXG4gICAgLy8gVGhpcyBzZXRzIGEgc3RpY2t5IG5vZGUgZm9yIGl0cyBsZXZlbC4gQW5kIGNsZWFycyBhbGwgc3RpY2t5IG5vZGVzXG4gICAgLy8gYmVsb3cgdGhhdCBsZXZlbC5cbiAgICBmdW5jdGlvbiB0cmFja19zdGlja3lfbm9kZShub2RlKSB7XG4gICAgICBjb25zdCBsZXZlbCA9IGV2ZW50LmluZGVudDtcblxuICAgICAgd2hpbGUgKHN0aWNreV9ub2Rlc19wZXJfbGV2ZWwubGVuZ3RoID4gbGV2ZWwgKyAxKSB7XG4gICAgICAgIHN0aWNreV9ub2Rlc19wZXJfbGV2ZWwucG9wKCk7XG4gICAgICB9XG5cbiAgICAgIHdoaWxlIChsZXZlbCA+PSBzdGlja3lfbm9kZXNfcGVyX2xldmVsLmxlbmd0aCkge1xuICAgICAgICBzdGlja3lfbm9kZXNfcGVyX2xldmVsLnB1c2gobnVsbCk7XG4gICAgICB9XG5cbiAgICAgIHN0aWNreV9ub2Rlc19wZXJfbGV2ZWxbbGV2ZWxdID0gbm9kZTtcbiAgICB9XG5cbiAgICAvLyBUaGlzIGdldHMgdGhlIHN0aWNreSBub2RlIGF0IGEgZ2l2ZW4gbGV2ZWwuXG4gICAgZnVuY3Rpb24gZ2V0X2xhc3Rfc3RpY2t5X25vZGUobGV2ZWwpIHtcbiAgICAgIGlmIChpc191bmRlZmluZWQobGV2ZWwpIHx8IGxldmVsID09PSBudWxsKSB7XG4gICAgICAgIGxldmVsID0gc3RpY2t5X25vZGVzX3Blcl9sZXZlbC5sZW5ndGggLSAxO1xuICAgICAgfVxuXG4gICAgICBpZiAobGV2ZWwgPCAwKSByZXR1cm4gbnVsbDtcblxuICAgICAgaWYgKGxldmVsID49IHN0aWNreV9ub2Rlc19wZXJfbGV2ZWwubGVuZ3RoKSB7XG4gICAgICAgIGxldmVsID0gc3RpY2t5X25vZGVzX3Blcl9sZXZlbC5sZW5ndGggLSAxO1xuICAgICAgfVxuXG4gICAgICBkbyB7XG4gICAgICAgIGNvbnN0IHN0aWNreV9ub2RlX2F0X2xldmVsID0gc3RpY2t5X25vZGVzX3Blcl9sZXZlbFtsZXZlbF07XG4gICAgICAgIGlmIChzdGlja3lfbm9kZV9hdF9sZXZlbCkgcmV0dXJuIHN0aWNreV9ub2RlX2F0X2xldmVsO1xuICAgICAgfSB3aGlsZSAoLS1sZXZlbCA+PSAwKTtcblxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgLy8gQXQgdGltZXMgd2UgbWF5IGhhdmUgdG8gc2hpZnQgdXAgcGFydCBvZiB0aGUgdHJlZSB3ZSBoYXZlIGFscmVhZHlcbiAgICAvLyBjb3ZlcmVkIGJlZm9yZS4gVGhpcyBmdW5jdGlvbiB0YWtlcyBjYXJlIG9mIHRoYXQuXG4gICAgLy9cbiAgICAvLyBUaGVyZSBpcyBzb21lIHByaW9yaXRpemF0aW9uIHdlIG5lZWQgdG8gYXBwbHkgdG8gdGhpcyBzaGlmdGluZzpcbiAgICAvLyB0aGUgZGVlcGVzdCBsZXZlbHMgc2hvdWxkIHNoaWZ0IHVwd2FyZHMgZmlyc3QuIFB1dCBkaWZmZXJlbnRseSxcbiAgICAvLyBjaGlsZHJlbiBzaG91bGQgc2hpZnQgdXAgYmVmb3JlIHdlIHNoaWZ0IHRoZWlyIHBhcmVudCBub2Rlcy5cbiAgICAvL1xuICAgIC8vXG4gICAgLy8gW0RFQlVHR0lORyBUSVBTXVxuICAgIC8vXG4gICAgLy8gSWYgeW91IGhhdmUgdG8gY2hhbmdlIHRoaXMgY29kZSwgYW5kIGl0J3Mgbm90IGRvaW5nIHdoYXQgeW91IGV4cGVjdCBpdFxuICAgIC8vIHRvLCBoZXJlIGFyZSBzb21lIGRlYnVnZ2luZyB0aXBzOlxuICAgIC8vICogVmlzdWFsaXplIHRoZSB2YWx1ZSBmb3IgJ2JvdHRvbV9lZGdlJyBieSBhZGRpbmcgYSBsaW5lIChociwgb3IgMXB4XG4gICAgLy8gICBoaWdoIGRpdikgYW5kIHBvc2l0aW9uaW5nIGl0IGF0IHRoYXQgdmFsdWUgKGJld2FyZSBvZiBwYWRkaW5nIGFuZFxuICAgIC8vICAgbWFyZ2lucyB3aGVuIGRvaW5nIHNvKS4gSXQgc2hvdWxkIGFsd2F5cyBhcHBlYXIgYXQgdGhlIGJvdHRvbSBvZiB0aGVcbiAgICAvLyAgIGxvd2VzdCBzdGlja3kgbm9kZS4gSWYgaXQgZG9lc24ndCB5b3UncmUgbWlzbWFuYWdpbmcgdGhlIGJ1ZGdldC5cbiAgICAvLyAqIERvbid0IHdyaXRlIHRvIGNvbnNvbGUsIGFzIHlvdSdsbCBxdWlja2x5IGdldCBsb3N0IGluIHRoZSBhbW91bnQgb2ZcbiAgICAvLyAgIGRhdGEgeW91J2xsIGdldC4gRmluZGluZyB0aGUgc3RhcnQgYW5kIGVuZCBvZiB0aGluZ3MgaXMgYWxzbyB0cmlja3kuXG4gICAgLy8gICBXaGF0IGhlbHBlZCBtZSB3YXMgdG8gc2V0IHVwIGFuIGV4dHJhIGRpdiBvbiB0b3Agb3AgZXZlcnl0aGluZyB3aGljaFxuICAgIC8vICAgZ2V0cyBjbGVhcmVkIG9uIHRoZSBzdGFydCBvZiB0aGUgbWV0aG9kLCBhbmQgdGhlbiBjb2xsZWN0cyBhbGwgaW5mb1xuICAgIC8vICAgeW91IG5lZWQgKGJ5IGFwcGVuZGluZyB0ZXh0IGVsZW1lbnRzKS4gVGhpcyB3YXkgeW91IGNhbiBtb3JlIGVhc2lseVxuICAgIC8vICAgc2VlIHZhbHVlcyBjaGFuZ2UgYXMgeW91IHNjcm9sbCwgd2hpY2ggaGVscHMgeW91IHBpbnBvaW50IHRoZSBtb21lbnRcbiAgICAvLyAgIHNvbWV0aGluZyBnb2VzIHdyb25nLlxuICAgIGNvbnN0IHNoaWZ0X3VwID0gZnVuY3Rpb24oc2hpZnRpbmdfYnVkZ2V0LCBldmVudCwgbG93ZXJfbGV2ZWwpIHtcbiAgICAgIGNvbnN0IHVwcGVyX2xldmVsID0gZ2V0X2xhc3Rfc3RpY2t5X25vZGUoKS5pbmRlbnQ7XG4gICAgICBmb3IgKGxldCBsZXZlbCA9IHVwcGVyX2xldmVsOyBsZXZlbCA+IGxvd2VyX2xldmVsOyBsZXZlbC0tKSB7XG4gICAgICAgIGNvbnN0IG5vZGVfdG9fc3RhcnRfYWZ0ZXIgPSBnZXRfbGFzdF9zdGlja3lfbm9kZShsZXZlbCAtIDEpO1xuICAgICAgICBjb25zdCBzdGFydF9pbmRleCA9IG5vZGVfdG9fc3RhcnRfYWZ0ZXIuZDNfaW5kZXggKyAxO1xuXG4gICAgICAgIGxldCBzaGlmdGluZ19hcHBsaWVkID0gMDtcbiAgICAgICAgZm9yIChsZXQgaSA9IHN0YXJ0X2luZGV4OyBpIDwgZXZlbnQuZDNfaW5kZXg7IGkrKykge1xuICAgICAgICAgIGNvbnN0IGUgPSB0aGlzLmQzX25vZGVzW2ldO1xuICAgICAgICAgIGNvbnN0IHAgPSB0aGlzLmQzX25vZGVzW2kgLSAxXTtcblxuICAgICAgICAgIGxldCBhdmFpbGFibGVfc2hpZnRpbmdfYW1vdW50O1xuICAgICAgICAgIGlmICh0aGlzLnNob3VsZF9yZW1haW5fdmlzaWJsZV93aGlsZV9zY3JvbGxpbmcoZSkpIHtcbiAgICAgICAgICAgIGF2YWlsYWJsZV9zaGlmdGluZ19hbW91bnQgPVxuICAgICAgICAgICAgICBlLnggLSBwLnggLSBOT0RFLmhlaWdodCAtIE5PREUuYmlnX3ZlcnRpY2FsX3NwYWNpbmc7XG4gICAgICAgICAgICBhdmFpbGFibGVfc2hpZnRpbmdfYW1vdW50ID0gTWF0aC5tYXgoYXZhaWxhYmxlX3NoaWZ0aW5nX2Ftb3VudCwgMCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGF2YWlsYWJsZV9zaGlmdGluZ19hbW91bnQgPSBlLnggLSBwLng7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgYXZhaWxhYmxlX3NoaWZ0aW5nX2Ftb3VudCA9IE1hdGgubWluKFxuICAgICAgICAgICAgc2hpZnRpbmdfYnVkZ2V0LFxuICAgICAgICAgICAgYXZhaWxhYmxlX3NoaWZ0aW5nX2Ftb3VudFxuICAgICAgICAgICk7XG4gICAgICAgICAgc2hpZnRpbmdfYXBwbGllZCA9IE1hdGgubWF4KFxuICAgICAgICAgICAgc2hpZnRpbmdfYXBwbGllZCxcbiAgICAgICAgICAgIGF2YWlsYWJsZV9zaGlmdGluZ19hbW91bnRcbiAgICAgICAgICApO1xuXG4gICAgICAgICAgZS54IC09IGF2YWlsYWJsZV9zaGlmdGluZ19hbW91bnQ7XG5cbiAgICAgICAgICBpZiAoZS5vcGFjaXR5ID4gMCkge1xuICAgICAgICAgICAgZS5vcGFjaXR5ID0gTWF0aC5taW4oKGUueCAtIHAueCkgLyBOT0RFLmhlaWdodCwgMS4wKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBzaGlmdGluZ19idWRnZXQgLT0gc2hpZnRpbmdfYXBwbGllZDtcbiAgICAgICAgaWYgKHNoaWZ0aW5nX2J1ZGdldCA8PSAwKSBicmVhaztcbiAgICAgIH1cblxuICAgICAgLy8gQXMgd2UgbWF5IGhhdmUgc2hpZnRlZCB1cCBzb21lIHN0aWNreSBub2Rlcywgd2UgbmVlZCB0byByZWRlZmluZSB0aGVcbiAgICAgIC8vIGJvdHRvbSBlZGdlLlxuICAgICAgYm90dG9tX2VkZ2UgPSBnZXRfbGFzdF9zdGlja3lfbm9kZSgpLnggKyBOT0RFLmhlaWdodDtcbiAgICB9LmJpbmQodGhpcyk7XG5cbiAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgdGhpcy5kM19ub2Rlcy5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgIC8vIFNvIHdlIHdhbnQgdG8gYXBwbHkgc2Nyb2xsIG9uIHRoaXMgZXZlbnQ6XG4gICAgICBldmVudCA9IHRoaXMuZDNfbm9kZXNbaW5kZXhdO1xuXG4gICAgICAvLyBJZiB3ZSBoYXZlIGdvbmUgcGFzdCBvdXIgc2Nyb2xsIGJ1ZGdldCB3ZSBqdXN0IG1vdmUgdGhlIGV2ZW50IGJ5IHRoZVxuICAgICAgLy8gb3ZlcmFsbCBzY3JvbGwgYW1vdW50LiBBbmQgdGhlbiB3ZSdyZSBkb25lIHdpdGggdGhhdCBldmVudC5cbiAgICAgIGlmIChzY3JvbGxfYnVkZ2V0IDwgMCkge1xuICAgICAgICBldmVudC54ID0gZXZlbnQucG9zaXRpb24ueDtcbiAgICAgICAgZXZlbnQuaXNfc3RpY2t5ID0gZmFsc2U7XG4gICAgICAgIGV2ZW50Lm9wYWNpdHkgPSAxO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cblxuICAgICAgLy8gSWYgd2Ugc3RpbGwgbmVlZCB0byBzY3JvbGwgYnV0IGhhdmUgYWxyZWFkeSBmaWxsZWQgdGhlIGF2YWlsYWJsZSBzcGFjZVxuICAgICAgLy8gd2l0aCBzdGlja3kgbm9kZXMsIHRoZW4gd2UgbmVlZCB0byBtb3ZlIHRoZSBzdGlja3kgbm9kZXMgdXAgdG8gZnJlZSB1cFxuICAgICAgLy8gZXh0cmEgc3BhY2UuXG4gICAgICBsZXQgb3Zlcl90aGVfZWRnZSA9IHNjcm9sbF9idWRnZXQgPiAwICYmIGJvdHRvbV9lZGdlID4gYXZhaWxhYmxlX2hlaWdodDtcbiAgICAgIGxldCBjb3JyZWN0aW9uO1xuICAgICAgaWYgKG92ZXJfdGhlX2VkZ2UpIHtcbiAgICAgICAgLy8gV2Ugd2FudCB0byB0cmFjayB0aGUgYW1vdW50IG9mIHNoaWZ0LlxuICAgICAgICBjb25zdCB4X2JlZm9yZSA9IGdldF9sYXN0X3N0aWNreV9ub2RlKCkueDtcblxuICAgICAgICAvLyBUaGlzIGlzIHRoZSBhbW91bnQgYnkgd2hpY2ggdG8gcHVzaCB1cCB0aGUgc3RpY2t5IG5vZGVzOlxuICAgICAgICBjb3JyZWN0aW9uID0gTWF0aC5taW4oXG4gICAgICAgICAgYm90dG9tX2VkZ2UgLSBhdmFpbGFibGVfaGVpZ2h0LFxuICAgICAgICAgIHNjcm9sbF9idWRnZXRcbiAgICAgICAgKTtcblxuICAgICAgICAvLyBXZSBhc2sgdG8gc2hpZnQgZXZlcnl0aGluZyB3ZSBoYXZlIHNlZW4gc28gZmFyIHVwIGJ5IHRoYXQgYW1vdW50LlxuICAgICAgICAvLyBUT0RPIEluIGNhc2UgdGhlcmUgaXMgYSBkZWVwIHRyZWUsIGFuZCB0aGUgcGF0aCBjYW4ndCBmaXQgaW4gd2l0aGluXG4gICAgICAgIC8vIHRoZSBhdmFpbGFibGUgaGVpZ2h0LCB0aGlzIGNhdXNlcyB3ZWlyZCBzY3JvbGxpbmcuXG4gICAgICAgIHNoaWZ0X3VwKGNvcnJlY3Rpb24sIGV2ZW50LCAwKTtcblxuICAgICAgICAvLyBTbyBob3cgbXVjaCBkaWQgd2Ugc2hpZnQgP1xuICAgICAgICBjb25zdCB4X2FmdGVyID0gZ2V0X2xhc3Rfc3RpY2t5X25vZGUoKS54O1xuICAgICAgICBjb25zdCBzaGlmdGVkX2J5ID0geF9iZWZvcmUgLSB4X2FmdGVyO1xuXG4gICAgICAgIC8vIEFkZCB0aGF0IHRvIHRoZSBib29ra2VlcGluZy5cbiAgICAgICAgc2Nyb2xsX2FwcGxpZWQgKz0gc2hpZnRlZF9ieTtcbiAgICAgICAgc2Nyb2xsX2J1ZGdldCAtPSBzaGlmdGVkX2J5O1xuICAgICAgfVxuXG4gICAgICAvLyBJdCBtYXkgYmUgdGhhdCB3ZSBjb3VsZCBub3Qgc2hpZnQgdGhlIHN0aWNreSBub2RlcyB1cCAoZW5vdWdoKS4gSW5cbiAgICAgIC8vIHdoaWNoIGNhc2Ugd2UgbXVzdCBzaGlmdCB1cCBvZiBldmVyeXRoaW5nIGluc3RlYWQuXG4gICAgICBvdmVyX3RoZV9lZGdlID0gc2Nyb2xsX2J1ZGdldCA+IDAgJiYgYm90dG9tX2VkZ2UgPiBhdmFpbGFibGVfaGVpZ2h0O1xuICAgICAgaWYgKG92ZXJfdGhlX2VkZ2UpIHtcbiAgICAgICAgLy8gVGhpcyBpcyB0aGUgYW1vdW50IGJ5IHdoaWNoIHRvIHB1c2ggdXA6XG4gICAgICAgIGNvcnJlY3Rpb24gPSBNYXRoLm1pbihcbiAgICAgICAgICBib3R0b21fZWRnZSAtIGF2YWlsYWJsZV9oZWlnaHQsXG4gICAgICAgICAgc2Nyb2xsX2J1ZGdldFxuICAgICAgICApO1xuXG4gICAgICAgIC8vIEFuZCB0aGlzIGFwcGxpZXMgaXQgdG8gZXZlcnl0aGluZyB3ZSd2ZSBzZWVuIHNvIGZhci5cbiAgICAgICAgZm9yIChpID0gMDsgaSA8IGV2ZW50LmQzX2luZGV4OyBpKyspIHtcbiAgICAgICAgICB0aGlzLmQzX25vZGVzW2ldLnggLT0gY29ycmVjdGlvbjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEhhdmluZyBzY3JvbGxlZCwgd2UgbmVlZCB0byB1cGRhdGUgb3V0IGJ1ZGdldCBhbmQgb3ZlcmFsbCBjb3VudC5cbiAgICAgICAgc2Nyb2xsX2FwcGxpZWQgKz0gY29ycmVjdGlvbjtcbiAgICAgICAgc2Nyb2xsX2J1ZGdldCAtPSBjb3JyZWN0aW9uO1xuICAgICAgfVxuXG4gICAgICAvLyBUaGlzIGlzIHRoZSBub2RlIHRoZSBjdXJyZW50IG5vZGUgY2FuJ3QgbW92ZSBiZXlvbmQuXG4gICAgICBjb25zdCBsaW1pdGluZ19zdGlja3lfbm9kZSA9IGdldF9sYXN0X3N0aWNreV9ub2RlKGV2ZW50LmluZGVudCk7XG5cbiAgICAgIC8vIFdoZW4gc2Nyb2xsaW5nIHdlIGFsc28gbmVlZCB0byB0YWtlIHRoZSByZXF1aXJlZCBzcGFjZSBiZXR3ZWVuIHRoZVxuICAgICAgLy8gY3VycmVudCBub2RlIGFuZCB0aGUgbGltaXRpbmcgb25lIGludG8gYWNjb3VudC5cbiAgICAgIGxldCBzcGFjZV9iZXR3ZWVuX25vZGVzO1xuICAgICAgbGV0IGF2YWlsYWJsZV9zY3JvbGxfYW1vdW50O1xuICAgICAgaWYgKGxpbWl0aW5nX3N0aWNreV9ub2RlID09PSBudWxsKSBzcGFjZV9iZXR3ZWVuX25vZGVzID0gMDtcbiAgICAgIGlmIChldmVudC5pc19ncm91cCgpIHx8IGxpbWl0aW5nX3N0aWNreV9ub2RlLmlzX2dyb3VwKCkpIHtcbiAgICAgICAgc3BhY2VfYmV0d2Vlbl9ub2RlcyA9IE5PREUuYmlnX3ZlcnRpY2FsX3NwYWNpbmc7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzcGFjZV9iZXR3ZWVuX25vZGVzID0gTk9ERS52ZXJ0aWNhbF9zcGFjaW5nO1xuICAgICAgfVxuXG4gICAgICBpZiAocHJldmlvdXNfbm9kZSA9PT0gbnVsbCkge1xuICAgICAgICAvLyBUaGUgZmlyc3Qgbm9kZSBvZiBhbnkgdHJlZSB3aWxsIGFsd2F5cyBnZXQgc3RpY2tpZWQuXG5cbiAgICAgICAgZXZlbnQueCA9IGV2ZW50LnBvc2l0aW9uLng7XG4gICAgICAgIGV2ZW50LmlzX3N0aWNreSA9IHRydWU7XG4gICAgICAgIGV2ZW50Lm9wYWNpdHkgPSAxO1xuICAgICAgfSBlbHNlIGlmIChcbiAgICAgICAgdGhpcy5zaG91bGRfYmVfc3RpY2tpZWRfd2hpbGVfc2Nyb2xsaW5nKGV2ZW50KSAmJlxuICAgICAgICBldmVudC5wb3NpdGlvbi54IC0gc2Nyb2xsX2FwcGxpZWQgPD0gYm90dG9tX2VkZ2UgKyBzcGFjZV9iZXR3ZWVuX25vZGVzXG4gICAgICApIHtcbiAgICAgICAgLy8gV2UgaGF2ZSBhIG5vZGUgd2hpY2ggaGFzIGNyb3NzZWQgdGhlIGN1cnJlbnQgYm90dG9tIGVkZ2Ugb2Ygc3RpY2t5XG4gICAgICAgIC8vIG5vZGVzLCBidXQgd2hpY2ggc2hvdWxkbid0LiBTbyBpdCBzaG91bGQgZWl0aGVyIGJlY29tZSBzdGlja3ksIG9yXG4gICAgICAgIC8vIHNvbWUgb2YgdGhlIGV4aXN0aW5nIHN0aWNreSBub2RlcyB3aWxsIGhhdmUgdG8gc2hpZnQgdG8gbWFrZSByb29tLlxuXG4gICAgICAgIC8vIFRoaXMgaXMgdGhlIGJvdHRvbSBzdGlja3kgbm9kZTsgaS5lLiB0aGUgb25lIGRlZmluaW5nIHRoZSBib3R0dG9tXG4gICAgICAgIC8vIGVkZ2UuXG4gICAgICAgIGNvbnN0IGxhc3Rfc3RpY2t5X25vZGUgPSBnZXRfbGFzdF9zdGlja3lfbm9kZSgpO1xuICAgICAgICBpZiAobGltaXRpbmdfc3RpY2t5X25vZGUgIT09IGxhc3Rfc3RpY2t5X25vZGUpIHtcbiAgICAgICAgICAvLyBTbyB3ZSBoYXZlIHNvbWUgc3RpY2t5IG5vZGVzIHdoaWNoIGNhbiBiZSBtYWRlIHRvIHNoaWZ0IHVwd2FyZHMuXG4gICAgICAgICAgc2hpZnRfdXAoc2Nyb2xsX2J1ZGdldCwgZXZlbnQsIGV2ZW50LmluZGVudCk7XG5cbiAgICAgICAgICAvLyBBbmQgbm93IHdlIGNhbiBoYW5kbGUgdGhlIGFjdHVhbCBub2RlLlxuICAgICAgICAgIGF2YWlsYWJsZV9zY3JvbGxfYW1vdW50ID0gTWF0aC5taW4oXG4gICAgICAgICAgICBzY3JvbGxfYnVkZ2V0LFxuICAgICAgICAgICAgZXZlbnQucG9zaXRpb24ueCAtXG4gICAgICAgICAgICBzY3JvbGxfYXBwbGllZCAtXG4gICAgICAgICAgICBsYXN0X3N0aWNreV9ub2RlLnggLVxuICAgICAgICAgICAgTk9ERS5oZWlnaHQgLVxuICAgICAgICAgICAgc3BhY2VfYmV0d2Vlbl9ub2Rlc1xuICAgICAgICAgICk7XG5cbiAgICAgICAgICBzY3JvbGxfYXBwbGllZCArPSBhdmFpbGFibGVfc2Nyb2xsX2Ftb3VudDtcbiAgICAgICAgICBzY3JvbGxfYnVkZ2V0IC09IGF2YWlsYWJsZV9zY3JvbGxfYW1vdW50O1xuXG4gICAgICAgICAgZXZlbnQueCA9IGV2ZW50LnBvc2l0aW9uLnggLSBzY3JvbGxfYXBwbGllZDtcbiAgICAgICAgICBldmVudC5pc19zdGlja3kgPSBzY3JvbGxfYnVkZ2V0ID4gMDtcblxuICAgICAgICAgIGV2ZW50Lm9wYWNpdHkgPSBNYXRoLm1pbihcbiAgICAgICAgICAgIChldmVudC54IC0gbGFzdF9zdGlja3lfbm9kZS54KSAvIE5PREUuaGVpZ2h0LFxuICAgICAgICAgICAgMS4wXG4gICAgICAgICAgKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBUaGVyZSBpcyBub3RoaW5nIHdlIGNhbiBzaGlmdCB1cC4gU28gd2UgbWFrZSB0aGUgY3VycmVudCBub2RlXG4gICAgICAgICAgLy8gc3RpY2t5LlxuICAgICAgICAgIGV2ZW50LnggPSBsaW1pdGluZ19zdGlja3lfbm9kZS54ICsgTk9ERS5oZWlnaHQgKyBzcGFjZV9iZXR3ZWVuX25vZGVzO1xuICAgICAgICAgIGV2ZW50LmlzX3N0aWNreSA9IHRydWU7XG4gICAgICAgICAgZXZlbnQub3BhY2l0eSA9IDE7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIEluIGFsbCBvdGhlciBjYXNlcyB3ZSBjYW4gbW92ZSB0aGUgbm9kZSB1cHdhcmRzIHRvIG1hdGNoIHRoZSBzY3JvbGwuXG4gICAgICAgIGF2YWlsYWJsZV9zY3JvbGxfYW1vdW50ID0gTWF0aC5taW4oXG4gICAgICAgICAgc2Nyb2xsX2J1ZGdldCxcbiAgICAgICAgICBldmVudC5wb3NpdGlvbi54IC0gcHJldmlvdXNfbm9kZS5wb3NpdGlvbi54XG4gICAgICAgICk7XG5cbiAgICAgICAgc2Nyb2xsX2FwcGxpZWQgKz0gYXZhaWxhYmxlX3Njcm9sbF9hbW91bnQ7XG4gICAgICAgIHNjcm9sbF9idWRnZXQgLT0gYXZhaWxhYmxlX3Njcm9sbF9hbW91bnQ7XG5cbiAgICAgICAgZXZlbnQueCA9IGV2ZW50LnBvc2l0aW9uLnggLSBzY3JvbGxfYXBwbGllZDtcbiAgICAgICAgZXZlbnQuaXNfc3RpY2t5ID0gZmFsc2U7XG5cbiAgICAgICAgZXZlbnQub3BhY2l0eSA9IE1hdGgubWluKFxuICAgICAgICAgIChldmVudC54IC0gZ2V0X2xhc3Rfc3RpY2t5X25vZGUoKS54KSAvIE5PREUuaGVpZ2h0LFxuICAgICAgICAgIDEuMFxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICAvLyBXZSBuZWVkIHRvIHRyYWNrIHRoZSBib3R0b20gZWRnZSBvZiBhbGwgc3RpY2t5IG5vZGVzLCBhcyB3ZWxsIGFzIHRoZVxuICAgICAgLy8gc3RpY2t5IG5vZGVzIHBlciBpbmRlbnRhdGlvbiBsZXZlbC4uLlxuICAgICAgaWYgKGV2ZW50LmlzX3N0aWNreSkge1xuICAgICAgICBib3R0b21fZWRnZSA9IGV2ZW50LnggKyBOT0RFLmhlaWdodDtcbiAgICAgICAgdHJhY2tfc3RpY2t5X25vZGUoZXZlbnQpO1xuICAgICAgfVxuXG4gICAgICBwcmV2aW91c19ub2RlID0gZXZlbnQ7XG4gICAgfVxuXG4gICAgLy8gVXAgdG8gbm93IHdlIGhhdmUgYWN0dWFsbHkgYmVlbiBwdXNoaW5nIG5vZGVzIHVwLCBidXQgdGhleSBzaG91bGQgcmVhbGx5XG4gICAgLy8gYmUgbW92ZWQgZG93biB0byB0aGUgc2Nyb2xsIHBvc2l0aW9uIChiZXdhcmUgb2YgaHVydGluZyB5b3VyIGdyYXkgbWFzc1xuICAgIC8vIHRyeWluZyB0byB0aGluayB0aGF0IG9uZSBvdXQpLiBTbyB3ZSBub3cgYXBwbHkgdGhlIGZpbmFsIHJlcG9zaXRpb25pbmcuXG4gICAgZm9yIChpID0gMDsgaSA8IHRoaXMuZDNfbm9kZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHRoaXMuZDNfbm9kZXNbaV0ueCArPSBzY3JvbGxfdG9wO1xuICAgIH1cbiAgfTtcblxuICAvLyBVc2VmdWwgZm9yIGRlYnVnZ2luZzpcbiAgbG9nKCkge1xuICAgIHRoaXMucm9vdC5sb2coJycpO1xuICB9O1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./Treeview/Tree.js\n");

/***/ }),

/***/ "./Treeview/constants.js":
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"DURATION\": function() { return /* binding */ DURATION; },\n/* harmony export */   \"INDENT\": function() { return /* binding */ INDENT; },\n/* harmony export */   \"MINIMUM_TREE_WIDTH\": function() { return /* binding */ MINIMUM_TREE_WIDTH; },\n/* harmony export */   \"NODE\": function() { return /* binding */ NODE; }\n/* harmony export */ });\n// TODO Which ones of these can be made external ?\n// Minimum width for any tree.\nvar MINIMUM_TREE_WIDTH = 250;\n\n// Sizing info for an individual node:\nvar NODE = {\n  height: 22,\n  vertical_spacing: 1,\n  // Default space between nodes.\n  big_vertical_spacing: 5 // Space before and after a group node.\n};\n\n// How much child nodes get indented:\nvar INDENT = 20;\n\n// Duration for individual animations:\nvar DURATION = 400;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9UcmVldmlldy9jb25zdGFudHMuanMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9SZWFjdENvbXBvbmVudHNfLy4vVHJlZXZpZXcvY29uc3RhbnRzLmpzP2RiMWUiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVE9ETyBXaGljaCBvbmVzIG9mIHRoZXNlIGNhbiBiZSBtYWRlIGV4dGVybmFsID9cbi8vIE1pbmltdW0gd2lkdGggZm9yIGFueSB0cmVlLlxuZXhwb3J0IGNvbnN0IE1JTklNVU1fVFJFRV9XSURUSCA9IDI1MDtcblxuLy8gU2l6aW5nIGluZm8gZm9yIGFuIGluZGl2aWR1YWwgbm9kZTpcbmV4cG9ydCBjb25zdCBOT0RFID0ge1xuICBoZWlnaHQ6IDIyLFxuICB2ZXJ0aWNhbF9zcGFjaW5nOiAxLCAvLyBEZWZhdWx0IHNwYWNlIGJldHdlZW4gbm9kZXMuXG4gIGJpZ192ZXJ0aWNhbF9zcGFjaW5nOiA1IC8vIFNwYWNlIGJlZm9yZSBhbmQgYWZ0ZXIgYSBncm91cCBub2RlLlxufTtcblxuLy8gSG93IG11Y2ggY2hpbGQgbm9kZXMgZ2V0IGluZGVudGVkOlxuZXhwb3J0IGNvbnN0IElOREVOVCA9IDIwO1xuXG4vLyBEdXJhdGlvbiBmb3IgaW5kaXZpZHVhbCBhbmltYXRpb25zOlxuZXhwb3J0IGNvbnN0IERVUkFUSU9OID0gNDAwO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./Treeview/constants.js\n");

/***/ }),

/***/ "./Treeview/event-treeview.js":
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"announced_datetime_for_record\": function() { return /* binding */ announced_datetime_for_record; },\n/* harmony export */   \"children_of_record\": function() { return /* binding */ children_of_record; },\n/* harmony export */   \"classes_for_node\": function() { return /* binding */ classes_for_node; },\n/* harmony export */   \"compare_by_announceddatetime_recursive_then_name\": function() { return /* binding */ compare_by_announceddatetime_recursive_then_name; },\n/* harmony export */   \"compare_for_layering\": function() { return /* binding */ compare_for_layering; },\n/* harmony export */   \"conflicts_for_record\": function() { return /* binding */ conflicts_for_record; },\n/* harmony export */   \"date_for_record\": function() { return /* binding */ date_for_record; },\n/* harmony export */   \"end_date_for_record\": function() { return /* binding */ end_date_for_record; },\n/* harmony export */   \"generic_date_for_record\": function() { return /* binding */ generic_date_for_record; },\n/* harmony export */   \"get_node_name\": function() { return /* binding */ get_node_name; },\n/* harmony export */   \"handle_error\": function() { return /* binding */ handle_error; },\n/* harmony export */   \"has_nodes_with_conflicts\": function() { return /* binding */ has_nodes_with_conflicts; },\n/* harmony export */   \"highlight_drop_targets\": function() { return /* binding */ highlight_drop_targets; },\n/* harmony export */   \"is_defined\": function() { return /* binding */ is_defined; },\n/* harmony export */   \"is_legal_drop_target\": function() { return /* binding */ is_legal_drop_target; },\n/* harmony export */   \"is_undefined\": function() { return /* binding */ is_undefined; },\n/* harmony export */   \"leaf_children_of_record\": function() { return /* binding */ leaf_children_of_record; },\n/* harmony export */   \"location_for_record\": function() { return /* binding */ location_for_record; },\n/* harmony export */   \"move_events_to_own_tree\": function() { return /* binding */ move_events_to_own_tree; },\n/* harmony export */   \"move_events_to_target\": function() { return /* binding */ move_events_to_target; },\n/* harmony export */   \"node_conflicts\": function() { return /* binding */ node_conflicts; },\n/* harmony export */   \"node_has_actual_lock\": function() { return /* binding */ node_has_actual_lock; },\n/* harmony export */   \"node_has_conflicts\": function() { return /* binding */ node_has_conflicts; },\n/* harmony export */   \"node_has_lock\": function() { return /* binding */ node_has_lock; },\n/* harmony export */   \"node_is_dated\": function() { return /* binding */ node_is_dated; },\n/* harmony export */   \"node_is_group\": function() { return /* binding */ node_is_group; },\n/* harmony export */   \"node_is_production\": function() { return /* binding */ node_is_production; },\n/* harmony export */   \"node_key\": function() { return /* binding */ node_key; },\n/* harmony export */   \"node_titlestring\": function() { return /* binding */ node_titlestring; },\n/* harmony export */   \"padded\": function() { return /* binding */ padded; },\n/* harmony export */   \"profile_for_record\": function() { return /* binding */ profile_for_record; },\n/* harmony export */   \"record_can_be_deleted\": function() { return /* binding */ record_can_be_deleted; },\n/* harmony export */   \"record_can_be_written\": function() { return /* binding */ record_can_be_written; },\n/* harmony export */   \"record_has_actual_lock\": function() { return /* binding */ record_has_actual_lock; },\n/* harmony export */   \"record_has_conflicts\": function() { return /* binding */ record_has_conflicts; },\n/* harmony export */   \"record_has_lock\": function() { return /* binding */ record_has_lock; },\n/* harmony export */   \"record_id\": function() { return /* binding */ record_id; },\n/* harmony export */   \"record_is_group\": function() { return /* binding */ record_is_group; },\n/* harmony export */   \"required_height_for_subtree\": function() { return /* binding */ required_height_for_subtree; },\n/* harmony export */   \"settable_statuses_for_record\": function() { return /* binding */ settable_statuses_for_record; },\n/* harmony export */   \"status_for_record\": function() { return /* binding */ status_for_record; },\n/* harmony export */   \"svg_path_for_link\": function() { return /* binding */ svg_path_for_link; },\n/* harmony export */   \"unhighlight_drop_targets\": function() { return /* binding */ unhighlight_drop_targets; }\n/* harmony export */ });\n/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./Treeview/constants.js\");\n/* harmony import */ var _CommonScripts_sharedscripts_sharedscripts_yesplanapi__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./CommonScripts/sharedscripts/sharedscripts-yesplanapi.js\");\n/* harmony import */ var _common_stringSortOrder__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"./common/stringSortOrder.js\");\n/* eslint-disable camelcase */\n/* global d3 Q */\n\n// --------------------------------------------------------------------------\n// The raw data for the treeview comes in the form of records (cfr.\n// ui_model.js). Following accessors abstract away some of their details.\n\n\n\n\nfunction record_id(record) {\n  return record.$meta.id;\n}\nfunction record_is_group(record) {\n  return is_defined(record.c);\n}\nfunction children_of_record(record) {\n  var children = record.c();\n  return children || [];\n}\nfunction leaf_children_of_record(record) {\n  if (record_is_group(record)) {\n    return [].concat(record.c().map(leaf_children_of_record));\n  } else {\n    return [record];\n  }\n}\nfunction generic_date_for_record(record, select_function, compare_function, model) {\n  if (record_is_group(record)) {\n    var children = children_of_record(record);\n    var date = null;\n    for (var i = 0; i < children.length; i++) {\n      var child_date = generic_date_for_record(model.get(children[i]), select_function, compare_function, model);\n      if (!child_date) continue;\n      if (!date || compare_function(child_date, date)) date = child_date;\n    }\n    return date;\n  } else {\n    return select_function(record);\n  }\n}\n\n// A record's date is either defined on the record itself or, if it is a\n// group, deduced from its descendants.\nfunction date_for_record(record, model) {\n  return generic_date_for_record(record, function (record) {\n    if (is_defined(record.d)) {\n      return new Date(record.d());\n    } else {\n      return null;\n    }\n  }, function (child_date, date) {\n    return child_date < date;\n  }, model);\n}\n\n// A record's end date is either equal to the start date (for events) or\n// deduced from its descendants if it's a group\nfunction end_date_for_record(record, model) {\n  return generic_date_for_record(record, function (record) {\n    if (is_defined(record.d)) {\n      return new Date(record.d());\n    } else {\n      return null;\n    }\n  }, function (child_date, date) {\n    return child_date > date;\n  }, model);\n}\n\n// A record's announced datetime is either defined on the record itself or, if it is a\n// group, deduced from its descendants.\nfunction announced_datetime_for_record(record, model) {\n  if (record_is_group(record)) {\n    var children = children_of_record(record);\n    var date = null;\n    for (var i = 0; i < children.length; i++) {\n      var child_date = announced_datetime_for_record(model.get(children[i]), model);\n      if (!child_date) continue;\n      if (!date || child_date < date) date = child_date;\n    }\n    return date;\n  } else if (is_defined(record.adt)) {\n    return new Date(record.adt());\n  } else {\n    return null;\n  }\n}\nfunction location_for_record(record, model) {\n  if (!record || !record.loc || !record.loc()) {\n    return null;\n  } else {\n    // The location is a record itself.\n    var location = model.get(record.loc(), null);\n\n    // TODO Get rid of the fallback path once locations are properly shared with\n    // the client as records.\n    if (location) {\n      return location;\n    } else {\n      return {\n        $meta: {\n          id: null\n        },\n        name: function name() {\n          return record.loc();\n        }\n      };\n    }\n  }\n}\nfunction status_for_record(record) {\n  if (!record || !record.st || !record.st()) {\n    return null;\n  } else {\n    return record.st();\n  }\n}\nfunction conflicts_for_record(record) {\n  if (!record || !record.con || !record.con()) {\n    return null;\n  } else {\n    return record.con();\n  }\n}\nfunction record_has_conflicts(record) {\n  if (!record || !record.con || !record.con()) return false;\n  return Object.keys(record.con()).length > 0;\n}\nfunction settable_statuses_for_record(record) {\n  if (!record || !record.st || !record.cs()) {\n    return null;\n  } else {\n    return record.cs();\n  }\n}\nfunction profile_for_record(record) {\n  if (!record || !record.pr || !record.pr()) return null;\n  return record.pr();\n}\nfunction record_has_lock(record) {\n  return record.l && record.l() === 'lock';\n}\nfunction record_has_actual_lock(record) {\n  return record.l && record.l() === 'actual';\n}\nfunction record_can_be_written(record) {\n  return record.pe && record.pe().indexOf('w') >= 0;\n}\nfunction record_can_be_deleted(record) {\n  return record.pe && record.pe().indexOf('d') >= 0;\n}\n\n// --------------------------------------------------------------------------\n// The treeview model\n//\n// A treeview basically consists of three levels:\n// * the Forest, which is the root of everything,\n// * the individual Trees, and\n// * the Nodes which make up a Tree.\n\n// --------------------------------------------------------------------------\n// Actual D3 tree setup\n\n// D3 accessors. These are functional versions of the different Node methods.\nfunction node_key(node) {\n  return node.get_key();\n}\nfunction node_is_production(node) {\n  return node.is_production();\n}\nfunction node_has_conflicts(node) {\n  return node.has_conflicts();\n}\nfunction has_nodes_with_conflicts(node) {\n  return node.has_nodes_with_conflicts();\n}\nfunction node_conflicts(node) {\n  return node.conflicts();\n}\nfunction node_is_dated(node) {\n  return node.is_dated();\n}\nfunction node_has_lock(node) {\n  return node.has_lock();\n}\nfunction node_has_actual_lock(node) {\n  return node.has_actual_lock();\n}\nfunction node_is_group(node) {\n  return node.is_group();\n}\nfunction get_node_name(node) {\n  return node.get_name_with_abbreviation();\n}\nfunction classes_for_node(node) {\n  return node.get_classes();\n}\nfunction node_titlestring(node, model) {\n  var location = location_for_record(node.record, model);\n  if (!location || record_is_group(node.record)) return null;\n  var name = node.get_name();\n  return \"\".concat(name, \" \\u2013 \").concat(node.record.ads(), \" \\u2013 \").concat(location.name());\n}\n\n// Whether or not an event can accept another event as a child.\nfunction is_legal_drop_target(target_node, dragged_node) {\n  if (target_node.forest !== dragged_node.forest) return false;\n  if (target_node === dragged_node) return false;\n  if (target_node.is_placeholder()) return false;\n\n  // If the event is a leaf event, then it is only droppable if it is not a root, and its parent can be dropped on\n  if (target_node.is_leafevent()) {\n    if (target_node.is_root()) return false;\n    if (!record_can_be_written(target_node.parent.record)) return false;\n  }\n\n  // We need to have write permissions to drop on an event\n  if (!record_can_be_written(target_node.record)) return false;\n\n  // You can't move an event to one of its own subtrees. So we need to check\n  // for cycles here.\n  var e = target_node.parent;\n  while (e) {\n    if (e === dragged_node) return false;\n    e = e.parent;\n  }\n  return true;\n}\n\n// When hovering over a droppable target its group should get highlighted.\n// If the group is expanded then the links should also get highlighted.\nvar highlighted_events = null;\nvar highlighted_links = null;\nfunction highlight_drop_targets(target_element, target_node) {\n  unhighlight_drop_targets();\n  highlighted_events = d3.select(target_element);\n  if (!target_node.is_group() && target_node.parent !== null) {\n    target_node = target_node.parent;\n    highlighted_events = d3.selectAll('div.tree-event').filter(function (it) {\n      return it && it === target_node;\n    });\n  }\n  if (!target_node.collapsed) {\n    highlighted_links = d3.selectAll('path.link').filter(function (it) {\n      return it && it.source.data === target_node;\n    });\n    highlighted_links.classed('highlight', true);\n  }\n  highlighted_events.classed('highlight', true);\n}\nfunction unhighlight_drop_targets() {\n  if (highlighted_events) {\n    highlighted_events.classed('highlight', false);\n    highlighted_events = null;\n  }\n  if (highlighted_links) {\n    highlighted_links.classed('highlight', false);\n    highlighted_links = null;\n  }\n}\n\n// --------------------------------------------------------------------------\n// Other interactions\n\n// Move the event to become a child of the target event.\nfunction move_events_to_target(dragged_node, target_node, model) {\n  unhighlight_drop_targets();\n\n  //    if (target_node.forest.has_tree(target_node))\n  //      target_node.forest.remove_tree(target_node)\n\n  var parent_node = dragged_node.parent;\n\n  // If we're dropping on a leaf event we add the dragged event to the\n  // parent instead. In effect it will become a sibling of the target event.\n  if (!target_node.is_group()) target_node = target_node.parent;\n  var parent_id = null;\n  if (parent_node) parent_id = record_id(parent_node.record);\n  var selected_event_ids = dragged_node.forest.selected().map(function (it) {\n    return record_id(it.record);\n  });\n  var request = dragged_node.forest.create_request({\n    intl: intl\n  }.intl.formatMessage({\n    \"id\": \"Move\",\n    \"defaultMessage\": \"Move\"\n  }), {\n    event_ids: selected_event_ids,\n    to_event_id: record_id(target_node.record),\n    from_event_id: parent_id\n  });\n  dragged_node.forest.running_action({\n    move_events: request\n  });\n  _CommonScripts_sharedscripts_sharedscripts_yesplanapi__WEBPACK_IMPORTED_MODULE_1__[\"default\"].move_events(model, request).then(function () {\n    // We always expand the target event, so that the user can see the new\n    // child in place.\n    target_node.collapsed = false;\n    dragged_node.forest.running_action(null);\n  }).catch(function (error) {\n    handle_error(error);\n    dragged_node.get_tree().request_update();\n    dragged_node.forest.running_action(null);\n  });\n}\n\n// Move the event (ui) to become its own tree.\nfunction move_events_to_own_tree(dragged_node, model) {\n  var parent_node = dragged_node.parent;\n  var selected_event_ids = dragged_node.forest.selected().map(function (it) {\n    return record_id(it.record);\n  });\n  var request = dragged_node.forest.create_request({\n    intl: intl\n  }.intl.formatMessage({\n    \"id\": \"Move\",\n    \"defaultMessage\": \"Move\"\n  }), {\n    event_ids: selected_event_ids,\n    to_event_id: null,\n    from_event_id: record_id(parent_node.record)\n  });\n  dragged_node.forest.running_action({\n    move_events: request\n  });\n  _CommonScripts_sharedscripts_sharedscripts_yesplanapi__WEBPACK_IMPORTED_MODULE_1__[\"default\"].move_events(model, request).then(function () {\n    _.each(dragged_node.forest.selected(), function (node) {\n      dragged_node.forest.add_tree(node);\n    });\n    dragged_node.forest.request_update();\n    dragged_node.forest.running_action(null);\n  }).catch(function (error) {\n    handle_error(error);\n    dragged_node.forest.request_update();\n    dragged_node.forest.running_action(null);\n  });\n}\n\n// This calculates the height which would be required for a fully expanded\n// tree with the node for the record as its root.\n//\n// IMPORTANT: This should match the actual layout logic in\n// TreeView.prototype.calculate_node_positions as closely as possible.\nfunction required_height_for_subtree(record, model) {\n  if (!record_is_group(record)) return _constants__WEBPACK_IMPORTED_MODULE_0__.NODE.height;\n  var previous_was_group = true;\n  return children_of_record(record).reduce(function (height, child_id) {\n    var child = model.get(child_id);\n    var child_is_group = record_is_group(child);\n    if (previous_was_group || child_is_group) {\n      height += _constants__WEBPACK_IMPORTED_MODULE_0__.NODE.big_vertical_spacing;\n    } else {\n      height += _constants__WEBPACK_IMPORTED_MODULE_0__.NODE.vertical_spacing;\n    }\n    previous_was_group = child_is_group;\n    return height + required_height_for_subtree(child, model);\n  }, _constants__WEBPACK_IMPORTED_MODULE_0__.NODE.height);\n}\n\n// --------------------------------------------------------------------------\n// Handling errors\n\nfunction handle_error(error) {\n  // show_error_dialog(error)\n  alert(error);\n}\n\n// function show_error_dialog(error) {\n//  $('<div class=\"panel panel--modal panel--error\">\n//    <div class=\"panel-main\">\n//      <h1 class=\"panel-title\">'+i18n('INTERNAL ERROR')+'</h1>\n//      <p>'+error+'</p>\n//    </div>\n//    <div class=\"panel-footer\">\n//      <div class=\"pull-right\">\n//        <a href=\"#\" class=\"btn btn-primary\">'+i18n('restart session')+'</a>\n//      </div>\n//    </div>\n//  </div>\n// <div class=\"cover-lightbox\"></div>')\n\n// }\n\n// --------------------------------------------------------------------------\n// Utility functions/types\n\nfunction is_defined(x) {\n  return typeof x !== 'undefined';\n}\nfunction is_undefined(x) {\n  return typeof x === 'undefined';\n}\n\n// Compares events for sorting in the event tree. Ordering is by date, where\n// a group's date gets defined as the earliest date of any event withing that\n// group. In case of matching dates, ordering then is by name.\nfunction compare_by_announceddatetime_recursive_then_name(event_a_id, event_b_id, model) {\n  var a = model.get(event_a_id);\n  var b = model.get(event_b_id);\n  var date_a = announced_datetime_for_record(a, model);\n  var date_b = announced_datetime_for_record(b, model);\n  if (date_a === null) {\n    return -1;\n  } else if (date_b === null) {\n    return +1;\n  } else if (date_a.getTime() === date_b.getTime()) {\n    return (0,_common_stringSortOrder__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(a.name(), b.name());\n  } else {\n    return date_a - date_b;\n  }\n}\n\n// Compares events for ordering the insertion of the associated elements in\n// the DOM.\n//\n// I tried a z-index approach at first, but that is harder to maintain. In\n// particular it becomes hard to keep the z-index value within a certain\n// range as there may be many more elements than the range allows. Ordering\n// the elements' insertion order in the DOM does not have this issue.\n//\n// Cfr. https://github.com/mbostock/d3/issues/252\nfunction compare_for_layering(event_a, event_b) {\n  // The \"trick\" we're using is that the order we want (children below parent\n  // nodes, and non-stickied nodes below stickied ones) is solved by taking\n  // the different nodes in reverse visual order. So a node which is visually\n  // \"higher\" on the page (on the X axis) than another should also be\n  // visually \"above\" (on the Z axis) that node.\n  //\n  // Beware though: you need to use the logically calculated position (i.e.\n  // the one calculated in calculate_node_positions) rather than the actual\n  // one, as the latter will have been modified to resolve the scrolling.\n  return event_b.position.x - event_a.position.x;\n}\n\n// Function which returns a string equivalent of an int, but padded\n// with leading zeroes to an overall length of 2.\nfunction padded(i) {\n  if (i < 10) {\n    return \"0\".concat(i);\n  } else {\n    return \"\".concat(i);\n  }\n}\n\n// Function which creates an SVG path description for connecting two\n// events. Basically shaped like an 'L'.\nfunction svg_path_for_link(link) {\n  var sx = link.source.x + _constants__WEBPACK_IMPORTED_MODULE_0__.NODE.height - 2 + 0.5;\n  var sy = link.source.y + _constants__WEBPACK_IMPORTED_MODULE_0__.INDENT / 2 + 2 + 0.5;\n  var tx = link.target.x + _constants__WEBPACK_IMPORTED_MODULE_0__.NODE.height / 2 + 0.5;\n  var ty = link.target.y + 0.5;\n  if (sx >= tx) {\n    return \"M\".concat(sy, \" \").concat(sx, \" L\").concat(sy, \" \").concat(sx, \" \");\n  } else {\n    return \"M\".concat(sy, \" \").concat(sx, \" L\").concat(sy, \" \").concat(tx, \" L\").concat(ty, \" \").concat(tx);\n  }\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9UcmVldmlldy9ldmVudC10cmVldmlldy5qcy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTs7QUFHQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFJQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBOztBQUdBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUVBO0FBR0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFFQTtBQUdBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFDQTs7QUFHQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBS0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vUmVhY3RDb21wb25lbnRzXy8uL1RyZWV2aWV3L2V2ZW50LXRyZWV2aWV3LmpzP2MxM2MiXSwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50LWRpc2FibGUgY2FtZWxjYXNlICovXG4vKiBnbG9iYWwgZDMgUSAqL1xuXG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBUaGUgcmF3IGRhdGEgZm9yIHRoZSB0cmVldmlldyBjb21lcyBpbiB0aGUgZm9ybSBvZiByZWNvcmRzIChjZnIuXG4vLyB1aV9tb2RlbC5qcykuIEZvbGxvd2luZyBhY2Nlc3NvcnMgYWJzdHJhY3QgYXdheSBzb21lIG9mIHRoZWlyIGRldGFpbHMuXG5cbmltcG9ydCB7SU5ERU5ULCBOT0RFfSBmcm9tICcuL2NvbnN0YW50cyc7XG5pbXBvcnQgJHllc3BsYW4gZnJvbSAnLi4vQ29tbW9uU2NyaXB0cy9zaGFyZWRzY3JpcHRzL3NoYXJlZHNjcmlwdHMteWVzcGxhbmFwaSc7XG5pbXBvcnQgbnBTdHJpbmdTb3J0T3JkZXIgZnJvbSAnLi4vY29tbW9uL3N0cmluZ1NvcnRPcmRlcic7XG5cbmV4cG9ydCBmdW5jdGlvbiByZWNvcmRfaWQocmVjb3JkKSB7XG4gIHJldHVybiByZWNvcmQuJG1ldGEuaWQ7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZWNvcmRfaXNfZ3JvdXAocmVjb3JkKSB7XG4gIHJldHVybiBpc19kZWZpbmVkKHJlY29yZC5jKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNoaWxkcmVuX29mX3JlY29yZChyZWNvcmQpIHtcbiAgY29uc3QgY2hpbGRyZW4gPSByZWNvcmQuYygpO1xuICByZXR1cm4gY2hpbGRyZW4gfHwgW107XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBsZWFmX2NoaWxkcmVuX29mX3JlY29yZChyZWNvcmQpIHtcbiAgaWYgKHJlY29yZF9pc19ncm91cChyZWNvcmQpKSB7XG4gICAgcmV0dXJuIFtdLmNvbmNhdChyZWNvcmQuYygpLm1hcChsZWFmX2NoaWxkcmVuX29mX3JlY29yZCkpO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBbcmVjb3JkXTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2VuZXJpY19kYXRlX2Zvcl9yZWNvcmQocmVjb3JkLCBzZWxlY3RfZnVuY3Rpb24sIGNvbXBhcmVfZnVuY3Rpb24sIG1vZGVsKSB7XG4gIGlmIChyZWNvcmRfaXNfZ3JvdXAocmVjb3JkKSkge1xuICAgIGNvbnN0IGNoaWxkcmVuID0gY2hpbGRyZW5fb2ZfcmVjb3JkKHJlY29yZCk7XG5cbiAgICBsZXQgZGF0ZSA9IG51bGw7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgY2hpbGRfZGF0ZSA9IGdlbmVyaWNfZGF0ZV9mb3JfcmVjb3JkKG1vZGVsLmdldChjaGlsZHJlbltpXSksIHNlbGVjdF9mdW5jdGlvbiwgY29tcGFyZV9mdW5jdGlvbiwgbW9kZWwpO1xuICAgICAgaWYgKCFjaGlsZF9kYXRlKSBjb250aW51ZTtcblxuICAgICAgaWYgKCFkYXRlIHx8IGNvbXBhcmVfZnVuY3Rpb24oY2hpbGRfZGF0ZSwgZGF0ZSkpIGRhdGUgPSBjaGlsZF9kYXRlO1xuICAgIH1cblxuICAgIHJldHVybiBkYXRlO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBzZWxlY3RfZnVuY3Rpb24ocmVjb3JkKTtcbiAgfVxufVxuXG4vLyBBIHJlY29yZCdzIGRhdGUgaXMgZWl0aGVyIGRlZmluZWQgb24gdGhlIHJlY29yZCBpdHNlbGYgb3IsIGlmIGl0IGlzIGFcbi8vIGdyb3VwLCBkZWR1Y2VkIGZyb20gaXRzIGRlc2NlbmRhbnRzLlxuZXhwb3J0IGZ1bmN0aW9uIGRhdGVfZm9yX3JlY29yZChyZWNvcmQsIG1vZGVsKSB7XG4gIHJldHVybiBnZW5lcmljX2RhdGVfZm9yX3JlY29yZChyZWNvcmQsIChyZWNvcmQpID0+IHtcbiAgICBpZiAoaXNfZGVmaW5lZChyZWNvcmQuZCkpIHtcbiAgICAgIHJldHVybiBuZXcgRGF0ZShyZWNvcmQuZCgpKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICB9LCBmdW5jdGlvbihjaGlsZF9kYXRlLCBkYXRlKSB7XG4gICAgcmV0dXJuIGNoaWxkX2RhdGUgPCBkYXRlO1xuICB9LFxuICAgIG1vZGVsKTtcbn1cblxuLy8gQSByZWNvcmQncyBlbmQgZGF0ZSBpcyBlaXRoZXIgZXF1YWwgdG8gdGhlIHN0YXJ0IGRhdGUgKGZvciBldmVudHMpIG9yXG4vLyBkZWR1Y2VkIGZyb20gaXRzIGRlc2NlbmRhbnRzIGlmIGl0J3MgYSBncm91cFxuZXhwb3J0IGZ1bmN0aW9uIGVuZF9kYXRlX2Zvcl9yZWNvcmQocmVjb3JkLCBtb2RlbCkge1xuICByZXR1cm4gZ2VuZXJpY19kYXRlX2Zvcl9yZWNvcmQocmVjb3JkLFxuICAgIChyZWNvcmQpID0+IHtcbiAgICAgIGlmIChpc19kZWZpbmVkKHJlY29yZC5kKSkge1xuICAgICAgICByZXR1cm4gbmV3IERhdGUocmVjb3JkLmQoKSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICB9LFxuICAgIChjaGlsZF9kYXRlLCBkYXRlKSA9PiB7XG4gICAgICByZXR1cm4gY2hpbGRfZGF0ZSA+IGRhdGU7XG4gICAgfSxcbiAgICBtb2RlbCk7XG59XG5cbi8vIEEgcmVjb3JkJ3MgYW5ub3VuY2VkIGRhdGV0aW1lIGlzIGVpdGhlciBkZWZpbmVkIG9uIHRoZSByZWNvcmQgaXRzZWxmIG9yLCBpZiBpdCBpcyBhXG4vLyBncm91cCwgZGVkdWNlZCBmcm9tIGl0cyBkZXNjZW5kYW50cy5cbmV4cG9ydCBmdW5jdGlvbiBhbm5vdW5jZWRfZGF0ZXRpbWVfZm9yX3JlY29yZChyZWNvcmQsIG1vZGVsKSB7XG4gIGlmIChyZWNvcmRfaXNfZ3JvdXAocmVjb3JkKSkge1xuICAgIGNvbnN0IGNoaWxkcmVuID0gY2hpbGRyZW5fb2ZfcmVjb3JkKHJlY29yZCk7XG5cbiAgICBsZXQgZGF0ZSA9IG51bGw7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3QgY2hpbGRfZGF0ZSA9IGFubm91bmNlZF9kYXRldGltZV9mb3JfcmVjb3JkKG1vZGVsLmdldChjaGlsZHJlbltpXSksIG1vZGVsKTtcbiAgICAgIGlmICghY2hpbGRfZGF0ZSkgY29udGludWU7XG5cbiAgICAgIGlmICghZGF0ZSB8fCBjaGlsZF9kYXRlIDwgZGF0ZSkgZGF0ZSA9IGNoaWxkX2RhdGU7XG4gICAgfVxuXG4gICAgcmV0dXJuIGRhdGU7XG4gIH0gZWxzZSBpZiAoaXNfZGVmaW5lZChyZWNvcmQuYWR0KSkge1xuICAgIHJldHVybiBuZXcgRGF0ZShyZWNvcmQuYWR0KCkpO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBsb2NhdGlvbl9mb3JfcmVjb3JkKHJlY29yZCwgbW9kZWwpIHtcbiAgaWYgKCFyZWNvcmQgfHwgIXJlY29yZC5sb2MgfHwgIXJlY29yZC5sb2MoKSkge1xuICAgIHJldHVybiBudWxsO1xuICB9IGVsc2Uge1xuICAgIC8vIFRoZSBsb2NhdGlvbiBpcyBhIHJlY29yZCBpdHNlbGYuXG4gICAgY29uc3QgbG9jYXRpb24gPSBtb2RlbC5nZXQocmVjb3JkLmxvYygpLCBudWxsKTtcblxuICAgIC8vIFRPRE8gR2V0IHJpZCBvZiB0aGUgZmFsbGJhY2sgcGF0aCBvbmNlIGxvY2F0aW9ucyBhcmUgcHJvcGVybHkgc2hhcmVkIHdpdGhcbiAgICAvLyB0aGUgY2xpZW50IGFzIHJlY29yZHMuXG4gICAgaWYgKGxvY2F0aW9uKSB7XG4gICAgICByZXR1cm4gbG9jYXRpb247XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgICRtZXRhOiB7aWQ6IG51bGx9LFxuICAgICAgICBuYW1lKCkge1xuICAgICAgICAgIHJldHVybiByZWNvcmQubG9jKCk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzdGF0dXNfZm9yX3JlY29yZChyZWNvcmQpIHtcbiAgaWYgKCFyZWNvcmQgfHwgIXJlY29yZC5zdCB8fCAhcmVjb3JkLnN0KCkpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gcmVjb3JkLnN0KCk7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbmZsaWN0c19mb3JfcmVjb3JkKHJlY29yZCkge1xuICBpZiAoIXJlY29yZCB8fCAhcmVjb3JkLmNvbiB8fCAhcmVjb3JkLmNvbigpKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHJlY29yZC5jb24oKTtcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVjb3JkX2hhc19jb25mbGljdHMocmVjb3JkKSB7XG4gIGlmICghcmVjb3JkIHx8ICFyZWNvcmQuY29uIHx8ICFyZWNvcmQuY29uKCkpIHJldHVybiBmYWxzZTtcbiAgcmV0dXJuIE9iamVjdC5rZXlzKHJlY29yZC5jb24oKSkubGVuZ3RoID4gMDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHNldHRhYmxlX3N0YXR1c2VzX2Zvcl9yZWNvcmQocmVjb3JkKSB7XG4gIGlmICghcmVjb3JkIHx8ICFyZWNvcmQuc3QgfHwgIXJlY29yZC5jcygpKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHJlY29yZC5jcygpO1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwcm9maWxlX2Zvcl9yZWNvcmQocmVjb3JkKSB7XG4gIGlmICghcmVjb3JkIHx8ICFyZWNvcmQucHIgfHwgIXJlY29yZC5wcigpKSByZXR1cm4gbnVsbDtcbiAgcmV0dXJuIHJlY29yZC5wcigpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVjb3JkX2hhc19sb2NrKHJlY29yZCkge1xuICByZXR1cm4gcmVjb3JkLmwgJiYgcmVjb3JkLmwoKSA9PT0gJ2xvY2snO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVjb3JkX2hhc19hY3R1YWxfbG9jayhyZWNvcmQpIHtcbiAgcmV0dXJuIHJlY29yZC5sICYmIHJlY29yZC5sKCkgPT09ICdhY3R1YWwnO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVjb3JkX2Nhbl9iZV93cml0dGVuKHJlY29yZCkge1xuICByZXR1cm4gcmVjb3JkLnBlICYmIHJlY29yZC5wZSgpLmluZGV4T2YoJ3cnKSA+PSAwO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVjb3JkX2Nhbl9iZV9kZWxldGVkKHJlY29yZCkge1xuICByZXR1cm4gcmVjb3JkLnBlICYmIHJlY29yZC5wZSgpLmluZGV4T2YoJ2QnKSA+PSAwO1xufVxuXG4vLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gVGhlIHRyZWV2aWV3IG1vZGVsXG4vL1xuLy8gQSB0cmVldmlldyBiYXNpY2FsbHkgY29uc2lzdHMgb2YgdGhyZWUgbGV2ZWxzOlxuLy8gKiB0aGUgRm9yZXN0LCB3aGljaCBpcyB0aGUgcm9vdCBvZiBldmVyeXRoaW5nLFxuLy8gKiB0aGUgaW5kaXZpZHVhbCBUcmVlcywgYW5kXG4vLyAqIHRoZSBOb2RlcyB3aGljaCBtYWtlIHVwIGEgVHJlZS5cblxuXG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBBY3R1YWwgRDMgdHJlZSBzZXR1cFxuXG4vLyBEMyBhY2Nlc3NvcnMuIFRoZXNlIGFyZSBmdW5jdGlvbmFsIHZlcnNpb25zIG9mIHRoZSBkaWZmZXJlbnQgTm9kZSBtZXRob2RzLlxuZXhwb3J0IGZ1bmN0aW9uIG5vZGVfa2V5KG5vZGUpIHtcbiAgcmV0dXJuIG5vZGUuZ2V0X2tleSgpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbm9kZV9pc19wcm9kdWN0aW9uKG5vZGUpIHtcbiAgcmV0dXJuIG5vZGUuaXNfcHJvZHVjdGlvbigpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbm9kZV9oYXNfY29uZmxpY3RzKG5vZGUpIHtcbiAgcmV0dXJuIG5vZGUuaGFzX2NvbmZsaWN0cygpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaGFzX25vZGVzX3dpdGhfY29uZmxpY3RzKG5vZGUpIHtcbiAgcmV0dXJuIG5vZGUuaGFzX25vZGVzX3dpdGhfY29uZmxpY3RzKCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBub2RlX2NvbmZsaWN0cyhub2RlKSB7XG4gIHJldHVybiBub2RlLmNvbmZsaWN0cygpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbm9kZV9pc19kYXRlZChub2RlKSB7XG4gIHJldHVybiBub2RlLmlzX2RhdGVkKCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBub2RlX2hhc19sb2NrKG5vZGUpIHtcbiAgcmV0dXJuIG5vZGUuaGFzX2xvY2soKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG5vZGVfaGFzX2FjdHVhbF9sb2NrKG5vZGUpIHtcbiAgcmV0dXJuIG5vZGUuaGFzX2FjdHVhbF9sb2NrKCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBub2RlX2lzX2dyb3VwKG5vZGUpIHtcbiAgcmV0dXJuIG5vZGUuaXNfZ3JvdXAoKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldF9ub2RlX25hbWUobm9kZSkge1xuICByZXR1cm4gbm9kZS5nZXRfbmFtZV93aXRoX2FiYnJldmlhdGlvbigpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY2xhc3Nlc19mb3Jfbm9kZShub2RlKSB7XG4gIHJldHVybiBub2RlLmdldF9jbGFzc2VzKCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBub2RlX3RpdGxlc3RyaW5nKG5vZGUsIG1vZGVsKSB7XG4gIGNvbnN0IGxvY2F0aW9uID0gbG9jYXRpb25fZm9yX3JlY29yZChub2RlLnJlY29yZCwgbW9kZWwpO1xuXG4gIGlmICghbG9jYXRpb24gfHwgcmVjb3JkX2lzX2dyb3VwKG5vZGUucmVjb3JkKSkgcmV0dXJuIG51bGw7XG5cbiAgY29uc3QgbmFtZSA9IG5vZGUuZ2V0X25hbWUoKTtcbiAgcmV0dXJuIGAke25hbWV9IOKAkyAke25vZGUucmVjb3JkLmFkcygpfSDigJMgJHtsb2NhdGlvbi5uYW1lKCl9YDtcbn1cblxuXG4vLyBXaGV0aGVyIG9yIG5vdCBhbiBldmVudCBjYW4gYWNjZXB0IGFub3RoZXIgZXZlbnQgYXMgYSBjaGlsZC5cbmV4cG9ydCBmdW5jdGlvbiBpc19sZWdhbF9kcm9wX3RhcmdldCh0YXJnZXRfbm9kZSwgZHJhZ2dlZF9ub2RlKSB7XG4gIGlmICh0YXJnZXRfbm9kZS5mb3Jlc3QgIT09IGRyYWdnZWRfbm9kZS5mb3Jlc3QpIHJldHVybiBmYWxzZTtcblxuICBpZiAodGFyZ2V0X25vZGUgPT09IGRyYWdnZWRfbm9kZSkgcmV0dXJuIGZhbHNlO1xuXG4gIGlmICh0YXJnZXRfbm9kZS5pc19wbGFjZWhvbGRlcigpKSByZXR1cm4gZmFsc2U7XG5cbiAgLy8gSWYgdGhlIGV2ZW50IGlzIGEgbGVhZiBldmVudCwgdGhlbiBpdCBpcyBvbmx5IGRyb3BwYWJsZSBpZiBpdCBpcyBub3QgYSByb290LCBhbmQgaXRzIHBhcmVudCBjYW4gYmUgZHJvcHBlZCBvblxuICBpZiAodGFyZ2V0X25vZGUuaXNfbGVhZmV2ZW50KCkpIHtcbiAgICBpZiAodGFyZ2V0X25vZGUuaXNfcm9vdCgpKSByZXR1cm4gZmFsc2U7XG4gICAgaWYgKCFyZWNvcmRfY2FuX2JlX3dyaXR0ZW4odGFyZ2V0X25vZGUucGFyZW50LnJlY29yZCkpIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIC8vIFdlIG5lZWQgdG8gaGF2ZSB3cml0ZSBwZXJtaXNzaW9ucyB0byBkcm9wIG9uIGFuIGV2ZW50XG4gIGlmICghcmVjb3JkX2Nhbl9iZV93cml0dGVuKHRhcmdldF9ub2RlLnJlY29yZCkpIHJldHVybiBmYWxzZTtcblxuICAvLyBZb3UgY2FuJ3QgbW92ZSBhbiBldmVudCB0byBvbmUgb2YgaXRzIG93biBzdWJ0cmVlcy4gU28gd2UgbmVlZCB0byBjaGVja1xuICAvLyBmb3IgY3ljbGVzIGhlcmUuXG4gIGxldCBlID0gdGFyZ2V0X25vZGUucGFyZW50O1xuICB3aGlsZSAoZSkge1xuICAgIGlmIChlID09PSBkcmFnZ2VkX25vZGUpIHJldHVybiBmYWxzZTtcbiAgICBlID0gZS5wYXJlbnQ7XG4gIH1cblxuICByZXR1cm4gdHJ1ZTtcbn1cblxuLy8gV2hlbiBob3ZlcmluZyBvdmVyIGEgZHJvcHBhYmxlIHRhcmdldCBpdHMgZ3JvdXAgc2hvdWxkIGdldCBoaWdobGlnaHRlZC5cbi8vIElmIHRoZSBncm91cCBpcyBleHBhbmRlZCB0aGVuIHRoZSBsaW5rcyBzaG91bGQgYWxzbyBnZXQgaGlnaGxpZ2h0ZWQuXG5sZXQgaGlnaGxpZ2h0ZWRfZXZlbnRzID0gbnVsbDtcbmxldCBoaWdobGlnaHRlZF9saW5rcyA9IG51bGw7XG5cbmV4cG9ydCBmdW5jdGlvbiBoaWdobGlnaHRfZHJvcF90YXJnZXRzKHRhcmdldF9lbGVtZW50LCB0YXJnZXRfbm9kZSkge1xuICB1bmhpZ2hsaWdodF9kcm9wX3RhcmdldHMoKTtcbiAgaGlnaGxpZ2h0ZWRfZXZlbnRzID0gZDMuc2VsZWN0KHRhcmdldF9lbGVtZW50KTtcblxuICBpZiAoIXRhcmdldF9ub2RlLmlzX2dyb3VwKCkgJiYgdGFyZ2V0X25vZGUucGFyZW50ICE9PSBudWxsKSB7XG4gICAgdGFyZ2V0X25vZGUgPSB0YXJnZXRfbm9kZS5wYXJlbnQ7XG5cbiAgICBoaWdobGlnaHRlZF9ldmVudHMgPSBkMy5zZWxlY3RBbGwoJ2Rpdi50cmVlLWV2ZW50JykuZmlsdGVyKGZ1bmN0aW9uKGl0KSB7XG4gICAgICByZXR1cm4gaXQgJiYgaXQgPT09IHRhcmdldF9ub2RlO1xuICAgIH0pO1xuICB9XG5cbiAgaWYgKCF0YXJnZXRfbm9kZS5jb2xsYXBzZWQpIHtcbiAgICBoaWdobGlnaHRlZF9saW5rcyA9IGQzLnNlbGVjdEFsbCgncGF0aC5saW5rJykuZmlsdGVyKGZ1bmN0aW9uKGl0KSB7XG4gICAgICByZXR1cm4gaXQgJiYgaXQuc291cmNlLmRhdGEgPT09IHRhcmdldF9ub2RlO1xuICAgIH0pO1xuXG4gICAgaGlnaGxpZ2h0ZWRfbGlua3MuY2xhc3NlZCgnaGlnaGxpZ2h0JywgdHJ1ZSk7XG4gIH1cblxuICBoaWdobGlnaHRlZF9ldmVudHMuY2xhc3NlZCgnaGlnaGxpZ2h0JywgdHJ1ZSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB1bmhpZ2hsaWdodF9kcm9wX3RhcmdldHMoKSB7XG4gIGlmIChoaWdobGlnaHRlZF9ldmVudHMpIHtcbiAgICBoaWdobGlnaHRlZF9ldmVudHMuY2xhc3NlZCgnaGlnaGxpZ2h0JywgZmFsc2UpO1xuICAgIGhpZ2hsaWdodGVkX2V2ZW50cyA9IG51bGw7XG4gIH1cblxuICBpZiAoaGlnaGxpZ2h0ZWRfbGlua3MpIHtcbiAgICBoaWdobGlnaHRlZF9saW5rcy5jbGFzc2VkKCdoaWdobGlnaHQnLCBmYWxzZSk7XG4gICAgaGlnaGxpZ2h0ZWRfbGlua3MgPSBudWxsO1xuICB9XG59XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBPdGhlciBpbnRlcmFjdGlvbnNcblxuLy8gTW92ZSB0aGUgZXZlbnQgdG8gYmVjb21lIGEgY2hpbGQgb2YgdGhlIHRhcmdldCBldmVudC5cbmV4cG9ydCBmdW5jdGlvbiBtb3ZlX2V2ZW50c190b190YXJnZXQoZHJhZ2dlZF9ub2RlLCB0YXJnZXRfbm9kZSwgbW9kZWwpIHtcbiAgdW5oaWdobGlnaHRfZHJvcF90YXJnZXRzKCk7XG5cbiAgLy8gICAgaWYgKHRhcmdldF9ub2RlLmZvcmVzdC5oYXNfdHJlZSh0YXJnZXRfbm9kZSkpXG4gIC8vICAgICAgdGFyZ2V0X25vZGUuZm9yZXN0LnJlbW92ZV90cmVlKHRhcmdldF9ub2RlKVxuXG4gIGNvbnN0IHBhcmVudF9ub2RlID0gZHJhZ2dlZF9ub2RlLnBhcmVudDtcblxuICAvLyBJZiB3ZSdyZSBkcm9wcGluZyBvbiBhIGxlYWYgZXZlbnQgd2UgYWRkIHRoZSBkcmFnZ2VkIGV2ZW50IHRvIHRoZVxuICAvLyBwYXJlbnQgaW5zdGVhZC4gSW4gZWZmZWN0IGl0IHdpbGwgYmVjb21lIGEgc2libGluZyBvZiB0aGUgdGFyZ2V0IGV2ZW50LlxuICBpZiAoIXRhcmdldF9ub2RlLmlzX2dyb3VwKCkpIHRhcmdldF9ub2RlID0gdGFyZ2V0X25vZGUucGFyZW50O1xuXG4gIGxldCBwYXJlbnRfaWQgPSBudWxsO1xuICBpZiAocGFyZW50X25vZGUpIHBhcmVudF9pZCA9IHJlY29yZF9pZChwYXJlbnRfbm9kZS5yZWNvcmQpO1xuXG4gIGNvbnN0IHNlbGVjdGVkX2V2ZW50X2lkcyA9IGRyYWdnZWRfbm9kZS5mb3Jlc3Quc2VsZWN0ZWQoKS5tYXAoKGl0KSA9PiB7XG4gICAgcmV0dXJuIHJlY29yZF9pZChpdC5yZWNvcmQpO1xuICB9KTtcblxuICBjb25zdCByZXF1ZXN0ID0gZHJhZ2dlZF9ub2RlLmZvcmVzdC5jcmVhdGVfcmVxdWVzdChpMThuKCdNb3ZlJyksIHtcbiAgICBldmVudF9pZHM6IHNlbGVjdGVkX2V2ZW50X2lkcyxcbiAgICB0b19ldmVudF9pZDogcmVjb3JkX2lkKHRhcmdldF9ub2RlLnJlY29yZCksXG4gICAgZnJvbV9ldmVudF9pZDogcGFyZW50X2lkXG4gIH0pO1xuICBkcmFnZ2VkX25vZGUuZm9yZXN0LnJ1bm5pbmdfYWN0aW9uKHttb3ZlX2V2ZW50czogcmVxdWVzdH0pO1xuXG4gICR5ZXNwbGFuXG4gICAgLm1vdmVfZXZlbnRzKG1vZGVsLCByZXF1ZXN0KVxuICAgIC50aGVuKCgpID0+IHtcbiAgICAgIC8vIFdlIGFsd2F5cyBleHBhbmQgdGhlIHRhcmdldCBldmVudCwgc28gdGhhdCB0aGUgdXNlciBjYW4gc2VlIHRoZSBuZXdcbiAgICAgIC8vIGNoaWxkIGluIHBsYWNlLlxuICAgICAgdGFyZ2V0X25vZGUuY29sbGFwc2VkID0gZmFsc2U7XG5cbiAgICAgIGRyYWdnZWRfbm9kZS5mb3Jlc3QucnVubmluZ19hY3Rpb24obnVsbCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICBoYW5kbGVfZXJyb3IoZXJyb3IpO1xuICAgICAgZHJhZ2dlZF9ub2RlLmdldF90cmVlKCkucmVxdWVzdF91cGRhdGUoKTtcblxuICAgICAgZHJhZ2dlZF9ub2RlLmZvcmVzdC5ydW5uaW5nX2FjdGlvbihudWxsKTtcbiAgICB9KVxufVxuXG4vLyBNb3ZlIHRoZSBldmVudCAodWkpIHRvIGJlY29tZSBpdHMgb3duIHRyZWUuXG5leHBvcnQgZnVuY3Rpb24gbW92ZV9ldmVudHNfdG9fb3duX3RyZWUoZHJhZ2dlZF9ub2RlLCBtb2RlbCkge1xuICBjb25zdCBwYXJlbnRfbm9kZSA9IGRyYWdnZWRfbm9kZS5wYXJlbnQ7XG5cbiAgY29uc3Qgc2VsZWN0ZWRfZXZlbnRfaWRzID0gZHJhZ2dlZF9ub2RlLmZvcmVzdC5zZWxlY3RlZCgpLm1hcChmdW5jdGlvbihpdCkge1xuICAgIHJldHVybiByZWNvcmRfaWQoaXQucmVjb3JkKTtcbiAgfSk7XG5cbiAgY29uc3QgcmVxdWVzdCA9IGRyYWdnZWRfbm9kZS5mb3Jlc3QuY3JlYXRlX3JlcXVlc3QoaTE4bignTW92ZScpLCB7XG4gICAgZXZlbnRfaWRzOiBzZWxlY3RlZF9ldmVudF9pZHMsXG4gICAgdG9fZXZlbnRfaWQ6IG51bGwsXG4gICAgZnJvbV9ldmVudF9pZDogcmVjb3JkX2lkKHBhcmVudF9ub2RlLnJlY29yZClcbiAgfSk7XG4gIGRyYWdnZWRfbm9kZS5mb3Jlc3QucnVubmluZ19hY3Rpb24oe21vdmVfZXZlbnRzOiByZXF1ZXN0fSk7XG5cbiAgJHllc3BsYW5cbiAgICAubW92ZV9ldmVudHMobW9kZWwsIHJlcXVlc3QpXG4gICAgLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICBfLmVhY2goZHJhZ2dlZF9ub2RlLmZvcmVzdC5zZWxlY3RlZCgpLCBmdW5jdGlvbihub2RlKSB7XG4gICAgICAgIGRyYWdnZWRfbm9kZS5mb3Jlc3QuYWRkX3RyZWUobm9kZSk7XG4gICAgICB9KTtcblxuICAgICAgZHJhZ2dlZF9ub2RlLmZvcmVzdC5yZXF1ZXN0X3VwZGF0ZSgpO1xuICAgICAgZHJhZ2dlZF9ub2RlLmZvcmVzdC5ydW5uaW5nX2FjdGlvbihudWxsKTtcbiAgICB9KVxuICAgIC5jYXRjaChmdW5jdGlvbihlcnJvcikge1xuICAgICAgaGFuZGxlX2Vycm9yKGVycm9yKTtcbiAgICAgIGRyYWdnZWRfbm9kZS5mb3Jlc3QucmVxdWVzdF91cGRhdGUoKTtcblxuICAgICAgZHJhZ2dlZF9ub2RlLmZvcmVzdC5ydW5uaW5nX2FjdGlvbihudWxsKTtcbiAgICB9KVxufVxuXG4vLyBUaGlzIGNhbGN1bGF0ZXMgdGhlIGhlaWdodCB3aGljaCB3b3VsZCBiZSByZXF1aXJlZCBmb3IgYSBmdWxseSBleHBhbmRlZFxuLy8gdHJlZSB3aXRoIHRoZSBub2RlIGZvciB0aGUgcmVjb3JkIGFzIGl0cyByb290LlxuLy9cbi8vIElNUE9SVEFOVDogVGhpcyBzaG91bGQgbWF0Y2ggdGhlIGFjdHVhbCBsYXlvdXQgbG9naWMgaW5cbi8vIFRyZWVWaWV3LnByb3RvdHlwZS5jYWxjdWxhdGVfbm9kZV9wb3NpdGlvbnMgYXMgY2xvc2VseSBhcyBwb3NzaWJsZS5cbmV4cG9ydCBmdW5jdGlvbiByZXF1aXJlZF9oZWlnaHRfZm9yX3N1YnRyZWUocmVjb3JkLCBtb2RlbCkge1xuICBpZiAoIXJlY29yZF9pc19ncm91cChyZWNvcmQpKSByZXR1cm4gTk9ERS5oZWlnaHQ7XG5cbiAgbGV0IHByZXZpb3VzX3dhc19ncm91cCA9IHRydWU7XG4gIHJldHVybiBjaGlsZHJlbl9vZl9yZWNvcmQocmVjb3JkKS5yZWR1Y2UoZnVuY3Rpb24oaGVpZ2h0LCBjaGlsZF9pZCkge1xuICAgIGNvbnN0IGNoaWxkID0gbW9kZWwuZ2V0KGNoaWxkX2lkKTtcbiAgICBjb25zdCBjaGlsZF9pc19ncm91cCA9IHJlY29yZF9pc19ncm91cChjaGlsZCk7XG5cbiAgICBpZiAocHJldmlvdXNfd2FzX2dyb3VwIHx8IGNoaWxkX2lzX2dyb3VwKSB7XG4gICAgICBoZWlnaHQgKz0gTk9ERS5iaWdfdmVydGljYWxfc3BhY2luZztcbiAgICB9IGVsc2Uge1xuICAgICAgaGVpZ2h0ICs9IE5PREUudmVydGljYWxfc3BhY2luZztcbiAgICB9XG5cbiAgICBwcmV2aW91c193YXNfZ3JvdXAgPSBjaGlsZF9pc19ncm91cDtcblxuICAgIHJldHVybiBoZWlnaHQgKyByZXF1aXJlZF9oZWlnaHRfZm9yX3N1YnRyZWUoY2hpbGQsIG1vZGVsKTtcbiAgfSwgTk9ERS5oZWlnaHQpO1xufVxuXG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBIYW5kbGluZyBlcnJvcnNcblxuZXhwb3J0IGZ1bmN0aW9uIGhhbmRsZV9lcnJvcihlcnJvcikge1xuICAvLyBzaG93X2Vycm9yX2RpYWxvZyhlcnJvcilcbiAgYWxlcnQoZXJyb3IpO1xufVxuXG4vLyBmdW5jdGlvbiBzaG93X2Vycm9yX2RpYWxvZyhlcnJvcikge1xuLy8gICQoJzxkaXYgY2xhc3M9XCJwYW5lbCBwYW5lbC0tbW9kYWwgcGFuZWwtLWVycm9yXCI+XG4vLyAgICA8ZGl2IGNsYXNzPVwicGFuZWwtbWFpblwiPlxuLy8gICAgICA8aDEgY2xhc3M9XCJwYW5lbC10aXRsZVwiPicraTE4bignSU5URVJOQUwgRVJST1InKSsnPC9oMT5cbi8vICAgICAgPHA+JytlcnJvcisnPC9wPlxuLy8gICAgPC9kaXY+XG4vLyAgICA8ZGl2IGNsYXNzPVwicGFuZWwtZm9vdGVyXCI+XG4vLyAgICAgIDxkaXYgY2xhc3M9XCJwdWxsLXJpZ2h0XCI+XG4vLyAgICAgICAgPGEgaHJlZj1cIiNcIiBjbGFzcz1cImJ0biBidG4tcHJpbWFyeVwiPicraTE4bigncmVzdGFydCBzZXNzaW9uJykrJzwvYT5cbi8vICAgICAgPC9kaXY+XG4vLyAgICA8L2Rpdj5cbi8vICA8L2Rpdj5cbi8vIDxkaXYgY2xhc3M9XCJjb3Zlci1saWdodGJveFwiPjwvZGl2PicpXG5cbi8vIH1cblxuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIFV0aWxpdHkgZnVuY3Rpb25zL3R5cGVzXG5cbmV4cG9ydCBmdW5jdGlvbiBpc19kZWZpbmVkKHgpIHtcbiAgcmV0dXJuIHR5cGVvZiB4ICE9PSAndW5kZWZpbmVkJztcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzX3VuZGVmaW5lZCh4KSB7XG4gIHJldHVybiB0eXBlb2YgeCA9PT0gJ3VuZGVmaW5lZCc7XG59XG5cbi8vIENvbXBhcmVzIGV2ZW50cyBmb3Igc29ydGluZyBpbiB0aGUgZXZlbnQgdHJlZS4gT3JkZXJpbmcgaXMgYnkgZGF0ZSwgd2hlcmVcbi8vIGEgZ3JvdXAncyBkYXRlIGdldHMgZGVmaW5lZCBhcyB0aGUgZWFybGllc3QgZGF0ZSBvZiBhbnkgZXZlbnQgd2l0aGluZyB0aGF0XG4vLyBncm91cC4gSW4gY2FzZSBvZiBtYXRjaGluZyBkYXRlcywgb3JkZXJpbmcgdGhlbiBpcyBieSBuYW1lLlxuZXhwb3J0IGZ1bmN0aW9uIGNvbXBhcmVfYnlfYW5ub3VuY2VkZGF0ZXRpbWVfcmVjdXJzaXZlX3RoZW5fbmFtZShcbiAgZXZlbnRfYV9pZCxcbiAgZXZlbnRfYl9pZCxcbiAgbW9kZWxcbikge1xuICBjb25zdCBhID0gbW9kZWwuZ2V0KGV2ZW50X2FfaWQpO1xuICBjb25zdCBiID0gbW9kZWwuZ2V0KGV2ZW50X2JfaWQpO1xuXG4gIGNvbnN0IGRhdGVfYSA9IGFubm91bmNlZF9kYXRldGltZV9mb3JfcmVjb3JkKGEsIG1vZGVsKTtcbiAgY29uc3QgZGF0ZV9iID0gYW5ub3VuY2VkX2RhdGV0aW1lX2Zvcl9yZWNvcmQoYiwgbW9kZWwpO1xuXG4gIGlmIChkYXRlX2EgPT09IG51bGwpIHtcbiAgICByZXR1cm4gLTE7XG4gIH0gZWxzZSBpZiAoZGF0ZV9iID09PSBudWxsKSB7XG4gICAgcmV0dXJuICsxO1xuICB9IGVsc2UgaWYgKGRhdGVfYS5nZXRUaW1lKCkgPT09IGRhdGVfYi5nZXRUaW1lKCkpIHtcbiAgICByZXR1cm4gbnBTdHJpbmdTb3J0T3JkZXIoYS5uYW1lKCksIGIubmFtZSgpKTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gZGF0ZV9hIC0gZGF0ZV9iO1xuICB9XG59XG5cbi8vIENvbXBhcmVzIGV2ZW50cyBmb3Igb3JkZXJpbmcgdGhlIGluc2VydGlvbiBvZiB0aGUgYXNzb2NpYXRlZCBlbGVtZW50cyBpblxuLy8gdGhlIERPTS5cbi8vXG4vLyBJIHRyaWVkIGEgei1pbmRleCBhcHByb2FjaCBhdCBmaXJzdCwgYnV0IHRoYXQgaXMgaGFyZGVyIHRvIG1haW50YWluLiBJblxuLy8gcGFydGljdWxhciBpdCBiZWNvbWVzIGhhcmQgdG8ga2VlcCB0aGUgei1pbmRleCB2YWx1ZSB3aXRoaW4gYSBjZXJ0YWluXG4vLyByYW5nZSBhcyB0aGVyZSBtYXkgYmUgbWFueSBtb3JlIGVsZW1lbnRzIHRoYW4gdGhlIHJhbmdlIGFsbG93cy4gT3JkZXJpbmdcbi8vIHRoZSBlbGVtZW50cycgaW5zZXJ0aW9uIG9yZGVyIGluIHRoZSBET00gZG9lcyBub3QgaGF2ZSB0aGlzIGlzc3VlLlxuLy9cbi8vIENmci4gaHR0cHM6Ly9naXRodWIuY29tL21ib3N0b2NrL2QzL2lzc3Vlcy8yNTJcbmV4cG9ydCBmdW5jdGlvbiBjb21wYXJlX2Zvcl9sYXllcmluZyhldmVudF9hLCBldmVudF9iKSB7XG4gIC8vIFRoZSBcInRyaWNrXCIgd2UncmUgdXNpbmcgaXMgdGhhdCB0aGUgb3JkZXIgd2Ugd2FudCAoY2hpbGRyZW4gYmVsb3cgcGFyZW50XG4gIC8vIG5vZGVzLCBhbmQgbm9uLXN0aWNraWVkIG5vZGVzIGJlbG93IHN0aWNraWVkIG9uZXMpIGlzIHNvbHZlZCBieSB0YWtpbmdcbiAgLy8gdGhlIGRpZmZlcmVudCBub2RlcyBpbiByZXZlcnNlIHZpc3VhbCBvcmRlci4gU28gYSBub2RlIHdoaWNoIGlzIHZpc3VhbGx5XG4gIC8vIFwiaGlnaGVyXCIgb24gdGhlIHBhZ2UgKG9uIHRoZSBYIGF4aXMpIHRoYW4gYW5vdGhlciBzaG91bGQgYWxzbyBiZVxuICAvLyB2aXN1YWxseSBcImFib3ZlXCIgKG9uIHRoZSBaIGF4aXMpIHRoYXQgbm9kZS5cbiAgLy9cbiAgLy8gQmV3YXJlIHRob3VnaDogeW91IG5lZWQgdG8gdXNlIHRoZSBsb2dpY2FsbHkgY2FsY3VsYXRlZCBwb3NpdGlvbiAoaS5lLlxuICAvLyB0aGUgb25lIGNhbGN1bGF0ZWQgaW4gY2FsY3VsYXRlX25vZGVfcG9zaXRpb25zKSByYXRoZXIgdGhhbiB0aGUgYWN0dWFsXG4gIC8vIG9uZSwgYXMgdGhlIGxhdHRlciB3aWxsIGhhdmUgYmVlbiBtb2RpZmllZCB0byByZXNvbHZlIHRoZSBzY3JvbGxpbmcuXG4gIHJldHVybiBldmVudF9iLnBvc2l0aW9uLnggLSBldmVudF9hLnBvc2l0aW9uLng7XG59XG5cbi8vIEZ1bmN0aW9uIHdoaWNoIHJldHVybnMgYSBzdHJpbmcgZXF1aXZhbGVudCBvZiBhbiBpbnQsIGJ1dCBwYWRkZWRcbi8vIHdpdGggbGVhZGluZyB6ZXJvZXMgdG8gYW4gb3ZlcmFsbCBsZW5ndGggb2YgMi5cbmV4cG9ydCBmdW5jdGlvbiBwYWRkZWQoaSkge1xuICBpZiAoaSA8IDEwKSB7XG4gICAgcmV0dXJuIGAwJHtpfWA7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGAke2l9YDtcbiAgfVxufVxuXG4vLyBGdW5jdGlvbiB3aGljaCBjcmVhdGVzIGFuIFNWRyBwYXRoIGRlc2NyaXB0aW9uIGZvciBjb25uZWN0aW5nIHR3b1xuLy8gZXZlbnRzLiBCYXNpY2FsbHkgc2hhcGVkIGxpa2UgYW4gJ0wnLlxuZXhwb3J0IGZ1bmN0aW9uIHN2Z19wYXRoX2Zvcl9saW5rKGxpbmspIHtcbiAgY29uc3Qgc3ggPSBsaW5rLnNvdXJjZS54ICsgTk9ERS5oZWlnaHQgLSAyICsgMC41O1xuICBjb25zdCBzeSA9IGxpbmsuc291cmNlLnkgKyBJTkRFTlQgLyAyICsgMiArIDAuNTtcblxuICBjb25zdCB0eCA9IGxpbmsudGFyZ2V0LnggKyBOT0RFLmhlaWdodCAvIDIgKyAwLjU7XG4gIGNvbnN0IHR5ID0gbGluay50YXJnZXQueSArIDAuNTtcblxuICBpZiAoc3ggPj0gdHgpIHtcbiAgICByZXR1cm4gYE0ke3N5fSAke3N4fSBMJHtzeX0gJHtzeH0gYDtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gKGBNJHtzeX0gJHtzeH0gTCR7c3l9ICR7dHh9IEwke3R5fSAke3R4fWApO1xuICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./Treeview/event-treeview.js\n");

/***/ }),

/***/ "./Treeview/tree_selections.js":
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"deselect_node\": function() { return /* binding */ deselect_node; },\n/* harmony export */   \"deselect_subtree\": function() { return /* binding */ deselect_subtree; },\n/* harmony export */   \"mark_children_parent_selected\": function() { return /* binding */ mark_children_parent_selected; },\n/* harmony export */   \"select_node\": function() { return /* binding */ select_node; },\n/* harmony export */   \"single_select_node\": function() { return /* binding */ single_select_node; },\n/* harmony export */   \"start_editing_event_name\": function() { return /* binding */ start_editing_event_name; },\n/* harmony export */   \"toggle_visibility_of_subtree\": function() { return /* binding */ toggle_visibility_of_subtree; },\n/* harmony export */   \"unmark_children_parent_selected\": function() { return /* binding */ unmark_children_parent_selected; }\n/* harmony export */ });\n/* harmony import */ var _PlaceholderNode__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./Treeview/PlaceholderNode.js\");\n/* harmony import */ var _event_treeview__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./Treeview/event-treeview.js\");\n/* harmony import */ var _CommonScripts_sharedscripts_sharedscripts_yesplanapi__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"./CommonScripts/sharedscripts/sharedscripts-yesplanapi.js\");\n/* eslint-disable camelcase */\n\n\n\n\n/* eslint-disable camelcase */\nfunction mark_children_parent_selected(node) {\n  if (node instanceof _PlaceholderNode__WEBPACK_IMPORTED_MODULE_0__[\"default\"]) return;\n\n  // Mark the links below this node\n  if (!node.collapsed) {\n    var links = d3.selectAll('path.link').filter(function (it) {\n      return it && it.source.data === node;\n    });\n    links.classed('parent-selected', true);\n  }\n\n  // Mark all children of the node, recursively\n  _.each(node.subnodes, function (child) {\n    if (child.element) {\n      child.element.addClass('parent-selected');\n      mark_children_parent_selected(child);\n    }\n  });\n}\nfunction unmark_children_parent_selected(node) {\n  if (node instanceof _PlaceholderNode__WEBPACK_IMPORTED_MODULE_0__[\"default\"]) return;\n\n  // Do not unmark parent-selected if node is selected or is itself parent-selected\n  if (node.selected || node.hasselectedancestor()) return;\n\n  // Unmark the links below this node\n  if (!node.collapsed) {\n    var links = d3.selectAll('path.link').filter(function (it) {\n      return it && it.source.data === node;\n    });\n    links.classed('parent-selected', false);\n  }\n\n  // Unmark all children of the node, recursively\n  _.each(node.subnodes, function (child) {\n    if (child.element) {\n      child.element.removeClass('parent-selected');\n      unmark_children_parent_selected(child);\n    }\n  });\n}\n\n// Select a certain event (group).\n// This only triggers a CSS update.\nfunction select_node(node) {\n  if (node instanceof _PlaceholderNode__WEBPACK_IMPORTED_MODULE_0__[\"default\"]) return;\n\n  // Prevent selecting the node again (otherwise duplicates will appear in the selected set)\n  if (!node.selected) {\n    node.forest.selected.push(node);\n    node.selected = true;\n    if (node.element) {\n      node.element.addClass('selected');\n      mark_children_parent_selected(node);\n    }\n  }\n  // console.log('selection: '+ node.forest.selected().map(function(it) { return it.record.name() }))\n}\n\n// Select a single event (first deselects existing)\nfunction single_select_node(node) {\n  if (node instanceof _PlaceholderNode__WEBPACK_IMPORTED_MODULE_0__[\"default\"]) return;\n  node.forest.deselect_all();\n  select_node(node);\n}\n\n// Remove a certain event (group) from the selection\n// This only triggers a CSS update\nfunction deselect_node(node) {\n  if (node instanceof _PlaceholderNode__WEBPACK_IMPORTED_MODULE_0__[\"default\"]) return;\n  if (node.selected) {\n    node.forest.selected.remove(node);\n    node.selected = false;\n    if (node.element) {\n      node.element.removeClass('selected');\n      unmark_children_parent_selected(node);\n    }\n  }\n  // console.log('selection: '+ node.forest.selected().map(function(it) { return it.record.name() }))\n}\n\nfunction deselect_subtree(node) {\n  deselect_node(node);\n  if (node.subnodes) {\n    _.each(node.subnodes, function (el) {\n      deselect_subtree(el);\n    });\n  }\n}\n\n// Toggle visibility of child events in an event group.\n// This triggers an update of the visualisation.\nfunction toggle_visibility_of_subtree(node) {\n  if (!node.is_group(node)) return;\n  node.collapsed = !node.collapsed;\n  // Deselect all nodes when we make them invisible\n  deselect_subtree(node);\n}\nfunction start_editing_event_name(node, label, model) {\n  // The new input field:\n  var input = $('<input>').attr('type', 'text').attr('value', node.record.name());\n  function update_event_name() {\n    var new_name = input.val().trim();\n\n    // Quick exit if nothing changed.\n    if (new_name === label.text()) {\n      input.replaceWith(label);\n      $(node.element).attr('draggable', true);\n      single_select_node(node);\n      return;\n    }\n\n    // Otherwise send the request to the server.\n    var request = node.forest.create_request({\n      intl: intl\n    }.intl.formatMessage({\n      \"id\": \"Rename\",\n      \"defaultMessage\": \"Rename\"\n    }), {\n      id: (0,_event_treeview__WEBPACK_IMPORTED_MODULE_1__.record_id)(node.record),\n      name: new_name\n    });\n    var forest = node.forest;\n    forest.running_action({\n      set_event_name: request\n    });\n    _CommonScripts_sharedscripts_sharedscripts_yesplanapi__WEBPACK_IMPORTED_MODULE_2__[\"default\"].set_event_name(model, request).then(function () {\n      label.text(new_name);\n      input.replaceWith(label);\n      $(node.element).attr('draggable', true);\n      single_select_node(node);\n      forest.running_action(null);\n    }).catch(function (error) {\n      (0,_event_treeview__WEBPACK_IMPORTED_MODULE_1__.handle_error)(error);\n      input.replaceWith(label);\n      $(node.element).attr('draggable', true);\n      forest.request_update();\n      forest.running_action(null);\n    });\n  }\n  input.on('focusout', update_event_name);\n  input.on('keyup', function (e) {\n    // ESCAPE or ENTER key ?\n    if (e.keyCode === 27 || e.keyCode === 13) {\n      e.preventDefault();\n      update_event_name();\n    }\n  });\n\n  // Show the input field:\n  label.replaceWith(input);\n  input.select();\n  /* Make the element not draggable while editing, otherwise the text was not 'unselectable' in Firefox */\n  $(node.element).attr('draggable', false);\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9UcmVldmlldy90cmVlX3NlbGVjdGlvbnMuanMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTs7QUFHQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBSUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBRUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vUmVhY3RDb21wb25lbnRzXy8uL1RyZWV2aWV3L3RyZWVfc2VsZWN0aW9ucy5qcz8yZTViIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIGVzbGludC1kaXNhYmxlIGNhbWVsY2FzZSAqL1xuaW1wb3J0IFBsYWNlaG9sZGVyTm9kZSBmcm9tICcuL1BsYWNlaG9sZGVyTm9kZSc7XG5pbXBvcnQge2hhbmRsZV9lcnJvciwgcmVjb3JkX2lkfSBmcm9tICcuL2V2ZW50LXRyZWV2aWV3JztcbmltcG9ydCAkeWVzcGxhbiBmcm9tICcuLi9Db21tb25TY3JpcHRzL3NoYXJlZHNjcmlwdHMvc2hhcmVkc2NyaXB0cy15ZXNwbGFuYXBpJztcblxuXG4vKiBlc2xpbnQtZGlzYWJsZSBjYW1lbGNhc2UgKi9cbmV4cG9ydCBmdW5jdGlvbiBtYXJrX2NoaWxkcmVuX3BhcmVudF9zZWxlY3RlZChub2RlKSB7XG4gIGlmIChub2RlIGluc3RhbmNlb2YgUGxhY2Vob2xkZXJOb2RlKSByZXR1cm47XG5cbiAgLy8gTWFyayB0aGUgbGlua3MgYmVsb3cgdGhpcyBub2RlXG4gIGlmICghbm9kZS5jb2xsYXBzZWQpIHtcbiAgICBjb25zdCBsaW5rcyA9IGQzLnNlbGVjdEFsbCgncGF0aC5saW5rJykuZmlsdGVyKGZ1bmN0aW9uKGl0KSB7XG4gICAgICByZXR1cm4gaXQgJiYgaXQuc291cmNlLmRhdGEgPT09IG5vZGU7XG4gICAgfSk7XG5cbiAgICBsaW5rcy5jbGFzc2VkKCdwYXJlbnQtc2VsZWN0ZWQnLCB0cnVlKTtcbiAgfVxuXG4gIC8vIE1hcmsgYWxsIGNoaWxkcmVuIG9mIHRoZSBub2RlLCByZWN1cnNpdmVseVxuICBfLmVhY2gobm9kZS5zdWJub2RlcywgZnVuY3Rpb24oY2hpbGQpIHtcbiAgICBpZiAoY2hpbGQuZWxlbWVudCkge1xuICAgICAgY2hpbGQuZWxlbWVudC5hZGRDbGFzcygncGFyZW50LXNlbGVjdGVkJyk7XG4gICAgICBtYXJrX2NoaWxkcmVuX3BhcmVudF9zZWxlY3RlZChjaGlsZCk7XG4gICAgfVxuICB9KTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVubWFya19jaGlsZHJlbl9wYXJlbnRfc2VsZWN0ZWQobm9kZSkge1xuICBpZiAobm9kZSBpbnN0YW5jZW9mIFBsYWNlaG9sZGVyTm9kZSkgcmV0dXJuO1xuXG4gIC8vIERvIG5vdCB1bm1hcmsgcGFyZW50LXNlbGVjdGVkIGlmIG5vZGUgaXMgc2VsZWN0ZWQgb3IgaXMgaXRzZWxmIHBhcmVudC1zZWxlY3RlZFxuICBpZiAobm9kZS5zZWxlY3RlZCB8fCBub2RlLmhhc3NlbGVjdGVkYW5jZXN0b3IoKSkgcmV0dXJuO1xuXG4gIC8vIFVubWFyayB0aGUgbGlua3MgYmVsb3cgdGhpcyBub2RlXG4gIGlmICghbm9kZS5jb2xsYXBzZWQpIHtcbiAgICBjb25zdCBsaW5rcyA9IGQzLnNlbGVjdEFsbCgncGF0aC5saW5rJykuZmlsdGVyKGZ1bmN0aW9uKGl0KSB7XG4gICAgICByZXR1cm4gaXQgJiYgaXQuc291cmNlLmRhdGEgPT09IG5vZGU7XG4gICAgfSk7XG5cbiAgICBsaW5rcy5jbGFzc2VkKCdwYXJlbnQtc2VsZWN0ZWQnLCBmYWxzZSk7XG4gIH1cblxuICAvLyBVbm1hcmsgYWxsIGNoaWxkcmVuIG9mIHRoZSBub2RlLCByZWN1cnNpdmVseVxuICBfLmVhY2gobm9kZS5zdWJub2RlcywgZnVuY3Rpb24oY2hpbGQpIHtcbiAgICBpZiAoY2hpbGQuZWxlbWVudCkge1xuICAgICAgY2hpbGQuZWxlbWVudC5yZW1vdmVDbGFzcygncGFyZW50LXNlbGVjdGVkJyk7XG4gICAgICB1bm1hcmtfY2hpbGRyZW5fcGFyZW50X3NlbGVjdGVkKGNoaWxkKTtcbiAgICB9XG4gIH0pO1xufVxuXG4vLyBTZWxlY3QgYSBjZXJ0YWluIGV2ZW50IChncm91cCkuXG4vLyBUaGlzIG9ubHkgdHJpZ2dlcnMgYSBDU1MgdXBkYXRlLlxuZXhwb3J0IGZ1bmN0aW9uIHNlbGVjdF9ub2RlKG5vZGUpIHtcbiAgaWYgKG5vZGUgaW5zdGFuY2VvZiBQbGFjZWhvbGRlck5vZGUpIHJldHVybjtcblxuICAvLyBQcmV2ZW50IHNlbGVjdGluZyB0aGUgbm9kZSBhZ2FpbiAob3RoZXJ3aXNlIGR1cGxpY2F0ZXMgd2lsbCBhcHBlYXIgaW4gdGhlIHNlbGVjdGVkIHNldClcbiAgaWYgKCFub2RlLnNlbGVjdGVkKSB7XG4gICAgbm9kZS5mb3Jlc3Quc2VsZWN0ZWQucHVzaChub2RlKTtcbiAgICBub2RlLnNlbGVjdGVkID0gdHJ1ZTtcblxuICAgIGlmIChub2RlLmVsZW1lbnQpIHtcbiAgICAgIG5vZGUuZWxlbWVudC5hZGRDbGFzcygnc2VsZWN0ZWQnKTtcbiAgICAgIG1hcmtfY2hpbGRyZW5fcGFyZW50X3NlbGVjdGVkKG5vZGUpO1xuICAgIH1cbiAgfVxuICAvLyBjb25zb2xlLmxvZygnc2VsZWN0aW9uOiAnKyBub2RlLmZvcmVzdC5zZWxlY3RlZCgpLm1hcChmdW5jdGlvbihpdCkgeyByZXR1cm4gaXQucmVjb3JkLm5hbWUoKSB9KSlcbn1cblxuLy8gU2VsZWN0IGEgc2luZ2xlIGV2ZW50IChmaXJzdCBkZXNlbGVjdHMgZXhpc3RpbmcpXG5leHBvcnQgZnVuY3Rpb24gc2luZ2xlX3NlbGVjdF9ub2RlKG5vZGUpIHtcbiAgaWYgKG5vZGUgaW5zdGFuY2VvZiBQbGFjZWhvbGRlck5vZGUpIHJldHVybjtcblxuICBub2RlLmZvcmVzdC5kZXNlbGVjdF9hbGwoKTtcbiAgc2VsZWN0X25vZGUobm9kZSk7XG59XG5cbi8vIFJlbW92ZSBhIGNlcnRhaW4gZXZlbnQgKGdyb3VwKSBmcm9tIHRoZSBzZWxlY3Rpb25cbi8vIFRoaXMgb25seSB0cmlnZ2VycyBhIENTUyB1cGRhdGVcbmV4cG9ydCBmdW5jdGlvbiBkZXNlbGVjdF9ub2RlKG5vZGUpIHtcbiAgaWYgKG5vZGUgaW5zdGFuY2VvZiBQbGFjZWhvbGRlck5vZGUpIHJldHVybjtcblxuICBpZiAobm9kZS5zZWxlY3RlZCkge1xuICAgIG5vZGUuZm9yZXN0LnNlbGVjdGVkLnJlbW92ZShub2RlKTtcbiAgICBub2RlLnNlbGVjdGVkID0gZmFsc2U7XG4gICAgaWYgKG5vZGUuZWxlbWVudCkge1xuICAgICAgbm9kZS5lbGVtZW50LnJlbW92ZUNsYXNzKCdzZWxlY3RlZCcpO1xuICAgICAgdW5tYXJrX2NoaWxkcmVuX3BhcmVudF9zZWxlY3RlZChub2RlKTtcbiAgICB9XG4gIH1cbiAgLy8gY29uc29sZS5sb2coJ3NlbGVjdGlvbjogJysgbm9kZS5mb3Jlc3Quc2VsZWN0ZWQoKS5tYXAoZnVuY3Rpb24oaXQpIHsgcmV0dXJuIGl0LnJlY29yZC5uYW1lKCkgfSkpXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBkZXNlbGVjdF9zdWJ0cmVlKG5vZGUpIHtcbiAgZGVzZWxlY3Rfbm9kZShub2RlKTtcbiAgaWYgKG5vZGUuc3Vibm9kZXMpIHtcbiAgICBfLmVhY2gobm9kZS5zdWJub2RlcywgZnVuY3Rpb24oZWwpIHtcbiAgICAgIGRlc2VsZWN0X3N1YnRyZWUoZWwpO1xuICAgIH0pO1xuICB9XG59XG5cbi8vIFRvZ2dsZSB2aXNpYmlsaXR5IG9mIGNoaWxkIGV2ZW50cyBpbiBhbiBldmVudCBncm91cC5cbi8vIFRoaXMgdHJpZ2dlcnMgYW4gdXBkYXRlIG9mIHRoZSB2aXN1YWxpc2F0aW9uLlxuZXhwb3J0IGZ1bmN0aW9uIHRvZ2dsZV92aXNpYmlsaXR5X29mX3N1YnRyZWUobm9kZSkge1xuICBpZiAoIW5vZGUuaXNfZ3JvdXAobm9kZSkpIHJldHVybjtcbiAgbm9kZS5jb2xsYXBzZWQgPSAhbm9kZS5jb2xsYXBzZWQ7XG4gIC8vIERlc2VsZWN0IGFsbCBub2RlcyB3aGVuIHdlIG1ha2UgdGhlbSBpbnZpc2libGVcbiAgZGVzZWxlY3Rfc3VidHJlZShub2RlKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHN0YXJ0X2VkaXRpbmdfZXZlbnRfbmFtZShub2RlLCBsYWJlbCwgbW9kZWwpIHtcbiAgLy8gVGhlIG5ldyBpbnB1dCBmaWVsZDpcbiAgY29uc3QgaW5wdXQgPSAkKCc8aW5wdXQ+JylcbiAgICAuYXR0cigndHlwZScsICd0ZXh0JylcbiAgICAuYXR0cigndmFsdWUnLCBub2RlLnJlY29yZC5uYW1lKCkpO1xuXG4gIGZ1bmN0aW9uIHVwZGF0ZV9ldmVudF9uYW1lKCkge1xuICAgIGNvbnN0IG5ld19uYW1lID0gaW5wdXQudmFsKCkudHJpbSgpO1xuXG4gICAgLy8gUXVpY2sgZXhpdCBpZiBub3RoaW5nIGNoYW5nZWQuXG4gICAgaWYgKG5ld19uYW1lID09PSBsYWJlbC50ZXh0KCkpIHtcbiAgICAgIGlucHV0LnJlcGxhY2VXaXRoKGxhYmVsKTtcbiAgICAgICQobm9kZS5lbGVtZW50KS5hdHRyKCdkcmFnZ2FibGUnLCB0cnVlKTtcbiAgICAgIHNpbmdsZV9zZWxlY3Rfbm9kZShub2RlKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBPdGhlcndpc2Ugc2VuZCB0aGUgcmVxdWVzdCB0byB0aGUgc2VydmVyLlxuICAgIGNvbnN0IHJlcXVlc3QgPSBub2RlLmZvcmVzdC5jcmVhdGVfcmVxdWVzdChpMThuKCdSZW5hbWUnKSwge1xuICAgICAgaWQ6IHJlY29yZF9pZChub2RlLnJlY29yZCksXG4gICAgICBuYW1lOiBuZXdfbmFtZVxuICAgIH0pO1xuXG4gICAgY29uc3Qge2ZvcmVzdH0gPSBub2RlO1xuICAgIGZvcmVzdC5ydW5uaW5nX2FjdGlvbih7c2V0X2V2ZW50X25hbWU6IHJlcXVlc3R9KTtcblxuICAgICR5ZXNwbGFuXG4gICAgICAuc2V0X2V2ZW50X25hbWUobW9kZWwsIHJlcXVlc3QpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGxhYmVsLnRleHQobmV3X25hbWUpO1xuICAgICAgICBpbnB1dC5yZXBsYWNlV2l0aChsYWJlbCk7XG4gICAgICAgICQobm9kZS5lbGVtZW50KS5hdHRyKCdkcmFnZ2FibGUnLCB0cnVlKTtcbiAgICAgICAgc2luZ2xlX3NlbGVjdF9ub2RlKG5vZGUpO1xuXG4gICAgICAgIGZvcmVzdC5ydW5uaW5nX2FjdGlvbihudWxsKTtcbiAgICAgIH0pXG4gICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgIGhhbmRsZV9lcnJvcihlcnJvcik7XG4gICAgICAgIGlucHV0LnJlcGxhY2VXaXRoKGxhYmVsKTtcbiAgICAgICAgJChub2RlLmVsZW1lbnQpLmF0dHIoJ2RyYWdnYWJsZScsIHRydWUpO1xuICAgICAgICBmb3Jlc3QucmVxdWVzdF91cGRhdGUoKTtcblxuICAgICAgICBmb3Jlc3QucnVubmluZ19hY3Rpb24obnVsbCk7XG4gICAgICB9KVxuICB9XG5cbiAgaW5wdXQub24oJ2ZvY3Vzb3V0JywgdXBkYXRlX2V2ZW50X25hbWUpO1xuICBpbnB1dC5vbigna2V5dXAnLCBmdW5jdGlvbihlKSB7XG4gICAgLy8gRVNDQVBFIG9yIEVOVEVSIGtleSA/XG4gICAgaWYgKGUua2V5Q29kZSA9PT0gMjcgfHwgZS5rZXlDb2RlID09PSAxMykge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdXBkYXRlX2V2ZW50X25hbWUoKTtcbiAgICB9XG4gIH0pO1xuXG4gIC8vIFNob3cgdGhlIGlucHV0IGZpZWxkOlxuICBsYWJlbC5yZXBsYWNlV2l0aChpbnB1dCk7XG4gIGlucHV0LnNlbGVjdCgpO1xuICAvKiBNYWtlIHRoZSBlbGVtZW50IG5vdCBkcmFnZ2FibGUgd2hpbGUgZWRpdGluZywgb3RoZXJ3aXNlIHRoZSB0ZXh0IHdhcyBub3QgJ3Vuc2VsZWN0YWJsZScgaW4gRmlyZWZveCAqL1xuICAkKG5vZGUuZWxlbWVudCkuYXR0cignZHJhZ2dhYmxlJywgZmFsc2UpO1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./Treeview/tree_selections.js\n");

/***/ }),

/***/ "./Treeview/treeview.js":
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"create\": function() { return /* binding */ create; },\n/* harmony export */   \"dispose\": function() { return /* binding */ dispose; },\n/* harmony export */   \"extend\": function() { return /* binding */ extend; },\n/* harmony export */   \"model\": function() { return /* binding */ model; }\n/* harmony export */ });\n/* harmony import */ var react_global_configuration__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./node_modules/react-global-configuration/build/index.js\");\n/* harmony import */ var _Forest__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./Treeview/Forest.js\");\n/* harmony import */ var _ui_model__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"./Treeview/ui_model.js\");\n/* harmony import */ var _globalConfiguration__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"./globalConfiguration.ts\");\n/* harmony import */ var _DateFormatSettings__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(\"./Treeview/DateFormatSettings.js\");\n/* eslint-disable camelcase */\n\n\n\n\n\n// --------------------------------------------------------------------------\n// Public API\n\nvar forests = {};\nvar model = new _ui_model__WEBPACK_IMPORTED_MODULE_2__[\"default\"]();\n\n// Set up a new tree view in the selected container, and for the specified\n// trees. If the latter is missing this will load in some dummy test data.\nfunction create(tree_container_selector, tree_root_ids, initial_selection, can_create_events_permission, updates_for_model, resourceUrl, dateFormatSettings) {\n  (0,_globalConfiguration__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(resourceUrl);\n  _DateFormatSettings__WEBPACK_IMPORTED_MODULE_4__[\"default\"].setSettings(dateFormatSettings);\n  model.process_all_additions(updates_for_model);\n  if (forests[tree_container_selector]) return;\n  var new_forest = new _Forest__WEBPACK_IMPORTED_MODULE_1__[\"default\"](tree_container_selector, tree_root_ids, initial_selection, can_create_events_permission, model);\n  forests[tree_container_selector] = new_forest;\n  new_forest.request_update();\n}\nfunction extend(tree_container_selector, event_id) {\n  if (!forests[tree_container_selector]) return;\n  forests[tree_container_selector].extend_with(event_id);\n}\n\n// Get rid of the tree view in the selected container.\nfunction dispose(tree_container_selector) {\n  var old_forest = forests[tree_container_selector];\n  if (!old_forest) return;\n  old_forest.dispose();\n  delete forests[tree_container_selector];\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9UcmVldmlldy90cmVldmlldy5qcy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBU0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQVFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vUmVhY3RDb21wb25lbnRzXy8uL1RyZWV2aWV3L3RyZWV2aWV3LmpzP2ZmODciXSwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50LWRpc2FibGUgY2FtZWxjYXNlICovXG5pbXBvcnQgY29uZmlnIGZyb20gJ3JlYWN0LWdsb2JhbC1jb25maWd1cmF0aW9uJztcbmltcG9ydCBGb3Jlc3QgZnJvbSAnLi9Gb3Jlc3QnO1xuaW1wb3J0IE1vZGVsIGZyb20gJy4vdWlfbW9kZWwnO1xuaW1wb3J0IGVuc3VyZVJlc291cmNlVXJsQW5kRGF0ZUZvcm1hdENvbmZpZyBmcm9tICcuLi9nbG9iYWxDb25maWd1cmF0aW9uJztcbmltcG9ydCBEYXRlRm9ybWF0U2V0dGluZ3MgZnJvbSAnLi9EYXRlRm9ybWF0U2V0dGluZ3MnO1xuLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbi8vIFB1YmxpYyBBUElcblxuY29uc3QgZm9yZXN0cyA9IHt9O1xuZXhwb3J0IGNvbnN0IG1vZGVsID0gbmV3IE1vZGVsKCk7XG5cbi8vIFNldCB1cCBhIG5ldyB0cmVlIHZpZXcgaW4gdGhlIHNlbGVjdGVkIGNvbnRhaW5lciwgYW5kIGZvciB0aGUgc3BlY2lmaWVkXG4vLyB0cmVlcy4gSWYgdGhlIGxhdHRlciBpcyBtaXNzaW5nIHRoaXMgd2lsbCBsb2FkIGluIHNvbWUgZHVtbXkgdGVzdCBkYXRhLlxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZShcbiAgdHJlZV9jb250YWluZXJfc2VsZWN0b3IsXG4gIHRyZWVfcm9vdF9pZHMsXG4gIGluaXRpYWxfc2VsZWN0aW9uLFxuICBjYW5fY3JlYXRlX2V2ZW50c19wZXJtaXNzaW9uLFxuICB1cGRhdGVzX2Zvcl9tb2RlbCxcbiAgcmVzb3VyY2VVcmwsXG4gIGRhdGVGb3JtYXRTZXR0aW5nc1xuKSB7XG4gIGVuc3VyZVJlc291cmNlVXJsQW5kRGF0ZUZvcm1hdENvbmZpZyhyZXNvdXJjZVVybCk7XG4gIERhdGVGb3JtYXRTZXR0aW5ncy5zZXRTZXR0aW5ncyhkYXRlRm9ybWF0U2V0dGluZ3MpO1xuXG4gIG1vZGVsLnByb2Nlc3NfYWxsX2FkZGl0aW9ucyh1cGRhdGVzX2Zvcl9tb2RlbCk7XG4gIGlmIChmb3Jlc3RzW3RyZWVfY29udGFpbmVyX3NlbGVjdG9yXSkgcmV0dXJuO1xuXG4gIGNvbnN0IG5ld19mb3Jlc3QgPSBuZXcgRm9yZXN0KFxuICAgIHRyZWVfY29udGFpbmVyX3NlbGVjdG9yLFxuICAgIHRyZWVfcm9vdF9pZHMsXG4gICAgaW5pdGlhbF9zZWxlY3Rpb24sXG4gICAgY2FuX2NyZWF0ZV9ldmVudHNfcGVybWlzc2lvbixcbiAgICBtb2RlbFxuICApO1xuXG4gIGZvcmVzdHNbdHJlZV9jb250YWluZXJfc2VsZWN0b3JdID0gbmV3X2ZvcmVzdDtcbiAgbmV3X2ZvcmVzdC5yZXF1ZXN0X3VwZGF0ZSgpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZXh0ZW5kKHRyZWVfY29udGFpbmVyX3NlbGVjdG9yLCBldmVudF9pZCkge1xuICBpZiAoIWZvcmVzdHNbdHJlZV9jb250YWluZXJfc2VsZWN0b3JdKSByZXR1cm47XG4gIGZvcmVzdHNbdHJlZV9jb250YWluZXJfc2VsZWN0b3JdLmV4dGVuZF93aXRoKGV2ZW50X2lkKTtcbn1cblxuLy8gR2V0IHJpZCBvZiB0aGUgdHJlZSB2aWV3IGluIHRoZSBzZWxlY3RlZCBjb250YWluZXIuXG5leHBvcnQgZnVuY3Rpb24gZGlzcG9zZSh0cmVlX2NvbnRhaW5lcl9zZWxlY3Rvcikge1xuICBjb25zdCBvbGRfZm9yZXN0ID0gZm9yZXN0c1t0cmVlX2NvbnRhaW5lcl9zZWxlY3Rvcl07XG4gIGlmICghb2xkX2ZvcmVzdCkgcmV0dXJuO1xuICBvbGRfZm9yZXN0LmRpc3Bvc2UoKTtcbiAgZGVsZXRlIGZvcmVzdHNbdHJlZV9jb250YWluZXJfc2VsZWN0b3JdO1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./Treeview/treeview.js\n");

/***/ }),

/***/ "./Treeview/ui_model.js":
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": function() { return /* binding */ Model; }\n/* harmony export */ });\n/* harmony import */ var knockout__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./node_modules/knockout/build/output/knockout-latest.js\");\n/* harmony import */ var knockout__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(knockout__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _sentry_browser__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"./node_modules/@sentry/hub/esm/exports.js\");\n/* harmony import */ var _CommonScripts_sharedscripts_sharedscripts_sentry__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./CommonScripts/sharedscripts/sharedscripts-sentry.js\");\nfunction _classPrivateMethodGet(receiver, privateSet, fn) { if (!privateSet.has(receiver)) { throw new TypeError(\"attempted to get private field on non-instance\"); } return fn; }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n/* eslint-disable camelcase */\n\n\n\n// This module takes care of maintaining the client-side model (aka. view\n// model). It takes the form of a database of observable records. The records\n// get created/updated with data received from the server.\n\n// A record holds some meta info on the data, an observable \"self\", as well\n// as the actual data fields.\nvar Record = /*#__PURE__*/function () {\n  function Record(id, data) {\n    _classCallCheck(this, Record);\n    this.$meta = {\n      // This is the server side object id. This is also the id under which\n      // the record can be retrieved from the view model.\n      id: id,\n      // Following two fields are purely informational and, so far, unused by\n      // any external logic.\n      // - When was the record created on the client side ?\n      created: Date.now(),\n      // - When was the record last updated (possibly partially) on the client\n      // side ?\n      updated: null\n    };\n    // The observable \"self\" triggers whenever we touch it. It allows clients\n    // to respond to any change in the record's data, without having to bind\n    // to specific fields. It will also help them be informed of when a record\n    // gets deleted from the database (in which case the value will become\n    // null).\n    this.$self = knockout__WEBPACK_IMPORTED_MODULE_0___default().observable(this).extend({\n      // Trigger notifications even when the raw value doesn't change (which it\n      // won't in normal use).\n      notify: 'always',\n      // But limit the triggering of individual notifications so we don't\n      // trigger them for each field which will have been updated.\n      rateLimit: {\n        timeout: 300\n      }\n    });\n\n    // And install the provided data:\n    this.update(data);\n  }\n\n  // This method takes whatever data is provided and merges it into the\n  // existing record.\n  _createClass(Record, [{\n    key: \"update\",\n    value: function update(data) {\n      this.$meta.updated = Date.now();\n      var keys = Object.keys(data);\n      for (var i = 0; i < keys.length; i++) {\n        var key = keys[i];\n        var value = data[key];\n        if (this.hasOwnProperty(key)) {\n          // If we already have this field as an observable then we should just\n          // update that observable's value.\n          this[key](value);\n        } else {\n          // If we do not have an observable for the field we will now create\n          // one. If the value is an array we make sure to create an observable\n          // array rather than a basic observable.\n          // NOTE A consequence of this is that arrays should not get passed in\n          // as null, but as [] instead.\n          var o = Array.isArray(value) ? knockout__WEBPACK_IMPORTED_MODULE_0___default().observableArray(value) : knockout__WEBPACK_IMPORTED_MODULE_0___default().observable(value);\n\n          // Any updates to a field should trigger an update of the $self.\n          this[key] = o.extend({\n            propagate_to: this.$self\n          });\n        }\n      }\n    }\n\n    // This deletes a record. Subscribers will get notified of a change to the\n    // record's $self, which will get set to null. They should take this as a\n    // trigger to at least clean up their subscriptions.\n  }, {\n    key: \"dispose\",\n    value: function dispose() {\n      this.$self(null);\n    }\n  }]);\n  return Record;\n}(); // Custom error logging\nfunction throwAndLogError(errorMessage, extraData) {\n  var error = new Error(errorMessage);\n  if ((0,_CommonScripts_sharedscripts_sharedscripts_sentry__WEBPACK_IMPORTED_MODULE_1__.isSentryInitialized)()) {\n    _sentry_browser__WEBPACK_IMPORTED_MODULE_2__.withScope(function (scope) {\n      if (extraData) {\n        Object.keys(extraData).forEach(function (key) {\n          scope.setExtra(key, extraData[key]);\n        });\n      }\n      _sentry_browser__WEBPACK_IMPORTED_MODULE_2__.captureException(error);\n    });\n  } else {\n    throw error;\n  }\n}\n\n// ------------------------------------------------------------------\n// Client-side lookup of records\nvar _set = /*#__PURE__*/new WeakSet();\nvar _process_addition = /*#__PURE__*/new WeakSet();\nvar _process_change = /*#__PURE__*/new WeakSet();\nvar _process_deletion = /*#__PURE__*/new WeakSet();\nvar Model = /*#__PURE__*/function () {\n  function Model() {\n    _classCallCheck(this, Model);\n    _process_deletion.add(this);\n    _process_change.add(this);\n    _process_addition.add(this);\n    _set.add(this);\n    // This holds all records in the client side \"database\".\n    this.db = {};\n    // Knockout extension\n\n    // This is a minor extension to Knockout with the purpose of being able to\n    // set up a forward propagation link on an observable.\n    (knockout__WEBPACK_IMPORTED_MODULE_0___default().extenders.propagate_to) = function (target, field) {\n      target.subscribe(function () {\n        field.valueHasMutated();\n      });\n      return target;\n    };\n  }\n\n  // ------------------------------------------------------------------\n  // Processing incoming updates\n  _createClass(Model, [{\n    key: \"process_all_additions\",\n    value: function process_all_additions(updates) {\n      // console.log('ADDING'); console.log(updates)\n      for (var i = 0; i < updates.length; i++) {\n        _classPrivateMethodGet(this, _process_addition, _process_addition2).call(this, updates[i]);\n      }\n    }\n  }, {\n    key: \"process_all_changes\",\n    value: function process_all_changes(updates) {\n      // console.log('UPDATING'); console.log(updates)\n      for (var i = 0; i < updates.length; i++) {\n        _classPrivateMethodGet(this, _process_change, _process_change2).call(this, updates[i]);\n      }\n    }\n  }, {\n    key: \"process_all_deletions\",\n    value: function process_all_deletions(updates) {\n      // console.log('DELETING'); console.log(updates)\n      for (var i = 0; i < updates.length; i++) {\n        _classPrivateMethodGet(this, _process_deletion, _process_deletion2).call(this, updates[i]);\n      }\n    }\n\n    // By ID\n  }, {\n    key: \"get\",\n    value: function get(id, value_if_missing) {\n      if (!this.db[id]) {\n        if (typeof value_if_missing !== 'undefined') {\n          return value_if_missing;\n        } else {\n          throwAndLogError('Model is missing the requested id', {\n            id: id\n          });\n        }\n      }\n      return this.db[id];\n    }\n\n    // Based on a predicate; for now this is a very simple implementation\n  }, {\n    key: \"getMatching\",\n    value: function getMatching(predicate) {\n      return _.select(_.values(this.db), predicate);\n    }\n  }, {\n    key: \"remove\",\n    value: function remove(record) {\n      record.dispose();\n      delete this.db[record.$meta.id];\n    }\n  }]);\n  return Model;\n}(); // ------------------------------------------------------------------\n// Get it all running.\n// This is really only needed for data-bind attributes inside of HTML\n// elements. Which we're not doing right now.\n/*\n$(document).ready(function() {\n  ko.applyBindings(db)\n})\n*/\nfunction _set2(id, data) {\n  if (this.db[id]) {\n    this.db[id].update(data);\n  } else {\n    this.db[id] = new Record(id, data);\n  }\n}\nfunction _process_addition2(update) {\n  _classPrivateMethodGet(this, _set, _set2).call(this, update.i, update.d);\n}\nfunction _process_change2(update) {\n  _classPrivateMethodGet(this, _set, _set2).call(this, update.i, update.d);\n}\nfunction _process_deletion2(id) {\n  var record = this.db[id];\n  if (!record) return;\n  record.dispose();\n  delete this.db[id];\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9UcmVldmlldy91aV9tb2RlbC5qcy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQUE7QUFFQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQTBCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUlBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFKQTtBQXpFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUdBO0FBQ0E7QUFBQTtBQUdBO0FBQ0E7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9SZWFjdENvbXBvbmVudHNfLy4vVHJlZXZpZXcvdWlfbW9kZWwuanM/YTA3ZCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiBlc2xpbnQtZGlzYWJsZSBjYW1lbGNhc2UgKi9cbmltcG9ydCBrbyBmcm9tICdrbm9ja291dCc7XG5pbXBvcnQgKiBhcyBTZW50cnkgZnJvbSBcIkBzZW50cnkvYnJvd3NlclwiO1xuaW1wb3J0IHtpc1NlbnRyeUluaXRpYWxpemVkfSBmcm9tIFwiLi4vQ29tbW9uU2NyaXB0cy9zaGFyZWRzY3JpcHRzL3NoYXJlZHNjcmlwdHMtc2VudHJ5XCI7XG4vLyBUaGlzIG1vZHVsZSB0YWtlcyBjYXJlIG9mIG1haW50YWluaW5nIHRoZSBjbGllbnQtc2lkZSBtb2RlbCAoYWthLiB2aWV3XG4vLyBtb2RlbCkuIEl0IHRha2VzIHRoZSBmb3JtIG9mIGEgZGF0YWJhc2Ugb2Ygb2JzZXJ2YWJsZSByZWNvcmRzLiBUaGUgcmVjb3Jkc1xuLy8gZ2V0IGNyZWF0ZWQvdXBkYXRlZCB3aXRoIGRhdGEgcmVjZWl2ZWQgZnJvbSB0aGUgc2VydmVyLlxuXG4vLyBBIHJlY29yZCBob2xkcyBzb21lIG1ldGEgaW5mbyBvbiB0aGUgZGF0YSwgYW4gb2JzZXJ2YWJsZSBcInNlbGZcIiwgYXMgd2VsbFxuLy8gYXMgdGhlIGFjdHVhbCBkYXRhIGZpZWxkcy5cbmNsYXNzIFJlY29yZCB7XG4gIGNvbnN0cnVjdG9yKGlkLCBkYXRhKSB7XG4gICAgdGhpcy4kbWV0YSA9IHtcbiAgICAgIC8vIFRoaXMgaXMgdGhlIHNlcnZlciBzaWRlIG9iamVjdCBpZC4gVGhpcyBpcyBhbHNvIHRoZSBpZCB1bmRlciB3aGljaFxuICAgICAgLy8gdGhlIHJlY29yZCBjYW4gYmUgcmV0cmlldmVkIGZyb20gdGhlIHZpZXcgbW9kZWwuXG4gICAgICBpZCxcblxuICAgICAgLy8gRm9sbG93aW5nIHR3byBmaWVsZHMgYXJlIHB1cmVseSBpbmZvcm1hdGlvbmFsIGFuZCwgc28gZmFyLCB1bnVzZWQgYnlcbiAgICAgIC8vIGFueSBleHRlcm5hbCBsb2dpYy5cbiAgICAgIC8vIC0gV2hlbiB3YXMgdGhlIHJlY29yZCBjcmVhdGVkIG9uIHRoZSBjbGllbnQgc2lkZSA/XG4gICAgICBjcmVhdGVkOiBEYXRlLm5vdygpLFxuICAgICAgLy8gLSBXaGVuIHdhcyB0aGUgcmVjb3JkIGxhc3QgdXBkYXRlZCAocG9zc2libHkgcGFydGlhbGx5KSBvbiB0aGUgY2xpZW50XG4gICAgICAvLyBzaWRlID9cbiAgICAgIHVwZGF0ZWQ6IG51bGxcbiAgICB9O1xuICAgIC8vIFRoZSBvYnNlcnZhYmxlIFwic2VsZlwiIHRyaWdnZXJzIHdoZW5ldmVyIHdlIHRvdWNoIGl0LiBJdCBhbGxvd3MgY2xpZW50c1xuICAgIC8vIHRvIHJlc3BvbmQgdG8gYW55IGNoYW5nZSBpbiB0aGUgcmVjb3JkJ3MgZGF0YSwgd2l0aG91dCBoYXZpbmcgdG8gYmluZFxuICAgIC8vIHRvIHNwZWNpZmljIGZpZWxkcy4gSXQgd2lsbCBhbHNvIGhlbHAgdGhlbSBiZSBpbmZvcm1lZCBvZiB3aGVuIGEgcmVjb3JkXG4gICAgLy8gZ2V0cyBkZWxldGVkIGZyb20gdGhlIGRhdGFiYXNlIChpbiB3aGljaCBjYXNlIHRoZSB2YWx1ZSB3aWxsIGJlY29tZVxuICAgIC8vIG51bGwpLlxuICAgIHRoaXMuJHNlbGYgPSBrby5vYnNlcnZhYmxlKHRoaXMpLmV4dGVuZCh7XG4gICAgICAvLyBUcmlnZ2VyIG5vdGlmaWNhdGlvbnMgZXZlbiB3aGVuIHRoZSByYXcgdmFsdWUgZG9lc24ndCBjaGFuZ2UgKHdoaWNoIGl0XG4gICAgICAvLyB3b24ndCBpbiBub3JtYWwgdXNlKS5cbiAgICAgIG5vdGlmeTogJ2Fsd2F5cycsXG4gICAgICAvLyBCdXQgbGltaXQgdGhlIHRyaWdnZXJpbmcgb2YgaW5kaXZpZHVhbCBub3RpZmljYXRpb25zIHNvIHdlIGRvbid0XG4gICAgICAvLyB0cmlnZ2VyIHRoZW0gZm9yIGVhY2ggZmllbGQgd2hpY2ggd2lsbCBoYXZlIGJlZW4gdXBkYXRlZC5cbiAgICAgIHJhdGVMaW1pdDoge3RpbWVvdXQ6IDMwMH1cbiAgICB9KTtcblxuICAgIC8vIEFuZCBpbnN0YWxsIHRoZSBwcm92aWRlZCBkYXRhOlxuICAgIHRoaXMudXBkYXRlKGRhdGEpO1xuICB9XG5cbiAgLy8gVGhpcyBtZXRob2QgdGFrZXMgd2hhdGV2ZXIgZGF0YSBpcyBwcm92aWRlZCBhbmQgbWVyZ2VzIGl0IGludG8gdGhlXG4gIC8vIGV4aXN0aW5nIHJlY29yZC5cbiAgdXBkYXRlKGRhdGEpIHtcbiAgICB0aGlzLiRtZXRhLnVwZGF0ZWQgPSBEYXRlLm5vdygpO1xuXG4gICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKGRhdGEpO1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykge1xuICAgICAgY29uc3Qga2V5ID0ga2V5c1tpXTtcbiAgICAgIGNvbnN0IHZhbHVlID0gZGF0YVtrZXldO1xuXG4gICAgICBpZiAodGhpcy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgIC8vIElmIHdlIGFscmVhZHkgaGF2ZSB0aGlzIGZpZWxkIGFzIGFuIG9ic2VydmFibGUgdGhlbiB3ZSBzaG91bGQganVzdFxuICAgICAgICAvLyB1cGRhdGUgdGhhdCBvYnNlcnZhYmxlJ3MgdmFsdWUuXG4gICAgICAgIHRoaXNba2V5XSh2YWx1ZSk7XG5cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIElmIHdlIGRvIG5vdCBoYXZlIGFuIG9ic2VydmFibGUgZm9yIHRoZSBmaWVsZCB3ZSB3aWxsIG5vdyBjcmVhdGVcbiAgICAgICAgLy8gb25lLiBJZiB0aGUgdmFsdWUgaXMgYW4gYXJyYXkgd2UgbWFrZSBzdXJlIHRvIGNyZWF0ZSBhbiBvYnNlcnZhYmxlXG4gICAgICAgIC8vIGFycmF5IHJhdGhlciB0aGFuIGEgYmFzaWMgb2JzZXJ2YWJsZS5cbiAgICAgICAgLy8gTk9URSBBIGNvbnNlcXVlbmNlIG9mIHRoaXMgaXMgdGhhdCBhcnJheXMgc2hvdWxkIG5vdCBnZXQgcGFzc2VkIGluXG4gICAgICAgIC8vIGFzIG51bGwsIGJ1dCBhcyBbXSBpbnN0ZWFkLlxuICAgICAgICBjb25zdCBvID0gQXJyYXkuaXNBcnJheSh2YWx1ZSkgPyBrby5vYnNlcnZhYmxlQXJyYXkodmFsdWUpIDoga28ub2JzZXJ2YWJsZSh2YWx1ZSk7XG5cbiAgICAgICAgLy8gQW55IHVwZGF0ZXMgdG8gYSBmaWVsZCBzaG91bGQgdHJpZ2dlciBhbiB1cGRhdGUgb2YgdGhlICRzZWxmLlxuICAgICAgICB0aGlzW2tleV0gPSBvLmV4dGVuZCh7cHJvcGFnYXRlX3RvOiB0aGlzLiRzZWxmfSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gVGhpcyBkZWxldGVzIGEgcmVjb3JkLiBTdWJzY3JpYmVycyB3aWxsIGdldCBub3RpZmllZCBvZiBhIGNoYW5nZSB0byB0aGVcbiAgLy8gcmVjb3JkJ3MgJHNlbGYsIHdoaWNoIHdpbGwgZ2V0IHNldCB0byBudWxsLiBUaGV5IHNob3VsZCB0YWtlIHRoaXMgYXMgYVxuICAvLyB0cmlnZ2VyIHRvIGF0IGxlYXN0IGNsZWFuIHVwIHRoZWlyIHN1YnNjcmlwdGlvbnMuXG4gIGRpc3Bvc2UoKSB7XG4gICAgdGhpcy4kc2VsZihudWxsKTtcbiAgfVxufVxuXG4vLyBDdXN0b20gZXJyb3IgbG9nZ2luZ1xuZnVuY3Rpb24gdGhyb3dBbmRMb2dFcnJvcihlcnJvck1lc3NhZ2UsIGV4dHJhRGF0YSkge1xuICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcihlcnJvck1lc3NhZ2UpO1xuICBpZiAoaXNTZW50cnlJbml0aWFsaXplZCgpKSB7XG4gICAgU2VudHJ5LndpdGhTY29wZSgoc2NvcGUpID0+IHtcbiAgICAgIGlmIChleHRyYURhdGEpIHtcbiAgICAgICAgT2JqZWN0LmtleXMoZXh0cmFEYXRhKVxuICAgICAgICAgIC5mb3JFYWNoKChrZXkpID0+IHtcbiAgICAgICAgICAgIHNjb3BlLnNldEV4dHJhKGtleSwgZXh0cmFEYXRhW2tleV0pO1xuICAgICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgU2VudHJ5LmNhcHR1cmVFeGNlcHRpb24oZXJyb3IpO1xuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIHRocm93IGVycm9yO1xuICB9XG59XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gQ2xpZW50LXNpZGUgbG9va3VwIG9mIHJlY29yZHNcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTW9kZWwge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICAvLyBUaGlzIGhvbGRzIGFsbCByZWNvcmRzIGluIHRoZSBjbGllbnQgc2lkZSBcImRhdGFiYXNlXCIuXG4gICAgdGhpcy5kYiA9IHt9O1xuICAgIC8vIEtub2Nrb3V0IGV4dGVuc2lvblxuXG4gICAgLy8gVGhpcyBpcyBhIG1pbm9yIGV4dGVuc2lvbiB0byBLbm9ja291dCB3aXRoIHRoZSBwdXJwb3NlIG9mIGJlaW5nIGFibGUgdG9cbiAgICAvLyBzZXQgdXAgYSBmb3J3YXJkIHByb3BhZ2F0aW9uIGxpbmsgb24gYW4gb2JzZXJ2YWJsZS5cbiAgICBrby5leHRlbmRlcnMucHJvcGFnYXRlX3RvID0gKHRhcmdldCwgZmllbGQpID0+IHtcbiAgICAgIHRhcmdldC5zdWJzY3JpYmUoKCkgPT4ge1xuICAgICAgICBmaWVsZC52YWx1ZUhhc011dGF0ZWQoKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHRhcmdldDtcbiAgICB9O1xuICB9XG5cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBQcm9jZXNzaW5nIGluY29taW5nIHVwZGF0ZXNcblxuICAjc2V0KGlkLCBkYXRhKSB7XG4gICAgaWYgKHRoaXMuZGJbaWRdKSB7XG4gICAgICB0aGlzLmRiW2lkXS51cGRhdGUoZGF0YSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZGJbaWRdID0gbmV3IFJlY29yZChpZCwgZGF0YSk7XG4gICAgfVxuICB9XG5cbiAgI3Byb2Nlc3NfYWRkaXRpb24odXBkYXRlKSB7XG4gICAgdGhpcy4jc2V0KHVwZGF0ZS5pLCB1cGRhdGUuZCk7XG4gIH1cblxuICAjcHJvY2Vzc19jaGFuZ2UodXBkYXRlKSB7XG4gICAgdGhpcy4jc2V0KHVwZGF0ZS5pLCB1cGRhdGUuZCk7XG4gIH1cblxuICAjcHJvY2Vzc19kZWxldGlvbihpZCkge1xuICAgIGNvbnN0IHJlY29yZCA9IHRoaXMuZGJbaWRdO1xuICAgIGlmICghcmVjb3JkKSByZXR1cm47XG4gICAgcmVjb3JkLmRpc3Bvc2UoKTtcbiAgICBkZWxldGUgdGhpcy5kYltpZF07XG4gIH1cblxuICBwcm9jZXNzX2FsbF9hZGRpdGlvbnModXBkYXRlcykge1xuICAgIC8vIGNvbnNvbGUubG9nKCdBRERJTkcnKTsgY29uc29sZS5sb2codXBkYXRlcylcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHVwZGF0ZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHRoaXMuI3Byb2Nlc3NfYWRkaXRpb24odXBkYXRlc1tpXSk7XG4gICAgfVxuICB9XG5cbiAgcHJvY2Vzc19hbGxfY2hhbmdlcyh1cGRhdGVzKSB7XG4gICAgLy8gY29uc29sZS5sb2coJ1VQREFUSU5HJyk7IGNvbnNvbGUubG9nKHVwZGF0ZXMpXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB1cGRhdGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB0aGlzLiNwcm9jZXNzX2NoYW5nZSh1cGRhdGVzW2ldKTtcbiAgICB9XG4gIH1cblxuICBwcm9jZXNzX2FsbF9kZWxldGlvbnModXBkYXRlcykge1xuICAgIC8vIGNvbnNvbGUubG9nKCdERUxFVElORycpOyBjb25zb2xlLmxvZyh1cGRhdGVzKVxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdXBkYXRlcy5sZW5ndGg7IGkrKykge1xuICAgICAgdGhpcy4jcHJvY2Vzc19kZWxldGlvbih1cGRhdGVzW2ldKTtcbiAgICB9XG4gIH1cblxuLy8gQnkgSURcbiAgZ2V0KGlkLCB2YWx1ZV9pZl9taXNzaW5nKSB7XG4gICAgaWYgKCF0aGlzLmRiW2lkXSkge1xuICAgICAgaWYgKHR5cGVvZiB2YWx1ZV9pZl9taXNzaW5nICE9PSAndW5kZWZpbmVkJykge1xuICAgICAgICByZXR1cm4gdmFsdWVfaWZfbWlzc2luZztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93QW5kTG9nRXJyb3IoJ01vZGVsIGlzIG1pc3NpbmcgdGhlIHJlcXVlc3RlZCBpZCcsIHtcbiAgICAgICAgICBpZFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHRoaXMuZGJbaWRdO1xuICB9XG5cbi8vIEJhc2VkIG9uIGEgcHJlZGljYXRlOyBmb3Igbm93IHRoaXMgaXMgYSB2ZXJ5IHNpbXBsZSBpbXBsZW1lbnRhdGlvblxuICBnZXRNYXRjaGluZyhwcmVkaWNhdGUpIHtcbiAgICByZXR1cm4gXy5zZWxlY3QoXy52YWx1ZXModGhpcy5kYiksIHByZWRpY2F0ZSk7XG4gIH1cblxuICByZW1vdmUocmVjb3JkKSB7XG4gICAgcmVjb3JkLmRpc3Bvc2UoKTtcbiAgICBkZWxldGUgdGhpcy5kYltyZWNvcmQuJG1ldGEuaWRdO1xuICB9XG59XG5cbi8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gR2V0IGl0IGFsbCBydW5uaW5nLlxuXG4vLyBUaGlzIGlzIHJlYWxseSBvbmx5IG5lZWRlZCBmb3IgZGF0YS1iaW5kIGF0dHJpYnV0ZXMgaW5zaWRlIG9mIEhUTUxcbi8vIGVsZW1lbnRzLiBXaGljaCB3ZSdyZSBub3QgZG9pbmcgcmlnaHQgbm93LlxuLypcbiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkge1xuICBrby5hcHBseUJpbmRpbmdzKGRiKVxufSlcbiovXG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./Treeview/ui_model.js\n");

/***/ }),

/***/ "./common/DatePickerInPopover.js":
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./node_modules/react/index.js\");\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./node_modules/prop-types/index.js\");\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"./node_modules/moment/moment.js\");\n/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var react_onclickoutside__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"./node_modules/react-onclickoutside/dist/react-onclickoutside.es.js\");\n/* harmony import */ var react_dom__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(\"./node_modules/react-dom/index.js\");\n/* harmony import */ var _SingleDatePicker__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(\"./common/SingleDatePicker.js\");\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n\n\n\n\n\nvar DatePickerInPopover = /*#__PURE__*/function (_React$Component) {\n  _inherits(DatePickerInPopover, _React$Component);\n  var _super = _createSuper(DatePickerInPopover);\n  function DatePickerInPopover(props) {\n    var _this;\n    _classCallCheck(this, DatePickerInPopover);\n    _this = _super.call(this, props);\n    _this.containerElement = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createRef();\n    _this.SingleDatePickerInstance = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createRef();\n    _this.closeDatepicker = _this.closeDatepicker.bind(_assertThisInitialized(_this));\n    _this.renderFooter = _this.renderFooter.bind(_assertThisInitialized(_this));\n    _this.handleTodayClick = _this.handleTodayClick.bind(_assertThisInitialized(_this));\n    _this.handleGoToThisMonthClick = _this.handleGoToThisMonthClick.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n  _createClass(DatePickerInPopover, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n      if (this.containerElement.current) {\n        /* Timeout is necessary to get the actual dimensions of the datepicker container.\n           If calculating immediately, the datepicker's height is not yet set and\n           the calculations would use a too small height to calculate the datepicker's orientation */\n        setTimeout(function () {\n          var styleAndOrientation = _this2.getInlineStyleForPopover();\n          var downwardsOrientation = styleAndOrientation[1];\n          var style = styleAndOrientation[0];\n          if (_this2.props.as === 'popover') {\n            /* Account for the arrow in the popover */\n            style.left = \"\".concat(parseInt(style.left) - 15, \"px\");\n            if (!downwardsOrientation) style.top = \"\".concat(parseInt(style.top) - 11, \"px\");\n          }\n          Object.keys(style).map(function (cssProperty) {\n            return $(_this2.containerElement.current).css(cssProperty, style[cssProperty]);\n          });\n        }, 1);\n        $(this.containerElement.current).click(function (event) {\n          event.preventDefault();\n        });\n      }\n    }\n  }, {\n    key: \"getContainerDimensions\",\n    value: function getContainerDimensions() {\n      if (this.containerElement.current) return [$(this.containerElement.current).outerWidth(), $(this.containerElement.current).outerHeight()];else return [300, 300]; /* fallback estimations */\n    }\n  }, {\n    key: \"getPopoverOrientation\",\n    value: function getPopoverOrientation(offset, isFixed) {\n      var viewHeight = document.documentElement.clientHeight + (isFixed ? 0 : $(document).scrollTop());\n      var viewWidth = document.documentElement.clientWidth + (isFixed ? 0 : $(document).scrollLeft());\n      var dpDimensions = this.getContainerDimensions();\n      return [!(offset.top + dpDimensions[1] > viewHeight && viewHeight > dpDimensions[1]), !(offset.left + dpDimensions[0] > viewWidth && viewWidth > dpDimensions[0])];\n    }\n  }, {\n    key: \"getInlineStyleForPopover\",\n    value: function getInlineStyleForPopover() {\n      var attachee = this.props.attachee;\n      /* Make sure to use the first element that was passed down */\n      var $attachee = $(attachee[0]);\n      var isFixed = false;\n      /* Use a JS function instead of ES6 arrow function on next line because of binding for $(this) */\n      // eslint-disable-next-line func-names\n      $attachee.parents().each(function () {\n        isFixed |= $(this).css('position') === 'fixed';\n        return !isFixed;\n      });\n\n      /* Get the current position of the element it is attached to\n      * Use $attachee[0] to make sure attachee is passed on as a js element instead of jquery\n      */\n      var nativeOffset = this.getOffset($attachee[0]);\n      var adjustedOffset = this.adjustOffset($attachee[0], nativeOffset, isFixed);\n\n      /* Return style and flag indicating its orientation */\n      return [{\n        position: isFixed ? 'fixed' : 'absolute',\n        top: \"\".concat(adjustedOffset.offset.top, \"px\"),\n        left: \"\".concat(adjustedOffset.offset.left, \"px\"),\n        zIndex: 900000\n      }, adjustedOffset.orientation[0], adjustedOffset.orientation[1]];\n    }\n  }, {\n    key: \"getOffset\",\n    value: function getOffset(element) {\n      var el = element;\n      var x = 0;\n      var y = 0;\n      // eslint-disable-next-line no-restricted-globals\n      while (el && !isNaN(el.offsetLeft) && !isNaN(el.offsetTop)) {\n        x += el.offsetLeft - el.scrollLeft;\n        y += el.offsetTop - el.scrollTop;\n        el = el.offsetParent;\n      }\n      return {\n        top: y,\n        left: x\n      };\n    }\n  }, {\n    key: \"adjustOffset\",\n    value: function adjustOffset(attachee, off, isFixed) {\n      var offset = off;\n      var inputHeight = $(attachee).outerHeight();\n      var viewWidth = document.documentElement.clientWidth + (isFixed ? 0 : $(document).scrollLeft());\n      var dpDimensions = this.getContainerDimensions();\n      /* Add the height of the element it is attached to */\n      offset.top += attachee.offsetHeight;\n      /* Adjust when the datepicker is outside the viewport */\n      var orientation = this.getPopoverOrientation(offset, isFixed);\n      offset.top -= Math.min(offset.top, !orientation[0] ? Math.abs(dpDimensions[1] + inputHeight) : 0);\n      offset.left -= Math.min(offset.left, !orientation[1] ? Math.abs(offset.left + dpDimensions[0] - viewWidth) : 0);\n      return {\n        offset: offset,\n        orientation: orientation\n      };\n    }\n  }, {\n    key: \"handleClickOutside\",\n    value: function handleClickOutside(event) {\n      event.stopPropagation();\n      this.closeDatepicker();\n    }\n  }, {\n    key: \"closeDatepicker\",\n    value: function closeDatepicker() {\n      if (!this.props.alwaysShown) {\n        this.props.closeDatepicker();\n      }\n    }\n  }, {\n    key: \"handleTodayClick\",\n    value: function handleTodayClick(event) {\n      var onDateChange = this.props.onDateChange;\n      var momentDate = moment__WEBPACK_IMPORTED_MODULE_2___default()();\n      event.stopPropagation();\n      event.preventDefault();\n      onDateChange(momentDate, false);\n      if (this.SingleDatePickerInstance.current) this.SingleDatePickerInstance.current.onDateChange(momentDate, true, true);\n    }\n  }, {\n    key: \"handleGoToThisMonthClick\",\n    value: function handleGoToThisMonthClick(event) {\n      event.stopPropagation();\n      event.preventDefault();\n      if (this.SingleDatePickerInstance.current) this.SingleDatePickerInstance.current.onVisibleMonthChange(moment__WEBPACK_IMPORTED_MODULE_2___default()());\n    }\n  }, {\n    key: \"renderFooter\",\n    value: function renderFooter() {\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"div\", {\n        className: \"u-padding u-padding-top-none\"\n      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"button\", {\n        className: \"ignore-react-onclickoutside c-button\",\n        onClick: this.handleGoToThisMonthClick\n      }, {\n        intl: intl\n      }.intl.formatMessage({\n        \"id\": \"Go to Current Month\",\n        \"defaultMessage\": \"Go to Current Month\"\n      })), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"button\", {\n        className: \"ignore-react-onclickoutside c-button u-margin-left-small\",\n        onClick: this.handleTodayClick\n      }, {\n        intl: intl\n      }.intl.formatMessage({\n        \"id\": \"Pick Today\",\n        \"defaultMessage\": \"Pick Today\"\n      })));\n    }\n  }, {\n    key: \"renderDatepicker\",\n    value: function renderDatepicker(withBorder) {\n      var _this3 = this;\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_SingleDatePicker__WEBPACK_IMPORTED_MODULE_5__[\"default\"], {\n        ref: this.SingleDatePickerInstance,\n        onDateChange: this.props.onDateChange,\n        selectedDay: this.props.selectedDay,\n        renderCalendarInfo: this.renderFooter,\n        hideKeyboardShortcutsPanel: true,\n        minDate: this.props.minDate,\n        maxDate: this.props.maxDate,\n        minYearDate: this.props.minYearDate,\n        maxYearDate: this.props.maxYearDate,\n        dropdownForMonth: this.props.dropdownForMonth || false,\n        dropdownForYear: this.props.dropdownForYear || false,\n        disabled: this.props.disabled,\n        noBorder: !withBorder,\n        initialVisibleMonth: this.props.initialVisibleMonth ? function () {\n          return _this3.props.initialVisibleMonth;\n        } : null\n      });\n    }\n  }, {\n    key: \"renderAsPopover\",\n    value: function renderAsPopover() {\n      var styleAndOrientation = this.getInlineStyleForPopover();\n      var downwardsOrientation = styleAndOrientation[1];\n      var rightOrientation = styleAndOrientation[2];\n      var extraClassName = 'c-popover--bottom-left';\n      if (!downwardsOrientation) {\n        if (!rightOrientation) extraClassName = 'c-popover--top-right';else extraClassName = 'c-popover--top-left';\n      } else if (!rightOrientation) {\n        extraClassName = 'c-popover--bottom-right';\n      }\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"div\", {\n        ref: this.containerElement,\n        id: DatePickerInPopover.containerID,\n        \"data-test-datepicker\": \"true\",\n        style: {\n          position: \"absolute\",\n          top: \"-1000px\"\n        } /* First render out of viewport to get the size of the datepicker */,\n        className: \"c-popover \".concat(extraClassName)\n      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"div\", {\n        className: \"c-popover__arrow\"\n      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"div\", {\n        className: \"c-popover__content\"\n      }, this.renderDatepicker(true)));\n    }\n  }, {\n    key: \"renderAsMenu\",\n    value: function renderAsMenu() {\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"div\", {\n        ref: this.containerElement,\n        id: DatePickerInPopover.containerID,\n        \"data-test-datepicker\": \"true\",\n        style: {\n          position: \"absolute\",\n          top: \"-1000px\"\n        } /* First render out of viewport to get the size of the datepicker */,\n        className: \"c-menu\"\n      }, this.renderDatepicker(false));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var content = this.props.as === 'popover' ? this.renderAsPopover() : this.renderAsMenu();\n      return /*#__PURE__*/react_dom__WEBPACK_IMPORTED_MODULE_4__.createPortal(content, document.body);\n    }\n  }]);\n  return DatePickerInPopover;\n}(react__WEBPACK_IMPORTED_MODULE_0__.Component);\n_defineProperty(DatePickerInPopover, \"propTypes\", {\n  alwaysShown: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool.isRequired),\n  onDateChange: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().func.isRequired),\n  selectedDay: prop_types__WEBPACK_IMPORTED_MODULE_1___default().oneOfType([(prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool), prop_types__WEBPACK_IMPORTED_MODULE_1___default().shape({})]),\n  closeDatepicker: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().func.isRequired),\n  minDate: prop_types__WEBPACK_IMPORTED_MODULE_1___default().shape({}),\n  maxDate: prop_types__WEBPACK_IMPORTED_MODULE_1___default().shape({}),\n  minYearDate: prop_types__WEBPACK_IMPORTED_MODULE_1___default().shape({}),\n  maxYearDate: prop_types__WEBPACK_IMPORTED_MODULE_1___default().shape({}),\n  dropdownForMonth: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool),\n  dropdownForYear: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool),\n  disabled: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool),\n  attachee: prop_types__WEBPACK_IMPORTED_MODULE_1___default().shape({\n    outerHeight: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().func),\n    offset: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().func)\n  }),\n  initialVisibleMonth: prop_types__WEBPACK_IMPORTED_MODULE_1___default().shape({}),\n  as: prop_types__WEBPACK_IMPORTED_MODULE_1___default().oneOf(['menu', 'popover'])\n});\n_defineProperty(DatePickerInPopover, \"defaultProps\", {\n  selectedDay: false,\n  minDate: null,\n  maxDate: null,\n  minYearDate: null,\n  maxYearDate: null,\n  dropdownForMonth: true,\n  dropdownForYear: true,\n  disabled: false,\n  as: 'popover',\n  attachee: null,\n  initialVisibleMonth: null\n});\n_defineProperty(DatePickerInPopover, \"containerID\", 'datepickerelement');\n/* harmony default export */ __webpack_exports__[\"default\"] = ((0,react_onclickoutside__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(DatePickerInPopover));//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9jb21tb24vRGF0ZVBpY2tlckluUG9wb3Zlci5qcy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBQUE7QUFzQ0E7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBSUE7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBS0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUtBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFLQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQTlQQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFnT0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9SZWFjdENvbXBvbmVudHNfLy4vY29tbW9uL0RhdGVQaWNrZXJJblBvcG92ZXIuanM/YWMyYSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcbmltcG9ydCBvbkNsaWNrT3V0c2lkZSBmcm9tICdyZWFjdC1vbmNsaWNrb3V0c2lkZSc7XG5pbXBvcnQgUmVhY3RET00gZnJvbSBcInJlYWN0LWRvbVwiO1xuaW1wb3J0IFNpbmdsZURhdGVQaWNrZXIgZnJvbSAnLi9TaW5nbGVEYXRlUGlja2VyJztcblxuY2xhc3MgRGF0ZVBpY2tlckluUG9wb3ZlciBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgYWx3YXlzU2hvd246IFByb3BUeXBlcy5ib29sLmlzUmVxdWlyZWQsXG4gICAgb25EYXRlQ2hhbmdlOiBQcm9wVHlwZXMuZnVuYy5pc1JlcXVpcmVkLFxuICAgIHNlbGVjdGVkRGF5OiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMuYm9vbCwgUHJvcFR5cGVzLnNoYXBlKHt9KV0pLFxuICAgIGNsb3NlRGF0ZXBpY2tlcjogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgICBtaW5EYXRlOiBQcm9wVHlwZXMuc2hhcGUoe30pLFxuICAgIG1heERhdGU6IFByb3BUeXBlcy5zaGFwZSh7fSksXG4gICAgbWluWWVhckRhdGU6IFByb3BUeXBlcy5zaGFwZSh7fSksXG4gICAgbWF4WWVhckRhdGU6IFByb3BUeXBlcy5zaGFwZSh7fSksXG4gICAgZHJvcGRvd25Gb3JNb250aDogUHJvcFR5cGVzLmJvb2wsXG4gICAgZHJvcGRvd25Gb3JZZWFyOiBQcm9wVHlwZXMuYm9vbCxcbiAgICBkaXNhYmxlZDogUHJvcFR5cGVzLmJvb2wsXG4gICAgYXR0YWNoZWU6IFByb3BUeXBlcy5zaGFwZSh7XG4gICAgICBvdXRlckhlaWdodDogUHJvcFR5cGVzLmZ1bmMsXG4gICAgICBvZmZzZXQ6IFByb3BUeXBlcy5mdW5jXG4gICAgfSksXG4gICAgaW5pdGlhbFZpc2libGVNb250aDogUHJvcFR5cGVzLnNoYXBlKHt9KSxcbiAgICBhczogUHJvcFR5cGVzLm9uZU9mKFsnbWVudScsICdwb3BvdmVyJ10pXG4gIH07XG5cbiAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcbiAgICBzZWxlY3RlZERheTogZmFsc2UsXG4gICAgbWluRGF0ZTogbnVsbCxcbiAgICBtYXhEYXRlOiBudWxsLFxuICAgIG1pblllYXJEYXRlOiBudWxsLFxuICAgIG1heFllYXJEYXRlOiBudWxsLFxuICAgIGRyb3Bkb3duRm9yTW9udGg6IHRydWUsXG4gICAgZHJvcGRvd25Gb3JZZWFyOiB0cnVlLFxuICAgIGRpc2FibGVkOiBmYWxzZSxcbiAgICBhczogJ3BvcG92ZXInLFxuICAgIGF0dGFjaGVlOiBudWxsLFxuICAgIGluaXRpYWxWaXNpYmxlTW9udGg6IG51bGxcbiAgfTtcblxuICBzdGF0aWMgY29udGFpbmVySUQgPSAnZGF0ZXBpY2tlcmVsZW1lbnQnO1xuXG5cbiAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG5cbiAgICB0aGlzLmNvbnRhaW5lckVsZW1lbnQgPSBSZWFjdC5jcmVhdGVSZWYoKTtcbiAgICB0aGlzLlNpbmdsZURhdGVQaWNrZXJJbnN0YW5jZSA9IFJlYWN0LmNyZWF0ZVJlZigpO1xuXG4gICAgdGhpcy5jbG9zZURhdGVwaWNrZXIgPSB0aGlzLmNsb3NlRGF0ZXBpY2tlci5iaW5kKHRoaXMpO1xuICAgIHRoaXMucmVuZGVyRm9vdGVyID0gdGhpcy5yZW5kZXJGb290ZXIuYmluZCh0aGlzKTtcbiAgICB0aGlzLmhhbmRsZVRvZGF5Q2xpY2sgPSB0aGlzLmhhbmRsZVRvZGF5Q2xpY2suYmluZCh0aGlzKTtcbiAgICB0aGlzLmhhbmRsZUdvVG9UaGlzTW9udGhDbGljayA9IHRoaXMuaGFuZGxlR29Ub1RoaXNNb250aENsaWNrLmJpbmQodGhpcyk7XG4gIH1cblxuICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICBpZiAodGhpcy5jb250YWluZXJFbGVtZW50LmN1cnJlbnQpIHtcbiAgICAgIC8qIFRpbWVvdXQgaXMgbmVjZXNzYXJ5IHRvIGdldCB0aGUgYWN0dWFsIGRpbWVuc2lvbnMgb2YgdGhlIGRhdGVwaWNrZXIgY29udGFpbmVyLlxuICAgICAgICAgSWYgY2FsY3VsYXRpbmcgaW1tZWRpYXRlbHksIHRoZSBkYXRlcGlja2VyJ3MgaGVpZ2h0IGlzIG5vdCB5ZXQgc2V0IGFuZFxuICAgICAgICAgdGhlIGNhbGN1bGF0aW9ucyB3b3VsZCB1c2UgYSB0b28gc21hbGwgaGVpZ2h0IHRvIGNhbGN1bGF0ZSB0aGUgZGF0ZXBpY2tlcidzIG9yaWVudGF0aW9uICovXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgY29uc3Qgc3R5bGVBbmRPcmllbnRhdGlvbiA9IHRoaXMuZ2V0SW5saW5lU3R5bGVGb3JQb3BvdmVyKCk7XG4gICAgICAgIGNvbnN0IGRvd253YXJkc09yaWVudGF0aW9uID0gc3R5bGVBbmRPcmllbnRhdGlvblsxXTtcbiAgICAgICAgY29uc3Qgc3R5bGUgPSBzdHlsZUFuZE9yaWVudGF0aW9uWzBdO1xuICAgICAgICBpZiAodGhpcy5wcm9wcy5hcyA9PT0gJ3BvcG92ZXInKSB7XG4gICAgICAgICAgLyogQWNjb3VudCBmb3IgdGhlIGFycm93IGluIHRoZSBwb3BvdmVyICovXG4gICAgICAgICAgc3R5bGUubGVmdCA9IGAke3BhcnNlSW50KHN0eWxlLmxlZnQpIC0gMTV9cHhgO1xuICAgICAgICAgIGlmKCFkb3dud2FyZHNPcmllbnRhdGlvbilcbiAgICAgICAgICAgIHN0eWxlLnRvcCA9IGAke3BhcnNlSW50KHN0eWxlLnRvcCkgLSAxMX1weGA7XG4gICAgICAgIH1cbiAgICAgICAgT2JqZWN0LmtleXMoc3R5bGUpXG4gICAgICAgICAgLm1hcChjc3NQcm9wZXJ0eSA9PiAkKHRoaXMuY29udGFpbmVyRWxlbWVudC5jdXJyZW50KVxuICAgICAgICAgICAgLmNzcyhjc3NQcm9wZXJ0eSwgc3R5bGVbY3NzUHJvcGVydHldKSlcbiAgICAgIH0sIDEpO1xuICAgICAgJCh0aGlzLmNvbnRhaW5lckVsZW1lbnQuY3VycmVudCkuY2xpY2soZnVuY3Rpb24oZXZlbnQpIHsgZXZlbnQucHJldmVudERlZmF1bHQoKSB9KTtcbiAgICB9XG5cbiAgfVxuXG4gIGdldENvbnRhaW5lckRpbWVuc2lvbnMoKSB7XG4gICAgaWYgKHRoaXMuY29udGFpbmVyRWxlbWVudC5jdXJyZW50KVxuICAgICAgcmV0dXJuIFskKHRoaXMuY29udGFpbmVyRWxlbWVudC5jdXJyZW50KS5vdXRlcldpZHRoKCksICQodGhpcy5jb250YWluZXJFbGVtZW50LmN1cnJlbnQpLm91dGVySGVpZ2h0KCldO1xuICAgIGVsc2VcbiAgICAgIHJldHVybiBbMzAwLDMwMF0gLyogZmFsbGJhY2sgZXN0aW1hdGlvbnMgKi9cbiAgfVxuXG4gIGdldFBvcG92ZXJPcmllbnRhdGlvbihvZmZzZXQsIGlzRml4ZWQpIHtcbiAgICBjb25zdCB2aWV3SGVpZ2h0ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCArIChpc0ZpeGVkID8gMCA6ICQoZG9jdW1lbnQpLnNjcm9sbFRvcCgpKTtcbiAgICBjb25zdCB2aWV3V2lkdGggPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGggKyAoaXNGaXhlZCA/IDAgOiAkKGRvY3VtZW50KS5zY3JvbGxMZWZ0KCkpO1xuICAgIGNvbnN0IGRwRGltZW5zaW9ucyA9IHRoaXMuZ2V0Q29udGFpbmVyRGltZW5zaW9ucygpO1xuICAgIHJldHVybiBbXG4gICAgICAhKG9mZnNldC50b3AgKyBkcERpbWVuc2lvbnNbMV0gPiB2aWV3SGVpZ2h0ICYmIHZpZXdIZWlnaHQgPiBkcERpbWVuc2lvbnNbMV0pLFxuICAgICAgIShvZmZzZXQubGVmdCArIGRwRGltZW5zaW9uc1swXSA+IHZpZXdXaWR0aCAmJiB2aWV3V2lkdGggPiBkcERpbWVuc2lvbnNbMF0pXTtcbiAgfVxuXG4gIGdldElubGluZVN0eWxlRm9yUG9wb3ZlcigpIHtcbiAgICBjb25zdCB7IGF0dGFjaGVlIH0gPSB0aGlzLnByb3BzO1xuICAgIC8qIE1ha2Ugc3VyZSB0byB1c2UgdGhlIGZpcnN0IGVsZW1lbnQgdGhhdCB3YXMgcGFzc2VkIGRvd24gKi9cbiAgICBjb25zdCAkYXR0YWNoZWUgPSAkKGF0dGFjaGVlWzBdKTtcbiAgICBsZXQgaXNGaXhlZCA9IGZhbHNlO1xuICAgIC8qIFVzZSBhIEpTIGZ1bmN0aW9uIGluc3RlYWQgb2YgRVM2IGFycm93IGZ1bmN0aW9uIG9uIG5leHQgbGluZSBiZWNhdXNlIG9mIGJpbmRpbmcgZm9yICQodGhpcykgKi9cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZnVuYy1uYW1lc1xuICAgICRhdHRhY2hlZS5wYXJlbnRzKCkuZWFjaChmdW5jdGlvbigpICB7IGlzRml4ZWQgfD0gJCh0aGlzKS5jc3MoJ3Bvc2l0aW9uJykgPT09ICdmaXhlZCc7IHJldHVybiAhaXNGaXhlZH0pO1xuIFxuICAgIC8qIEdldCB0aGUgY3VycmVudCBwb3NpdGlvbiBvZiB0aGUgZWxlbWVudCBpdCBpcyBhdHRhY2hlZCB0b1xuICAgICogVXNlICRhdHRhY2hlZVswXSB0byBtYWtlIHN1cmUgYXR0YWNoZWUgaXMgcGFzc2VkIG9uIGFzIGEganMgZWxlbWVudCBpbnN0ZWFkIG9mIGpxdWVyeVxuICAgICovXG4gICAgY29uc3QgbmF0aXZlT2Zmc2V0ID0gdGhpcy5nZXRPZmZzZXQoJGF0dGFjaGVlWzBdKTtcbiAgICBjb25zdCBhZGp1c3RlZE9mZnNldCA9IHRoaXMuYWRqdXN0T2Zmc2V0KCRhdHRhY2hlZVswXSwgbmF0aXZlT2Zmc2V0LCBpc0ZpeGVkKTtcblxuICAgIC8qIFJldHVybiBzdHlsZSBhbmQgZmxhZyBpbmRpY2F0aW5nIGl0cyBvcmllbnRhdGlvbiAqL1xuICAgIHJldHVybiBbe1xuICAgICAgcG9zaXRpb246IGlzRml4ZWQgPyAnZml4ZWQnIDogJ2Fic29sdXRlJyxcbiAgICAgIHRvcDogYCR7YWRqdXN0ZWRPZmZzZXQub2Zmc2V0LnRvcH1weGAsXG4gICAgICBsZWZ0OiBgJHthZGp1c3RlZE9mZnNldC5vZmZzZXQubGVmdH1weGAsXG4gICAgICB6SW5kZXg6IDkwMDAwMFxuICAgIH0sIGFkanVzdGVkT2Zmc2V0Lm9yaWVudGF0aW9uWzBdLCBhZGp1c3RlZE9mZnNldC5vcmllbnRhdGlvblsxXV1cbiAgfVxuXG5cbiAgZ2V0T2Zmc2V0KGVsZW1lbnQpIHtcbiAgICBsZXQgZWwgPSBlbGVtZW50O1xuICAgIGxldCB4ID0gMDtcbiAgICBsZXQgeSA9IDA7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXJlc3RyaWN0ZWQtZ2xvYmFsc1xuICAgIHdoaWxlKCBlbCAmJiAhaXNOYU4oIGVsLm9mZnNldExlZnQgKSAmJiAhaXNOYU4oIGVsLm9mZnNldFRvcCApICkge1xuICAgICAgICB4ICs9IGVsLm9mZnNldExlZnQgLSBlbC5zY3JvbGxMZWZ0O1xuICAgICAgICB5ICs9IGVsLm9mZnNldFRvcCAtIGVsLnNjcm9sbFRvcDtcbiAgICAgICAgZWwgPSBlbC5vZmZzZXRQYXJlbnQ7XG4gICAgfVxuICAgIHJldHVybiB7IHRvcDogeSwgbGVmdDogeCB9O1xuICB9XG5cbiAgYWRqdXN0T2Zmc2V0KGF0dGFjaGVlLCBvZmYsIGlzRml4ZWQpIHtcbiAgICBjb25zdCBvZmZzZXQgPSBvZmY7XG4gICAgY29uc3QgaW5wdXRIZWlnaHQgPSAkKGF0dGFjaGVlKS5vdXRlckhlaWdodCgpO1xuICAgIGNvbnN0IHZpZXdXaWR0aCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCArIChpc0ZpeGVkID8gMCA6ICQoZG9jdW1lbnQpLnNjcm9sbExlZnQoKSk7XG4gICAgY29uc3QgZHBEaW1lbnNpb25zID0gdGhpcy5nZXRDb250YWluZXJEaW1lbnNpb25zKCk7XG4gICAgLyogQWRkIHRoZSBoZWlnaHQgb2YgdGhlIGVsZW1lbnQgaXQgaXMgYXR0YWNoZWQgdG8gKi9cbiAgICBvZmZzZXQudG9wICs9IGF0dGFjaGVlLm9mZnNldEhlaWdodDtcbiAgICAvKiBBZGp1c3Qgd2hlbiB0aGUgZGF0ZXBpY2tlciBpcyBvdXRzaWRlIHRoZSB2aWV3cG9ydCAqL1xuICAgIGNvbnN0IG9yaWVudGF0aW9uID0gdGhpcy5nZXRQb3BvdmVyT3JpZW50YXRpb24ob2Zmc2V0LCBpc0ZpeGVkKTtcbiAgICBvZmZzZXQudG9wIC09IE1hdGgubWluKG9mZnNldC50b3AsICghb3JpZW50YXRpb25bMF0gPyBNYXRoLmFicyhkcERpbWVuc2lvbnNbMV0gKyBpbnB1dEhlaWdodCkgOiAwKSk7XG4gICAgb2Zmc2V0LmxlZnQgLT0gTWF0aC5taW4ob2Zmc2V0LmxlZnQsICFvcmllbnRhdGlvblsxXSA/IE1hdGguYWJzKG9mZnNldC5sZWZ0ICsgZHBEaW1lbnNpb25zWzBdIC0gdmlld1dpZHRoKSA6IDAgKTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgb2Zmc2V0LFxuICAgICAgb3JpZW50YXRpb25cbiAgICB9O1xuICB9XG5cbiAgaGFuZGxlQ2xpY2tPdXRzaWRlKGV2ZW50KSB7XG4gICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgdGhpcy5jbG9zZURhdGVwaWNrZXIoKTtcbiAgfVxuXG4gIGNsb3NlRGF0ZXBpY2tlcigpIHtcbiAgICBpZiAoIXRoaXMucHJvcHMuYWx3YXlzU2hvd24pIHtcbiAgICAgIHRoaXMucHJvcHMuY2xvc2VEYXRlcGlja2VyKCk7XG4gICAgfVxuICB9XG5cbiAgaGFuZGxlVG9kYXlDbGljayhldmVudCkge1xuICAgIGNvbnN0IHsgb25EYXRlQ2hhbmdlIH0gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IG1vbWVudERhdGUgPSBtb21lbnQoKTtcbiAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIG9uRGF0ZUNoYW5nZShtb21lbnREYXRlLCBmYWxzZSk7XG4gICAgaWYodGhpcy5TaW5nbGVEYXRlUGlja2VySW5zdGFuY2UuY3VycmVudClcbiAgICAgIHRoaXMuU2luZ2xlRGF0ZVBpY2tlckluc3RhbmNlLmN1cnJlbnQub25EYXRlQ2hhbmdlKG1vbWVudERhdGUsIHRydWUsIHRydWUpO1xuICB9XG5cbiAgaGFuZGxlR29Ub1RoaXNNb250aENsaWNrKGV2ZW50KSB7XG4gICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICBpZih0aGlzLlNpbmdsZURhdGVQaWNrZXJJbnN0YW5jZS5jdXJyZW50KVxuICAgICAgdGhpcy5TaW5nbGVEYXRlUGlja2VySW5zdGFuY2UuY3VycmVudC5vblZpc2libGVNb250aENoYW5nZShtb21lbnQoKSk7XG4gIH1cblxuICByZW5kZXJGb290ZXIoKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXYgY2xhc3NOYW1lPVwidS1wYWRkaW5nIHUtcGFkZGluZy10b3Atbm9uZVwiPlxuICAgICAgICA8YnV0dG9uIGNsYXNzTmFtZT1cImlnbm9yZS1yZWFjdC1vbmNsaWNrb3V0c2lkZSBjLWJ1dHRvblwiIG9uQ2xpY2s9e3RoaXMuaGFuZGxlR29Ub1RoaXNNb250aENsaWNrfT5cbiAgICAgICAgICB7aTE4bignR28gdG8gQ3VycmVudCBNb250aCcpfVxuICAgICAgICA8L2J1dHRvbj5cbiAgICAgICAgPGJ1dHRvbiBjbGFzc05hbWU9XCJpZ25vcmUtcmVhY3Qtb25jbGlja291dHNpZGUgYy1idXR0b24gdS1tYXJnaW4tbGVmdC1zbWFsbFwiIG9uQ2xpY2s9e3RoaXMuaGFuZGxlVG9kYXlDbGlja30+XG4gICAgICAgICAge2kxOG4oJ1BpY2sgVG9kYXknKX1cbiAgICAgICAgPC9idXR0b24+XG4gICAgICA8L2Rpdj5cbiAgICApXG4gIH1cblxuICByZW5kZXJEYXRlcGlja2VyKHdpdGhCb3JkZXIpIHtcbiAgICByZXR1cm4gKFxuICAgICAgPFNpbmdsZURhdGVQaWNrZXJcbiAgICAgICAgcmVmPXt0aGlzLlNpbmdsZURhdGVQaWNrZXJJbnN0YW5jZX1cbiAgICAgICAgb25EYXRlQ2hhbmdlPXt0aGlzLnByb3BzLm9uRGF0ZUNoYW5nZX1cbiAgICAgICAgc2VsZWN0ZWREYXk9e3RoaXMucHJvcHMuc2VsZWN0ZWREYXl9XG4gICAgICAgIHJlbmRlckNhbGVuZGFySW5mbz17dGhpcy5yZW5kZXJGb290ZXJ9XG4gICAgICAgIGhpZGVLZXlib2FyZFNob3J0Y3V0c1BhbmVsXG4gICAgICAgIG1pbkRhdGU9e3RoaXMucHJvcHMubWluRGF0ZX1cbiAgICAgICAgbWF4RGF0ZT17dGhpcy5wcm9wcy5tYXhEYXRlfVxuICAgICAgICBtaW5ZZWFyRGF0ZT17dGhpcy5wcm9wcy5taW5ZZWFyRGF0ZX1cbiAgICAgICAgbWF4WWVhckRhdGU9e3RoaXMucHJvcHMubWF4WWVhckRhdGV9XG4gICAgICAgIGRyb3Bkb3duRm9yTW9udGg9e3RoaXMucHJvcHMuZHJvcGRvd25Gb3JNb250aCB8fCBmYWxzZX1cbiAgICAgICAgZHJvcGRvd25Gb3JZZWFyPXt0aGlzLnByb3BzLmRyb3Bkb3duRm9yWWVhciB8fCBmYWxzZX1cbiAgICAgICAgZGlzYWJsZWQ9e3RoaXMucHJvcHMuZGlzYWJsZWR9XG4gICAgICAgIG5vQm9yZGVyPXshd2l0aEJvcmRlcn1cbiAgICAgICAgaW5pdGlhbFZpc2libGVNb250aD17dGhpcy5wcm9wcy5pbml0aWFsVmlzaWJsZU1vbnRoID8gKCkgPT4gdGhpcy5wcm9wcy5pbml0aWFsVmlzaWJsZU1vbnRoIDogbnVsbH1cbiAgICAgIC8+XG4gICAgKTtcbiAgfVxuXG4gIHJlbmRlckFzUG9wb3ZlcigpIHtcbiAgICBjb25zdCBzdHlsZUFuZE9yaWVudGF0aW9uID0gdGhpcy5nZXRJbmxpbmVTdHlsZUZvclBvcG92ZXIoKTtcbiAgICBjb25zdCBkb3dud2FyZHNPcmllbnRhdGlvbiA9IHN0eWxlQW5kT3JpZW50YXRpb25bMV07XG4gICAgY29uc3QgcmlnaHRPcmllbnRhdGlvbiA9IHN0eWxlQW5kT3JpZW50YXRpb25bMl07XG4gICAgbGV0IGV4dHJhQ2xhc3NOYW1lID0gJ2MtcG9wb3Zlci0tYm90dG9tLWxlZnQnO1xuICAgIGlmICghZG93bndhcmRzT3JpZW50YXRpb24pIHtcbiAgICAgIGlmICghcmlnaHRPcmllbnRhdGlvbilcbiAgICAgICAgZXh0cmFDbGFzc05hbWUgPSAnYy1wb3BvdmVyLS10b3AtcmlnaHQnO1xuICAgICAgZWxzZVxuICAgICAgICBleHRyYUNsYXNzTmFtZSA9ICdjLXBvcG92ZXItLXRvcC1sZWZ0JztcbiAgICB9IGVsc2UgaWYgKCFyaWdodE9yaWVudGF0aW9uKSB7XG4gICAgICBleHRyYUNsYXNzTmFtZSA9ICdjLXBvcG92ZXItLWJvdHRvbS1yaWdodCc7XG4gICAgfVxuICAgIHJldHVybiAoXG4gICAgICA8ZGl2XG4gICAgICAgIHJlZj17dGhpcy5jb250YWluZXJFbGVtZW50fVxuICAgICAgICBpZD17RGF0ZVBpY2tlckluUG9wb3Zlci5jb250YWluZXJJRH1cbiAgICAgICAgZGF0YS10ZXN0LWRhdGVwaWNrZXI9XCJ0cnVlXCJcbiAgICAgICAgc3R5bGU9e3twb3NpdGlvbjogXCJhYnNvbHV0ZVwiLCB0b3A6IFwiLTEwMDBweFwiIH19IC8qIEZpcnN0IHJlbmRlciBvdXQgb2Ygdmlld3BvcnQgdG8gZ2V0IHRoZSBzaXplIG9mIHRoZSBkYXRlcGlja2VyICovXG4gICAgICAgIGNsYXNzTmFtZT17YGMtcG9wb3ZlciAke2V4dHJhQ2xhc3NOYW1lfWB9XG4gICAgICA+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYy1wb3BvdmVyX19hcnJvd1wiIC8+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYy1wb3BvdmVyX19jb250ZW50XCI+XG4gICAgICAgICAge3RoaXMucmVuZGVyRGF0ZXBpY2tlcih0cnVlKX1cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICApXG4gIH1cblxuICByZW5kZXJBc01lbnUoKSB7XG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXZcbiAgICAgICAgcmVmPXt0aGlzLmNvbnRhaW5lckVsZW1lbnR9XG4gICAgICAgIGlkPXtEYXRlUGlja2VySW5Qb3BvdmVyLmNvbnRhaW5lcklEfVxuICAgICAgICBkYXRhLXRlc3QtZGF0ZXBpY2tlcj1cInRydWVcIlxuICAgICAgICBzdHlsZT17eyBwb3NpdGlvbjogXCJhYnNvbHV0ZVwiLCB0b3A6IFwiLTEwMDBweFwiIH19IC8qIEZpcnN0IHJlbmRlciBvdXQgb2Ygdmlld3BvcnQgdG8gZ2V0IHRoZSBzaXplIG9mIHRoZSBkYXRlcGlja2VyICovXG4gICAgICAgIGNsYXNzTmFtZT1cImMtbWVudVwiXG4gICAgICA+XG4gICAgICAgIHt0aGlzLnJlbmRlckRhdGVwaWNrZXIoZmFsc2UpfVxuICAgICAgPC9kaXY+XG4gICAgKVxuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IGNvbnRlbnQgPSAodGhpcy5wcm9wcy5hcyA9PT0gJ3BvcG92ZXInID8gdGhpcy5yZW5kZXJBc1BvcG92ZXIoKSA6IHRoaXMucmVuZGVyQXNNZW51KCkpO1xuICAgIHJldHVybiBSZWFjdERPTS5jcmVhdGVQb3J0YWwoY29udGVudCwgZG9jdW1lbnQuYm9keSk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgb25DbGlja091dHNpZGUoRGF0ZVBpY2tlckluUG9wb3Zlcik7XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./common/DatePickerInPopover.js\n");

/***/ }),

/***/ "./common/InputWithDatePicker.js":
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./node_modules/react/index.js\");\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./node_modules/prop-types/index.js\");\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"./node_modules/moment/moment.js\");\n/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _inputHelper__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"./common/inputHelper.js\");\n/* harmony import */ var _SpanSVGIcon__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(\"./common/SpanSVGIcon.js\");\n/* harmony import */ var _DatePickerInPopover__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(\"./common/DatePickerInPopover.js\");\n/* harmony import */ var _CommonScripts_sharedscripts_sharedscripts_globals__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(\"./CommonScripts/sharedscripts/sharedscripts-globals.js\");\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n\n\n\n\n\n\n\n/**\n * InputWithDatePicker has two modes of working.\n * One is that it works entirely in the frontend with the renderingType 'input'.\n * The other is that it gets rendered by the backend by having the renderingType 'hidden', \n * and then the frontend only controls the datepicker.\n */\nvar InputWithDatePicker = /*#__PURE__*/function (_React$Component) {\n  _inherits(InputWithDatePicker, _React$Component);\n  var _super = _createSuper(InputWithDatePicker);\n  function InputWithDatePicker(props) {\n    var _this;\n    _classCallCheck(this, InputWithDatePicker);\n    _this = _super.call(this, props);\n    _this.state = {\n      show: props.alwaysShown,\n      formattedInputDateString: props.configuration.defaultInputDate || null,\n      pickerDate: props.configuration.defaultPickerDate || null,\n      untransformedDate: null,\n      disabled: props.configuration.disabled,\n      attachee: null\n    };\n    _this.DatePickerInstance = /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createRef();\n    _this.attachDatepickerElement = props.innerRef || /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createRef();\n    _this.onFocusChange = _this.onFocusChange.bind(_assertThisInitialized(_this));\n    _this.onBlurInput = _this.onBlurInput.bind(_assertThisInitialized(_this));\n    _this.renderCalendarInfo = _this.renderCalendarInfo.bind(_assertThisInitialized(_this));\n    _this.handleCalendarIconClick = _this.handleCalendarIconClick.bind(_assertThisInitialized(_this));\n    _this.closeDatepicker = _this.closeDatepicker.bind(_assertThisInitialized(_this));\n    _this.processInput = _this.processInput.bind(_assertThisInitialized(_this));\n    _this.submitInput = _this.submitInput.bind(_assertThisInitialized(_this));\n    _this.processKeyPress = _this.processKeyPress.bind(_assertThisInitialized(_this));\n    _this.onDateSelectedInDatepicker = _this.onDateSelectedInDatepicker.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n  _createClass(InputWithDatePicker, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n      var configuration = this.props.configuration;\n      var attachToCustomElement = configuration.datepickerOptions && configuration.datepickerOptions.attachToElement;\n      if (this.attachDatepickerElement.current) {\n        this.setState({\n          attachee: attachToCustomElement ? $(attachToCustomElement) : $(this.attachDatepickerElement.current)\n        });\n        /* Install the blur event listener on the input field manually,\n            such that it can be removed to trigger a blur event without submitting the date  */\n        if (this.props.configuration.renderingType === 'input') this.attachDatepickerElement.current.addEventListener('blur', this.onBlurInput);\n\n        /* To be able to manipulate the datepickers from other scripts (treeview,...)\n        we allow the state to be manipulated via the HTML elements */\n        $(this.attachDatepickerElement.current).bind('showDatepickerAt', function (event, pickerDate, attachee) {\n          _this2.setState({\n            show: true,\n            pickerDate: pickerDate,\n            attachee: attachee\n          });\n        });\n        $(this.attachDatepickerElement.current).bind('closeDatepicker', function () {\n          _this2.closeDatepicker();\n        });\n        $(this.attachDatepickerElement.current).bind('updateDatepickerDate', function (event, pickerDate) {\n          _this2.setState({\n            pickerDate: pickerDate\n          });\n        });\n        $(this.attachDatepickerElement.current).bind('toggleDisablement', function () {\n          _this2.setState({\n            disabled: !_this2.state.disabled\n          });\n        });\n        $(this.attachDatepickerElement.current).bind('setDisablement', function (event, isDisabled) {\n          _this2.setState({\n            disabled: isDisabled\n          });\n        });\n        $(this.attachDatepickerElement.current).bind('setDate', function (event, pickerDate) {\n          var formattedInputDateString = moment__WEBPACK_IMPORTED_MODULE_2___default()(pickerDate, _CommonScripts_sharedscripts_sharedscripts_globals__WEBPACK_IMPORTED_MODULE_6__.internalJSDateFormat).format(_this2.props.configuration.dateFormat);\n          _this2.setState({\n            formattedInputDateString: formattedInputDateString,\n            pickerDate: pickerDate\n          });\n        });\n        this.attachDatepickerElement.current.getConfiguration = function () {\n          return _this2.props.configuration;\n        };\n        this.attachDatepickerElement.current.toggleDatepicker = function () {\n          _this2.setState({\n            show: !_this2.state.show\n          });\n        };\n        this.attachDatepickerElement.current.closeDatepicker = function () {\n          _this2.closeDatepicker();\n        };\n      }\n    }\n  }, {\n    key: \"onFocusChange\",\n    value: function onFocusChange(focused) {\n      if (focused) {\n        $(this.attachDatepickerElement.current).select();\n        this.setState({\n          show: true\n        });\n      }\n    }\n  }, {\n    key: \"onDateSelectedInDatepicker\",\n    value: function onDateSelectedInDatepicker(momentDate) {\n      var _this3 = this;\n      var submit = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n      this.setState({\n        formattedInputDateString: momentDate.format(this.props.configuration.dateFormat),\n        pickerDate: momentDate.format(_CommonScripts_sharedscripts_sharedscripts_globals__WEBPACK_IMPORTED_MODULE_6__.internalJSDateFormat)\n      }, function () {\n        if (submit) _this3.submitInput(true);\n      });\n    }\n  }, {\n    key: \"onBlurInput\",\n    value: function onBlurInput(event) {\n      /* Check if we need to submit the value on a blur event, default is submitting on blur unless options specify otherwise.\n         However, do not submit when the event is triggered by clicking in the datepicker */\n      var datepickerOptions = this.props.configuration.datepickerOptions;\n      var submitOnBlur = true;\n      if (datepickerOptions && datepickerOptions.submitOnBlur === false) submitOnBlur = false;\n      if (submitOnBlur && event.relatedTarget && $(event.relatedTarget).closest('#datepickerelement').length > 0) submitOnBlur = false;\n      this.submitInput(submitOnBlur);\n    }\n  }, {\n    key: \"getMomentObjectForInputDate\",\n    value: function getMomentObjectForInputDate() {\n      return moment__WEBPACK_IMPORTED_MODULE_2___default()(this.state.formattedInputDateString, this.props.configuration.dateFormat);\n    }\n  }, {\n    key: \"getMinDate\",\n    value: function getMinDate() {\n      var datepickerOptions = this.props.configuration.datepickerOptions;\n      if (datepickerOptions && datepickerOptions.minDate) return moment__WEBPACK_IMPORTED_MODULE_2___default()(datepickerOptions.minDate, _CommonScripts_sharedscripts_sharedscripts_globals__WEBPACK_IMPORTED_MODULE_6__.internalJSDateFormat);\n      return null;\n    }\n  }, {\n    key: \"getMaxDate\",\n    value: function getMaxDate() {\n      var datepickerOptions = this.props.configuration.datepickerOptions;\n      if (datepickerOptions && datepickerOptions.maxDate) return moment__WEBPACK_IMPORTED_MODULE_2___default()(datepickerOptions.maxDate, _CommonScripts_sharedscripts_sharedscripts_globals__WEBPACK_IMPORTED_MODULE_6__.internalJSDateFormat);\n      return null;\n    }\n  }, {\n    key: \"getMinimalYearDate\",\n    value: function getMinimalYearDate() {\n      var minYear = this.props.configuration.minYear;\n      if (minYear) return moment__WEBPACK_IMPORTED_MODULE_2___default()().year(minYear).month(0).date(1);\n      return null;\n    }\n  }, {\n    key: \"getMaximalYearDate\",\n    value: function getMaximalYearDate() {\n      var maxYear = this.props.configuration.maxYear;\n      if (maxYear) return moment__WEBPACK_IMPORTED_MODULE_2___default()().year(maxYear).month(11).date(31);\n      return null;\n    }\n  }, {\n    key: \"getMinimalSelectableDate\",\n    value: function getMinimalSelectableDate() {\n      return this.getMinDate() || this.getMinimalYearDate();\n    }\n  }, {\n    key: \"getMaximalSelectableDate\",\n    value: function getMaximalSelectableDate() {\n      return this.getMaxDate() || this.getMaximalYearDate();\n    }\n  }, {\n    key: \"getContainerRenderingType\",\n    value: function getContainerRenderingType() {\n      var _this$props$configura = this.props.configuration,\n        renderingTypeContainer = _this$props$configura.renderingTypeContainer,\n        renderingType = _this$props$configura.renderingType;\n      if (renderingType === 'input') return 'menu';\n      /* hidden type */\n      return renderingTypeContainer || 'popover';\n    }\n  }, {\n    key: \"processInput\",\n    value: function processInput(event) {\n      var _this$props$configura2 = this.props.configuration,\n        datepickerOptions = _this$props$configura2.datepickerOptions,\n        dateFormat = _this$props$configura2.dateFormat;\n      var inputString = event.target.value;\n      var formattedInputDateString;\n      var internalDateString;\n      if (inputString.length === 0 && datepickerOptions && datepickerOptions.allowEmptyValue) {\n        formattedInputDateString = null;\n        internalDateString = null;\n      } else {\n        var inputDateString = (0,_inputHelper__WEBPACK_IMPORTED_MODULE_3__.valueForString)(inputString, 'date');\n        formattedInputDateString = moment__WEBPACK_IMPORTED_MODULE_2___default()(inputDateString, _CommonScripts_sharedscripts_sharedscripts_globals__WEBPACK_IMPORTED_MODULE_6__.internalJSDateFormat).format(dateFormat);\n        internalDateString = moment__WEBPACK_IMPORTED_MODULE_2___default()(inputDateString, _CommonScripts_sharedscripts_sharedscripts_globals__WEBPACK_IMPORTED_MODULE_6__.internalJSDateFormat).format(_CommonScripts_sharedscripts_sharedscripts_globals__WEBPACK_IMPORTED_MODULE_6__.internalJSDateFormat);\n      }\n      this.setState({\n        formattedInputDateString: formattedInputDateString,\n        pickerDate: internalDateString,\n        untransformedDate: inputString\n      });\n    }\n  }, {\n    key: \"submitInput\",\n    value: function submitInput(forceSubmit) {\n      var _this$props = this.props,\n        configuration = _this$props.configuration,\n        alwaysShown = _this$props.alwaysShown;\n      var formattedInputDateString = this.state.formattedInputDateString;\n      var minDate = this.getMinimalSelectableDate();\n      var maxDate = this.getMaximalSelectableDate();\n      var isBeforeMinDate = minDate !== null ? this.getMomentObjectForInputDate().isBefore(minDate, 'day') : false;\n      var isAfterMaxDate = maxDate !== null ? this.getMomentObjectForInputDate().isAfter(maxDate, 'day') : false;\n      var validFormattedInputDateString = formattedInputDateString;\n      if (isBeforeMinDate) {\n        if (configuration.datepickerOptions && configuration.datepickerOptions.resetWhenOutOfRange) validFormattedInputDateString = '';else validFormattedInputDateString = minDate.format(configuration.dateFormat);\n      }\n      if (isAfterMaxDate) {\n        if (configuration.datepickerOptions && configuration.datepickerOptions.resetWhenOutOfRange) validFormattedInputDateString = '';else validFormattedInputDateString = maxDate.format(configuration.dateFormat);\n      }\n      if (forceSubmit) {\n        configuration.scriptOnDateChange(validFormattedInputDateString);\n        this.setState({\n          formattedInputDateString: validFormattedInputDateString,\n          pickerDate: moment__WEBPACK_IMPORTED_MODULE_2___default()(validFormattedInputDateString, this.props.configuration.dateFormat).format(_CommonScripts_sharedscripts_sharedscripts_globals__WEBPACK_IMPORTED_MODULE_6__.internalJSDateFormat),\n          untransformedDate: null,\n          show: alwaysShown || false\n        });\n      }\n    }\n  }, {\n    key: \"isValidInternalDateString\",\n    value: function isValidInternalDateString(dateString) {\n      var date = moment__WEBPACK_IMPORTED_MODULE_2___default()(dateString, _CommonScripts_sharedscripts_sharedscripts_globals__WEBPACK_IMPORTED_MODULE_6__.internalJSDateFormat);\n      return date.isValid();\n    }\n  }, {\n    key: \"processKeyPress\",\n    value: function processKeyPress(event) {\n      if (event.key === 'Enter' || event.key === 'Tab') {\n        event.preventDefault();\n        event.stopPropagation();\n        this.submitInput(true);\n        /* Blur the input, but do not trigger the blur event listener to prevent a second submission */\n        event.target.removeEventListener('blur', this.onBlurInput);\n        event.target.blur();\n        event.target.addEventListener('blur', this.onBlurInput);\n        return;\n      }\n      if (event.key === 'Escape') {\n        this.closeDatepicker();\n      }\n    }\n  }, {\n    key: \"closeDatepicker\",\n    value: function closeDatepicker() {\n      this.setState({\n        show: false\n      });\n    }\n  }, {\n    key: \"handleCalendarIconClick\",\n    value: function handleCalendarIconClick() {\n      var disabled = this.state.disabled;\n      if (!this.props.alwaysShown && !disabled) {\n        this.setState({\n          show: true\n        });\n      }\n    }\n  }, {\n    key: \"renderCalendarInfo\",\n    value: function renderCalendarInfo() {\n      var _this4 = this;\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"a\", {\n        className: \"close\",\n        onClick: function onClick() {\n          return _this4.onFocusChange(false);\n        },\n        title: {\n          intl: intl\n        }.intl.formatMessage({\n          \"id\": \"close\",\n          \"defaultMessage\": \"close\"\n        })\n      });\n    }\n  }, {\n    key: \"renderInputWithDatepicker\",\n    value: function renderInputWithDatepicker() {\n      var _this5 = this;\n      var _this$props$configura3 = this.props.configuration,\n        invalidValue = _this$props$configura3.invalidValue,\n        showIconForInput = _this$props$configura3.showIconForInput,\n        datepickerOptions = _this$props$configura3.datepickerOptions,\n        dateFormat = _this$props$configura3.dateFormat;\n      var _this$state = this.state,\n        disabled = _this$state.disabled,\n        untransformedDate = _this$state.untransformedDate,\n        formattedInputDateString = _this$state.formattedInputDateString;\n      var valueForInput = untransformedDate;\n      var showAsInvalid = datepickerOptions && datepickerOptions.showInvalidValueIcon && invalidValue;\n      if (untransformedDate === null) {\n        if (formattedInputDateString === null) valueForInput = '';else if (this.getMomentObjectForInputDate().isValid()) valueForInput = this.getMomentObjectForInputDate().format(dateFormat); // need to check later if double work is being done w.r.t. dateFormat\n        else valueForInput = {\n          intl: intl\n        }.intl.formatMessage({\n          \"id\": \"Invalid date\",\n          \"defaultMessage\": \"Invalid date\"\n        });\n      }\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"div\", {\n        className: \"c-control-group c-control-group--inline\"\n      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"div\", {\n        className: \"c-control-group__item c-control-text c-control-text--short \".concat(showAsInvalid ? 'is-invalid' : '', \" \")\n      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"input\", {\n        ref: this.attachDatepickerElement,\n        disabled: disabled,\n        type: \"text\",\n        className: \"dev-attachdatepicker c-control-text__input text \".concat(disabled ? ' is-disabled' : ''),\n        value: valueForInput,\n        placeholder: {\n          intl: intl\n        }.intl.formatMessage({\n          \"id\": \"dd-mm-yyyy\",\n          \"defaultMessage\": \"dd-mm-yyyy\"\n        }),\n        onKeyDown: this.processKeyPress,\n        onChange: this.processInput,\n        onFocus: function onFocus() {\n          return _this5.onFocusChange(true);\n        },\n        \"data-test-hasdatepicker\": \"true\",\n        autoComplete: \"off\"\n      }), showAsInvalid && this.renderInvalidValueIcon()), showIconForInput && this.renderDatepickerButton()), this.props.alwaysShown && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"div\", {\n        className: \"u-padding-small\"\n      }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"div\", {\n        style: {\n          right: 'auto',\n          top: 'auto'\n        },\n        ref: function ref(_ref) {\n          _this5.standaloneElement = _ref;\n        }\n      })));\n    }\n  }, {\n    key: \"renderDatepickerIcon\",\n    value: function renderDatepickerIcon() {\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_SpanSVGIcon__WEBPACK_IMPORTED_MODULE_4__[\"default\"], {\n        icon: \"calendar-24\",\n        block: true,\n        subhead: true\n      });\n    }\n  }, {\n    key: \"renderDatepickerButton\",\n    value: function renderDatepickerButton() {\n      var disabled = this.state.disabled;\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"div\", {\n        className: \"c-control-info c-control-group__item \".concat(disabled ? 'is-disabled' : ''),\n        onClick: this.handleCalendarIconClick,\n        title: \"\".concat({\n          intl: intl\n        }.intl.formatMessage({\n          \"id\": \"Open date picker\",\n          \"defaultMessage\": \"Open date picker\"\n        }), \".\")\n      }, this.renderDatepickerIcon());\n    }\n  }, {\n    key: \"renderHiddenContainerForDatepicker\",\n    value: function renderHiddenContainerForDatepicker() {\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"div\", {\n        ref: this.attachDatepickerElement,\n        className: \"dev-attachdatepicker ignore-react-onclickoutside\",\n        style: {\n          display: 'none'\n        }\n      });\n    }\n  }, {\n    key: \"renderInvalidValueIcon\",\n    value: function renderInvalidValueIcon() {\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"div\", {\n        className: \"c-control-text__status-icon\"\n      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_SpanSVGIcon__WEBPACK_IMPORTED_MODULE_4__[\"default\"], {\n        error: true,\n        icon: \"warning\"\n      }));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props2 = this.props,\n        configuration = _this$props2.configuration,\n        alwaysShown = _this$props2.alwaysShown;\n      var _this$state2 = this.state,\n        show = _this$state2.show,\n        pickerDate = _this$state2.pickerDate,\n        disabled = _this$state2.disabled,\n        attachee = _this$state2.attachee;\n      var datepickerOptions = configuration.datepickerOptions;\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment, null, configuration.renderingType === 'input' && this.renderInputWithDatepicker(), configuration.renderingType === 'hidden' && this.renderHiddenContainerForDatepicker(), show && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_DatePickerInPopover__WEBPACK_IMPORTED_MODULE_5__[\"default\"], {\n        ref: this.DatePickerInstance,\n        selectedDay: this.isValidInternalDateString(pickerDate) ? moment__WEBPACK_IMPORTED_MODULE_2___default()(pickerDate, _CommonScripts_sharedscripts_sharedscripts_globals__WEBPACK_IMPORTED_MODULE_6__.internalJSDateFormat) : null,\n        onDateChange: this.onDateSelectedInDatepicker,\n        dropdownForMonth: true,\n        dropdownForYear: true,\n        minYearDate: this.getMinimalYearDate(),\n        maxYearDate: this.getMaximalYearDate(),\n        disabled: disabled,\n        alwaysShown: alwaysShown,\n        closeDatepicker: this.closeDatepicker,\n        minDate: this.getMinDate(),\n        maxDate: this.getMaxDate(),\n        attachee: attachee,\n        as: this.getContainerRenderingType(),\n        initialVisibleMonth: datepickerOptions && datepickerOptions.initialVisibleMonth ? moment__WEBPACK_IMPORTED_MODULE_2___default()(datepickerOptions.initialVisibleMonth, _CommonScripts_sharedscripts_sharedscripts_globals__WEBPACK_IMPORTED_MODULE_6__.internalJSDateFormat) : null\n      }));\n    }\n  }]);\n  return InputWithDatePicker;\n}(react__WEBPACK_IMPORTED_MODULE_0__.Component);\n_defineProperty(InputWithDatePicker, \"propTypes\", {\n  alwaysShown: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool),\n  configuration: prop_types__WEBPACK_IMPORTED_MODULE_1___default().shape({\n    defaultInputDate: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().string),\n    // The defaultInputDate is a default value for the formattedInputDateString\n    defaultPickerDate: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().string),\n    // The defaultPickerDate is an internal representation for the date picker in YYYY-MM-DD\n    renderingType: prop_types__WEBPACK_IMPORTED_MODULE_1___default().oneOf(['input', 'hidden']),\n    renderingTypeContainer: prop_types__WEBPACK_IMPORTED_MODULE_1___default().oneOf(['popover', 'menu']),\n    minYear: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().string),\n    maxYear: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().string),\n    dateFormat: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().string),\n    disabled: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool),\n    invalidValue: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool),\n    scriptOnDateChange: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().func),\n    datepickerOptions: prop_types__WEBPACK_IMPORTED_MODULE_1___default().shape({\n      attachToElement: prop_types__WEBPACK_IMPORTED_MODULE_1___default().oneOfType([(prop_types__WEBPACK_IMPORTED_MODULE_1___default().string), prop_types__WEBPACK_IMPORTED_MODULE_1___default().shape({})]),\n      submitOnBlur: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool),\n      minDate: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().string),\n      maxDate: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().string),\n      resetWhenOutOfRange: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool),\n      showInvalidValueIcon: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool),\n      initialVisibleMonth: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().string),\n      allowEmptyValue: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool)\n    }),\n    showIconForInput: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool)\n  }).isRequired,\n  innerRef: prop_types__WEBPACK_IMPORTED_MODULE_1___default().shape({})\n});\n_defineProperty(InputWithDatePicker, \"defaultProps\", {\n  alwaysShown: false,\n  innerRef: null\n});\n/* harmony default export */ __webpack_exports__[\"default\"] = (/*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.forwardRef(function (props, ref) {\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(InputWithDatePicker, _extends({}, props, {\n    innerRef: ref\n  }));\n}));//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9jb21tb24vSW5wdXRXaXRoRGF0ZVBpY2tlci5qcy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUxBO0FBT0E7QUFBQTtBQWtDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBRUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQUE7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBRUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBUUE7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFNQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFLQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBQUE7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUVBO0FBT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFLQTtBQUFBO0FBQUE7QUFBQTtBQXBaQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFHQTtBQUNBO0FBQ0E7QUF1WEE7QUFBQTtBQUNBO0FBQUE7QUFBQSIsInNvdXJjZXMiOlsid2VicGFjazovL1JlYWN0Q29tcG9uZW50c18vLi9jb21tb24vSW5wdXRXaXRoRGF0ZVBpY2tlci5qcz83MDQxIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCAgZnJvbSAncmVhY3QnO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcbmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcbmltcG9ydCB7IHZhbHVlRm9yU3RyaW5nIH0gZnJvbSAnLi9pbnB1dEhlbHBlcic7XG5pbXBvcnQgU3BhblNWR0ljb24gZnJvbSAnLi9TcGFuU1ZHSWNvbic7XG5pbXBvcnQgRGF0ZVBpY2tlckluUG9wb3ZlciBmcm9tICcuL0RhdGVQaWNrZXJJblBvcG92ZXInO1xuaW1wb3J0IHtpbnRlcm5hbEpTRGF0ZUZvcm1hdH0gZnJvbSAnLi4vQ29tbW9uU2NyaXB0cy9zaGFyZWRzY3JpcHRzL3NoYXJlZHNjcmlwdHMtZ2xvYmFscyc7XG5cbi8qKlxuICogSW5wdXRXaXRoRGF0ZVBpY2tlciBoYXMgdHdvIG1vZGVzIG9mIHdvcmtpbmcuXG4gKiBPbmUgaXMgdGhhdCBpdCB3b3JrcyBlbnRpcmVseSBpbiB0aGUgZnJvbnRlbmQgd2l0aCB0aGUgcmVuZGVyaW5nVHlwZSAnaW5wdXQnLlxuICogVGhlIG90aGVyIGlzIHRoYXQgaXQgZ2V0cyByZW5kZXJlZCBieSB0aGUgYmFja2VuZCBieSBoYXZpbmcgdGhlIHJlbmRlcmluZ1R5cGUgJ2hpZGRlbicsIFxuICogYW5kIHRoZW4gdGhlIGZyb250ZW5kIG9ubHkgY29udHJvbHMgdGhlIGRhdGVwaWNrZXIuXG4gKi9cblxuY2xhc3MgSW5wdXRXaXRoRGF0ZVBpY2tlciBleHRlbmRzIFJlYWN0LkNvbXBvbmVudCB7XG4gIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgYWx3YXlzU2hvd246IFByb3BUeXBlcy5ib29sLFxuICAgIGNvbmZpZ3VyYXRpb246IFByb3BUeXBlcy5zaGFwZSh7XG4gICAgICBkZWZhdWx0SW5wdXREYXRlOiBQcm9wVHlwZXMuc3RyaW5nLCAvLyBUaGUgZGVmYXVsdElucHV0RGF0ZSBpcyBhIGRlZmF1bHQgdmFsdWUgZm9yIHRoZSBmb3JtYXR0ZWRJbnB1dERhdGVTdHJpbmdcbiAgICAgIGRlZmF1bHRQaWNrZXJEYXRlOiBQcm9wVHlwZXMuc3RyaW5nLCAvLyBUaGUgZGVmYXVsdFBpY2tlckRhdGUgaXMgYW4gaW50ZXJuYWwgcmVwcmVzZW50YXRpb24gZm9yIHRoZSBkYXRlIHBpY2tlciBpbiBZWVlZLU1NLUREXG4gICAgICByZW5kZXJpbmdUeXBlOiBQcm9wVHlwZXMub25lT2YoWydpbnB1dCcsICdoaWRkZW4nXSksXG4gICAgICByZW5kZXJpbmdUeXBlQ29udGFpbmVyOiBQcm9wVHlwZXMub25lT2YoWydwb3BvdmVyJywgJ21lbnUnXSksXG4gICAgICBtaW5ZZWFyOiBQcm9wVHlwZXMuc3RyaW5nLFxuICAgICAgbWF4WWVhcjogUHJvcFR5cGVzLnN0cmluZyxcbiAgICAgIGRhdGVGb3JtYXQ6IFByb3BUeXBlcy5zdHJpbmcsXG4gICAgICBkaXNhYmxlZDogUHJvcFR5cGVzLmJvb2wsXG4gICAgICBpbnZhbGlkVmFsdWU6IFByb3BUeXBlcy5ib29sLFxuICAgICAgc2NyaXB0T25EYXRlQ2hhbmdlOiBQcm9wVHlwZXMuZnVuYyxcbiAgICAgIGRhdGVwaWNrZXJPcHRpb25zOiBQcm9wVHlwZXMuc2hhcGUoe1xuICAgICAgICBhdHRhY2hUb0VsZW1lbnQ6IFByb3BUeXBlcy5vbmVPZlR5cGUoW1Byb3BUeXBlcy5zdHJpbmcsIFByb3BUeXBlcy5zaGFwZSh7fSldKSxcbiAgICAgICAgc3VibWl0T25CbHVyOiBQcm9wVHlwZXMuYm9vbCxcbiAgICAgICAgbWluRGF0ZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgICAgICAgbWF4RGF0ZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgICAgICAgcmVzZXRXaGVuT3V0T2ZSYW5nZTogUHJvcFR5cGVzLmJvb2wsXG4gICAgICAgIHNob3dJbnZhbGlkVmFsdWVJY29uOiBQcm9wVHlwZXMuYm9vbCxcbiAgICAgICAgaW5pdGlhbFZpc2libGVNb250aDogUHJvcFR5cGVzLnN0cmluZyxcbiAgICAgICAgYWxsb3dFbXB0eVZhbHVlOiBQcm9wVHlwZXMuYm9vbFxuICAgICAgfSksXG4gICAgICBzaG93SWNvbkZvcklucHV0OiBQcm9wVHlwZXMuYm9vbCxcbiAgICB9KS5pc1JlcXVpcmVkLFxuICAgIGlubmVyUmVmOiBQcm9wVHlwZXMuc2hhcGUoe30pXG4gIH07XG5cbiAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcbiAgICBhbHdheXNTaG93bjogZmFsc2UsXG4gICAgaW5uZXJSZWY6IG51bGwsXG4gIH07XG5cbiAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcyk7XG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIHNob3c6IHByb3BzLmFsd2F5c1Nob3duLFxuICAgICAgZm9ybWF0dGVkSW5wdXREYXRlU3RyaW5nOiAocHJvcHMuY29uZmlndXJhdGlvbi5kZWZhdWx0SW5wdXREYXRlIHx8IG51bGwpLFxuICAgICAgcGlja2VyRGF0ZTogKHByb3BzLmNvbmZpZ3VyYXRpb24uZGVmYXVsdFBpY2tlckRhdGUgfHwgbnVsbCksXG4gICAgICB1bnRyYW5zZm9ybWVkRGF0ZTogbnVsbCxcbiAgICAgIGRpc2FibGVkOiBwcm9wcy5jb25maWd1cmF0aW9uLmRpc2FibGVkLFxuICAgICAgYXR0YWNoZWU6IG51bGxcbiAgICB9O1xuXG4gICAgdGhpcy5EYXRlUGlja2VySW5zdGFuY2UgPSBSZWFjdC5jcmVhdGVSZWYoKTtcbiAgICB0aGlzLmF0dGFjaERhdGVwaWNrZXJFbGVtZW50ID0gcHJvcHMuaW5uZXJSZWYgfHwgUmVhY3QuY3JlYXRlUmVmKCk7XG5cbiAgICB0aGlzLm9uRm9jdXNDaGFuZ2UgPSB0aGlzLm9uRm9jdXNDaGFuZ2UuYmluZCh0aGlzKTtcbiAgICB0aGlzLm9uQmx1cklucHV0ID0gdGhpcy5vbkJsdXJJbnB1dC5iaW5kKHRoaXMpO1xuICAgIHRoaXMucmVuZGVyQ2FsZW5kYXJJbmZvID0gdGhpcy5yZW5kZXJDYWxlbmRhckluZm8uYmluZCh0aGlzKTtcbiAgICB0aGlzLmhhbmRsZUNhbGVuZGFySWNvbkNsaWNrID0gdGhpcy5oYW5kbGVDYWxlbmRhckljb25DbGljay5iaW5kKHRoaXMpO1xuICAgIHRoaXMuY2xvc2VEYXRlcGlja2VyID0gdGhpcy5jbG9zZURhdGVwaWNrZXIuYmluZCh0aGlzKTtcbiAgICB0aGlzLnByb2Nlc3NJbnB1dCA9IHRoaXMucHJvY2Vzc0lucHV0LmJpbmQodGhpcyk7XG4gICAgdGhpcy5zdWJtaXRJbnB1dCA9IHRoaXMuc3VibWl0SW5wdXQuYmluZCh0aGlzKTtcbiAgICB0aGlzLnByb2Nlc3NLZXlQcmVzcyA9IHRoaXMucHJvY2Vzc0tleVByZXNzLmJpbmQodGhpcyk7XG4gICAgdGhpcy5vbkRhdGVTZWxlY3RlZEluRGF0ZXBpY2tlciA9IHRoaXMub25EYXRlU2VsZWN0ZWRJbkRhdGVwaWNrZXIuYmluZCh0aGlzKTtcbiAgfVxuXG4gIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgIGNvbnN0IHsgY29uZmlndXJhdGlvbiB9ID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCBhdHRhY2hUb0N1c3RvbUVsZW1lbnQgPSBjb25maWd1cmF0aW9uLmRhdGVwaWNrZXJPcHRpb25zICYmIGNvbmZpZ3VyYXRpb24uZGF0ZXBpY2tlck9wdGlvbnMuYXR0YWNoVG9FbGVtZW50O1xuICAgIGlmICh0aGlzLmF0dGFjaERhdGVwaWNrZXJFbGVtZW50LmN1cnJlbnQpIHtcbiAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICBhdHRhY2hlZTogYXR0YWNoVG9DdXN0b21FbGVtZW50ID8gJChhdHRhY2hUb0N1c3RvbUVsZW1lbnQpIDogJCh0aGlzLmF0dGFjaERhdGVwaWNrZXJFbGVtZW50LmN1cnJlbnQpXG4gICAgICB9KTtcbiAgICAgIC8qIEluc3RhbGwgdGhlIGJsdXIgZXZlbnQgbGlzdGVuZXIgb24gdGhlIGlucHV0IGZpZWxkIG1hbnVhbGx5LFxuICAgICAgICAgIHN1Y2ggdGhhdCBpdCBjYW4gYmUgcmVtb3ZlZCB0byB0cmlnZ2VyIGEgYmx1ciBldmVudCB3aXRob3V0IHN1Ym1pdHRpbmcgdGhlIGRhdGUgICovXG4gICAgICBpZih0aGlzLnByb3BzLmNvbmZpZ3VyYXRpb24ucmVuZGVyaW5nVHlwZSA9PT0gJ2lucHV0JylcbiAgICAgICAgdGhpcy5hdHRhY2hEYXRlcGlja2VyRWxlbWVudC5jdXJyZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCB0aGlzLm9uQmx1cklucHV0KTtcblxuICAgICAgLyogVG8gYmUgYWJsZSB0byBtYW5pcHVsYXRlIHRoZSBkYXRlcGlja2VycyBmcm9tIG90aGVyIHNjcmlwdHMgKHRyZWV2aWV3LC4uLilcbiAgICB3ZSBhbGxvdyB0aGUgc3RhdGUgdG8gYmUgbWFuaXB1bGF0ZWQgdmlhIHRoZSBIVE1MIGVsZW1lbnRzICovXG4gICAgICAkKHRoaXMuYXR0YWNoRGF0ZXBpY2tlckVsZW1lbnQuY3VycmVudCkuYmluZCgnc2hvd0RhdGVwaWNrZXJBdCcsIChldmVudCwgcGlja2VyRGF0ZSwgYXR0YWNoZWUpID0+IHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgc2hvdzogdHJ1ZSxcbiAgICAgICAgICBwaWNrZXJEYXRlLFxuICAgICAgICAgIGF0dGFjaGVlXG4gICAgICAgIH0pXG4gICAgICB9KTtcbiAgICAgICQodGhpcy5hdHRhY2hEYXRlcGlja2VyRWxlbWVudC5jdXJyZW50KS5iaW5kKCdjbG9zZURhdGVwaWNrZXInLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuY2xvc2VEYXRlcGlja2VyKCk7XG4gICAgICB9KTtcbiAgICAgICQodGhpcy5hdHRhY2hEYXRlcGlja2VyRWxlbWVudC5jdXJyZW50KS5iaW5kKCd1cGRhdGVEYXRlcGlja2VyRGF0ZScsIChldmVudCwgcGlja2VyRGF0ZSkgPT4ge1xuICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICBwaWNrZXJEYXRlXG4gICAgICAgIH0pXG4gICAgICB9KTtcbiAgICAgICQodGhpcy5hdHRhY2hEYXRlcGlja2VyRWxlbWVudC5jdXJyZW50KS5iaW5kKCd0b2dnbGVEaXNhYmxlbWVudCcsICAoKSA9PiB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgIGRpc2FibGVkOiAhdGhpcy5zdGF0ZS5kaXNhYmxlZFxuICAgICAgICB9KVxuICAgICAgfSk7XG4gICAgICAkKHRoaXMuYXR0YWNoRGF0ZXBpY2tlckVsZW1lbnQuY3VycmVudCkuYmluZCgnc2V0RGlzYWJsZW1lbnQnLCAgKGV2ZW50LCBpc0Rpc2FibGVkKSA9PiB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgIGRpc2FibGVkOiBpc0Rpc2FibGVkXG4gICAgICAgIH0pXG4gICAgICB9KTtcbiAgICAgICQodGhpcy5hdHRhY2hEYXRlcGlja2VyRWxlbWVudC5jdXJyZW50KS5iaW5kKCdzZXREYXRlJywgKGV2ZW50LCBwaWNrZXJEYXRlKSA9PiB7XG4gICAgICAgIGNvbnN0IGZvcm1hdHRlZElucHV0RGF0ZVN0cmluZyA9IG1vbWVudChwaWNrZXJEYXRlLCBpbnRlcm5hbEpTRGF0ZUZvcm1hdCkuZm9ybWF0KHRoaXMucHJvcHMuY29uZmlndXJhdGlvbi5kYXRlRm9ybWF0KTtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgZm9ybWF0dGVkSW5wdXREYXRlU3RyaW5nLFxuICAgICAgICAgIHBpY2tlckRhdGVcbiAgICAgICAgfSlcbiAgICAgIH0pO1xuICAgICAgdGhpcy5hdHRhY2hEYXRlcGlja2VyRWxlbWVudC5jdXJyZW50LmdldENvbmZpZ3VyYXRpb24gPSAoKSA9PiB7XG4gICAgICAgIHJldHVybiB0aGlzLnByb3BzLmNvbmZpZ3VyYXRpb25cbiAgICAgIH07XG4gICAgICB0aGlzLmF0dGFjaERhdGVwaWNrZXJFbGVtZW50LmN1cnJlbnQudG9nZ2xlRGF0ZXBpY2tlciA9ICgpID0+IHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgc2hvdzogIXRoaXMuc3RhdGUuc2hvd1xuICAgICAgICB9KVxuICAgICAgfTtcbiAgICAgIHRoaXMuYXR0YWNoRGF0ZXBpY2tlckVsZW1lbnQuY3VycmVudC5jbG9zZURhdGVwaWNrZXIgPSAoKSA9PiB7XG4gICAgICAgIHRoaXMuY2xvc2VEYXRlcGlja2VyKCk7XG4gICAgICB9O1xuICAgIH1cbiAgfVxuXG4gIG9uRm9jdXNDaGFuZ2UoZm9jdXNlZCkge1xuICAgIGlmIChmb2N1c2VkKSB7XG4gICAgICAkKHRoaXMuYXR0YWNoRGF0ZXBpY2tlckVsZW1lbnQuY3VycmVudCkuc2VsZWN0KCk7XG4gICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgc2hvdzogdHJ1ZVxuICAgICAgfSlcbiAgICB9XG4gIH1cblxuICBvbkRhdGVTZWxlY3RlZEluRGF0ZXBpY2tlcihtb21lbnREYXRlLCBzdWJtaXQgPSB0cnVlKSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICBmb3JtYXR0ZWRJbnB1dERhdGVTdHJpbmc6IG1vbWVudERhdGUuZm9ybWF0KHRoaXMucHJvcHMuY29uZmlndXJhdGlvbi5kYXRlRm9ybWF0KSxcbiAgICAgIHBpY2tlckRhdGU6IG1vbWVudERhdGUuZm9ybWF0KGludGVybmFsSlNEYXRlRm9ybWF0KVxuICAgIH0sICgpID0+IHsgaWYgKHN1Ym1pdCkgdGhpcy5zdWJtaXRJbnB1dCh0cnVlKSB9KTtcbiAgfVxuXG4gIG9uQmx1cklucHV0KGV2ZW50KSB7XG4gICAgLyogQ2hlY2sgaWYgd2UgbmVlZCB0byBzdWJtaXQgdGhlIHZhbHVlIG9uIGEgYmx1ciBldmVudCwgZGVmYXVsdCBpcyBzdWJtaXR0aW5nIG9uIGJsdXIgdW5sZXNzIG9wdGlvbnMgc3BlY2lmeSBvdGhlcndpc2UuXG4gICAgICAgSG93ZXZlciwgZG8gbm90IHN1Ym1pdCB3aGVuIHRoZSBldmVudCBpcyB0cmlnZ2VyZWQgYnkgY2xpY2tpbmcgaW4gdGhlIGRhdGVwaWNrZXIgKi9cbiAgICBjb25zdCB7IGRhdGVwaWNrZXJPcHRpb25zIH0gPSB0aGlzLnByb3BzLmNvbmZpZ3VyYXRpb247XG4gICAgbGV0IHN1Ym1pdE9uQmx1ciA9IHRydWU7XG4gICAgaWYgKGRhdGVwaWNrZXJPcHRpb25zICYmIGRhdGVwaWNrZXJPcHRpb25zLnN1Ym1pdE9uQmx1ciA9PT0gZmFsc2UpXG4gICAgICBzdWJtaXRPbkJsdXIgPSBmYWxzZTtcbiAgICBpZiAoc3VibWl0T25CbHVyICYmIGV2ZW50LnJlbGF0ZWRUYXJnZXQgJiYgJChldmVudC5yZWxhdGVkVGFyZ2V0KS5jbG9zZXN0KCcjZGF0ZXBpY2tlcmVsZW1lbnQnKS5sZW5ndGggPiAwKVxuICAgICAgc3VibWl0T25CbHVyID0gZmFsc2U7XG4gICAgdGhpcy5zdWJtaXRJbnB1dChzdWJtaXRPbkJsdXIpO1xuICB9XG5cbiAgZ2V0TW9tZW50T2JqZWN0Rm9ySW5wdXREYXRlKCkge1xuICAgIHJldHVybiBtb21lbnQodGhpcy5zdGF0ZS5mb3JtYXR0ZWRJbnB1dERhdGVTdHJpbmcsIHRoaXMucHJvcHMuY29uZmlndXJhdGlvbi5kYXRlRm9ybWF0KVxuICB9XG5cbiAgZ2V0TWluRGF0ZSgpIHtcbiAgICBjb25zdCB7IGRhdGVwaWNrZXJPcHRpb25zIH0gPSB0aGlzLnByb3BzLmNvbmZpZ3VyYXRpb247XG4gICAgaWYoZGF0ZXBpY2tlck9wdGlvbnMgJiYgZGF0ZXBpY2tlck9wdGlvbnMubWluRGF0ZSlcbiAgICAgIHJldHVybiBtb21lbnQoZGF0ZXBpY2tlck9wdGlvbnMubWluRGF0ZSwgaW50ZXJuYWxKU0RhdGVGb3JtYXQpO1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgZ2V0TWF4RGF0ZSgpIHtcbiAgICBjb25zdCB7IGRhdGVwaWNrZXJPcHRpb25zIH0gPSB0aGlzLnByb3BzLmNvbmZpZ3VyYXRpb247XG4gICAgaWYoZGF0ZXBpY2tlck9wdGlvbnMgJiYgZGF0ZXBpY2tlck9wdGlvbnMubWF4RGF0ZSlcbiAgICAgIHJldHVybiBtb21lbnQoZGF0ZXBpY2tlck9wdGlvbnMubWF4RGF0ZSwgaW50ZXJuYWxKU0RhdGVGb3JtYXQpO1xuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgZ2V0TWluaW1hbFllYXJEYXRlKCkge1xuICAgIGNvbnN0IHsgbWluWWVhciB9ID0gdGhpcy5wcm9wcy5jb25maWd1cmF0aW9uO1xuICAgIGlmIChtaW5ZZWFyKVxuICAgICAgcmV0dXJuIG1vbWVudCgpLnllYXIobWluWWVhcikubW9udGgoMCkuZGF0ZSgxKTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIGdldE1heGltYWxZZWFyRGF0ZSgpIHtcbiAgICBjb25zdCB7IG1heFllYXIgfSA9IHRoaXMucHJvcHMuY29uZmlndXJhdGlvbjtcbiAgICBpZiAobWF4WWVhcilcbiAgICAgIHJldHVybiBtb21lbnQoKS55ZWFyKG1heFllYXIpLm1vbnRoKDExKS5kYXRlKDMxKTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIGdldE1pbmltYWxTZWxlY3RhYmxlRGF0ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRNaW5EYXRlKCkgfHwgdGhpcy5nZXRNaW5pbWFsWWVhckRhdGUoKTtcbiAgfVxuXG4gIGdldE1heGltYWxTZWxlY3RhYmxlRGF0ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRNYXhEYXRlKCkgfHwgdGhpcy5nZXRNYXhpbWFsWWVhckRhdGUoKTtcbiAgfVxuXG4gIGdldENvbnRhaW5lclJlbmRlcmluZ1R5cGUoKSB7XG4gICAgY29uc3QgeyByZW5kZXJpbmdUeXBlQ29udGFpbmVyLCByZW5kZXJpbmdUeXBlIH0gPSB0aGlzLnByb3BzLmNvbmZpZ3VyYXRpb247XG4gICAgaWYgKHJlbmRlcmluZ1R5cGUgPT09ICdpbnB1dCcpXG4gICAgICByZXR1cm4gJ21lbnUnO1xuICAgIC8qIGhpZGRlbiB0eXBlICovXG4gICAgcmV0dXJuIHJlbmRlcmluZ1R5cGVDb250YWluZXIgfHwgJ3BvcG92ZXInO1xuICB9XG5cbiAgcHJvY2Vzc0lucHV0KGV2ZW50KSB7XG4gICAgY29uc3QgeyBkYXRlcGlja2VyT3B0aW9ucywgZGF0ZUZvcm1hdCB9ID0gdGhpcy5wcm9wcy5jb25maWd1cmF0aW9uO1xuICAgIGNvbnN0IGlucHV0U3RyaW5nID0gZXZlbnQudGFyZ2V0LnZhbHVlO1xuICAgIGxldCBmb3JtYXR0ZWRJbnB1dERhdGVTdHJpbmc7XG4gICAgbGV0IGludGVybmFsRGF0ZVN0cmluZztcbiAgICBpZiAoaW5wdXRTdHJpbmcubGVuZ3RoID09PSAwICYmIGRhdGVwaWNrZXJPcHRpb25zICYmIGRhdGVwaWNrZXJPcHRpb25zLmFsbG93RW1wdHlWYWx1ZSkge1xuICAgICAgZm9ybWF0dGVkSW5wdXREYXRlU3RyaW5nID0gbnVsbDtcbiAgICAgIGludGVybmFsRGF0ZVN0cmluZyA9IG51bGw7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgY29uc3QgaW5wdXREYXRlU3RyaW5nID0gdmFsdWVGb3JTdHJpbmcoaW5wdXRTdHJpbmcsICdkYXRlJyk7XG4gICAgICBmb3JtYXR0ZWRJbnB1dERhdGVTdHJpbmcgPSBtb21lbnQoaW5wdXREYXRlU3RyaW5nLCBpbnRlcm5hbEpTRGF0ZUZvcm1hdCkuZm9ybWF0KGRhdGVGb3JtYXQpO1xuICAgICAgaW50ZXJuYWxEYXRlU3RyaW5nID0gbW9tZW50KGlucHV0RGF0ZVN0cmluZywgaW50ZXJuYWxKU0RhdGVGb3JtYXQpLmZvcm1hdChpbnRlcm5hbEpTRGF0ZUZvcm1hdCk7XG4gICAgfVxuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgZm9ybWF0dGVkSW5wdXREYXRlU3RyaW5nLFxuICAgICAgcGlja2VyRGF0ZTogaW50ZXJuYWxEYXRlU3RyaW5nLFxuICAgICAgdW50cmFuc2Zvcm1lZERhdGU6IGlucHV0U3RyaW5nXG4gICAgfSk7XG4gIH1cblxuICBzdWJtaXRJbnB1dChmb3JjZVN1Ym1pdCkge1xuICAgIGNvbnN0IHsgY29uZmlndXJhdGlvbiwgYWx3YXlzU2hvd24gfSA9IHRoaXMucHJvcHM7XG4gICAgY29uc3QgeyBmb3JtYXR0ZWRJbnB1dERhdGVTdHJpbmcgfSA9IHRoaXMuc3RhdGU7XG4gICAgY29uc3QgbWluRGF0ZSA9IHRoaXMuZ2V0TWluaW1hbFNlbGVjdGFibGVEYXRlKCk7XG4gICAgY29uc3QgbWF4RGF0ZSA9IHRoaXMuZ2V0TWF4aW1hbFNlbGVjdGFibGVEYXRlKCk7XG4gICAgY29uc3QgaXNCZWZvcmVNaW5EYXRlID0gbWluRGF0ZSAhPT0gbnVsbCA/IHRoaXMuZ2V0TW9tZW50T2JqZWN0Rm9ySW5wdXREYXRlKCkuaXNCZWZvcmUobWluRGF0ZSwgJ2RheScpIDogZmFsc2U7XG4gICAgY29uc3QgaXNBZnRlck1heERhdGUgPSBtYXhEYXRlICE9PSBudWxsID8gdGhpcy5nZXRNb21lbnRPYmplY3RGb3JJbnB1dERhdGUoKS5pc0FmdGVyKG1heERhdGUsICdkYXknKSA6IGZhbHNlO1xuICAgIGxldCB2YWxpZEZvcm1hdHRlZElucHV0RGF0ZVN0cmluZyA9IGZvcm1hdHRlZElucHV0RGF0ZVN0cmluZztcbiAgICBpZiAoaXNCZWZvcmVNaW5EYXRlKSB7XG4gICAgICBpZiAoY29uZmlndXJhdGlvbi5kYXRlcGlja2VyT3B0aW9ucyAmJiBjb25maWd1cmF0aW9uLmRhdGVwaWNrZXJPcHRpb25zLnJlc2V0V2hlbk91dE9mUmFuZ2UpXG4gICAgICAgIHZhbGlkRm9ybWF0dGVkSW5wdXREYXRlU3RyaW5nID0gJyc7XG4gICAgICBlbHNlXG4gICAgICAgIHZhbGlkRm9ybWF0dGVkSW5wdXREYXRlU3RyaW5nID0gbWluRGF0ZS5mb3JtYXQoY29uZmlndXJhdGlvbi5kYXRlRm9ybWF0KTtcbiAgICB9XG4gICAgaWYgKGlzQWZ0ZXJNYXhEYXRlKSAge1xuICAgICAgaWYgKGNvbmZpZ3VyYXRpb24uZGF0ZXBpY2tlck9wdGlvbnMgJiYgY29uZmlndXJhdGlvbi5kYXRlcGlja2VyT3B0aW9ucy5yZXNldFdoZW5PdXRPZlJhbmdlKVxuICAgICAgICB2YWxpZEZvcm1hdHRlZElucHV0RGF0ZVN0cmluZyA9ICcnO1xuICAgICAgZWxzZVxuICAgICAgICB2YWxpZEZvcm1hdHRlZElucHV0RGF0ZVN0cmluZyA9IG1heERhdGUuZm9ybWF0KGNvbmZpZ3VyYXRpb24uZGF0ZUZvcm1hdCk7XG4gICAgfVxuICAgIGlmIChmb3JjZVN1Ym1pdCkge1xuICAgICAgY29uZmlndXJhdGlvbi5zY3JpcHRPbkRhdGVDaGFuZ2UodmFsaWRGb3JtYXR0ZWRJbnB1dERhdGVTdHJpbmcpO1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgIGZvcm1hdHRlZElucHV0RGF0ZVN0cmluZzogdmFsaWRGb3JtYXR0ZWRJbnB1dERhdGVTdHJpbmcsXG4gICAgICAgIHBpY2tlckRhdGU6IG1vbWVudCh2YWxpZEZvcm1hdHRlZElucHV0RGF0ZVN0cmluZywgdGhpcy5wcm9wcy5jb25maWd1cmF0aW9uLmRhdGVGb3JtYXQpLmZvcm1hdChpbnRlcm5hbEpTRGF0ZUZvcm1hdCksXG4gICAgICAgIHVudHJhbnNmb3JtZWREYXRlOiBudWxsLFxuICAgICAgICBzaG93OiBhbHdheXNTaG93biB8fCBmYWxzZVxuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgaXNWYWxpZEludGVybmFsRGF0ZVN0cmluZyhkYXRlU3RyaW5nKSB7XG4gICAgY29uc3QgZGF0ZSA9IG1vbWVudChkYXRlU3RyaW5nLCBpbnRlcm5hbEpTRGF0ZUZvcm1hdCk7XG4gICAgcmV0dXJuIGRhdGUuaXNWYWxpZCgpO1xuICB9XG5cbiAgcHJvY2Vzc0tleVByZXNzKGV2ZW50KSB7XG4gICAgaWYgKGV2ZW50LmtleSA9PT0gJ0VudGVyJyB8fCBldmVudC5rZXkgPT09ICdUYWInKSB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICB0aGlzLnN1Ym1pdElucHV0KHRydWUpO1xuICAgICAgLyogQmx1ciB0aGUgaW5wdXQsIGJ1dCBkbyBub3QgdHJpZ2dlciB0aGUgYmx1ciBldmVudCBsaXN0ZW5lciB0byBwcmV2ZW50IGEgc2Vjb25kIHN1Ym1pc3Npb24gKi9cbiAgICAgIGV2ZW50LnRhcmdldC5yZW1vdmVFdmVudExpc3RlbmVyKCdibHVyJywgdGhpcy5vbkJsdXJJbnB1dCk7XG4gICAgICBldmVudC50YXJnZXQuYmx1cigpO1xuICAgICAgZXZlbnQudGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCB0aGlzLm9uQmx1cklucHV0KTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKGV2ZW50LmtleSA9PT0gJ0VzY2FwZScpIHtcbiAgICAgIHRoaXMuY2xvc2VEYXRlcGlja2VyKCk7XG4gICAgfVxuICB9XG5cbiAgY2xvc2VEYXRlcGlja2VyKCkge1xuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgc2hvdzogZmFsc2VcbiAgICB9KVxuICB9XG5cbiAgaGFuZGxlQ2FsZW5kYXJJY29uQ2xpY2soKSB7XG4gICAgY29uc3QgeyBkaXNhYmxlZCB9ID0gdGhpcy5zdGF0ZTtcbiAgICBpZiAoIXRoaXMucHJvcHMuYWx3YXlzU2hvd24gJiYgIWRpc2FibGVkKSB7XG4gICAgICB0aGlzLnNldFN0YXRlKHtzaG93OiB0cnVlIH0pO1xuICAgIH1cbiAgfVxuXG4gIHJlbmRlckNhbGVuZGFySW5mbygpIHtcbiAgICByZXR1cm4gPGEgY2xhc3NOYW1lPVwiY2xvc2VcIiBvbkNsaWNrPXsoKSA9PiB0aGlzLm9uRm9jdXNDaGFuZ2UoZmFsc2UpfSB0aXRsZT17aTE4bignY2xvc2UnKX0gLz5cbiAgfVxuXG5cbiAgcmVuZGVySW5wdXRXaXRoRGF0ZXBpY2tlcigpIHtcbiAgICBjb25zdCB7IGludmFsaWRWYWx1ZSwgc2hvd0ljb25Gb3JJbnB1dCwgZGF0ZXBpY2tlck9wdGlvbnMsIGRhdGVGb3JtYXQgfSA9IHRoaXMucHJvcHMuY29uZmlndXJhdGlvbjtcbiAgICBjb25zdCB7IGRpc2FibGVkLCB1bnRyYW5zZm9ybWVkRGF0ZSwgZm9ybWF0dGVkSW5wdXREYXRlU3RyaW5nIH0gPSB0aGlzLnN0YXRlO1xuICAgIGxldCB2YWx1ZUZvcklucHV0ID0gdW50cmFuc2Zvcm1lZERhdGU7XG4gICAgY29uc3Qgc2hvd0FzSW52YWxpZCA9IGRhdGVwaWNrZXJPcHRpb25zICYmIGRhdGVwaWNrZXJPcHRpb25zLnNob3dJbnZhbGlkVmFsdWVJY29uICYmIGludmFsaWRWYWx1ZTtcbiAgICBpZiAodW50cmFuc2Zvcm1lZERhdGUgPT09IG51bGwpIHtcbiAgICAgIGlmIChmb3JtYXR0ZWRJbnB1dERhdGVTdHJpbmcgPT09IG51bGwpXG4gICAgICAgIHZhbHVlRm9ySW5wdXQgPSAnJztcbiAgICAgIGVsc2UgaWYgKHRoaXMuZ2V0TW9tZW50T2JqZWN0Rm9ySW5wdXREYXRlKCkuaXNWYWxpZCgpKVxuICAgICAgICB2YWx1ZUZvcklucHV0ID0gdGhpcy5nZXRNb21lbnRPYmplY3RGb3JJbnB1dERhdGUoKS5mb3JtYXQoZGF0ZUZvcm1hdCk7IC8vIG5lZWQgdG8gY2hlY2sgbGF0ZXIgaWYgZG91YmxlIHdvcmsgaXMgYmVpbmcgZG9uZSB3LnIudC4gZGF0ZUZvcm1hdFxuICAgICAgZWxzZVxuICAgICAgICB2YWx1ZUZvcklucHV0ID0gaTE4bignSW52YWxpZCBkYXRlJylcbiAgICB9XG4gICAgcmV0dXJuIChcbiAgICAgIDw+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiYy1jb250cm9sLWdyb3VwIGMtY29udHJvbC1ncm91cC0taW5saW5lXCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9e2BjLWNvbnRyb2wtZ3JvdXBfX2l0ZW0gYy1jb250cm9sLXRleHQgYy1jb250cm9sLXRleHQtLXNob3J0ICR7c2hvd0FzSW52YWxpZCA/ICdpcy1pbnZhbGlkJyA6ICcnfSBgfT5cbiAgICAgICAgICAgIDxpbnB1dFxuICAgICAgICAgICAgICByZWY9e3RoaXMuYXR0YWNoRGF0ZXBpY2tlckVsZW1lbnR9XG4gICAgICAgICAgICAgIGRpc2FibGVkPXtkaXNhYmxlZH1cbiAgICAgICAgICAgICAgdHlwZT1cInRleHRcIlxuICAgICAgICAgICAgICBjbGFzc05hbWU9e2BkZXYtYXR0YWNoZGF0ZXBpY2tlciBjLWNvbnRyb2wtdGV4dF9faW5wdXQgdGV4dCAke1xuICAgICAgICAgICAgICAgIGRpc2FibGVkID8gJyBpcy1kaXNhYmxlZCcgOiAnJ1xuICAgICAgICAgICAgICB9YH1cbiAgICAgICAgICAgICAgdmFsdWU9e3ZhbHVlRm9ySW5wdXR9XG4gICAgICAgICAgICAgIHBsYWNlaG9sZGVyPXtpMThuKCdkZC1tbS15eXl5Jyl9XG4gICAgICAgICAgICAgIG9uS2V5RG93bj17dGhpcy5wcm9jZXNzS2V5UHJlc3N9XG4gICAgICAgICAgICAgIG9uQ2hhbmdlPXt0aGlzLnByb2Nlc3NJbnB1dH1cbiAgICAgICAgICAgICAgb25Gb2N1cz17KCkgPT4gdGhpcy5vbkZvY3VzQ2hhbmdlKHRydWUpfVxuICAgICAgICAgICAgICBkYXRhLXRlc3QtaGFzZGF0ZXBpY2tlcj1cInRydWVcIlxuICAgICAgICAgICAgICBhdXRvQ29tcGxldGU9XCJvZmZcIlxuICAgICAgICAgICAgLz5cbiAgICAgICAgICAgIHtzaG93QXNJbnZhbGlkICYmIHRoaXMucmVuZGVySW52YWxpZFZhbHVlSWNvbigpfVxuICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgIHtzaG93SWNvbkZvcklucHV0ICYmIHRoaXMucmVuZGVyRGF0ZXBpY2tlckJ1dHRvbigpfVxuICAgICAgICA8L2Rpdj5cbiAgICAgICAge3RoaXMucHJvcHMuYWx3YXlzU2hvd24gJiYgKFxuICAgICAgICAgIDw+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cInUtcGFkZGluZy1zbWFsbFwiIC8+XG4gICAgICAgICAgICA8ZGl2XG4gICAgICAgICAgICAgIHN0eWxlPXt7IHJpZ2h0OiAnYXV0bycsIHRvcDogJ2F1dG8nIH19XG4gICAgICAgICAgICAgIHJlZj17KHJlZikgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuc3RhbmRhbG9uZUVsZW1lbnQgPSByZWY7XG4gICAgICAgICAgICAgIH19XG4gICAgICAgICAgICAvPlxuICAgICAgICAgIDwvPlxuICAgICAgICApfVxuICAgICAgPC8+XG4gICAgKTtcbiAgfVxuXG4gIHJlbmRlckRhdGVwaWNrZXJJY29uKCkge1xuICAgIHJldHVybiAoXG4gICAgICA8U3BhblNWR0ljb24gaWNvbj1cImNhbGVuZGFyLTI0XCIgYmxvY2sgc3ViaGVhZCAvPlxuICAgICk7XG4gIH1cblxuICByZW5kZXJEYXRlcGlja2VyQnV0dG9uKCkge1xuICAgIGNvbnN0IHsgZGlzYWJsZWQgfSA9IHRoaXMuc3RhdGU7XG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXZcbiAgICAgICAgY2xhc3NOYW1lPXtgYy1jb250cm9sLWluZm8gYy1jb250cm9sLWdyb3VwX19pdGVtICR7ZGlzYWJsZWQgPyAnaXMtZGlzYWJsZWQnIDogJyd9YH1cbiAgICAgICAgb25DbGljaz17dGhpcy5oYW5kbGVDYWxlbmRhckljb25DbGlja31cbiAgICAgICAgdGl0bGU9e2Ake2kxOG4oJ09wZW4gZGF0ZSBwaWNrZXInKX0uYH1cbiAgICAgID5cbiAgICAgICAge3RoaXMucmVuZGVyRGF0ZXBpY2tlckljb24oKX1cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH1cblxuICByZW5kZXJIaWRkZW5Db250YWluZXJGb3JEYXRlcGlja2VyKCkge1xuICAgIHJldHVybiAoXG4gICAgICA8ZGl2XG4gICAgICAgIHJlZj17dGhpcy5hdHRhY2hEYXRlcGlja2VyRWxlbWVudH1cbiAgICAgICAgY2xhc3NOYW1lPVwiZGV2LWF0dGFjaGRhdGVwaWNrZXIgaWdub3JlLXJlYWN0LW9uY2xpY2tvdXRzaWRlXCJcbiAgICAgICAgc3R5bGU9e3tkaXNwbGF5OiAnbm9uZSd9fVxuICAgICAgLz5cbiAgICApO1xuICB9XG5cbiAgcmVuZGVySW52YWxpZFZhbHVlSWNvbigpIHtcbiAgICByZXR1cm4gKFxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJjLWNvbnRyb2wtdGV4dF9fc3RhdHVzLWljb25cIj5cbiAgICAgICAgPFNwYW5TVkdJY29uIGVycm9yIGljb249XCJ3YXJuaW5nXCIgLz5cbiAgICAgIDwvZGl2Pik7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3QgeyBjb25maWd1cmF0aW9uLCBhbHdheXNTaG93biB9ID0gdGhpcy5wcm9wcztcbiAgICBjb25zdCB7IHNob3csIHBpY2tlckRhdGUsIGRpc2FibGVkLCBhdHRhY2hlZSB9ID0gdGhpcy5zdGF0ZTtcbiAgICBjb25zdCB7IGRhdGVwaWNrZXJPcHRpb25zIH0gPSBjb25maWd1cmF0aW9uO1xuXG4gICAgcmV0dXJuIChcbiAgICAgIDw+XG4gICAgICAgIHtjb25maWd1cmF0aW9uLnJlbmRlcmluZ1R5cGUgPT09ICdpbnB1dCcgJiYgdGhpcy5yZW5kZXJJbnB1dFdpdGhEYXRlcGlja2VyKCl9XG4gICAgICAgIHtjb25maWd1cmF0aW9uLnJlbmRlcmluZ1R5cGUgPT09ICdoaWRkZW4nICYmIHRoaXMucmVuZGVySGlkZGVuQ29udGFpbmVyRm9yRGF0ZXBpY2tlcigpfVxuICAgICAgICB7c2hvdyAmJlxuICAgICAgICAoXG4gICAgICAgICAgPERhdGVQaWNrZXJJblBvcG92ZXJcbiAgICAgICAgICAgIHJlZj17dGhpcy5EYXRlUGlja2VySW5zdGFuY2V9XG4gICAgICAgICAgICBzZWxlY3RlZERheT17dGhpcy5pc1ZhbGlkSW50ZXJuYWxEYXRlU3RyaW5nKHBpY2tlckRhdGUpID8gbW9tZW50KHBpY2tlckRhdGUsIGludGVybmFsSlNEYXRlRm9ybWF0KSA6IG51bGx9XG4gICAgICAgICAgICBvbkRhdGVDaGFuZ2U9e3RoaXMub25EYXRlU2VsZWN0ZWRJbkRhdGVwaWNrZXJ9XG4gICAgICAgICAgICBkcm9wZG93bkZvck1vbnRoXG4gICAgICAgICAgICBkcm9wZG93bkZvclllYXJcbiAgICAgICAgICAgIG1pblllYXJEYXRlPXt0aGlzLmdldE1pbmltYWxZZWFyRGF0ZSgpfVxuICAgICAgICAgICAgbWF4WWVhckRhdGU9e3RoaXMuZ2V0TWF4aW1hbFllYXJEYXRlKCl9XG4gICAgICAgICAgICBkaXNhYmxlZD17ZGlzYWJsZWR9XG4gICAgICAgICAgICBhbHdheXNTaG93bj17YWx3YXlzU2hvd259XG4gICAgICAgICAgICBjbG9zZURhdGVwaWNrZXI9e3RoaXMuY2xvc2VEYXRlcGlja2VyfVxuICAgICAgICAgICAgbWluRGF0ZT17dGhpcy5nZXRNaW5EYXRlKCl9XG4gICAgICAgICAgICBtYXhEYXRlPXt0aGlzLmdldE1heERhdGUoKX1cbiAgICAgICAgICAgIGF0dGFjaGVlPXthdHRhY2hlZX1cbiAgICAgICAgICAgIGFzPXt0aGlzLmdldENvbnRhaW5lclJlbmRlcmluZ1R5cGUoKX1cbiAgICAgICAgICAgIGluaXRpYWxWaXNpYmxlTW9udGg9e2RhdGVwaWNrZXJPcHRpb25zICYmIGRhdGVwaWNrZXJPcHRpb25zLmluaXRpYWxWaXNpYmxlTW9udGggPyBtb21lbnQoZGF0ZXBpY2tlck9wdGlvbnMuaW5pdGlhbFZpc2libGVNb250aCwgaW50ZXJuYWxKU0RhdGVGb3JtYXQpIDogbnVsbH1cbiAgICAgICAgICAvPlxuICAgICAgICApfVxuICAgICAgPC8+XG4gICAgKTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBSZWFjdC5mb3J3YXJkUmVmKChwcm9wcywgcmVmKSA9PiAoXG4gIDxJbnB1dFdpdGhEYXRlUGlja2VyIHsuLi5wcm9wc30gaW5uZXJSZWY9e3JlZn0gLz5cbikpO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./common/InputWithDatePicker.js\n");

/***/ }),

/***/ "./common/RawIntlProviderGlobalIntl.js":
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./node_modules/react/index.js\");\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./node_modules/prop-types/index.js\");\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_1__);\n\n\n\n/* TODO: replace this placeholder implementation of RawIntlProvider with the real implementation from FormatJS (requires upgrade of the package to version >= 3)\n  See: https://formatjs.io/docs/react-intl/components/#rawintlprovider\n  Note that this placeholder implementation does not actually provide the intl object as currently only the imperative API of FormatJS is used ( https://formatjs.io/docs/react-intl/api ),\n  none of the components that depend on RawIntlProvider are used at the moment ( https://formatjs.io/docs/react-intl/components ) */\nvar RawIntlProvider = function RawIntlProvider(_ref) {\n  var children = _ref.children;\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react__WEBPACK_IMPORTED_MODULE_0__.Fragment, null, react__WEBPACK_IMPORTED_MODULE_0__.Children.only(children));\n};\nRawIntlProvider.propTypes = {\n  value: prop_types__WEBPACK_IMPORTED_MODULE_1___default().shape({}).isRequired,\n  children: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().element.isRequired)\n};\nvar RawIntlProviderGlobalIntl = function RawIntlProviderGlobalIntl(_ref2) {\n  var children = _ref2.children;\n  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(RawIntlProvider, {\n    value: intl\n  }, children);\n};\nRawIntlProviderGlobalIntl.propTypes = {\n  children: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().element.isRequired)\n};\n/* harmony default export */ __webpack_exports__[\"default\"] = (RawIntlProviderGlobalIntl);//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9jb21tb24vUmF3SW50bFByb3ZpZGVyR2xvYmFsSW50bC5qcy5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUdBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFFQSIsInNvdXJjZXMiOlsid2VicGFjazovL1JlYWN0Q29tcG9uZW50c18vLi9jb21tb24vUmF3SW50bFByb3ZpZGVyR2xvYmFsSW50bC5qcz9kMWQ2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCAgZnJvbSAncmVhY3QnO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcblxuLyogVE9ETzogcmVwbGFjZSB0aGlzIHBsYWNlaG9sZGVyIGltcGxlbWVudGF0aW9uIG9mIOKAmFJhd0ludGxQcm92aWRlcuKAmSB3aXRoIHRoZSByZWFsIGltcGxlbWVudGF0aW9uIGZyb20gRm9ybWF0SlMgKHJlcXVpcmVzIHVwZ3JhZGUgb2YgdGhlIHBhY2thZ2UgdG8gdmVyc2lvbiA+PSAzKVxuICBTZWU6IGh0dHBzOi8vZm9ybWF0anMuaW8vZG9jcy9yZWFjdC1pbnRsL2NvbXBvbmVudHMvI3Jhd2ludGxwcm92aWRlclxuICBOb3RlIHRoYXQgdGhpcyBwbGFjZWhvbGRlciBpbXBsZW1lbnRhdGlvbiBkb2VzIG5vdCBhY3R1YWxseSDigJhwcm92aWRl4oCZIHRoZSBpbnRsIG9iamVjdCBhcyBjdXJyZW50bHkgb25seSB0aGUg4oCYaW1wZXJhdGl2ZSBBUEnigJkgb2YgRm9ybWF0SlMgaXMgdXNlZCAoIGh0dHBzOi8vZm9ybWF0anMuaW8vZG9jcy9yZWFjdC1pbnRsL2FwaSApLFxuICBub25lIG9mIHRoZSBjb21wb25lbnRzIHRoYXQgZGVwZW5kIG9uIOKAmFJhd0ludGxQcm92aWRlcuKAmSBhcmUgdXNlZCBhdCB0aGUgbW9tZW50ICggaHR0cHM6Ly9mb3JtYXRqcy5pby9kb2NzL3JlYWN0LWludGwvY29tcG9uZW50cyApICovXG5jb25zdCBSYXdJbnRsUHJvdmlkZXIgPSAoeyBjaGlsZHJlbiB9KSA9PiAoXG4gIDw+XG4gICAgeyBSZWFjdC5DaGlsZHJlbi5vbmx5KGNoaWxkcmVuKSB9XG4gIDwvPlxuKTtcblJhd0ludGxQcm92aWRlci5wcm9wVHlwZXMgPSB7XG4gIHZhbHVlOiBQcm9wVHlwZXMuc2hhcGUoe30pLmlzUmVxdWlyZWQsXG4gIGNoaWxkcmVuOiBQcm9wVHlwZXMuZWxlbWVudC5pc1JlcXVpcmVkXG59O1xuXG5jb25zdCBSYXdJbnRsUHJvdmlkZXJHbG9iYWxJbnRsID0gKHsgY2hpbGRyZW4gfSkgPT4gKFxuICA8UmF3SW50bFByb3ZpZGVyIHZhbHVlPXtpbnRsfT5cbiAgICB7IGNoaWxkcmVuIH1cbiAgPC9SYXdJbnRsUHJvdmlkZXI+XG4pO1xuUmF3SW50bFByb3ZpZGVyR2xvYmFsSW50bC5wcm9wVHlwZXMgPSB7XG4gIGNoaWxkcmVuOiBQcm9wVHlwZXMuZWxlbWVudC5pc1JlcXVpcmVkXG59O1xuXG5leHBvcnQgZGVmYXVsdCBSYXdJbnRsUHJvdmlkZXJHbG9iYWxJbnRsO1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./common/RawIntlProviderGlobalIntl.js\n");

/***/ }),

/***/ "./common/SingleDatePicker.js":
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": function() { return /* binding */ SingleDatePicker; }\n/* harmony export */ });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./node_modules/react/index.js\");\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./node_modules/prop-types/index.js\");\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var react_dates__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"./node_modules/react-dates/index.js\");\n/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(\"./node_modules/moment/moment.js\");\n/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var lodash_omit__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(\"./node_modules/lodash/omit.js\");\n/* harmony import */ var lodash_omit__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(lodash_omit__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(\"./node_modules/uuid/dist/esm-browser/v4.js\");\n/* harmony import */ var react_global_configuration__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(\"./node_modules/react-global-configuration/build/index.js\");\n/* harmony import */ var _SpanSVGIcon__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(\"./common/SpanSVGIcon.js\");\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n\n\n\n\n\n\n\nvar SingleDatePicker = /*#__PURE__*/function (_React$Component) {\n  _inherits(SingleDatePicker, _React$Component);\n  var _super = _createSuper(SingleDatePicker);\n  function SingleDatePicker(props) {\n    var _this;\n    _classCallCheck(this, SingleDatePicker);\n    _this = _super.call(this, props);\n    _this.state = {\n      selectedDay: _this.props.selectedDay,\n      id: (0,uuid__WEBPACK_IMPORTED_MODULE_7__[\"default\"])(),\n      visibleMonth: _this.props.initialVisibleMonth\n    };\n    _this.svgiconsurl = \"\".concat(react_global_configuration__WEBPACK_IMPORTED_MODULE_5__[\"default\"].get('resourceUrl'), \"/images/svg-icons.svg\");\n    _this.onDateChange = _this.onDateChange.bind(_assertThisInitialized(_this));\n    _this.handleMonthNavigation = _this.handleMonthNavigation.bind(_assertThisInitialized(_this));\n    _this.isOutsideDaysPredicate = _this.isOutsideDaysPredicate.bind(_assertThisInitialized(_this));\n    _this.onVisibleMonthChange = _this.onVisibleMonthChange.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n  _createClass(SingleDatePicker, [{\n    key: \"onDateChange\",\n    value: function onDateChange(day) {\n      var forceUpdate = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n      var propagate = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n      this.setState({\n        selectedDay: day,\n        id: forceUpdate ? (0,uuid__WEBPACK_IMPORTED_MODULE_7__[\"default\"])() : this.state.id\n      });\n      if (propagate) this.props.onDateChange(moment__WEBPACK_IMPORTED_MODULE_3___default()(day));\n    }\n  }, {\n    key: \"onFocusChange\",\n    value: function onFocusChange(day) {\n      /* Do nothing */\n    }\n  }, {\n    key: \"onVisibleMonthChange\",\n    value: function onVisibleMonthChange(momentDate) {\n      this.setState({\n        visibleMonth: function visibleMonth() {\n          return momentDate;\n        },\n        id: (0,uuid__WEBPACK_IMPORTED_MODULE_7__[\"default\"])()\n      });\n    }\n  }, {\n    key: \"getMinimalDate\",\n    value: function getMinimalDate() {\n      var _this$props = this.props,\n        minYearDate = _this$props.minYearDate,\n        minDate = _this$props.minDate;\n      if (minYearDate) return moment__WEBPACK_IMPORTED_MODULE_3___default()(minYearDate);\n      if (minDate) return moment__WEBPACK_IMPORTED_MODULE_3___default()(minDate);\n      return moment__WEBPACK_IMPORTED_MODULE_3___default()().subtract(10, 'year').month(0).date(1);\n    }\n  }, {\n    key: \"getMaximalDate\",\n    value: function getMaximalDate() {\n      var _this$props2 = this.props,\n        maxYearDate = _this$props2.maxYearDate,\n        maxDate = _this$props2.maxDate;\n      if (maxYearDate) return moment__WEBPACK_IMPORTED_MODULE_3___default()(maxYearDate);\n      if (maxDate) return moment__WEBPACK_IMPORTED_MODULE_3___default()(maxDate);\n      return moment__WEBPACK_IMPORTED_MODULE_3___default()().add(10, 'year').month(11).date(31);\n    }\n  }, {\n    key: \"getYearOptionsForMonth\",\n    value: function getYearOptionsForMonth(month, selectedYear) {\n      var minimalDate = this.getMinimalDate();\n      var maximalDate = this.getMaximalDate();\n      var years = [];\n      var minYear = minimalDate.year();\n      var maxYear = maximalDate.year();\n      /* When navigating with the arrows outside the range, add these years to the select.\n       *  Otherwise the first/last year will be shown as selected.\n       *  Note that dates outside the range are not selectable */\n      if (selectedYear <= minYear) minYear = selectedYear;else if (selectedYear >= maxYear) maxYear = selectedYear;\n      for (var year = minYear; year <= maxYear; year++) {\n        years.push( /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"option\", {\n          key: year,\n          value: year\n        }, year));\n      }\n      return years;\n    }\n  }, {\n    key: \"isOutsideDaysPredicate\",\n    value: function isOutsideDaysPredicate(day) {\n      var isOutsideRange = this.props.isOutsideRange;\n      var minDate = this.getMinimalDate();\n      var maxDate = this.getMaximalDate();\n      if (isOutsideRange) return isOutsideRange(day);\n      if (minDate && maxDate) return moment__WEBPACK_IMPORTED_MODULE_3___default()(day).isBefore(moment__WEBPACK_IMPORTED_MODULE_3___default()(minDate), 'day') || moment__WEBPACK_IMPORTED_MODULE_3___default()(day).isAfter(moment__WEBPACK_IMPORTED_MODULE_3___default()(maxDate), 'day');\n      if (minDate) return moment__WEBPACK_IMPORTED_MODULE_3___default()(day).isBefore(moment__WEBPACK_IMPORTED_MODULE_3___default()(minDate), 'day');\n      if (maxDate) return moment__WEBPACK_IMPORTED_MODULE_3___default()(day).isAfter(moment__WEBPACK_IMPORTED_MODULE_3___default()(maxDate), 'day');\n      return false;\n    }\n\n    /* Make sure that the year navigation displays the correct year when navigating the months via the arrows */\n  }, {\n    key: \"handleMonthNavigation\",\n    value: function handleMonthNavigation(event) {\n      if (event.year() !== this.state.currentYear) {\n        this.setState({\n          currentYear: event.year()\n        });\n      }\n    }\n  }, {\n    key: \"renderDropdownForMonth\",\n    value: function renderDropdownForMonth(month, onMonthSelect) {\n      var monthsForYear = moment__WEBPACK_IMPORTED_MODULE_3___default().months();\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"select\", {\n        value: month.month(),\n        onChange: function onChange(e) {\n          return onMonthSelect(month, e.target.value);\n        },\n        \"data-test-datepicker-month\": \"true\",\n        className: \"u-margin-right-tiny\"\n      }, monthsForYear.map(function (label) {\n        var monthIndex = moment__WEBPACK_IMPORTED_MODULE_3___default()().month(label).format(\"M\") - 1;\n        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"option\", {\n          key: \"month\".concat(monthIndex),\n          value: monthIndex\n        }, label);\n      }));\n    }\n  }, {\n    key: \"renderDropdownForYear\",\n    value: function renderDropdownForYear(month, onYearSelect) {\n      /* When navigating with the arrows outside the range, add these years to the select.\n      *  Otherwise the first/last year will be shown as selected.\n      *  Note that dates outside the range are not selectable */\n      var years = this.getYearOptionsForMonth(month, month.year());\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"select\", {\n        value: month.year(),\n        onChange: function onChange(e) {\n          return onYearSelect(month, e.target.value);\n        },\n        \"data-test-datepicker-year\": \"true\",\n        className: \"u-margin-left-tiny\"\n      }, years);\n    }\n  }, {\n    key: \"renderMonthAndYearNavigation\",\n    value: function renderMonthAndYearNavigation() {\n      var _this2 = this;\n      var _this$props3 = this.props,\n        dropdownForMonth = _this$props3.dropdownForMonth,\n        dropdownForYear = _this$props3.dropdownForYear;\n      return function (_ref) {\n        var month = _ref.month,\n          onMonthSelect = _ref.onMonthSelect,\n          onYearSelect = _ref.onYearSelect;\n        var textual = '';\n        if (!dropdownForMonth) textual = \"\".concat(month.format('MMMM'), \" \");\n        if (!dropdownForYear) textual += \"\".concat(month.year());\n        return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"div\", {\n          style: {\n            display: 'flex',\n            justifyContent: 'center'\n          }\n        }, dropdownForMonth && _this2.renderDropdownForMonth(month, onMonthSelect), dropdownForYear && !dropdownForMonth && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"p\", {\n          className: \"u-text-body u-color-grey\"\n        }, textual), dropdownForYear && _this2.renderDropdownForYear(month, onYearSelect), !dropdownForYear && /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"p\", {\n          className: \"u-text-body u-color-grey\"\n        }, textual));\n      };\n    }\n  }, {\n    key: \"renderNavigationButton\",\n    value: function renderNavigationButton(icon, position) {\n      var divPositionClass = \"devDayPickerNavigate\".concat(position, \" DayPickerNavigation_leftButton__horizontalDefault\");\n      if (position === 'right') divPositionClass = \"devDayPickerNavigate\".concat(position, \" DayPickerNavigation_rightButton__horizontalDefault\");\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"div\", {\n        className: \"DayPickerNavigation_button__horizontalDefault \".concat(divPositionClass)\n      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"button\", {\n        type: \"button\",\n        className: \"c-button c-button--flat c-button--slim-fit-icon\"\n      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(_SpanSVGIcon__WEBPACK_IMPORTED_MODULE_6__[\"default\"], {\n        icon: icon,\n        fontSize24: true,\n        block: true\n      })));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n      var props = lodash_omit__WEBPACK_IMPORTED_MODULE_4___default()(this.props, ['selectedDay', 'minDate', 'maxDate', 'minYearDate', 'maxYearDate', 'dropdownForMonth', 'dropdownForYear', 'disabled', 'initialVisibleMonth']);\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(react_dates__WEBPACK_IMPORTED_MODULE_2__.DayPickerSingleDateController, _extends({}, props, {\n        key: this.state.id /* Manually maintain the key to be able to force an update */,\n        ref: function ref(_ref2) {\n          _this3.datepickerelement = _ref2;\n        },\n        date: this.state.selectedDay,\n        focused: true,\n        firstDayOfWeek: 1,\n        onDateChange: this.onDateChange,\n        onFocusChange: this.onFocusChange,\n        hideKeyboardShortcutsPanel: true,\n        daySize: 34,\n        horizontalMonthPadding: 4,\n        renderMonthElement: this.renderMonthAndYearNavigation(),\n        onPrevMonthClick: this.handleMonthNavigation,\n        onNextMonthClick: this.handleMonthNavigation,\n        navPrev: this.renderNavigationButton('navigate-prev', 'left'),\n        navNext: this.renderNavigationButton('navigate-next', 'right'),\n        isOutsideRange: this.isOutsideDaysPredicate,\n        enableOutsideDays: false,\n        initialVisibleMonth: this.state.visibleMonth\n      }));\n    }\n  }], [{\n    key: \"getDerivedStateFromProps\",\n    value: function getDerivedStateFromProps(props, state) {\n      if (props.selectedDay === null && state.selectedDay !== null) {\n        return {\n          selectedDay: false\n        };\n      }\n      if (props.selectedDay && props.selectedDay.isValid() && !props.selectedDay.isSame(state.selectedDay)) {\n        var newState = {\n          selectedDay: props.selectedDay\n        };\n        return _objectSpread(_objectSpread({}, newState), {}, {\n          id: (0,uuid__WEBPACK_IMPORTED_MODULE_7__[\"default\"])()\n        }); /* Force update, otherwise previous month stays focused (refreshes calendar, so don't to this every time) */\n      }\n\n      return null;\n    }\n  }]);\n  return SingleDatePicker;\n}(react__WEBPACK_IMPORTED_MODULE_0__.Component);\n_defineProperty(SingleDatePicker, \"propTypes\", {\n  onDateChange: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().func.isRequired),\n  selectedDay: prop_types__WEBPACK_IMPORTED_MODULE_1___default().oneOfType([(prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool), prop_types__WEBPACK_IMPORTED_MODULE_1___default().shape({})]),\n  dropdownForMonth: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool),\n  dropdownForYear: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool),\n  minDate: prop_types__WEBPACK_IMPORTED_MODULE_1___default().shape({}),\n  maxDate: prop_types__WEBPACK_IMPORTED_MODULE_1___default().shape({}),\n  minYearDate: prop_types__WEBPACK_IMPORTED_MODULE_1___default().shape({}),\n  maxYearDate: prop_types__WEBPACK_IMPORTED_MODULE_1___default().shape({}),\n  isOutsideRange: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().func),\n  initialVisibleMonth: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().func)\n});\n_defineProperty(SingleDatePicker, \"defaultProps\", {\n  selectedDay: false,\n  dropdownForMonth: false,\n  dropdownForYear: false,\n  minDate: null,\n  maxDate: null,\n  minYearDate: null,\n  maxYearDate: null,\n  isOutsideRange: null,\n  initialVisibleMonth: null\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9jb21tb24vU2luZ2xlRGF0ZVBpY2tlci5qcy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUFBO0FBMEJBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBb0JBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUFBO0FBQ0E7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFHQTtBQUFBO0FBQUE7QUFDQTtBQUVBO0FBRUE7QUFJQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQUE7QUFBQTtBQUNBO0FBRUE7QUFFQTtBQUlBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUVBO0FBRUE7QUFDQTs7QUFFQTtBQUFBO0FBQUE7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUdBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUdBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBS0E7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBR0E7QUFBQTtBQUVBO0FBQUE7QUFHQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBR0E7QUFDQTtBQUVBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBSUE7QUFBQTtBQUFBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFHQTtBQUFBO0FBQUE7QUFBQTtBQXhNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQUE7QUFFQTs7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBMURBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9SZWFjdENvbXBvbmVudHNfLy4vY29tbW9uL1NpbmdsZURhdGVQaWNrZXIuanM/ZjE4NiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcbmltcG9ydCB7IERheVBpY2tlclNpbmdsZURhdGVDb250cm9sbGVyIH0gZnJvbSAncmVhY3QtZGF0ZXMnO1xuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xuaW1wb3J0IG9taXQgZnJvbSAnbG9kYXNoL29taXQnO1xuaW1wb3J0IHsgdjQgYXMgdXVpZCB9IGZyb20gJ3V1aWQnO1xuaW1wb3J0IGNvbmZpZyBmcm9tICdyZWFjdC1nbG9iYWwtY29uZmlndXJhdGlvbic7XG5pbXBvcnQgU3BhblNWR0ljb24gZnJvbSAnLi9TcGFuU1ZHSWNvbic7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNpbmdsZURhdGVQaWNrZXIgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICBzdGF0aWMgcHJvcFR5cGVzID0ge1xuICAgIG9uRGF0ZUNoYW5nZTogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgICBzZWxlY3RlZERheTogUHJvcFR5cGVzLm9uZU9mVHlwZShbUHJvcFR5cGVzLmJvb2wsIFByb3BUeXBlcy5zaGFwZSh7fSldKSxcbiAgICBkcm9wZG93bkZvck1vbnRoOiBQcm9wVHlwZXMuYm9vbCxcbiAgICBkcm9wZG93bkZvclllYXI6IFByb3BUeXBlcy5ib29sLFxuICAgIG1pbkRhdGU6IFByb3BUeXBlcy5zaGFwZSh7fSksXG4gICAgbWF4RGF0ZTogUHJvcFR5cGVzLnNoYXBlKHt9KSxcbiAgICBtaW5ZZWFyRGF0ZTogUHJvcFR5cGVzLnNoYXBlKHt9KSxcbiAgICBtYXhZZWFyRGF0ZTogUHJvcFR5cGVzLnNoYXBlKHt9KSxcbiAgICBpc091dHNpZGVSYW5nZTogUHJvcFR5cGVzLmZ1bmMsXG4gICAgaW5pdGlhbFZpc2libGVNb250aDogUHJvcFR5cGVzLmZ1bmMsXG4gIH07XG5cbiAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcbiAgICBzZWxlY3RlZERheTogZmFsc2UsXG4gICAgZHJvcGRvd25Gb3JNb250aDogZmFsc2UsXG4gICAgZHJvcGRvd25Gb3JZZWFyOiBmYWxzZSxcbiAgICBtaW5EYXRlOiBudWxsLFxuICAgIG1heERhdGU6IG51bGwsXG4gICAgbWluWWVhckRhdGU6IG51bGwsXG4gICAgbWF4WWVhckRhdGU6IG51bGwsXG4gICAgaXNPdXRzaWRlUmFuZ2U6IG51bGwsXG4gICAgaW5pdGlhbFZpc2libGVNb250aDogbnVsbFxuICB9O1xuXG4gIGNvbnN0cnVjdG9yKHByb3BzKSB7XG4gICAgc3VwZXIocHJvcHMpO1xuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBzZWxlY3RlZERheTogdGhpcy5wcm9wcy5zZWxlY3RlZERheSxcbiAgICAgIGlkOiB1dWlkKCksXG4gICAgICB2aXNpYmxlTW9udGg6IHRoaXMucHJvcHMuaW5pdGlhbFZpc2libGVNb250aFxuICAgIH07XG5cbiAgICB0aGlzLnN2Z2ljb25zdXJsID0gYCR7Y29uZmlnLmdldCgncmVzb3VyY2VVcmwnKX0vaW1hZ2VzL3N2Zy1pY29ucy5zdmdgO1xuXG4gICAgdGhpcy5vbkRhdGVDaGFuZ2UgPSB0aGlzLm9uRGF0ZUNoYW5nZS5iaW5kKHRoaXMpO1xuICAgIHRoaXMuaGFuZGxlTW9udGhOYXZpZ2F0aW9uID0gdGhpcy5oYW5kbGVNb250aE5hdmlnYXRpb24uYmluZCh0aGlzKTtcbiAgICB0aGlzLmlzT3V0c2lkZURheXNQcmVkaWNhdGUgPSB0aGlzLmlzT3V0c2lkZURheXNQcmVkaWNhdGUuYmluZCh0aGlzKTtcbiAgICB0aGlzLm9uVmlzaWJsZU1vbnRoQ2hhbmdlID0gdGhpcy5vblZpc2libGVNb250aENoYW5nZS5iaW5kKHRoaXMpO1xuICB9XG5cbiAgc3RhdGljIGdldERlcml2ZWRTdGF0ZUZyb21Qcm9wcyhwcm9wcywgc3RhdGUpIHtcbiAgICBpZiAocHJvcHMuc2VsZWN0ZWREYXkgPT09IG51bGwgJiYgc3RhdGUuc2VsZWN0ZWREYXkgIT09IG51bGwpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHNlbGVjdGVkRGF5OiBmYWxzZVxuICAgICAgfTtcbiAgICB9XG4gICAgaWYgKHByb3BzLnNlbGVjdGVkRGF5ICYmIHByb3BzLnNlbGVjdGVkRGF5LmlzVmFsaWQoKSAmJiAhcHJvcHMuc2VsZWN0ZWREYXkuaXNTYW1lKHN0YXRlLnNlbGVjdGVkRGF5KSkge1xuICAgICAgY29uc3QgbmV3U3RhdGUgPSB7XG4gICAgICAgIHNlbGVjdGVkRGF5OiBwcm9wcy5zZWxlY3RlZERheVxuICAgICAgfTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIC4uLm5ld1N0YXRlLFxuICAgICAgICBpZDogdXVpZCgpXG4gICAgICB9OyAvKiBGb3JjZSB1cGRhdGUsIG90aGVyd2lzZSBwcmV2aW91cyBtb250aCBzdGF5cyBmb2N1c2VkIChyZWZyZXNoZXMgY2FsZW5kYXIsIHNvIGRvbid0IHRvIHRoaXMgZXZlcnkgdGltZSkgKi9cbiAgICB9XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICBvbkRhdGVDaGFuZ2UoZGF5LCBmb3JjZVVwZGF0ZSA9IGZhbHNlLCBwcm9wYWdhdGUgPSB0cnVlKSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICBzZWxlY3RlZERheTogZGF5LFxuICAgICAgaWQ6IGZvcmNlVXBkYXRlID8gdXVpZCgpIDogdGhpcy5zdGF0ZS5pZFxuICAgIH0pO1xuICAgIGlmIChwcm9wYWdhdGUpIHRoaXMucHJvcHMub25EYXRlQ2hhbmdlKG1vbWVudChkYXkpKTtcbiAgfVxuXG4gIG9uRm9jdXNDaGFuZ2UoZGF5KSB7XG4gICAgLyogRG8gbm90aGluZyAqL1xuICB9XG5cbiAgb25WaXNpYmxlTW9udGhDaGFuZ2UobW9tZW50RGF0ZSkge1xuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgdmlzaWJsZU1vbnRoOiAoKSA9PiBtb21lbnREYXRlLFxuICAgICAgaWQ6IHV1aWQoKVxuICAgIH0pXG4gIH1cblxuICBnZXRNaW5pbWFsRGF0ZSgpIHtcbiAgICBjb25zdCB7IG1pblllYXJEYXRlLCBtaW5EYXRlIH0gPSB0aGlzLnByb3BzO1xuICAgIGlmIChtaW5ZZWFyRGF0ZSlcbiAgICAgIHJldHVybiBtb21lbnQobWluWWVhckRhdGUpO1xuICAgIGlmIChtaW5EYXRlKVxuICAgICAgcmV0dXJuIG1vbWVudChtaW5EYXRlKTtcbiAgICByZXR1cm4gbW9tZW50KClcbiAgICAgIC5zdWJ0cmFjdCgxMCwgJ3llYXInKVxuICAgICAgLm1vbnRoKDApXG4gICAgICAuZGF0ZSgxKTtcbiAgfVxuXG4gIGdldE1heGltYWxEYXRlKCkge1xuICAgIGNvbnN0IHsgbWF4WWVhckRhdGUsIG1heERhdGUgfSA9IHRoaXMucHJvcHM7XG4gICAgaWYgKG1heFllYXJEYXRlKVxuICAgICAgcmV0dXJuIG1vbWVudChtYXhZZWFyRGF0ZSk7XG4gICAgaWYgKG1heERhdGUpXG4gICAgICByZXR1cm4gbW9tZW50KG1heERhdGUpO1xuICAgIHJldHVybiBtb21lbnQoKVxuICAgICAgLmFkZCgxMCwgJ3llYXInKVxuICAgICAgLm1vbnRoKDExKVxuICAgICAgLmRhdGUoMzEpXG4gIH1cblxuICBnZXRZZWFyT3B0aW9uc0Zvck1vbnRoKG1vbnRoLCBzZWxlY3RlZFllYXIpIHtcbiAgICBjb25zdCBtaW5pbWFsRGF0ZSA9IHRoaXMuZ2V0TWluaW1hbERhdGUoKTtcbiAgICBjb25zdCBtYXhpbWFsRGF0ZSA9IHRoaXMuZ2V0TWF4aW1hbERhdGUoKTtcbiAgICBjb25zdCB5ZWFycyA9IFtdO1xuICAgIGxldCBtaW5ZZWFyID0gbWluaW1hbERhdGUueWVhcigpO1xuICAgIGxldCBtYXhZZWFyID0gbWF4aW1hbERhdGUueWVhcigpO1xuICAgIC8qIFdoZW4gbmF2aWdhdGluZyB3aXRoIHRoZSBhcnJvd3Mgb3V0c2lkZSB0aGUgcmFuZ2UsIGFkZCB0aGVzZSB5ZWFycyB0byB0aGUgc2VsZWN0LlxuICAgICAqICBPdGhlcndpc2UgdGhlIGZpcnN0L2xhc3QgeWVhciB3aWxsIGJlIHNob3duIGFzIHNlbGVjdGVkLlxuICAgICAqICBOb3RlIHRoYXQgZGF0ZXMgb3V0c2lkZSB0aGUgcmFuZ2UgYXJlIG5vdCBzZWxlY3RhYmxlICovXG4gICAgaWYgKHNlbGVjdGVkWWVhciA8PSBtaW5ZZWFyKVxuICAgICAgbWluWWVhciA9IHNlbGVjdGVkWWVhcjtcbiAgICBlbHNlIGlmIChzZWxlY3RlZFllYXIgPj0gbWF4WWVhcilcbiAgICAgIG1heFllYXIgPSBzZWxlY3RlZFllYXI7XG4gICAgZm9yIChsZXQgeWVhciA9IG1pblllYXI7IHllYXIgPD0gbWF4WWVhcjsgeWVhcisrKSB7XG4gICAgICB5ZWFycy5wdXNoKDxvcHRpb24ga2V5PXt5ZWFyfSB2YWx1ZT17eWVhcn0+e3llYXJ9PC9vcHRpb24+KTtcbiAgICB9XG4gICAgcmV0dXJuIHllYXJzO1xuICB9XG5cbiAgaXNPdXRzaWRlRGF5c1ByZWRpY2F0ZShkYXkpIHtcbiAgICBjb25zdCB7IGlzT3V0c2lkZVJhbmdlIH0gPSB0aGlzLnByb3BzO1xuICAgIGNvbnN0IG1pbkRhdGUgPSB0aGlzLmdldE1pbmltYWxEYXRlKCk7XG4gICAgY29uc3QgbWF4RGF0ZSA9IHRoaXMuZ2V0TWF4aW1hbERhdGUoKTtcbiAgICBpZiAoaXNPdXRzaWRlUmFuZ2UpXG4gICAgICByZXR1cm4gaXNPdXRzaWRlUmFuZ2UoZGF5KTtcbiAgICBpZiAobWluRGF0ZSAmJiBtYXhEYXRlKVxuICAgICAgcmV0dXJuIG1vbWVudChkYXkpLmlzQmVmb3JlKG1vbWVudChtaW5EYXRlKSwgJ2RheScpIHx8IG1vbWVudChkYXkpLmlzQWZ0ZXIobW9tZW50KG1heERhdGUpLCAnZGF5Jyk7XG4gICAgaWYgKG1pbkRhdGUpXG4gICAgICByZXR1cm4gbW9tZW50KGRheSkuaXNCZWZvcmUobW9tZW50KG1pbkRhdGUpLCAnZGF5Jyk7XG4gICAgaWYgKG1heERhdGUpXG4gICAgICByZXR1cm4gbW9tZW50KGRheSkuaXNBZnRlcihtb21lbnQobWF4RGF0ZSksICdkYXknKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cblxuICAvKiBNYWtlIHN1cmUgdGhhdCB0aGUgeWVhciBuYXZpZ2F0aW9uIGRpc3BsYXlzIHRoZSBjb3JyZWN0IHllYXIgd2hlbiBuYXZpZ2F0aW5nIHRoZSBtb250aHMgdmlhIHRoZSBhcnJvd3MgKi9cbiAgaGFuZGxlTW9udGhOYXZpZ2F0aW9uKGV2ZW50KSB7XG4gICAgaWYgKGV2ZW50LnllYXIoKSAhPT0gdGhpcy5zdGF0ZS5jdXJyZW50WWVhcikge1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgIGN1cnJlbnRZZWFyOiBldmVudC55ZWFyKClcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIHJlbmRlckRyb3Bkb3duRm9yTW9udGgobW9udGgsIG9uTW9udGhTZWxlY3QpIHtcbiAgICBjb25zdCBtb250aHNGb3JZZWFyID0gIG1vbWVudC5tb250aHMoKTtcbiAgICByZXR1cm4gKFxuICAgICAgPHNlbGVjdFxuICAgICAgICB2YWx1ZT17bW9udGgubW9udGgoKX1cbiAgICAgICAgb25DaGFuZ2U9eyhlKSA9PiBvbk1vbnRoU2VsZWN0KG1vbnRoLCBlLnRhcmdldC52YWx1ZSl9XG4gICAgICAgIGRhdGEtdGVzdC1kYXRlcGlja2VyLW1vbnRoPVwidHJ1ZVwiXG4gICAgICAgIGNsYXNzTmFtZT1cInUtbWFyZ2luLXJpZ2h0LXRpbnlcIlxuICAgICAgPlxuICAgICAgICB7bW9udGhzRm9yWWVhci5tYXAoKGxhYmVsKSA9PiB7XG4gICAgICAgICAgY29uc3QgbW9udGhJbmRleCA9IG1vbWVudCgpLm1vbnRoKGxhYmVsKS5mb3JtYXQoXCJNXCIpIC0gMTtcbiAgICAgICAgICByZXR1cm4gPG9wdGlvbiBrZXk9e2Btb250aCR7bW9udGhJbmRleH1gfSB2YWx1ZT17bW9udGhJbmRleH0+e2xhYmVsfTwvb3B0aW9uPlxuICAgICAgICB9KX1cbiAgICAgIDwvc2VsZWN0PlxuICAgICk7XG4gIH1cblxuICByZW5kZXJEcm9wZG93bkZvclllYXIobW9udGgsIG9uWWVhclNlbGVjdCkge1xuICAgIC8qIFdoZW4gbmF2aWdhdGluZyB3aXRoIHRoZSBhcnJvd3Mgb3V0c2lkZSB0aGUgcmFuZ2UsIGFkZCB0aGVzZSB5ZWFycyB0byB0aGUgc2VsZWN0LlxuICAgKiAgT3RoZXJ3aXNlIHRoZSBmaXJzdC9sYXN0IHllYXIgd2lsbCBiZSBzaG93biBhcyBzZWxlY3RlZC5cbiAgICogIE5vdGUgdGhhdCBkYXRlcyBvdXRzaWRlIHRoZSByYW5nZSBhcmUgbm90IHNlbGVjdGFibGUgKi9cbiAgICBjb25zdCB5ZWFycyA9IHRoaXMuZ2V0WWVhck9wdGlvbnNGb3JNb250aChtb250aCwgbW9udGgueWVhcigpKTtcbiAgICByZXR1cm4gKFxuICAgICAgPHNlbGVjdFxuICAgICAgICB2YWx1ZT17bW9udGgueWVhcigpfVxuICAgICAgICBvbkNoYW5nZT17KGUpID0+IG9uWWVhclNlbGVjdChtb250aCwgZS50YXJnZXQudmFsdWUpfVxuICAgICAgICBkYXRhLXRlc3QtZGF0ZXBpY2tlci15ZWFyPVwidHJ1ZVwiXG4gICAgICAgIGNsYXNzTmFtZT1cInUtbWFyZ2luLWxlZnQtdGlueVwiXG4gICAgICA+XG4gICAgICAgIHt5ZWFyc31cbiAgICAgIDwvc2VsZWN0PlxuICAgICk7XG4gIH1cblxuICByZW5kZXJNb250aEFuZFllYXJOYXZpZ2F0aW9uKCkge1xuICAgIGNvbnN0IHsgZHJvcGRvd25Gb3JNb250aCwgZHJvcGRvd25Gb3JZZWFyIH0gPSB0aGlzLnByb3BzO1xuICAgIHJldHVybiAoeyBtb250aCwgb25Nb250aFNlbGVjdCwgb25ZZWFyU2VsZWN0IH0pID0+IHtcbiAgICAgIGxldCB0ZXh0dWFsID0gJyc7XG4gICAgICBpZiAoIWRyb3Bkb3duRm9yTW9udGgpXG4gICAgICAgIHRleHR1YWwgPSBgJHttb250aC5mb3JtYXQoJ01NTU0nKX0gYDtcbiAgICAgIGlmICghZHJvcGRvd25Gb3JZZWFyKVxuICAgICAgICB0ZXh0dWFsICs9IGAke21vbnRoLnllYXIoKX1gO1xuICAgICAgcmV0dXJuIChcbiAgICAgICAgPGRpdiBzdHlsZT17e1xuICAgICAgICAgIGRpc3BsYXk6ICdmbGV4JyxcbiAgICAgICAgICBqdXN0aWZ5Q29udGVudDogJ2NlbnRlcidcbiAgICAgICAgfX1cbiAgICAgICAgPlxuICAgICAgICAgIHtkcm9wZG93bkZvck1vbnRoICYmIHRoaXMucmVuZGVyRHJvcGRvd25Gb3JNb250aChtb250aCwgb25Nb250aFNlbGVjdCl9XG4gICAgICAgICAge2Ryb3Bkb3duRm9yWWVhciAmJiAhZHJvcGRvd25Gb3JNb250aCAmJiA8cCBjbGFzc05hbWU9XCJ1LXRleHQtYm9keSB1LWNvbG9yLWdyZXlcIj57dGV4dHVhbH08L3A+fVxuICAgICAgICAgIHtkcm9wZG93bkZvclllYXIgJiYgdGhpcy5yZW5kZXJEcm9wZG93bkZvclllYXIobW9udGgsIG9uWWVhclNlbGVjdCl9XG4gICAgICAgICAgeyFkcm9wZG93bkZvclllYXIgJiYgPHAgY2xhc3NOYW1lPVwidS10ZXh0LWJvZHkgdS1jb2xvci1ncmV5XCI+e3RleHR1YWx9PC9wPn1cbiAgICAgICAgPC9kaXY+XG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIHJlbmRlck5hdmlnYXRpb25CdXR0b24oaWNvbiwgcG9zaXRpb24pIHtcbiAgICBsZXQgZGl2UG9zaXRpb25DbGFzcyA9IGBkZXZEYXlQaWNrZXJOYXZpZ2F0ZSR7cG9zaXRpb259IERheVBpY2tlck5hdmlnYXRpb25fbGVmdEJ1dHRvbl9faG9yaXpvbnRhbERlZmF1bHRgO1xuICAgIGlmIChwb3NpdGlvbiA9PT0gJ3JpZ2h0JylcbiAgICAgIGRpdlBvc2l0aW9uQ2xhc3MgPSBgZGV2RGF5UGlja2VyTmF2aWdhdGUke3Bvc2l0aW9ufSBEYXlQaWNrZXJOYXZpZ2F0aW9uX3JpZ2h0QnV0dG9uX19ob3Jpem9udGFsRGVmYXVsdGA7XG4gICAgcmV0dXJuIChcbiAgICAgIDxkaXYgY2xhc3NOYW1lPXtgRGF5UGlja2VyTmF2aWdhdGlvbl9idXR0b25fX2hvcml6b250YWxEZWZhdWx0ICR7ZGl2UG9zaXRpb25DbGFzc31gfT5cbiAgICAgICAgPGJ1dHRvbiB0eXBlPVwiYnV0dG9uXCIgY2xhc3NOYW1lPVwiYy1idXR0b24gYy1idXR0b24tLWZsYXQgYy1idXR0b24tLXNsaW0tZml0LWljb25cIj5cbiAgICAgICAgICA8U3BhblNWR0ljb24gaWNvbj17aWNvbn0gZm9udFNpemUyNCBibG9jayAvPlxuICAgICAgICA8L2J1dHRvbj5cbiAgICAgIDwvZGl2PlxuICAgICk7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgY29uc3QgcHJvcHMgPSBvbWl0KHRoaXMucHJvcHMsIFsnc2VsZWN0ZWREYXknLCAnbWluRGF0ZScsICdtYXhEYXRlJywgJ21pblllYXJEYXRlJywgJ21heFllYXJEYXRlJywgJ2Ryb3Bkb3duRm9yTW9udGgnLCAnZHJvcGRvd25Gb3JZZWFyJywgJ2Rpc2FibGVkJywgJ2luaXRpYWxWaXNpYmxlTW9udGgnXSk7XG4gICAgcmV0dXJuIChcbiAgICAgIDxEYXlQaWNrZXJTaW5nbGVEYXRlQ29udHJvbGxlclxuICAgICAgICB7Li4ucHJvcHN9XG4gICAgICAgIGtleT17dGhpcy5zdGF0ZS5pZH0gLyogTWFudWFsbHkgbWFpbnRhaW4gdGhlIGtleSB0byBiZSBhYmxlIHRvIGZvcmNlIGFuIHVwZGF0ZSAqL1xuICAgICAgICByZWY9eyhyZWYpID0+IHtcbiAgICAgICAgICB0aGlzLmRhdGVwaWNrZXJlbGVtZW50ID0gcmVmO1xuICAgICAgICB9fVxuICAgICAgICBkYXRlPXt0aGlzLnN0YXRlLnNlbGVjdGVkRGF5fVxuICAgICAgICBmb2N1c2VkXG4gICAgICAgIGZpcnN0RGF5T2ZXZWVrPXsxfVxuICAgICAgICBvbkRhdGVDaGFuZ2U9e3RoaXMub25EYXRlQ2hhbmdlfVxuICAgICAgICBvbkZvY3VzQ2hhbmdlPXt0aGlzLm9uRm9jdXNDaGFuZ2V9XG4gICAgICAgIGhpZGVLZXlib2FyZFNob3J0Y3V0c1BhbmVsXG4gICAgICAgIGRheVNpemU9ezM0fVxuICAgICAgICBob3Jpem9udGFsTW9udGhQYWRkaW5nPXs0fVxuICAgICAgICByZW5kZXJNb250aEVsZW1lbnQ9e3RoaXMucmVuZGVyTW9udGhBbmRZZWFyTmF2aWdhdGlvbigpfVxuICAgICAgICBvblByZXZNb250aENsaWNrPXt0aGlzLmhhbmRsZU1vbnRoTmF2aWdhdGlvbn1cbiAgICAgICAgb25OZXh0TW9udGhDbGljaz17dGhpcy5oYW5kbGVNb250aE5hdmlnYXRpb259XG4gICAgICAgIG5hdlByZXY9e3RoaXMucmVuZGVyTmF2aWdhdGlvbkJ1dHRvbignbmF2aWdhdGUtcHJldicsICdsZWZ0Jyl9XG4gICAgICAgIG5hdk5leHQ9e3RoaXMucmVuZGVyTmF2aWdhdGlvbkJ1dHRvbignbmF2aWdhdGUtbmV4dCcsICdyaWdodCcpfVxuICAgICAgICBpc091dHNpZGVSYW5nZT17dGhpcy5pc091dHNpZGVEYXlzUHJlZGljYXRlfVxuICAgICAgICBlbmFibGVPdXRzaWRlRGF5cz17ZmFsc2V9XG4gICAgICAgIGluaXRpYWxWaXNpYmxlTW9udGg9e3RoaXMuc3RhdGUudmlzaWJsZU1vbnRofVxuICAgICAgLz5cbiAgICApO1xuICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./common/SingleDatePicker.js\n");

/***/ }),

/***/ "./common/SpanSVGIcon.js":
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": function() { return /* binding */ SpanSVGIcon; }\n/* harmony export */ });\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./node_modules/react/index.js\");\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./node_modules/prop-types/index.js\");\n/* harmony import */ var prop_types__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var react_global_configuration__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"./node_modules/react-global-configuration/build/index.js\");\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } else if (call !== void 0) { throw new TypeError(\"Derived constructors may only return object or undefined\"); } return _assertThisInitialized(self); }\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n\n\nvar SpanSVGIcon = /*#__PURE__*/function (_React$PureComponent) {\n  _inherits(SpanSVGIcon, _React$PureComponent);\n  var _super = _createSuper(SpanSVGIcon);\n  function SpanSVGIcon() {\n    _classCallCheck(this, SpanSVGIcon);\n    return _super.apply(this, arguments);\n  }\n  _createClass(SpanSVGIcon, [{\n    key: \"composedClassName\",\n    value: function composedClassName() {\n      var className = 'svg-icon';\n      if (this.props.block) className += ' svg-icon--block';\n      if (this.props.baseline) className += ' svg-icon--baseline';\n      if (this.props.shy) className += ' svg-icon--shy';\n      if (this.props.error) className += ' svg-icon--error';\n      if (this.props.warning) className += ' svg-icon--warning';\n      if (this.props.blue) className += ' svg-icon--blue';\n      if (this.props.lightBlue) className += ' svg-icon--light-blue';\n      if (this.props.invert) className += ' svg-icon--invert';\n      if (this.props.subhead) className += ' u-text-subhead';\n      if (this.props.fontSize16) className += ' svg-icon--16';\n      if (this.props.fontSize20) className += ' svg-icon--20';\n      if (this.props.fontSize24) className += ' svg-icon--24';\n      if (this.props.className.length > 0) className += \" \".concat(this.props.className);\n      return className;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var baseURL = react_global_configuration__WEBPACK_IMPORTED_MODULE_2__[\"default\"].get('inlinedSVGIcons', false) ? '' : \"\".concat(react_global_configuration__WEBPACK_IMPORTED_MODULE_2__[\"default\"].get('resourceUrl'), \"/images/svg-icons.svg\");\n      return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"span\", {\n        title: this.props.title,\n        className: this.composedClassName()\n      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"svg\", {\n        className: \"svg-icon-\".concat(this.props.icon)\n      }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__.createElement(\"use\", {\n        xmlnsXlink: \"http://www.w3.org/1999/xlink\",\n        xlinkHref: \"\".concat(baseURL, \"#\").concat(this.props.icon)\n      })));\n    }\n  }]);\n  return SpanSVGIcon;\n}(react__WEBPACK_IMPORTED_MODULE_0__.PureComponent);\n_defineProperty(SpanSVGIcon, \"propTypes\", {\n  className: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().string),\n  title: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().string),\n  icon: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().string.isRequired),\n  block: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool),\n  baseline: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool),\n  shy: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool),\n  error: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool),\n  warning: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool),\n  blue: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool),\n  lightBlue: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool),\n  invert: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool),\n  fontSize16: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool),\n  fontSize20: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool),\n  fontSize24: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool),\n  subhead: (prop_types__WEBPACK_IMPORTED_MODULE_1___default().bool)\n});\n_defineProperty(SpanSVGIcon, \"defaultProps\", {\n  className: '',\n  title: '',\n  block: false,\n  baseline: false,\n  shy: false,\n  error: false,\n  warning: false,\n  blue: false,\n  lightBlue: false,\n  invert: false,\n  subhead: false,\n  fontSize16: false,\n  fontSize20: false,\n  fontSize24: false\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9jb21tb24vU3BhblNWR0ljb24uanMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQXFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUdBO0FBR0E7QUFDQTtBQUFBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUFBO0FBS0E7QUFBQTtBQUFBO0FBQUE7QUFwRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vUmVhY3RDb21wb25lbnRzXy8uL2NvbW1vbi9TcGFuU1ZHSWNvbi5qcz80YTgwIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnO1xuaW1wb3J0IGNvbmZpZyBmcm9tICdyZWFjdC1nbG9iYWwtY29uZmlndXJhdGlvbic7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNwYW5TVkdJY29uIGV4dGVuZHMgUmVhY3QuUHVyZUNvbXBvbmVudCB7XG4gIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgY2xhc3NOYW1lOiBQcm9wVHlwZXMuc3RyaW5nLFxuICAgIHRpdGxlOiBQcm9wVHlwZXMuc3RyaW5nLFxuICAgIGljb246IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZCxcbiAgICBibG9jazogUHJvcFR5cGVzLmJvb2wsXG4gICAgYmFzZWxpbmU6IFByb3BUeXBlcy5ib29sLFxuICAgIHNoeTogUHJvcFR5cGVzLmJvb2wsXG4gICAgZXJyb3I6IFByb3BUeXBlcy5ib29sLFxuICAgIHdhcm5pbmc6IFByb3BUeXBlcy5ib29sLFxuICAgIGJsdWU6IFByb3BUeXBlcy5ib29sLFxuICAgIGxpZ2h0Qmx1ZTogUHJvcFR5cGVzLmJvb2wsXG4gICAgaW52ZXJ0OiBQcm9wVHlwZXMuYm9vbCxcbiAgICBmb250U2l6ZTE2OiBQcm9wVHlwZXMuYm9vbCxcbiAgICBmb250U2l6ZTIwOiBQcm9wVHlwZXMuYm9vbCxcbiAgICBmb250U2l6ZTI0OiBQcm9wVHlwZXMuYm9vbCxcbiAgICBzdWJoZWFkOiBQcm9wVHlwZXMuYm9vbFxuICB9O1xuXG4gIHN0YXRpYyBkZWZhdWx0UHJvcHMgPSB7XG4gICAgY2xhc3NOYW1lOiAnJyxcbiAgICB0aXRsZTogJycsXG4gICAgYmxvY2s6IGZhbHNlLFxuICAgIGJhc2VsaW5lOiBmYWxzZSxcbiAgICBzaHk6IGZhbHNlLFxuICAgIGVycm9yOiBmYWxzZSxcbiAgICB3YXJuaW5nOiBmYWxzZSxcbiAgICBibHVlOiBmYWxzZSxcbiAgICBsaWdodEJsdWU6IGZhbHNlLFxuICAgIGludmVydDogZmFsc2UsXG4gICAgc3ViaGVhZDogZmFsc2UsXG4gICAgZm9udFNpemUxNjogZmFsc2UsXG4gICAgZm9udFNpemUyMDogZmFsc2UsXG4gICAgZm9udFNpemUyNDogZmFsc2VcbiAgfTtcblxuICBjb21wb3NlZENsYXNzTmFtZSgpIHtcbiAgICBsZXQgY2xhc3NOYW1lID0gJ3N2Zy1pY29uJztcbiAgICBpZiAodGhpcy5wcm9wcy5ibG9jaykgY2xhc3NOYW1lICs9ICcgc3ZnLWljb24tLWJsb2NrJztcbiAgICBpZiAodGhpcy5wcm9wcy5iYXNlbGluZSkgY2xhc3NOYW1lICs9ICcgc3ZnLWljb24tLWJhc2VsaW5lJztcbiAgICBpZiAodGhpcy5wcm9wcy5zaHkpIGNsYXNzTmFtZSArPSAnIHN2Zy1pY29uLS1zaHknO1xuICAgIGlmICh0aGlzLnByb3BzLmVycm9yKSBjbGFzc05hbWUgKz0gJyBzdmctaWNvbi0tZXJyb3InO1xuICAgIGlmICh0aGlzLnByb3BzLndhcm5pbmcpIGNsYXNzTmFtZSArPSAnIHN2Zy1pY29uLS13YXJuaW5nJztcbiAgICBpZiAodGhpcy5wcm9wcy5ibHVlKSBjbGFzc05hbWUgKz0gJyBzdmctaWNvbi0tYmx1ZSc7XG4gICAgaWYgKHRoaXMucHJvcHMubGlnaHRCbHVlKSBjbGFzc05hbWUgKz0gJyBzdmctaWNvbi0tbGlnaHQtYmx1ZSc7XG4gICAgaWYgKHRoaXMucHJvcHMuaW52ZXJ0KSBjbGFzc05hbWUgKz0gJyBzdmctaWNvbi0taW52ZXJ0JztcbiAgICBpZiAodGhpcy5wcm9wcy5zdWJoZWFkKSBjbGFzc05hbWUgKz0gJyB1LXRleHQtc3ViaGVhZCc7XG4gICAgaWYgKHRoaXMucHJvcHMuZm9udFNpemUxNikgY2xhc3NOYW1lICs9ICcgc3ZnLWljb24tLTE2JztcbiAgICBpZiAodGhpcy5wcm9wcy5mb250U2l6ZTIwKSBjbGFzc05hbWUgKz0gJyBzdmctaWNvbi0tMjAnO1xuICAgIGlmICh0aGlzLnByb3BzLmZvbnRTaXplMjQpIGNsYXNzTmFtZSArPSAnIHN2Zy1pY29uLS0yNCc7XG4gICAgaWYgKHRoaXMucHJvcHMuY2xhc3NOYW1lLmxlbmd0aCA+IDApIGNsYXNzTmFtZSArPSBgICR7dGhpcy5wcm9wcy5jbGFzc05hbWV9YDtcbiAgICByZXR1cm4gY2xhc3NOYW1lO1xuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IGJhc2VVUkwgPSBjb25maWcuZ2V0KCdpbmxpbmVkU1ZHSWNvbnMnLCBmYWxzZSlcbiAgICAgID8gJydcbiAgICAgIDogYCR7Y29uZmlnLmdldCgncmVzb3VyY2VVcmwnKX0vaW1hZ2VzL3N2Zy1pY29ucy5zdmdgO1xuICAgIHJldHVybiAoXG4gICAgICA8c3BhbiB0aXRsZT17dGhpcy5wcm9wcy50aXRsZX0gY2xhc3NOYW1lPXt0aGlzLmNvbXBvc2VkQ2xhc3NOYW1lKCl9PlxuICAgICAgICA8c3ZnIGNsYXNzTmFtZT17YHN2Zy1pY29uLSR7dGhpcy5wcm9wcy5pY29ufWB9PlxuICAgICAgICAgIDx1c2VcbiAgICAgICAgICAgIHhtbG5zWGxpbms9XCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rXCJcbiAgICAgICAgICAgIHhsaW5rSHJlZj17YCR7YmFzZVVSTH0jJHt0aGlzLnByb3BzLmljb259YH1cbiAgICAgICAgICAvPlxuICAgICAgICA8L3N2Zz5cbiAgICAgIDwvc3Bhbj5cbiAgICApO1xuICB9XG59XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///./common/SpanSVGIcon.js\n");

/***/ }),

/***/ "./common/inputHelper.js":
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"humanReadableStringForParameterValue\": function() { return /* binding */ humanReadableStringForParameterValue; },\n/* harmony export */   \"isValidValue\": function() { return /* binding */ isValidValue; },\n/* harmony export */   \"representationForValue\": function() { return /* binding */ representationForValue; },\n/* harmony export */   \"serializedRepresentationOfValue\": function() { return /* binding */ serializedRepresentationOfValue; },\n/* harmony export */   \"valueForString\": function() { return /* binding */ valueForString; }\n/* harmony export */ });\n/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"./node_modules/moment/moment.js\");\n/* harmony import */ var moment__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(moment__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var react_global_configuration__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"./node_modules/react-global-configuration/build/index.js\");\n\n\nvar numberRegex = /^[-]?\\d+(.\\d+)*$/;\nvar timeRegex = /^([0-1]?[0-9]|2[0-3]):[0-5][0-9]$/;\nvar durationRegex = /^PT([1-9][0-9]*|0)H[0-9][0-9]M[0-9][0-9]S$/;\nvar relativePercentageRegex = /^((0)|([+|-][0-9]+(.[0-9][0-9]?)?))$/;\nvar formatPercentage = function formatPercentage(input, alwaysWithSign, includePercentageSign) {\n  // Use a reg exp to parse the input\n  var validPercentageInputRegex = /^([+|-])?([0-9]+)(.([0-9])([0-9]?))?%?$/;\n  var match = validPercentageInputRegex.exec(input);\n  if (!match) return input;\n  var sign = match[1];\n  var before = match[2];\n  var after1 = match[4];\n  var after2 = match[5];\n\n  // We drop the second decimal if it is a 0\n  var secondDecimal = after2 !== undefined && after2 !== '0' ? after2 : '';\n  // We also drop the first decimal if there is no second one and it is 0 (or not passed along)\n  var firstDecimal = secondDecimal ? after1 : after1 !== undefined && after1 !== '0' ? after1 : '';\n  var decimalPart = firstDecimal + secondDecimal;\n\n  // If the percentage is 0% we never print a sign, else it depends on whether there always should be a sign (by default +), or not\n  var signToPrint = decimalPart === '' && before === '0' ? '' : alwaysWithSign ? sign || '+' : sign || '';\n\n  // Return the sign + the number + the percentage symbol if needed\n  return signToPrint + parseFloat(before).toString() + (\n  // Parse the before part to remove spurious front 0's\n  decimalPart !== '' ? \".\".concat(decimalPart) : '') + (includePercentageSign ? '%' : '');\n};\nvar processDateOrTime = function processDateOrTime(input, doIfDateAndTime, doIfDate, doIfTime, ifNone) {\n  var dateWithTime = moment__WEBPACK_IMPORTED_MODULE_0___default()(input, 'YYYY-MM-DDTHH:mmZ', true);\n  if (dateWithTime.isValid()) {\n    return doIfDateAndTime(dateWithTime);\n  }\n  var dateOnly = moment__WEBPACK_IMPORTED_MODULE_0___default()(input, 'YYYY-MM-DD', true);\n  if (dateOnly.isValid()) {\n    return doIfDate(dateOnly);\n  }\n  var timeOnly = moment__WEBPACK_IMPORTED_MODULE_0___default()(input, 'HH:mm', true);\n  if (timeOnly.isValid()) {\n    return doIfTime(timeOnly);\n  }\n  return ifNone();\n};\n\n// Predicate that checks whether a string-representation of a value is correctly formed\nvar isValidValue = function isValidValue(value, type) {\n  if (value === null) return false;\n  switch (type) {\n    case 'date':\n      return value !== '' && moment__WEBPACK_IMPORTED_MODULE_0___default()(value, 'YYYY-MM-DD', true).isValid();\n    case 'number':\n      return value.toString().match(numberRegex);\n    case 'time':\n      return value.toString().match(timeRegex);\n    case 'duration':\n      return value.toString().match(durationRegex);\n    case 'dateAndTime':\n      return value !== '' && moment__WEBPACK_IMPORTED_MODULE_0___default()(value, 'YYYY-MM-DDTHH:mm', false).isValid();\n    case 'dateOrTime':\n      return value !== '' && (moment__WEBPACK_IMPORTED_MODULE_0___default()(value, 'YYYY-MM-DDTHH:mm', false).isValid() || moment__WEBPACK_IMPORTED_MODULE_0___default()(value, 'YYYY-MM-DD', true).isValid() || moment__WEBPACK_IMPORTED_MODULE_0___default()(value, 'HH:mm', true).isValid());\n    case 'object':\n      return value !== undefined;\n    case 'string':\n    case 'boolean':\n      return true;\n    case 'percentage':\n      return value.toString().match(numberRegex);\n    case 'relativePercentage':\n      return formatPercentage(value, true, false).match(relativePercentageRegex);\n    default:\n      throw new Error(\"Unhandled type in isValidValue: \".concat(type));\n  }\n};\n\n// Convert a value to an internal representation to be used for rendering the type in the input\nvar representationForValue = function representationForValue(value, type) {\n  var dateFormat = react_global_configuration__WEBPACK_IMPORTED_MODULE_1__[\"default\"].get('dateFormat');\n  if (value === null) return '';\n  if (!isValidValue(value, type)) return value;\n  switch (type) {\n    case 'date':\n      return moment__WEBPACK_IMPORTED_MODULE_0___default()(value, 'YYYY-MM-DD', true).format(dateFormat);\n    case 'number':\n      return value.toString();\n    case 'duration':\n      return moment__WEBPACK_IMPORTED_MODULE_0___default()(value, '[PT]H[H]mm[M00S]', true).format('HH:mm');\n    case 'dateAndTime':\n      {\n        var valueMoment = moment__WEBPACK_IMPORTED_MODULE_0___default()(value, 'YYYY-MM-DDThh:mm');\n        return {\n          date: valueMoment.format(dateFormat),\n          dateValid: true,\n          time: valueMoment.format('HH:mm'),\n          timeValid: true\n        };\n      }\n    case 'dateOrTime':\n      return processDateOrTime(value, function (dateAndTimeMoment) {\n        return {\n          date: dateAndTimeMoment.format(dateFormat),\n          dateValid: true,\n          time: dateAndTimeMoment.format('HH:mm'),\n          timeValid: true\n        };\n      }, function (dateMoment) {\n        return {\n          date: dateMoment.format(dateFormat),\n          dateValid: true,\n          time: null,\n          timeValid: true\n        };\n      }, function (timeMoment) {\n        return {\n          date: null,\n          dateValid: true,\n          time: timeMoment.format('HH:mm'),\n          timeValid: true\n        };\n      }, function () {\n        return {\n          date: null,\n          dateValid: true,\n          time: null,\n          timeValid: true\n        };\n      });\n    case 'time':\n    case 'object':\n    case 'boolean':\n    case 'string':\n      return value;\n    case 'relativePercentage':\n      return formatPercentage(value, true, false);\n    case 'percentage':\n      return formatPercentage(value, false, false);\n    default:\n      throw new Error(\"Unhandled type in representationForValue: \".concat(type));\n  }\n};\n\n// Transform a parameter value to a string that can be shown in the user interface outside the context of an input field\nvar humanReadableStringForParameterValue = function humanReadableStringForParameterValue(parameterValue, parameterType) {\n  var dateFormat = react_global_configuration__WEBPACK_IMPORTED_MODULE_1__[\"default\"].get('dateFormat');\n  if (parameterValue === null) return null;\n  switch (parameterType) {\n    case 'string':\n      return parameterValue;\n    case 'date':\n      return moment__WEBPACK_IMPORTED_MODULE_0___default()(parameterValue, 'YYYY-MM-DD', true).format(dateFormat);\n    case 'number':\n      return parameterValue.toString();\n    case 'duration':\n      return moment__WEBPACK_IMPORTED_MODULE_0___default()(parameterValue, '[PT]H[H]mm[M00S]', true).format('HH:mm');\n    case 'dateAndTime':\n      return typeof parameterValue !== 'string' && !parameterValue.date && !parameterValue.time ? '' : moment__WEBPACK_IMPORTED_MODULE_0___default()(parameterValue, 'YYYY-MM-DDThh:mm').format(dateFormat + ' HH:mm');\n    case 'dateOrTime':\n      return processDateOrTime(parameterValue, function (dateAndTime) {\n        return dateAndTime.format(dateFormat + ' HH:mm');\n      }, function (date) {\n        return date.format(dateFormat);\n      }, function (time) {\n        return time.format('HH:mm');\n      }, function () {\n        return '';\n      });\n    case 'time':\n      return parameterValue;\n    case 'relativePercentage':\n      return formatPercentage(parameterValue.toString(), true, true);\n    case 'boolean':\n      return parameterValue ? {\n        intl: intl\n      }.intl.formatMessage({\n        \"id\": \"Yes\",\n        \"defaultMessage\": \"Yes\"\n      }) : {\n        intl: intl\n      }.intl.formatMessage({\n        \"id\": \"No\",\n        \"defaultMessage\": \"No\"\n      });\n    case 'percentage':\n      return formatPercentage(parameterValue.toString(), false, true);\n    default:\n      return parameterValue.label;\n  }\n};\n\n// Function that converts the input entered in an input field to the right format\nfunction createAcceptedDateFormats(dateFormat) {\n  var sep = '-';\n  var regex = /^[a-z0-9]+$/i;\n  for (var i = 0; i < dateFormat.length; i++) {\n    var aCharacter = dateFormat[i];\n    if (!regex.test(aCharacter)) {\n      sep = aCharacter;\n      break;\n    }\n  }\n  // xx and yy can both be DD or MM, depending on their position, \n  // denoted as xx and yy to somewhat match the literal strings DD and MM\n  var xx = dateFormat.split(sep)[0];\n  var x = xx[0];\n  var yy = dateFormat.split(sep)[1];\n  var y = yy[0];\n\n  // example: ['DD-MM-YYYY', 'D-MM-YYYY', 'D-M-YYYY', 'DD-M-YYYY'];\n  return [\"\".concat(xx).concat(sep).concat(yy).concat(sep, \"YYYY\"), \"\".concat(x).concat(sep).concat(yy).concat(sep, \"YYYY\"), \"\".concat(x).concat(sep).concat(y).concat(sep, \"YYYY\"), \"\".concat(xx).concat(sep).concat(y).concat(sep, \"YYYY\")];\n}\n\n// Parse user input string\nvar valueForString = function valueForString(string, type) {\n  var dateFormat = react_global_configuration__WEBPACK_IMPORTED_MODULE_1__[\"default\"].get('dateFormat');\n  var acceptedDateFormats = createAcceptedDateFormats(dateFormat);\n  var acceptedTimeFormats = ['HH:mm', 'HHmm', 'HH', 'H'];\n  if (string.length === 0) return null;\n  switch (type) {\n    case 'date':\n      {\n        var momentDate = moment__WEBPACK_IMPORTED_MODULE_0___default()(string.trim(), acceptedDateFormats, true);\n        if (momentDate.isValid()) return momentDate.format('YYYY-MM-DD');\n        return string;\n      }\n    case 'duration':\n      return string.match(timeRegex) ? moment__WEBPACK_IMPORTED_MODULE_0___default()(string.trim(), 'HH:mm', true).format('[PT]H[H]mm[M00S]') : string;\n    case 'number':\n      return string.match(numberRegex) ? parseFloat(string.trim()) : string;\n    case 'dateAndTime':\n      {\n        var dateAndTimeDatePart = string.date;\n        var dateAndTimeTimePart = string.time;\n        var momentDateTime = moment__WEBPACK_IMPORTED_MODULE_0___default()(\"\".concat(dateAndTimeDatePart, \" \").concat(dateAndTimeTimePart), 'DD-MM-YYYY H:mm', true);\n        if (momentDateTime.isValid()) return momentDateTime.format('YYYY-MM-DDTHH:mmZ');\n        return string;\n      }\n    case 'dateOrTime':\n      {\n        var dateOrTimeDatePart = string.date;\n        var dateOrTimeTimePart = string.time;\n        if (dateOrTimeDatePart && dateOrTimeTimePart) {\n          var dateOrTimeMoment = moment__WEBPACK_IMPORTED_MODULE_0___default()(\"\".concat(dateOrTimeDatePart, \" \").concat(dateOrTimeTimePart), 'DD-MM-YYYY HH:mm', true);\n          if (dateOrTimeMoment.isValid()) return dateOrTimeMoment.format('YYYY-MM-DDTHH:mmZ');\n        } else if (dateOrTimeDatePart) {\n          var _dateOrTimeMoment = moment__WEBPACK_IMPORTED_MODULE_0___default()(dateOrTimeDatePart, 'DD-MM-YYYY', true);\n          if (_dateOrTimeMoment.isValid()) return _dateOrTimeMoment.format('YYYY-MM-DD');\n        } else {\n          var _dateOrTimeMoment2 = moment__WEBPACK_IMPORTED_MODULE_0___default()(dateOrTimeTimePart, 'HH:mm', true);\n          if (_dateOrTimeMoment2.isValid()) return _dateOrTimeMoment2.format('HH:mm');\n        }\n        return string;\n      }\n    case 'time':\n      {\n        var momentTime = moment__WEBPACK_IMPORTED_MODULE_0___default()(string.trim(), acceptedTimeFormats, true);\n        if (momentTime.isValid()) return momentTime.format('HH:mm');\n        return string;\n      }\n    case 'object':\n    case 'string':\n    case 'percentage':\n      return string;\n    case 'relativePercentage':\n      return formatPercentage(string, true, false);\n    default:\n      throw new Error(\"Unhandled type in valueForString: \".concat(type));\n  }\n};\n\n// Function that converts a value into the format that the back-end expects\nvar serializedRepresentationOfValue = function serializedRepresentationOfValue(value, type) {\n  switch (type) {\n    case 'relativePercentage':\n      // Relative percentages expect a %-sign in the back-end\n      return formatPercentage(value, true, true);\n    default:\n      return value;\n  }\n};//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9jb21tb24vaW5wdXRIZWxwZXIuanMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFLQTs7QUFFQTtBQUNBOztBQUdBO0FBQ0E7QUFFQTtBQUNBO0FBR0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUdBO0FBQ0E7QUFFQTtBQUFBO0FBQ0E7QUFBQTtBQUNBO0FBQUE7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBR0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vUmVhY3RDb21wb25lbnRzXy8uL2NvbW1vbi9pbnB1dEhlbHBlci5qcz82NzRlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JztcbmltcG9ydCBjb25maWcgZnJvbSAncmVhY3QtZ2xvYmFsLWNvbmZpZ3VyYXRpb24nO1xuXG5jb25zdCBudW1iZXJSZWdleCA9IC9eWy1dP1xcZCsoLlxcZCspKiQvO1xuY29uc3QgdGltZVJlZ2V4ID0gL14oWzAtMV0/WzAtOV18MlswLTNdKTpbMC01XVswLTldJC87XG5jb25zdCBkdXJhdGlvblJlZ2V4ID0gL15QVChbMS05XVswLTldKnwwKUhbMC05XVswLTldTVswLTldWzAtOV1TJC87XG5jb25zdCByZWxhdGl2ZVBlcmNlbnRhZ2VSZWdleCA9IC9eKCgwKXwoWyt8LV1bMC05XSsoLlswLTldWzAtOV0/KT8pKSQvO1xuXG5jb25zdCBmb3JtYXRQZXJjZW50YWdlID0gZnVuY3Rpb24gKGlucHV0LCBhbHdheXNXaXRoU2lnbiwgaW5jbHVkZVBlcmNlbnRhZ2VTaWduKSB7XG4gIC8vIFVzZSBhIHJlZyBleHAgdG8gcGFyc2UgdGhlIGlucHV0XG4gIGNvbnN0IHZhbGlkUGVyY2VudGFnZUlucHV0UmVnZXggPSAvXihbK3wtXSk/KFswLTldKykoLihbMC05XSkoWzAtOV0/KSk/JT8kLztcbiAgY29uc3QgbWF0Y2ggPSB2YWxpZFBlcmNlbnRhZ2VJbnB1dFJlZ2V4LmV4ZWMoaW5wdXQpO1xuICBpZiAoIW1hdGNoKSByZXR1cm4gaW5wdXQ7XG4gIGNvbnN0IHNpZ24gPSBtYXRjaFsxXTtcbiAgY29uc3QgYmVmb3JlID0gbWF0Y2hbMl07XG4gIGNvbnN0IGFmdGVyMSA9IG1hdGNoWzRdO1xuICBjb25zdCBhZnRlcjIgPSBtYXRjaFs1XTtcblxuICAvLyBXZSBkcm9wIHRoZSBzZWNvbmQgZGVjaW1hbCBpZiBpdCBpcyBhIDBcbiAgY29uc3Qgc2Vjb25kRGVjaW1hbCA9IGFmdGVyMiAhPT0gdW5kZWZpbmVkICYmIGFmdGVyMiAhPT0gJzAnID8gYWZ0ZXIyIDogJyc7XG4gIC8vIFdlIGFsc28gZHJvcCB0aGUgZmlyc3QgZGVjaW1hbCBpZiB0aGVyZSBpcyBubyBzZWNvbmQgb25lIGFuZCBpdCBpcyAwIChvciBub3QgcGFzc2VkIGFsb25nKVxuICBjb25zdCBmaXJzdERlY2ltYWwgPSBzZWNvbmREZWNpbWFsXG4gICAgPyBhZnRlcjFcbiAgICA6IGFmdGVyMSAhPT0gdW5kZWZpbmVkICYmIGFmdGVyMSAhPT0gJzAnXG4gICAgPyBhZnRlcjFcbiAgICA6ICcnO1xuICBjb25zdCBkZWNpbWFsUGFydCA9IGZpcnN0RGVjaW1hbCArIHNlY29uZERlY2ltYWw7XG5cbiAgLy8gSWYgdGhlIHBlcmNlbnRhZ2UgaXMgMCUgd2UgbmV2ZXIgcHJpbnQgYSBzaWduLCBlbHNlIGl0IGRlcGVuZHMgb24gd2hldGhlciB0aGVyZSBhbHdheXMgc2hvdWxkIGJlIGEgc2lnbiAoYnkgZGVmYXVsdCArKSwgb3Igbm90XG4gIGNvbnN0IHNpZ25Ub1ByaW50ID1cbiAgICBkZWNpbWFsUGFydCA9PT0gJycgJiYgYmVmb3JlID09PSAnMCcgPyAnJyA6IGFsd2F5c1dpdGhTaWduID8gc2lnbiB8fCAnKycgOiBzaWduIHx8ICcnO1xuXG4gIC8vIFJldHVybiB0aGUgc2lnbiArIHRoZSBudW1iZXIgKyB0aGUgcGVyY2VudGFnZSBzeW1ib2wgaWYgbmVlZGVkXG4gIHJldHVybiAoXG4gICAgc2lnblRvUHJpbnQgK1xuICAgIHBhcnNlRmxvYXQoYmVmb3JlKS50b1N0cmluZygpICsgLy8gUGFyc2UgdGhlIGJlZm9yZSBwYXJ0IHRvIHJlbW92ZSBzcHVyaW91cyBmcm9udCAwJ3NcbiAgICAoZGVjaW1hbFBhcnQgIT09ICcnID8gYC4ke2RlY2ltYWxQYXJ0fWAgOiAnJykgK1xuICAgIChpbmNsdWRlUGVyY2VudGFnZVNpZ24gPyAnJScgOiAnJylcbiAgKTtcbn07XG5cbmNvbnN0IHByb2Nlc3NEYXRlT3JUaW1lID0gZnVuY3Rpb24gKGlucHV0LCBkb0lmRGF0ZUFuZFRpbWUsIGRvSWZEYXRlLCBkb0lmVGltZSwgaWZOb25lKSB7XG4gIGNvbnN0IGRhdGVXaXRoVGltZSA9IG1vbWVudChpbnB1dCwgJ1lZWVktTU0tRERUSEg6bW1aJywgdHJ1ZSk7XG4gIGlmIChkYXRlV2l0aFRpbWUuaXNWYWxpZCgpKSB7XG4gICAgcmV0dXJuIGRvSWZEYXRlQW5kVGltZShkYXRlV2l0aFRpbWUpO1xuICB9XG4gIGNvbnN0IGRhdGVPbmx5ID0gbW9tZW50KGlucHV0LCAnWVlZWS1NTS1ERCcsIHRydWUpO1xuICBpZiAoZGF0ZU9ubHkuaXNWYWxpZCgpKSB7XG4gICAgcmV0dXJuIGRvSWZEYXRlKGRhdGVPbmx5KTtcbiAgfVxuICBjb25zdCB0aW1lT25seSA9IG1vbWVudChpbnB1dCwgJ0hIOm1tJywgdHJ1ZSk7XG4gIGlmICh0aW1lT25seS5pc1ZhbGlkKCkpIHtcbiAgICByZXR1cm4gZG9JZlRpbWUodGltZU9ubHkpO1xuICB9XG4gIHJldHVybiBpZk5vbmUoKTtcbn07XG5cbi8vIFByZWRpY2F0ZSB0aGF0IGNoZWNrcyB3aGV0aGVyIGEgc3RyaW5nLXJlcHJlc2VudGF0aW9uIG9mIGEgdmFsdWUgaXMgY29ycmVjdGx5IGZvcm1lZFxuZXhwb3J0IGNvbnN0IGlzVmFsaWRWYWx1ZSA9IGZ1bmN0aW9uICh2YWx1ZSwgdHlwZSkge1xuICBpZiAodmFsdWUgPT09IG51bGwpIHJldHVybiBmYWxzZTtcbiAgc3dpdGNoICh0eXBlKSB7XG4gICAgY2FzZSAnZGF0ZSc6XG4gICAgICByZXR1cm4gdmFsdWUgIT09ICcnICYmIG1vbWVudCh2YWx1ZSwgJ1lZWVktTU0tREQnLCB0cnVlKS5pc1ZhbGlkKCk7XG4gICAgY2FzZSAnbnVtYmVyJzpcbiAgICAgIHJldHVybiB2YWx1ZS50b1N0cmluZygpLm1hdGNoKG51bWJlclJlZ2V4KTtcbiAgICBjYXNlICd0aW1lJzpcbiAgICAgIHJldHVybiB2YWx1ZS50b1N0cmluZygpLm1hdGNoKHRpbWVSZWdleCk7XG4gICAgY2FzZSAnZHVyYXRpb24nOlxuICAgICAgcmV0dXJuIHZhbHVlLnRvU3RyaW5nKCkubWF0Y2goZHVyYXRpb25SZWdleCk7XG4gICAgY2FzZSAnZGF0ZUFuZFRpbWUnOlxuICAgICAgcmV0dXJuIHZhbHVlICE9PSAnJyAmJiBtb21lbnQodmFsdWUsICdZWVlZLU1NLUREVEhIOm1tJywgZmFsc2UpLmlzVmFsaWQoKTtcbiAgICBjYXNlICdkYXRlT3JUaW1lJzpcbiAgICAgIHJldHVybiAoXG4gICAgICAgIHZhbHVlICE9PSAnJyAmJlxuICAgICAgICAobW9tZW50KHZhbHVlLCAnWVlZWS1NTS1ERFRISDptbScsIGZhbHNlKS5pc1ZhbGlkKCkgfHxcbiAgICAgICAgICBtb21lbnQodmFsdWUsICdZWVlZLU1NLUREJywgdHJ1ZSkuaXNWYWxpZCgpIHx8XG4gICAgICAgICAgbW9tZW50KHZhbHVlLCAnSEg6bW0nLCB0cnVlKS5pc1ZhbGlkKCkpXG4gICAgICApO1xuICAgIGNhc2UgJ29iamVjdCc6XG4gICAgICByZXR1cm4gdmFsdWUgIT09IHVuZGVmaW5lZDtcbiAgICBjYXNlICdzdHJpbmcnOlxuICAgIGNhc2UgJ2Jvb2xlYW4nOlxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgY2FzZSAncGVyY2VudGFnZSc6XG4gICAgICByZXR1cm4gdmFsdWUudG9TdHJpbmcoKS5tYXRjaChudW1iZXJSZWdleCk7XG4gICAgY2FzZSAncmVsYXRpdmVQZXJjZW50YWdlJzpcbiAgICAgIHJldHVybiBmb3JtYXRQZXJjZW50YWdlKHZhbHVlLCB0cnVlLCBmYWxzZSkubWF0Y2gocmVsYXRpdmVQZXJjZW50YWdlUmVnZXgpO1xuICAgIGRlZmF1bHQ6XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuaGFuZGxlZCB0eXBlIGluIGlzVmFsaWRWYWx1ZTogJHt0eXBlfWApO1xuICB9XG59O1xuXG4vLyBDb252ZXJ0IGEgdmFsdWUgdG8gYW4gaW50ZXJuYWwgcmVwcmVzZW50YXRpb24gdG8gYmUgdXNlZCBmb3IgcmVuZGVyaW5nIHRoZSB0eXBlIGluIHRoZSBpbnB1dFxuZXhwb3J0IGNvbnN0IHJlcHJlc2VudGF0aW9uRm9yVmFsdWUgPSBmdW5jdGlvbiAodmFsdWUsIHR5cGUpIHtcbiAgY29uc3QgZGF0ZUZvcm1hdCA9IGNvbmZpZy5nZXQoJ2RhdGVGb3JtYXQnKTtcbiAgaWYgKHZhbHVlID09PSBudWxsKSByZXR1cm4gJyc7XG4gIGlmICghaXNWYWxpZFZhbHVlKHZhbHVlLCB0eXBlKSkgcmV0dXJuIHZhbHVlO1xuICBzd2l0Y2ggKHR5cGUpIHtcbiAgICBjYXNlICdkYXRlJzpcbiAgICAgIHJldHVybiBtb21lbnQodmFsdWUsICdZWVlZLU1NLUREJywgdHJ1ZSkuZm9ybWF0KGRhdGVGb3JtYXQpO1xuICAgIGNhc2UgJ251bWJlcic6XG4gICAgICByZXR1cm4gdmFsdWUudG9TdHJpbmcoKTtcbiAgICBjYXNlICdkdXJhdGlvbic6XG4gICAgICByZXR1cm4gbW9tZW50KHZhbHVlLCAnW1BUXUhbSF1tbVtNMDBTXScsIHRydWUpLmZvcm1hdCgnSEg6bW0nKTtcbiAgICBjYXNlICdkYXRlQW5kVGltZSc6IHtcbiAgICAgIGNvbnN0IHZhbHVlTW9tZW50ID0gbW9tZW50KHZhbHVlLCAnWVlZWS1NTS1ERFRoaDptbScpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZGF0ZTogdmFsdWVNb21lbnQuZm9ybWF0KGRhdGVGb3JtYXQpLFxuICAgICAgICBkYXRlVmFsaWQ6IHRydWUsXG4gICAgICAgIHRpbWU6IHZhbHVlTW9tZW50LmZvcm1hdCgnSEg6bW0nKSxcbiAgICAgICAgdGltZVZhbGlkOiB0cnVlXG4gICAgICB9O1xuICAgIH1cbiAgICBjYXNlICdkYXRlT3JUaW1lJzpcbiAgICAgIHJldHVybiBwcm9jZXNzRGF0ZU9yVGltZShcbiAgICAgICAgdmFsdWUsXG4gICAgICAgIChkYXRlQW5kVGltZU1vbWVudCkgPT4gKHtcbiAgICAgICAgICBkYXRlOiBkYXRlQW5kVGltZU1vbWVudC5mb3JtYXQoZGF0ZUZvcm1hdCksXG4gICAgICAgICAgZGF0ZVZhbGlkOiB0cnVlLFxuICAgICAgICAgIHRpbWU6IGRhdGVBbmRUaW1lTW9tZW50LmZvcm1hdCgnSEg6bW0nKSxcbiAgICAgICAgICB0aW1lVmFsaWQ6IHRydWVcbiAgICAgICAgfSksXG4gICAgICAgIChkYXRlTW9tZW50KSA9PiAoe1xuICAgICAgICAgIGRhdGU6IGRhdGVNb21lbnQuZm9ybWF0KGRhdGVGb3JtYXQpLFxuICAgICAgICAgIGRhdGVWYWxpZDogdHJ1ZSxcbiAgICAgICAgICB0aW1lOiBudWxsLFxuICAgICAgICAgIHRpbWVWYWxpZDogdHJ1ZVxuICAgICAgICB9KSxcbiAgICAgICAgKHRpbWVNb21lbnQpID0+ICh7XG4gICAgICAgICAgZGF0ZTogbnVsbCxcbiAgICAgICAgICBkYXRlVmFsaWQ6IHRydWUsXG4gICAgICAgICAgdGltZTogdGltZU1vbWVudC5mb3JtYXQoJ0hIOm1tJyksXG4gICAgICAgICAgdGltZVZhbGlkOiB0cnVlXG4gICAgICAgIH0pLFxuICAgICAgICAoKSA9PiAoe1xuICAgICAgICAgIGRhdGU6IG51bGwsXG4gICAgICAgICAgZGF0ZVZhbGlkOiB0cnVlLFxuICAgICAgICAgIHRpbWU6IG51bGwsXG4gICAgICAgICAgdGltZVZhbGlkOiB0cnVlXG4gICAgICAgIH0pXG4gICAgICApO1xuICAgIGNhc2UgJ3RpbWUnOlxuICAgIGNhc2UgJ29iamVjdCc6XG4gICAgY2FzZSAnYm9vbGVhbic6XG4gICAgY2FzZSAnc3RyaW5nJzpcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICBjYXNlICdyZWxhdGl2ZVBlcmNlbnRhZ2UnOlxuICAgICAgcmV0dXJuIGZvcm1hdFBlcmNlbnRhZ2UodmFsdWUsIHRydWUsIGZhbHNlKTtcbiAgICBjYXNlICdwZXJjZW50YWdlJzpcbiAgICAgIHJldHVybiBmb3JtYXRQZXJjZW50YWdlKHZhbHVlLCBmYWxzZSwgZmFsc2UpO1xuICAgIGRlZmF1bHQ6XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuaGFuZGxlZCB0eXBlIGluIHJlcHJlc2VudGF0aW9uRm9yVmFsdWU6ICR7dHlwZX1gKTtcbiAgfVxufTtcblxuLy8gVHJhbnNmb3JtIGEgcGFyYW1ldGVyIHZhbHVlIHRvIGEgc3RyaW5nIHRoYXQgY2FuIGJlIHNob3duIGluIHRoZSB1c2VyIGludGVyZmFjZSBvdXRzaWRlIHRoZSBjb250ZXh0IG9mIGFuIGlucHV0IGZpZWxkXG5leHBvcnQgY29uc3QgaHVtYW5SZWFkYWJsZVN0cmluZ0ZvclBhcmFtZXRlclZhbHVlID0gZnVuY3Rpb24gKHBhcmFtZXRlclZhbHVlLCBwYXJhbWV0ZXJUeXBlKSB7XG4gIGxldCBkYXRlRm9ybWF0ID0gY29uZmlnLmdldCgnZGF0ZUZvcm1hdCcpO1xuICBpZiAocGFyYW1ldGVyVmFsdWUgPT09IG51bGwpIHJldHVybiBudWxsO1xuICBzd2l0Y2ggKHBhcmFtZXRlclR5cGUpIHtcbiAgICBjYXNlICdzdHJpbmcnOlxuICAgICAgcmV0dXJuIHBhcmFtZXRlclZhbHVlO1xuICAgIGNhc2UgJ2RhdGUnOlxuICAgICAgcmV0dXJuIG1vbWVudChwYXJhbWV0ZXJWYWx1ZSwgJ1lZWVktTU0tREQnLCB0cnVlKS5mb3JtYXQoZGF0ZUZvcm1hdCk7XG4gICAgY2FzZSAnbnVtYmVyJzpcbiAgICAgIHJldHVybiBwYXJhbWV0ZXJWYWx1ZS50b1N0cmluZygpO1xuICAgIGNhc2UgJ2R1cmF0aW9uJzpcbiAgICAgIHJldHVybiBtb21lbnQocGFyYW1ldGVyVmFsdWUsICdbUFRdSFtIXW1tW00wMFNdJywgdHJ1ZSkuZm9ybWF0KCdISDptbScpO1xuICAgIGNhc2UgJ2RhdGVBbmRUaW1lJzpcbiAgICAgIHJldHVybiB0eXBlb2YgcGFyYW1ldGVyVmFsdWUgIT09ICdzdHJpbmcnICYmICFwYXJhbWV0ZXJWYWx1ZS5kYXRlICYmICFwYXJhbWV0ZXJWYWx1ZS50aW1lXG4gICAgICAgID8gJydcbiAgICAgICAgOiBtb21lbnQocGFyYW1ldGVyVmFsdWUsICdZWVlZLU1NLUREVGhoOm1tJykuZm9ybWF0KGRhdGVGb3JtYXQgKycgSEg6bW0nKTtcbiAgICBjYXNlICdkYXRlT3JUaW1lJzpcbiAgICAgIHJldHVybiBwcm9jZXNzRGF0ZU9yVGltZShcbiAgICAgICAgcGFyYW1ldGVyVmFsdWUsXG4gICAgICAgIChkYXRlQW5kVGltZSkgPT4gZGF0ZUFuZFRpbWUuZm9ybWF0KGRhdGVGb3JtYXQgKyAnIEhIOm1tJyksXG4gICAgICAgIChkYXRlKSA9PiBkYXRlLmZvcm1hdChkYXRlRm9ybWF0KSxcbiAgICAgICAgKHRpbWUpID0+IHRpbWUuZm9ybWF0KCdISDptbScpLFxuICAgICAgICAoKSA9PiAnJ1xuICAgICAgKTtcbiAgICBjYXNlICd0aW1lJzpcbiAgICAgIHJldHVybiBwYXJhbWV0ZXJWYWx1ZTtcbiAgICBjYXNlICdyZWxhdGl2ZVBlcmNlbnRhZ2UnOlxuICAgICAgcmV0dXJuIGZvcm1hdFBlcmNlbnRhZ2UocGFyYW1ldGVyVmFsdWUudG9TdHJpbmcoKSwgdHJ1ZSwgdHJ1ZSk7XG4gICAgY2FzZSAnYm9vbGVhbic6XG4gICAgICByZXR1cm4gcGFyYW1ldGVyVmFsdWUgPyBpMThuKCdZZXMnKSA6IGkxOG4oJ05vJyk7XG4gICAgY2FzZSAncGVyY2VudGFnZSc6XG4gICAgICByZXR1cm4gZm9ybWF0UGVyY2VudGFnZShwYXJhbWV0ZXJWYWx1ZS50b1N0cmluZygpLCBmYWxzZSwgdHJ1ZSk7XG4gICAgZGVmYXVsdDpcbiAgICAgIHJldHVybiBwYXJhbWV0ZXJWYWx1ZS5sYWJlbDtcbiAgfVxufTtcblxuLy8gRnVuY3Rpb24gdGhhdCBjb252ZXJ0cyB0aGUgaW5wdXQgZW50ZXJlZCBpbiBhbiBpbnB1dCBmaWVsZCB0byB0aGUgcmlnaHQgZm9ybWF0XG5mdW5jdGlvbiBjcmVhdGVBY2NlcHRlZERhdGVGb3JtYXRzKGRhdGVGb3JtYXQpIHtcbiAgbGV0IHNlcCA9ICctJztcbiAgY29uc3QgcmVnZXggPSAvXlthLXowLTldKyQvaTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRlRm9ybWF0Lmxlbmd0aDsgaSsrKSB7XG4gICAgbGV0IGFDaGFyYWN0ZXIgPSBkYXRlRm9ybWF0W2ldO1xuICAgIGlmICghcmVnZXgudGVzdChhQ2hhcmFjdGVyKSkge1xuICAgICAgc2VwID0gYUNoYXJhY3RlcjtcbiAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuICAvLyB4eCBhbmQgeXkgY2FuIGJvdGggYmUgREQgb3IgTU0sIGRlcGVuZGluZyBvbiB0aGVpciBwb3NpdGlvbiwgXG4gIC8vIGRlbm90ZWQgYXMgeHggYW5kIHl5IHRvIHNvbWV3aGF0IG1hdGNoIHRoZSBsaXRlcmFsIHN0cmluZ3MgREQgYW5kIE1NXG4gIGNvbnN0IHh4ID0gZGF0ZUZvcm1hdC5zcGxpdChzZXApWzBdO1xuICBjb25zdCB4ID0geHhbMF07XG4gIGNvbnN0IHl5ID0gZGF0ZUZvcm1hdC5zcGxpdChzZXApWzFdO1xuICBjb25zdCB5ID0geXlbMF07XG5cbiAgLy8gZXhhbXBsZTogWydERC1NTS1ZWVlZJywgJ0QtTU0tWVlZWScsICdELU0tWVlZWScsICdERC1NLVlZWVknXTtcbiAgcmV0dXJuIFtgJHt4eH0ke3NlcH0ke3l5fSR7c2VwfVlZWVlgLCBgJHt4fSR7c2VwfSR7eXl9JHtzZXB9WVlZWWAsIGAke3h9JHtzZXB9JHt5fSR7c2VwfVlZWVlgLCBgJHt4eH0ke3NlcH0ke3l9JHtzZXB9WVlZWWBdXG59XG5cbi8vIFBhcnNlIHVzZXIgaW5wdXQgc3RyaW5nXG5leHBvcnQgY29uc3QgdmFsdWVGb3JTdHJpbmcgPSBmdW5jdGlvbiAoc3RyaW5nLCB0eXBlKSB7XG4gIGxldCBkYXRlRm9ybWF0ID0gY29uZmlnLmdldCgnZGF0ZUZvcm1hdCcpO1xuICBjb25zdCBhY2NlcHRlZERhdGVGb3JtYXRzID0gY3JlYXRlQWNjZXB0ZWREYXRlRm9ybWF0cyhkYXRlRm9ybWF0KTtcbiAgXG4gIGNvbnN0IGFjY2VwdGVkVGltZUZvcm1hdHMgPSBbJ0hIOm1tJywgJ0hIbW0nLCAnSEgnLCAnSCddO1xuICBpZiAoc3RyaW5nLmxlbmd0aCA9PT0gMCkgcmV0dXJuIG51bGw7XG4gIHN3aXRjaCAodHlwZSkge1xuICAgIGNhc2UgJ2RhdGUnOiB7XG4gICAgICBjb25zdCBtb21lbnREYXRlID0gbW9tZW50KHN0cmluZy50cmltKCksIGFjY2VwdGVkRGF0ZUZvcm1hdHMsIHRydWUpO1xuICAgICAgaWYgKG1vbWVudERhdGUuaXNWYWxpZCgpKSByZXR1cm4gbW9tZW50RGF0ZS5mb3JtYXQoJ1lZWVktTU0tREQnKTtcbiAgICAgIHJldHVybiBzdHJpbmc7XG4gICAgfVxuICAgIGNhc2UgJ2R1cmF0aW9uJzpcbiAgICAgIHJldHVybiBzdHJpbmcubWF0Y2godGltZVJlZ2V4KVxuICAgICAgICA/IG1vbWVudChzdHJpbmcudHJpbSgpLCAnSEg6bW0nLCB0cnVlKS5mb3JtYXQoJ1tQVF1IW0hdbW1bTTAwU10nKVxuICAgICAgICA6IHN0cmluZztcbiAgICBjYXNlICdudW1iZXInOlxuICAgICAgcmV0dXJuIHN0cmluZy5tYXRjaChudW1iZXJSZWdleCkgPyBwYXJzZUZsb2F0KHN0cmluZy50cmltKCkpIDogc3RyaW5nO1xuICAgIGNhc2UgJ2RhdGVBbmRUaW1lJzoge1xuICAgICAgY29uc3QgZGF0ZUFuZFRpbWVEYXRlUGFydCA9IHN0cmluZy5kYXRlO1xuICAgICAgY29uc3QgZGF0ZUFuZFRpbWVUaW1lUGFydCA9IHN0cmluZy50aW1lO1xuICAgICAgY29uc3QgbW9tZW50RGF0ZVRpbWUgPSBtb21lbnQoXG4gICAgICAgIGAke2RhdGVBbmRUaW1lRGF0ZVBhcnR9ICR7ZGF0ZUFuZFRpbWVUaW1lUGFydH1gLFxuICAgICAgICAnREQtTU0tWVlZWSBIOm1tJyxcbiAgICAgICAgdHJ1ZVxuICAgICAgKTtcbiAgICAgIGlmIChtb21lbnREYXRlVGltZS5pc1ZhbGlkKCkpIHJldHVybiBtb21lbnREYXRlVGltZS5mb3JtYXQoJ1lZWVktTU0tRERUSEg6bW1aJyk7XG4gICAgICByZXR1cm4gc3RyaW5nO1xuICAgIH1cbiAgICBjYXNlICdkYXRlT3JUaW1lJzoge1xuICAgICAgY29uc3QgZGF0ZU9yVGltZURhdGVQYXJ0ID0gc3RyaW5nLmRhdGU7XG4gICAgICBjb25zdCBkYXRlT3JUaW1lVGltZVBhcnQgPSBzdHJpbmcudGltZTtcbiAgICAgIGlmIChkYXRlT3JUaW1lRGF0ZVBhcnQgJiYgZGF0ZU9yVGltZVRpbWVQYXJ0KSB7XG4gICAgICAgIGNvbnN0IGRhdGVPclRpbWVNb21lbnQgPSBtb21lbnQoXG4gICAgICAgICAgYCR7ZGF0ZU9yVGltZURhdGVQYXJ0fSAke2RhdGVPclRpbWVUaW1lUGFydH1gLFxuICAgICAgICAgICdERC1NTS1ZWVlZIEhIOm1tJyxcbiAgICAgICAgICB0cnVlXG4gICAgICAgICk7XG4gICAgICAgIGlmIChkYXRlT3JUaW1lTW9tZW50LmlzVmFsaWQoKSkgcmV0dXJuIGRhdGVPclRpbWVNb21lbnQuZm9ybWF0KCdZWVlZLU1NLUREVEhIOm1tWicpO1xuICAgICAgfSBlbHNlIGlmIChkYXRlT3JUaW1lRGF0ZVBhcnQpIHtcbiAgICAgICAgY29uc3QgZGF0ZU9yVGltZU1vbWVudCA9IG1vbWVudChkYXRlT3JUaW1lRGF0ZVBhcnQsICdERC1NTS1ZWVlZJywgdHJ1ZSk7XG4gICAgICAgIGlmIChkYXRlT3JUaW1lTW9tZW50LmlzVmFsaWQoKSkgcmV0dXJuIGRhdGVPclRpbWVNb21lbnQuZm9ybWF0KCdZWVlZLU1NLUREJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBkYXRlT3JUaW1lTW9tZW50ID0gbW9tZW50KGRhdGVPclRpbWVUaW1lUGFydCwgJ0hIOm1tJywgdHJ1ZSk7XG4gICAgICAgIGlmIChkYXRlT3JUaW1lTW9tZW50LmlzVmFsaWQoKSkgcmV0dXJuIGRhdGVPclRpbWVNb21lbnQuZm9ybWF0KCdISDptbScpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHN0cmluZztcbiAgICB9XG4gICAgY2FzZSAndGltZSc6IHtcbiAgICAgIGNvbnN0IG1vbWVudFRpbWUgPSBtb21lbnQoc3RyaW5nLnRyaW0oKSwgYWNjZXB0ZWRUaW1lRm9ybWF0cywgdHJ1ZSk7XG4gICAgICBpZiAobW9tZW50VGltZS5pc1ZhbGlkKCkpIHJldHVybiBtb21lbnRUaW1lLmZvcm1hdCgnSEg6bW0nKTtcbiAgICAgIHJldHVybiBzdHJpbmc7XG4gICAgfVxuICAgIGNhc2UgJ29iamVjdCc6XG4gICAgY2FzZSAnc3RyaW5nJzpcbiAgICBjYXNlICdwZXJjZW50YWdlJzpcbiAgICAgIHJldHVybiBzdHJpbmc7XG4gICAgY2FzZSAncmVsYXRpdmVQZXJjZW50YWdlJzpcbiAgICAgIHJldHVybiBmb3JtYXRQZXJjZW50YWdlKHN0cmluZywgdHJ1ZSwgZmFsc2UpO1xuICAgIGRlZmF1bHQ6XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuaGFuZGxlZCB0eXBlIGluIHZhbHVlRm9yU3RyaW5nOiAke3R5cGV9YCk7XG4gIH1cbn07XG5cbi8vIEZ1bmN0aW9uIHRoYXQgY29udmVydHMgYSB2YWx1ZSBpbnRvIHRoZSBmb3JtYXQgdGhhdCB0aGUgYmFjay1lbmQgZXhwZWN0c1xuZXhwb3J0IGNvbnN0IHNlcmlhbGl6ZWRSZXByZXNlbnRhdGlvbk9mVmFsdWUgPSBmdW5jdGlvbiAodmFsdWUsIHR5cGUpIHtcbiAgc3dpdGNoICh0eXBlKSB7XG4gICAgY2FzZSAncmVsYXRpdmVQZXJjZW50YWdlJzpcbiAgICAgIC8vIFJlbGF0aXZlIHBlcmNlbnRhZ2VzIGV4cGVjdCBhICUtc2lnbiBpbiB0aGUgYmFjay1lbmRcbiAgICAgIHJldHVybiBmb3JtYXRQZXJjZW50YWdlKHZhbHVlLCB0cnVlLCB0cnVlKTtcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIHZhbHVlO1xuICB9XG59O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./common/inputHelper.js\n");

/***/ }),

/***/ "./common/stringSortOrder.js":
/***/ (function(__unused_webpack_module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": function() { return /* binding */ npStringSortOrder; }\n/* harmony export */ });\n// The 'codePointMappingData' is a dump of [ NPStringCharacterTransformer mappingData asJavascript ]\n// eslint-disable-next-line comma-spacing\nvar codePointMappingData = [[48, 48], [49, 49], [50, 50], [51, 51], [52, 52], [53, 53], [54, 54], [55, 55], [56, 56], [57, 57], [65, 97], [66, 98], [67, 99], [68, 100], [69, 101], [70, 102], [71, 103], [72, 104], [73, 105], [74, 106], [75, 107], [76, 108], [77, 109], [78, 110], [79, 111], [80, 112], [81, 113], [82, 114], [83, 115], [84, 116], [85, 117], [86, 118], [87, 119], [88, 120], [89, 121], [90, 122], [97, 97], [98, 98], [99, 99], [100, 100], [101, 101], [102, 102], [103, 103], [104, 104], [105, 105], [106, 106], [107, 107], [108, 108], [109, 109], [110, 110], [111, 111], [112, 112], [113, 113], [114, 114], [115, 115], [116, 116], [117, 117], [118, 118], [119, 119], [120, 120], [121, 121], [122, 122], [192, 97], [193, 97], [194, 97], [195, 97], [196, 97], [197, 97], [198, 230], [199, 99], [200, 101], [201, 101], [202, 101], [203, 101], [204, 105], [205, 105], [206, 105], [207, 105], [209, 110], [210, 111], [211, 111], [212, 111], [213, 111], [214, 111], [216, 248], [217, 117], [218, 117], [219, 117], [220, 117], [221, 121], [224, 97], [225, 97], [226, 97], [227, 97], [228, 97], [229, 97], [231, 99], [232, 101], [233, 101], [234, 101], [235, 101], [236, 105], [237, 105], [238, 105], [239, 105], [241, 110], [242, 111], [243, 111], [244, 111], [245, 111], [246, 111], [249, 117], [250, 117], [251, 117], [252, 117], [253, 121], [255, 121], [256, 97], [257, 97], [258, 97], [259, 97], [260, 97], [261, 97], [262, 99], [263, 99], [264, 99], [265, 99], [266, 99], [267, 99], [268, 99], [269, 99], [270, 100], [271, 100], [274, 101], [275, 101], [276, 101], [277, 101], [278, 101], [279, 101], [280, 101], [281, 101], [282, 101], [283, 101], [284, 103], [285, 103], [286, 103], [287, 103], [288, 103], [289, 103], [290, 103], [291, 103], [292, 104], [293, 104], [296, 105], [297, 105], [298, 105], [299, 105], [300, 105], [301, 105], [302, 105], [303, 105], [304, 105], [308, 106], [309, 106], [310, 107], [311, 107], [313, 108], [314, 108], [315, 108], [316, 108], [317, 108], [318, 108], [323, 110], [324, 110], [325, 110], [326, 110], [327, 110], [328, 110], [332, 111], [333, 111], [334, 111], [335, 111], [336, 111], [337, 111], [340, 114], [341, 114], [342, 114], [343, 114], [344, 114], [345, 114], [346, 115], [347, 115], [348, 115], [349, 115], [350, 115], [351, 115], [352, 115], [353, 115], [354, 116], [355, 116], [356, 116], [357, 116], [360, 117], [361, 117], [362, 117], [363, 117], [364, 117], [365, 117], [366, 117], [367, 117], [368, 117], [369, 117], [370, 117], [371, 117], [372, 119], [373, 119], [374, 121], [375, 121], [376, 121], [377, 122], [378, 122], [379, 122], [380, 122], [381, 122], [382, 122], [416, 111], [417, 111], [431, 117], [432, 117], [461, 97], [462, 97], [463, 105], [464, 105], [465, 111], [466, 111], [467, 117], [468, 117], [469, 117], [470, 117], [471, 117], [472, 117], [473, 117], [474, 117], [475, 117], [476, 117], [478, 97], [479, 97], [480, 97], [481, 97], [486, 103], [487, 103], [488, 107], [489, 107], [490, 111], [491, 111], [492, 111], [493, 111], [496, 106], [500, 103], [501, 103], [504, 110], [505, 110], [506, 97], [507, 97], [512, 97], [513, 97], [514, 97], [515, 97], [516, 101], [517, 101], [518, 101], [519, 101], [520, 105], [521, 105], [522, 105], [523, 105], [524, 111], [525, 111], [526, 111], [527, 111], [528, 114], [529, 114], [530, 114], [531, 114], [532, 117], [533, 117], [534, 117], [535, 117], [536, 115], [537, 115], [538, 116], [539, 116], [542, 104], [543, 104], [550, 97], [551, 97], [552, 101], [553, 101], [554, 111], [555, 111], [556, 111], [557, 111], [558, 111], [559, 111], [560, 111], [561, 111], [562, 121], [563, 121], [7680, 97], [7681, 97], [7682, 98], [7683, 98], [7684, 98], [7685, 98], [7686, 98], [7687, 98], [7688, 99], [7689, 99], [7690, 100], [7691, 100], [7692, 100], [7693, 100], [7694, 100], [7695, 100], [7696, 100], [7697, 100], [7698, 100], [7699, 100], [7700, 101], [7701, 101], [7702, 101], [7703, 101], [7704, 101], [7705, 101], [7706, 101], [7707, 101], [7708, 101], [7709, 101], [7710, 102], [7711, 102], [7712, 103], [7713, 103], [7714, 104], [7715, 104], [7716, 104], [7717, 104], [7718, 104], [7719, 104], [7720, 104], [7721, 104], [7722, 104], [7723, 104], [7724, 105], [7725, 105], [7726, 105], [7727, 105], [7728, 107], [7729, 107], [7730, 107], [7731, 107], [7732, 107], [7733, 107], [7734, 108], [7735, 108], [7736, 108], [7737, 108], [7738, 108], [7739, 108], [7740, 108], [7741, 108], [7742, 109], [7743, 109], [7744, 109], [7745, 109], [7746, 109], [7747, 109], [7748, 110], [7749, 110], [7750, 110], [7751, 110], [7752, 110], [7753, 110], [7754, 110], [7755, 110], [7756, 111], [7757, 111], [7758, 111], [7759, 111], [7760, 111], [7761, 111], [7762, 111], [7763, 111], [7764, 112], [7765, 112], [7766, 112], [7767, 112], [7768, 114], [7769, 114], [7770, 114], [7771, 114], [7772, 114], [7773, 114], [7774, 114], [7775, 114], [7776, 115], [7777, 115], [7778, 115], [7779, 115], [7780, 115], [7781, 115], [7782, 115], [7783, 115], [7784, 115], [7785, 115], [7786, 116], [7787, 116], [7788, 116], [7789, 116], [7790, 116], [7791, 116], [7792, 116], [7793, 116], [7794, 117], [7795, 117], [7796, 117], [7797, 117], [7798, 117], [7799, 117], [7800, 117], [7801, 117], [7802, 117], [7803, 117], [7804, 118], [7805, 118], [7806, 118], [7807, 118], [7808, 119], [7809, 119], [7810, 119], [7811, 119], [7812, 119], [7813, 119], [7814, 119], [7815, 119], [7816, 119], [7817, 119], [7818, 120], [7819, 120], [7820, 120], [7821, 120], [7822, 121], [7823, 121], [7824, 122], [7825, 122], [7826, 122], [7827, 122], [7828, 122], [7829, 122], [7830, 104], [7831, 116], [7832, 119], [7833, 121], [7840, 97], [7841, 97], [7842, 97], [7843, 97], [7844, 97], [7845, 97], [7846, 97], [7847, 97], [7848, 97], [7849, 97], [7850, 97], [7851, 97], [7852, 97], [7853, 97], [7854, 97], [7855, 97], [7856, 97], [7857, 97], [7858, 97], [7859, 97], [7860, 97], [7861, 97], [7862, 97], [7863, 97], [7864, 101], [7865, 101], [7866, 101], [7867, 101], [7868, 101], [7869, 101], [7870, 101], [7871, 101], [7872, 101], [7873, 101], [7874, 101], [7875, 101], [7876, 101], [7877, 101], [7878, 101], [7879, 101], [7880, 105], [7881, 105], [7882, 105], [7883, 105], [7884, 111], [7885, 111], [7886, 111], [7887, 111], [7888, 111], [7889, 111], [7890, 111], [7891, 111], [7892, 111], [7893, 111], [7894, 111], [7895, 111], [7896, 111], [7897, 111], [7898, 111], [7899, 111], [7900, 111], [7901, 111], [7902, 111], [7903, 111], [7904, 111], [7905, 111], [7906, 111], [7907, 111], [7908, 117], [7909, 117], [7910, 117], [7911, 117], [7912, 117], [7913, 117], [7914, 117], [7915, 117], [7916, 117], [7917, 117], [7918, 117], [7919, 117], [7920, 117], [7921, 117], [7922, 121], [7923, 121], [7924, 121], [7925, 121], [7926, 121], [7927, 121], [7928, 121], [7929, 121], [8490, 107], [8491, 97]];\nvar codePointMapping = function () {\n  var array = [];\n  codePointMappingData.forEach(function (mapping) {\n    array[mapping[0]] = mapping[1];\n  });\n  return array;\n}();\nfunction npStringSortOrder(stringX, stringY) {\n  var indexX = 0;\n  var indexY = 0;\n  while (indexX < stringX.length) {\n    if (indexY === stringY.length) return +1;\n    var realCodePointX = stringX.codePointAt(indexX);\n    var realCodePointY = stringY.codePointAt(indexY);\n    var mappedCodePointX = codePointMapping[realCodePointX] || realCodePointX;\n    var mappedCodePointY = codePointMapping[realCodePointY] || realCodePointY;\n    var order = mappedCodePointX - mappedCodePointY;\n    if (order !== 0) return order;\n    indexX += realCodePointX > 0xffff ? 2 : 1;\n    indexY += realCodePointY > 0xffff ? 2 : 1;\n  }\n  return indexY === stringY.length ? 0 : -1;\n}//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9jb21tb24vc3RyaW5nU29ydE9yZGVyLmpzLmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBO0FBQ0E7QUE0aUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9SZWFjdENvbXBvbmVudHNfLy4vY29tbW9uL3N0cmluZ1NvcnRPcmRlci5qcz85ZGMwIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSAnY29kZVBvaW50TWFwcGluZ0RhdGEnIGlzIGEgZHVtcCBvZiBbIE5QU3RyaW5nQ2hhcmFjdGVyVHJhbnNmb3JtZXIgbWFwcGluZ0RhdGEgYXNKYXZhc2NyaXB0IF1cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBjb21tYS1zcGFjaW5nXG5jb25zdCBjb2RlUG9pbnRNYXBwaW5nRGF0YSA9IFtcbiAgWzQ4LCA0OF0sXG4gIFs0OSwgNDldLFxuICBbNTAsIDUwXSxcbiAgWzUxLCA1MV0sXG4gIFs1MiwgNTJdLFxuICBbNTMsIDUzXSxcbiAgWzU0LCA1NF0sXG4gIFs1NSwgNTVdLFxuICBbNTYsIDU2XSxcbiAgWzU3LCA1N10sXG4gIFs2NSwgOTddLFxuICBbNjYsIDk4XSxcbiAgWzY3LCA5OV0sXG4gIFs2OCwgMTAwXSxcbiAgWzY5LCAxMDFdLFxuICBbNzAsIDEwMl0sXG4gIFs3MSwgMTAzXSxcbiAgWzcyLCAxMDRdLFxuICBbNzMsIDEwNV0sXG4gIFs3NCwgMTA2XSxcbiAgWzc1LCAxMDddLFxuICBbNzYsIDEwOF0sXG4gIFs3NywgMTA5XSxcbiAgWzc4LCAxMTBdLFxuICBbNzksIDExMV0sXG4gIFs4MCwgMTEyXSxcbiAgWzgxLCAxMTNdLFxuICBbODIsIDExNF0sXG4gIFs4MywgMTE1XSxcbiAgWzg0LCAxMTZdLFxuICBbODUsIDExN10sXG4gIFs4NiwgMTE4XSxcbiAgWzg3LCAxMTldLFxuICBbODgsIDEyMF0sXG4gIFs4OSwgMTIxXSxcbiAgWzkwLCAxMjJdLFxuICBbOTcsIDk3XSxcbiAgWzk4LCA5OF0sXG4gIFs5OSwgOTldLFxuICBbMTAwLCAxMDBdLFxuICBbMTAxLCAxMDFdLFxuICBbMTAyLCAxMDJdLFxuICBbMTAzLCAxMDNdLFxuICBbMTA0LCAxMDRdLFxuICBbMTA1LCAxMDVdLFxuICBbMTA2LCAxMDZdLFxuICBbMTA3LCAxMDddLFxuICBbMTA4LCAxMDhdLFxuICBbMTA5LCAxMDldLFxuICBbMTEwLCAxMTBdLFxuICBbMTExLCAxMTFdLFxuICBbMTEyLCAxMTJdLFxuICBbMTEzLCAxMTNdLFxuICBbMTE0LCAxMTRdLFxuICBbMTE1LCAxMTVdLFxuICBbMTE2LCAxMTZdLFxuICBbMTE3LCAxMTddLFxuICBbMTE4LCAxMThdLFxuICBbMTE5LCAxMTldLFxuICBbMTIwLCAxMjBdLFxuICBbMTIxLCAxMjFdLFxuICBbMTIyLCAxMjJdLFxuICBbMTkyLCA5N10sXG4gIFsxOTMsIDk3XSxcbiAgWzE5NCwgOTddLFxuICBbMTk1LCA5N10sXG4gIFsxOTYsIDk3XSxcbiAgWzE5NywgOTddLFxuICBbMTk4LCAyMzBdLFxuICBbMTk5LCA5OV0sXG4gIFsyMDAsIDEwMV0sXG4gIFsyMDEsIDEwMV0sXG4gIFsyMDIsIDEwMV0sXG4gIFsyMDMsIDEwMV0sXG4gIFsyMDQsIDEwNV0sXG4gIFsyMDUsIDEwNV0sXG4gIFsyMDYsIDEwNV0sXG4gIFsyMDcsIDEwNV0sXG4gIFsyMDksIDExMF0sXG4gIFsyMTAsIDExMV0sXG4gIFsyMTEsIDExMV0sXG4gIFsyMTIsIDExMV0sXG4gIFsyMTMsIDExMV0sXG4gIFsyMTQsIDExMV0sXG4gIFsyMTYsIDI0OF0sXG4gIFsyMTcsIDExN10sXG4gIFsyMTgsIDExN10sXG4gIFsyMTksIDExN10sXG4gIFsyMjAsIDExN10sXG4gIFsyMjEsIDEyMV0sXG4gIFsyMjQsIDk3XSxcbiAgWzIyNSwgOTddLFxuICBbMjI2LCA5N10sXG4gIFsyMjcsIDk3XSxcbiAgWzIyOCwgOTddLFxuICBbMjI5LCA5N10sXG4gIFsyMzEsIDk5XSxcbiAgWzIzMiwgMTAxXSxcbiAgWzIzMywgMTAxXSxcbiAgWzIzNCwgMTAxXSxcbiAgWzIzNSwgMTAxXSxcbiAgWzIzNiwgMTA1XSxcbiAgWzIzNywgMTA1XSxcbiAgWzIzOCwgMTA1XSxcbiAgWzIzOSwgMTA1XSxcbiAgWzI0MSwgMTEwXSxcbiAgWzI0MiwgMTExXSxcbiAgWzI0MywgMTExXSxcbiAgWzI0NCwgMTExXSxcbiAgWzI0NSwgMTExXSxcbiAgWzI0NiwgMTExXSxcbiAgWzI0OSwgMTE3XSxcbiAgWzI1MCwgMTE3XSxcbiAgWzI1MSwgMTE3XSxcbiAgWzI1MiwgMTE3XSxcbiAgWzI1MywgMTIxXSxcbiAgWzI1NSwgMTIxXSxcbiAgWzI1NiwgOTddLFxuICBbMjU3LCA5N10sXG4gIFsyNTgsIDk3XSxcbiAgWzI1OSwgOTddLFxuICBbMjYwLCA5N10sXG4gIFsyNjEsIDk3XSxcbiAgWzI2MiwgOTldLFxuICBbMjYzLCA5OV0sXG4gIFsyNjQsIDk5XSxcbiAgWzI2NSwgOTldLFxuICBbMjY2LCA5OV0sXG4gIFsyNjcsIDk5XSxcbiAgWzI2OCwgOTldLFxuICBbMjY5LCA5OV0sXG4gIFsyNzAsIDEwMF0sXG4gIFsyNzEsIDEwMF0sXG4gIFsyNzQsIDEwMV0sXG4gIFsyNzUsIDEwMV0sXG4gIFsyNzYsIDEwMV0sXG4gIFsyNzcsIDEwMV0sXG4gIFsyNzgsIDEwMV0sXG4gIFsyNzksIDEwMV0sXG4gIFsyODAsIDEwMV0sXG4gIFsyODEsIDEwMV0sXG4gIFsyODIsIDEwMV0sXG4gIFsyODMsIDEwMV0sXG4gIFsyODQsIDEwM10sXG4gIFsyODUsIDEwM10sXG4gIFsyODYsIDEwM10sXG4gIFsyODcsIDEwM10sXG4gIFsyODgsIDEwM10sXG4gIFsyODksIDEwM10sXG4gIFsyOTAsIDEwM10sXG4gIFsyOTEsIDEwM10sXG4gIFsyOTIsIDEwNF0sXG4gIFsyOTMsIDEwNF0sXG4gIFsyOTYsIDEwNV0sXG4gIFsyOTcsIDEwNV0sXG4gIFsyOTgsIDEwNV0sXG4gIFsyOTksIDEwNV0sXG4gIFszMDAsIDEwNV0sXG4gIFszMDEsIDEwNV0sXG4gIFszMDIsIDEwNV0sXG4gIFszMDMsIDEwNV0sXG4gIFszMDQsIDEwNV0sXG4gIFszMDgsIDEwNl0sXG4gIFszMDksIDEwNl0sXG4gIFszMTAsIDEwN10sXG4gIFszMTEsIDEwN10sXG4gIFszMTMsIDEwOF0sXG4gIFszMTQsIDEwOF0sXG4gIFszMTUsIDEwOF0sXG4gIFszMTYsIDEwOF0sXG4gIFszMTcsIDEwOF0sXG4gIFszMTgsIDEwOF0sXG4gIFszMjMsIDExMF0sXG4gIFszMjQsIDExMF0sXG4gIFszMjUsIDExMF0sXG4gIFszMjYsIDExMF0sXG4gIFszMjcsIDExMF0sXG4gIFszMjgsIDExMF0sXG4gIFszMzIsIDExMV0sXG4gIFszMzMsIDExMV0sXG4gIFszMzQsIDExMV0sXG4gIFszMzUsIDExMV0sXG4gIFszMzYsIDExMV0sXG4gIFszMzcsIDExMV0sXG4gIFszNDAsIDExNF0sXG4gIFszNDEsIDExNF0sXG4gIFszNDIsIDExNF0sXG4gIFszNDMsIDExNF0sXG4gIFszNDQsIDExNF0sXG4gIFszNDUsIDExNF0sXG4gIFszNDYsIDExNV0sXG4gIFszNDcsIDExNV0sXG4gIFszNDgsIDExNV0sXG4gIFszNDksIDExNV0sXG4gIFszNTAsIDExNV0sXG4gIFszNTEsIDExNV0sXG4gIFszNTIsIDExNV0sXG4gIFszNTMsIDExNV0sXG4gIFszNTQsIDExNl0sXG4gIFszNTUsIDExNl0sXG4gIFszNTYsIDExNl0sXG4gIFszNTcsIDExNl0sXG4gIFszNjAsIDExN10sXG4gIFszNjEsIDExN10sXG4gIFszNjIsIDExN10sXG4gIFszNjMsIDExN10sXG4gIFszNjQsIDExN10sXG4gIFszNjUsIDExN10sXG4gIFszNjYsIDExN10sXG4gIFszNjcsIDExN10sXG4gIFszNjgsIDExN10sXG4gIFszNjksIDExN10sXG4gIFszNzAsIDExN10sXG4gIFszNzEsIDExN10sXG4gIFszNzIsIDExOV0sXG4gIFszNzMsIDExOV0sXG4gIFszNzQsIDEyMV0sXG4gIFszNzUsIDEyMV0sXG4gIFszNzYsIDEyMV0sXG4gIFszNzcsIDEyMl0sXG4gIFszNzgsIDEyMl0sXG4gIFszNzksIDEyMl0sXG4gIFszODAsIDEyMl0sXG4gIFszODEsIDEyMl0sXG4gIFszODIsIDEyMl0sXG4gIFs0MTYsIDExMV0sXG4gIFs0MTcsIDExMV0sXG4gIFs0MzEsIDExN10sXG4gIFs0MzIsIDExN10sXG4gIFs0NjEsIDk3XSxcbiAgWzQ2MiwgOTddLFxuICBbNDYzLCAxMDVdLFxuICBbNDY0LCAxMDVdLFxuICBbNDY1LCAxMTFdLFxuICBbNDY2LCAxMTFdLFxuICBbNDY3LCAxMTddLFxuICBbNDY4LCAxMTddLFxuICBbNDY5LCAxMTddLFxuICBbNDcwLCAxMTddLFxuICBbNDcxLCAxMTddLFxuICBbNDcyLCAxMTddLFxuICBbNDczLCAxMTddLFxuICBbNDc0LCAxMTddLFxuICBbNDc1LCAxMTddLFxuICBbNDc2LCAxMTddLFxuICBbNDc4LCA5N10sXG4gIFs0NzksIDk3XSxcbiAgWzQ4MCwgOTddLFxuICBbNDgxLCA5N10sXG4gIFs0ODYsIDEwM10sXG4gIFs0ODcsIDEwM10sXG4gIFs0ODgsIDEwN10sXG4gIFs0ODksIDEwN10sXG4gIFs0OTAsIDExMV0sXG4gIFs0OTEsIDExMV0sXG4gIFs0OTIsIDExMV0sXG4gIFs0OTMsIDExMV0sXG4gIFs0OTYsIDEwNl0sXG4gIFs1MDAsIDEwM10sXG4gIFs1MDEsIDEwM10sXG4gIFs1MDQsIDExMF0sXG4gIFs1MDUsIDExMF0sXG4gIFs1MDYsIDk3XSxcbiAgWzUwNywgOTddLFxuICBbNTEyLCA5N10sXG4gIFs1MTMsIDk3XSxcbiAgWzUxNCwgOTddLFxuICBbNTE1LCA5N10sXG4gIFs1MTYsIDEwMV0sXG4gIFs1MTcsIDEwMV0sXG4gIFs1MTgsIDEwMV0sXG4gIFs1MTksIDEwMV0sXG4gIFs1MjAsIDEwNV0sXG4gIFs1MjEsIDEwNV0sXG4gIFs1MjIsIDEwNV0sXG4gIFs1MjMsIDEwNV0sXG4gIFs1MjQsIDExMV0sXG4gIFs1MjUsIDExMV0sXG4gIFs1MjYsIDExMV0sXG4gIFs1MjcsIDExMV0sXG4gIFs1MjgsIDExNF0sXG4gIFs1MjksIDExNF0sXG4gIFs1MzAsIDExNF0sXG4gIFs1MzEsIDExNF0sXG4gIFs1MzIsIDExN10sXG4gIFs1MzMsIDExN10sXG4gIFs1MzQsIDExN10sXG4gIFs1MzUsIDExN10sXG4gIFs1MzYsIDExNV0sXG4gIFs1MzcsIDExNV0sXG4gIFs1MzgsIDExNl0sXG4gIFs1MzksIDExNl0sXG4gIFs1NDIsIDEwNF0sXG4gIFs1NDMsIDEwNF0sXG4gIFs1NTAsIDk3XSxcbiAgWzU1MSwgOTddLFxuICBbNTUyLCAxMDFdLFxuICBbNTUzLCAxMDFdLFxuICBbNTU0LCAxMTFdLFxuICBbNTU1LCAxMTFdLFxuICBbNTU2LCAxMTFdLFxuICBbNTU3LCAxMTFdLFxuICBbNTU4LCAxMTFdLFxuICBbNTU5LCAxMTFdLFxuICBbNTYwLCAxMTFdLFxuICBbNTYxLCAxMTFdLFxuICBbNTYyLCAxMjFdLFxuICBbNTYzLCAxMjFdLFxuICBbNzY4MCwgOTddLFxuICBbNzY4MSwgOTddLFxuICBbNzY4MiwgOThdLFxuICBbNzY4MywgOThdLFxuICBbNzY4NCwgOThdLFxuICBbNzY4NSwgOThdLFxuICBbNzY4NiwgOThdLFxuICBbNzY4NywgOThdLFxuICBbNzY4OCwgOTldLFxuICBbNzY4OSwgOTldLFxuICBbNzY5MCwgMTAwXSxcbiAgWzc2OTEsIDEwMF0sXG4gIFs3NjkyLCAxMDBdLFxuICBbNzY5MywgMTAwXSxcbiAgWzc2OTQsIDEwMF0sXG4gIFs3Njk1LCAxMDBdLFxuICBbNzY5NiwgMTAwXSxcbiAgWzc2OTcsIDEwMF0sXG4gIFs3Njk4LCAxMDBdLFxuICBbNzY5OSwgMTAwXSxcbiAgWzc3MDAsIDEwMV0sXG4gIFs3NzAxLCAxMDFdLFxuICBbNzcwMiwgMTAxXSxcbiAgWzc3MDMsIDEwMV0sXG4gIFs3NzA0LCAxMDFdLFxuICBbNzcwNSwgMTAxXSxcbiAgWzc3MDYsIDEwMV0sXG4gIFs3NzA3LCAxMDFdLFxuICBbNzcwOCwgMTAxXSxcbiAgWzc3MDksIDEwMV0sXG4gIFs3NzEwLCAxMDJdLFxuICBbNzcxMSwgMTAyXSxcbiAgWzc3MTIsIDEwM10sXG4gIFs3NzEzLCAxMDNdLFxuICBbNzcxNCwgMTA0XSxcbiAgWzc3MTUsIDEwNF0sXG4gIFs3NzE2LCAxMDRdLFxuICBbNzcxNywgMTA0XSxcbiAgWzc3MTgsIDEwNF0sXG4gIFs3NzE5LCAxMDRdLFxuICBbNzcyMCwgMTA0XSxcbiAgWzc3MjEsIDEwNF0sXG4gIFs3NzIyLCAxMDRdLFxuICBbNzcyMywgMTA0XSxcbiAgWzc3MjQsIDEwNV0sXG4gIFs3NzI1LCAxMDVdLFxuICBbNzcyNiwgMTA1XSxcbiAgWzc3MjcsIDEwNV0sXG4gIFs3NzI4LCAxMDddLFxuICBbNzcyOSwgMTA3XSxcbiAgWzc3MzAsIDEwN10sXG4gIFs3NzMxLCAxMDddLFxuICBbNzczMiwgMTA3XSxcbiAgWzc3MzMsIDEwN10sXG4gIFs3NzM0LCAxMDhdLFxuICBbNzczNSwgMTA4XSxcbiAgWzc3MzYsIDEwOF0sXG4gIFs3NzM3LCAxMDhdLFxuICBbNzczOCwgMTA4XSxcbiAgWzc3MzksIDEwOF0sXG4gIFs3NzQwLCAxMDhdLFxuICBbNzc0MSwgMTA4XSxcbiAgWzc3NDIsIDEwOV0sXG4gIFs3NzQzLCAxMDldLFxuICBbNzc0NCwgMTA5XSxcbiAgWzc3NDUsIDEwOV0sXG4gIFs3NzQ2LCAxMDldLFxuICBbNzc0NywgMTA5XSxcbiAgWzc3NDgsIDExMF0sXG4gIFs3NzQ5LCAxMTBdLFxuICBbNzc1MCwgMTEwXSxcbiAgWzc3NTEsIDExMF0sXG4gIFs3NzUyLCAxMTBdLFxuICBbNzc1MywgMTEwXSxcbiAgWzc3NTQsIDExMF0sXG4gIFs3NzU1LCAxMTBdLFxuICBbNzc1NiwgMTExXSxcbiAgWzc3NTcsIDExMV0sXG4gIFs3NzU4LCAxMTFdLFxuICBbNzc1OSwgMTExXSxcbiAgWzc3NjAsIDExMV0sXG4gIFs3NzYxLCAxMTFdLFxuICBbNzc2MiwgMTExXSxcbiAgWzc3NjMsIDExMV0sXG4gIFs3NzY0LCAxMTJdLFxuICBbNzc2NSwgMTEyXSxcbiAgWzc3NjYsIDExMl0sXG4gIFs3NzY3LCAxMTJdLFxuICBbNzc2OCwgMTE0XSxcbiAgWzc3NjksIDExNF0sXG4gIFs3NzcwLCAxMTRdLFxuICBbNzc3MSwgMTE0XSxcbiAgWzc3NzIsIDExNF0sXG4gIFs3NzczLCAxMTRdLFxuICBbNzc3NCwgMTE0XSxcbiAgWzc3NzUsIDExNF0sXG4gIFs3Nzc2LCAxMTVdLFxuICBbNzc3NywgMTE1XSxcbiAgWzc3NzgsIDExNV0sXG4gIFs3Nzc5LCAxMTVdLFxuICBbNzc4MCwgMTE1XSxcbiAgWzc3ODEsIDExNV0sXG4gIFs3NzgyLCAxMTVdLFxuICBbNzc4MywgMTE1XSxcbiAgWzc3ODQsIDExNV0sXG4gIFs3Nzg1LCAxMTVdLFxuICBbNzc4NiwgMTE2XSxcbiAgWzc3ODcsIDExNl0sXG4gIFs3Nzg4LCAxMTZdLFxuICBbNzc4OSwgMTE2XSxcbiAgWzc3OTAsIDExNl0sXG4gIFs3NzkxLCAxMTZdLFxuICBbNzc5MiwgMTE2XSxcbiAgWzc3OTMsIDExNl0sXG4gIFs3Nzk0LCAxMTddLFxuICBbNzc5NSwgMTE3XSxcbiAgWzc3OTYsIDExN10sXG4gIFs3Nzk3LCAxMTddLFxuICBbNzc5OCwgMTE3XSxcbiAgWzc3OTksIDExN10sXG4gIFs3ODAwLCAxMTddLFxuICBbNzgwMSwgMTE3XSxcbiAgWzc4MDIsIDExN10sXG4gIFs3ODAzLCAxMTddLFxuICBbNzgwNCwgMTE4XSxcbiAgWzc4MDUsIDExOF0sXG4gIFs3ODA2LCAxMThdLFxuICBbNzgwNywgMTE4XSxcbiAgWzc4MDgsIDExOV0sXG4gIFs3ODA5LCAxMTldLFxuICBbNzgxMCwgMTE5XSxcbiAgWzc4MTEsIDExOV0sXG4gIFs3ODEyLCAxMTldLFxuICBbNzgxMywgMTE5XSxcbiAgWzc4MTQsIDExOV0sXG4gIFs3ODE1LCAxMTldLFxuICBbNzgxNiwgMTE5XSxcbiAgWzc4MTcsIDExOV0sXG4gIFs3ODE4LCAxMjBdLFxuICBbNzgxOSwgMTIwXSxcbiAgWzc4MjAsIDEyMF0sXG4gIFs3ODIxLCAxMjBdLFxuICBbNzgyMiwgMTIxXSxcbiAgWzc4MjMsIDEyMV0sXG4gIFs3ODI0LCAxMjJdLFxuICBbNzgyNSwgMTIyXSxcbiAgWzc4MjYsIDEyMl0sXG4gIFs3ODI3LCAxMjJdLFxuICBbNzgyOCwgMTIyXSxcbiAgWzc4MjksIDEyMl0sXG4gIFs3ODMwLCAxMDRdLFxuICBbNzgzMSwgMTE2XSxcbiAgWzc4MzIsIDExOV0sXG4gIFs3ODMzLCAxMjFdLFxuICBbNzg0MCwgOTddLFxuICBbNzg0MSwgOTddLFxuICBbNzg0MiwgOTddLFxuICBbNzg0MywgOTddLFxuICBbNzg0NCwgOTddLFxuICBbNzg0NSwgOTddLFxuICBbNzg0NiwgOTddLFxuICBbNzg0NywgOTddLFxuICBbNzg0OCwgOTddLFxuICBbNzg0OSwgOTddLFxuICBbNzg1MCwgOTddLFxuICBbNzg1MSwgOTddLFxuICBbNzg1MiwgOTddLFxuICBbNzg1MywgOTddLFxuICBbNzg1NCwgOTddLFxuICBbNzg1NSwgOTddLFxuICBbNzg1NiwgOTddLFxuICBbNzg1NywgOTddLFxuICBbNzg1OCwgOTddLFxuICBbNzg1OSwgOTddLFxuICBbNzg2MCwgOTddLFxuICBbNzg2MSwgOTddLFxuICBbNzg2MiwgOTddLFxuICBbNzg2MywgOTddLFxuICBbNzg2NCwgMTAxXSxcbiAgWzc4NjUsIDEwMV0sXG4gIFs3ODY2LCAxMDFdLFxuICBbNzg2NywgMTAxXSxcbiAgWzc4NjgsIDEwMV0sXG4gIFs3ODY5LCAxMDFdLFxuICBbNzg3MCwgMTAxXSxcbiAgWzc4NzEsIDEwMV0sXG4gIFs3ODcyLCAxMDFdLFxuICBbNzg3MywgMTAxXSxcbiAgWzc4NzQsIDEwMV0sXG4gIFs3ODc1LCAxMDFdLFxuICBbNzg3NiwgMTAxXSxcbiAgWzc4NzcsIDEwMV0sXG4gIFs3ODc4LCAxMDFdLFxuICBbNzg3OSwgMTAxXSxcbiAgWzc4ODAsIDEwNV0sXG4gIFs3ODgxLCAxMDVdLFxuICBbNzg4MiwgMTA1XSxcbiAgWzc4ODMsIDEwNV0sXG4gIFs3ODg0LCAxMTFdLFxuICBbNzg4NSwgMTExXSxcbiAgWzc4ODYsIDExMV0sXG4gIFs3ODg3LCAxMTFdLFxuICBbNzg4OCwgMTExXSxcbiAgWzc4ODksIDExMV0sXG4gIFs3ODkwLCAxMTFdLFxuICBbNzg5MSwgMTExXSxcbiAgWzc4OTIsIDExMV0sXG4gIFs3ODkzLCAxMTFdLFxuICBbNzg5NCwgMTExXSxcbiAgWzc4OTUsIDExMV0sXG4gIFs3ODk2LCAxMTFdLFxuICBbNzg5NywgMTExXSxcbiAgWzc4OTgsIDExMV0sXG4gIFs3ODk5LCAxMTFdLFxuICBbNzkwMCwgMTExXSxcbiAgWzc5MDEsIDExMV0sXG4gIFs3OTAyLCAxMTFdLFxuICBbNzkwMywgMTExXSxcbiAgWzc5MDQsIDExMV0sXG4gIFs3OTA1LCAxMTFdLFxuICBbNzkwNiwgMTExXSxcbiAgWzc5MDcsIDExMV0sXG4gIFs3OTA4LCAxMTddLFxuICBbNzkwOSwgMTE3XSxcbiAgWzc5MTAsIDExN10sXG4gIFs3OTExLCAxMTddLFxuICBbNzkxMiwgMTE3XSxcbiAgWzc5MTMsIDExN10sXG4gIFs3OTE0LCAxMTddLFxuICBbNzkxNSwgMTE3XSxcbiAgWzc5MTYsIDExN10sXG4gIFs3OTE3LCAxMTddLFxuICBbNzkxOCwgMTE3XSxcbiAgWzc5MTksIDExN10sXG4gIFs3OTIwLCAxMTddLFxuICBbNzkyMSwgMTE3XSxcbiAgWzc5MjIsIDEyMV0sXG4gIFs3OTIzLCAxMjFdLFxuICBbNzkyNCwgMTIxXSxcbiAgWzc5MjUsIDEyMV0sXG4gIFs3OTI2LCAxMjFdLFxuICBbNzkyNywgMTIxXSxcbiAgWzc5MjgsIDEyMV0sXG4gIFs3OTI5LCAxMjFdLFxuICBbODQ5MCwgMTA3XSxcbiAgWzg0OTEsIDk3XV07XG5cbmNvbnN0IGNvZGVQb2ludE1hcHBpbmcgPSAoKCkgPT4ge1xuICBjb25zdCBhcnJheSA9IFtdO1xuICBjb2RlUG9pbnRNYXBwaW5nRGF0YS5mb3JFYWNoKChtYXBwaW5nKSA9PiB7XG4gICAgYXJyYXlbbWFwcGluZ1swXV0gPSBtYXBwaW5nWzFdO1xuICB9KTtcbiAgcmV0dXJuIGFycmF5O1xufSkoKTtcblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gbnBTdHJpbmdTb3J0T3JkZXIoc3RyaW5nWCwgc3RyaW5nWSkge1xuICBsZXQgaW5kZXhYID0gMDtcbiAgbGV0IGluZGV4WSA9IDA7XG4gIHdoaWxlIChpbmRleFggPCBzdHJpbmdYLmxlbmd0aCkge1xuICAgIGlmIChpbmRleFkgPT09IHN0cmluZ1kubGVuZ3RoKSByZXR1cm4gKzE7XG4gICAgY29uc3QgcmVhbENvZGVQb2ludFggPSBzdHJpbmdYLmNvZGVQb2ludEF0KGluZGV4WCk7XG4gICAgY29uc3QgcmVhbENvZGVQb2ludFkgPSBzdHJpbmdZLmNvZGVQb2ludEF0KGluZGV4WSk7XG4gICAgY29uc3QgbWFwcGVkQ29kZVBvaW50WCA9IGNvZGVQb2ludE1hcHBpbmdbcmVhbENvZGVQb2ludFhdIHx8IHJlYWxDb2RlUG9pbnRYO1xuICAgIGNvbnN0IG1hcHBlZENvZGVQb2ludFkgPSBjb2RlUG9pbnRNYXBwaW5nW3JlYWxDb2RlUG9pbnRZXSB8fCByZWFsQ29kZVBvaW50WTtcbiAgICBjb25zdCBvcmRlciA9IG1hcHBlZENvZGVQb2ludFggLSBtYXBwZWRDb2RlUG9pbnRZO1xuICAgIGlmIChvcmRlciAhPT0gMCkgcmV0dXJuIG9yZGVyO1xuICAgIGluZGV4WCArPSByZWFsQ29kZVBvaW50WCA+IDB4ZmZmZiA/IDIgOiAxO1xuICAgIGluZGV4WSArPSByZWFsQ29kZVBvaW50WSA+IDB4ZmZmZiA/IDIgOiAxO1xuICB9XG4gIHJldHVybiBpbmRleFkgPT09IHN0cmluZ1kubGVuZ3RoID8gMCA6IC0xO1xufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./common/stringSortOrder.js\n");

/***/ }),

/***/ "./globalConfiguration.ts":
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

"use strict";
eval("\n\nObject.defineProperty(exports, \"__esModule\", ({\n  value: true\n}));\nexports.ensureInlinedSVGIconsAndDateFormatConfig = exports.ensureInlinedSVGIconsConfig = exports.ensureResourceUrlAndMomentJSDateFormatConfigSettings = void 0;\nvar react_global_configuration_1 = __webpack_require__(\"./node_modules/react-global-configuration/build/index.js\");\n// Feel free to change if the config becomes more complex\nfunction ensureResourceUrlAndDateFormatConfig(resourceUrl, dateFormat) {\n  if (react_global_configuration_1.default.serialize() === 'null') {\n    react_global_configuration_1.default.set({\n      resourceUrl: resourceUrl,\n      dateFormat: dateFormat\n    }, {\n      freeze: false\n    });\n  } else {\n    react_global_configuration_1.default.set({\n      resourceUrl: resourceUrl,\n      dateFormat: dateFormat\n    }, {\n      freeze: false,\n      assign: true\n    });\n  }\n}\nexports[\"default\"] = ensureResourceUrlAndDateFormatConfig;\nfunction ensureResourceUrlAndMomentJSDateFormatConfigSettings(resourceUrl, momentJSDateFormatSettings) {\n  if (react_global_configuration_1.default.serialize() === 'null') {\n    react_global_configuration_1.default.set({\n      resourceUrl: resourceUrl,\n      momentJSDateFormatSettings: momentJSDateFormatSettings\n    }, {\n      freeze: false\n    });\n  } else {\n    react_global_configuration_1.default.set({\n      resourceUrl: resourceUrl,\n      momentJSDateFormatSettings: momentJSDateFormatSettings\n    }, {\n      freeze: false,\n      assign: true\n    });\n  }\n}\nexports.ensureResourceUrlAndMomentJSDateFormatConfigSettings = ensureResourceUrlAndMomentJSDateFormatConfigSettings;\nfunction ensureInlinedSVGIconsConfig() {\n  if (react_global_configuration_1.default.serialize() === 'null') {\n    react_global_configuration_1.default.set({\n      inlinedSVGIcons: true\n    }, {\n      freeze: false\n    });\n  } else {\n    react_global_configuration_1.default.set({\n      inlinedSVGIcons: true\n    }, {\n      freeze: false,\n      assign: true\n    });\n  }\n}\nexports.ensureInlinedSVGIconsConfig = ensureInlinedSVGIconsConfig;\nfunction ensureInlinedSVGIconsAndDateFormatConfig(dateFormat) {\n  if (react_global_configuration_1.default.serialize() === 'null') {\n    react_global_configuration_1.default.set({\n      inlinedSVGIcons: true,\n      dateFormat: dateFormat\n    }, {\n      freeze: false\n    });\n  } else {\n    react_global_configuration_1.default.set({\n      inlinedSVGIcons: true,\n      dateFormat: dateFormat\n    }, {\n      freeze: false,\n      assign: true\n    });\n  }\n}\nexports.ensureInlinedSVGIconsAndDateFormatConfig = ensureInlinedSVGIconsAndDateFormatConfig;//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9nbG9iYWxDb25maWd1cmF0aW9uLnRzLmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFOQTtBQVFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQU5BO0FBUUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUNBO0FBQ0E7QUFOQTtBQVFBO0FBQ0E7QUFDQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFDQTtBQUNBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQU5BIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vUmVhY3RDb21wb25lbnRzXy8uL2dsb2JhbENvbmZpZ3VyYXRpb24udHM/ODRkZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgY29uZmlnIGZyb20gJ3JlYWN0LWdsb2JhbC1jb25maWd1cmF0aW9uJztcblxuLy8gRmVlbCBmcmVlIHRvIGNoYW5nZSBpZiB0aGUgY29uZmlnIGJlY29tZXMgbW9yZSBjb21wbGV4XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBlbnN1cmVSZXNvdXJjZVVybEFuZERhdGVGb3JtYXRDb25maWcocmVzb3VyY2VVcmwsIGRhdGVGb3JtYXQpIHtcbiAgICBpZiAoY29uZmlnLnNlcmlhbGl6ZSgpID09PSAnbnVsbCcpIHtcbiAgICAgICAgY29uZmlnLnNldCh7IHJlc291cmNlVXJsLCBkYXRlRm9ybWF0IH0sIHsgZnJlZXplOmZhbHNlIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbmZpZy5zZXQoeyByZXNvdXJjZVVybCwgZGF0ZUZvcm1hdCB9LCB7IGZyZWV6ZTpmYWxzZSwgYXNzaWduOiB0cnVlIH0pOyAgICAgIFxuICAgIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGVuc3VyZVJlc291cmNlVXJsQW5kTW9tZW50SlNEYXRlRm9ybWF0Q29uZmlnU2V0dGluZ3MocmVzb3VyY2VVcmwsIG1vbWVudEpTRGF0ZUZvcm1hdFNldHRpbmdzKSB7XG4gICAgaWYgKGNvbmZpZy5zZXJpYWxpemUoKSA9PT0gJ251bGwnKSB7XG4gICAgICAgIGNvbmZpZy5zZXQoeyByZXNvdXJjZVVybCwgbW9tZW50SlNEYXRlRm9ybWF0U2V0dGluZ3MgfSwgeyBmcmVlemU6ZmFsc2UgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY29uZmlnLnNldCh7IHJlc291cmNlVXJsLCBtb21lbnRKU0RhdGVGb3JtYXRTZXR0aW5ncyB9LCB7IGZyZWV6ZTpmYWxzZSwgYXNzaWduOiB0cnVlIH0pOyAgICAgICBcbiAgICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBlbnN1cmVJbmxpbmVkU1ZHSWNvbnNDb25maWcoKSB7XG4gICAgaWYgKGNvbmZpZy5zZXJpYWxpemUoKSA9PT0gJ251bGwnKSB7XG4gICAgICAgIGNvbmZpZy5zZXQoeyBpbmxpbmVkU1ZHSWNvbnM6IHRydWUgfSwgeyBmcmVlemU6ZmFsc2UgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY29uZmlnLnNldCh7IGlubGluZWRTVkdJY29uczogdHJ1ZSB9LCB7IGZyZWV6ZTpmYWxzZSwgYXNzaWduOiB0cnVlIH0pOyAgICAgICAgXG4gICAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZW5zdXJlSW5saW5lZFNWR0ljb25zQW5kRGF0ZUZvcm1hdENvbmZpZyhkYXRlRm9ybWF0KSB7XG4gICAgaWYgKGNvbmZpZy5zZXJpYWxpemUoKSA9PT0gJ251bGwnKSB7XG4gICAgICAgIGNvbmZpZy5zZXQoeyBpbmxpbmVkU1ZHSWNvbnM6IHRydWUsIGRhdGVGb3JtYXQgfSwgeyBmcmVlemU6ZmFsc2UgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY29uZmlnLnNldCh7IGlubGluZWRTVkdJY29uczogdHJ1ZSwgZGF0ZUZvcm1hdCB9LCB7IGZyZWV6ZTpmYWxzZSwgYXNzaWduOiB0cnVlIH0pOyAgICAgICBcbiAgICB9XG59Il0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./globalConfiguration.ts\n");

/***/ }),

/***/ "./node_modules/moment/locale sync recursive nl%7Cfr%7Cen":
/***/ (function(module, __unused_webpack_exports, __webpack_require__) {

var map = {
	"./en-au": "./node_modules/moment/locale/en-au.js",
	"./en-au.js": "./node_modules/moment/locale/en-au.js",
	"./en-ca": "./node_modules/moment/locale/en-ca.js",
	"./en-ca.js": "./node_modules/moment/locale/en-ca.js",
	"./en-gb": "./node_modules/moment/locale/en-gb.js",
	"./en-gb.js": "./node_modules/moment/locale/en-gb.js",
	"./en-ie": "./node_modules/moment/locale/en-ie.js",
	"./en-ie.js": "./node_modules/moment/locale/en-ie.js",
	"./en-il": "./node_modules/moment/locale/en-il.js",
	"./en-il.js": "./node_modules/moment/locale/en-il.js",
	"./en-in": "./node_modules/moment/locale/en-in.js",
	"./en-in.js": "./node_modules/moment/locale/en-in.js",
	"./en-nz": "./node_modules/moment/locale/en-nz.js",
	"./en-nz.js": "./node_modules/moment/locale/en-nz.js",
	"./en-sg": "./node_modules/moment/locale/en-sg.js",
	"./en-sg.js": "./node_modules/moment/locale/en-sg.js",
	"./fr": "./node_modules/moment/locale/fr.js",
	"./fr-ca": "./node_modules/moment/locale/fr-ca.js",
	"./fr-ca.js": "./node_modules/moment/locale/fr-ca.js",
	"./fr-ch": "./node_modules/moment/locale/fr-ch.js",
	"./fr-ch.js": "./node_modules/moment/locale/fr-ch.js",
	"./fr.js": "./node_modules/moment/locale/fr.js",
	"./nl": "./node_modules/moment/locale/nl.js",
	"./nl-be": "./node_modules/moment/locale/nl-be.js",
	"./nl-be.js": "./node_modules/moment/locale/nl-be.js",
	"./nl.js": "./node_modules/moment/locale/nl.js"
};


function webpackContext(req) {
	var id = webpackContextResolve(req);
	return __webpack_require__(id);
}
function webpackContextResolve(req) {
	if(!__webpack_require__.o(map, req)) {
		var e = new Error("Cannot find module '" + req + "'");
		e.code = 'MODULE_NOT_FOUND';
		throw e;
	}
	return map[req];
}
webpackContext.keys = function webpackContextKeys() {
	return Object.keys(map);
};
webpackContext.resolve = webpackContextResolve;
module.exports = webpackContext;
webpackContext.id = "./node_modules/moment/locale sync recursive nl%7Cfr%7Cen";

/***/ }),

/***/ "?4f7e":
/***/ (function() {

/* (ignored) */

/***/ })

},
/******/ function(__webpack_require__) { // webpackRuntimeModules
/******/ var __webpack_exec__ = function(moduleId) { return __webpack_require__(__webpack_require__.s = moduleId); }
/******/ __webpack_require__.O(0, ["vendor"], function() { return __webpack_exec__("./Treeview/treeview.js"); });
/******/ var __webpack_exports__ = __webpack_require__.O();
/******/ ReactComponents_treeview = __webpack_exports__;
/******/ }
]);